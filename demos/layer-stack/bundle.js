!function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function i(){return Object.create(null)}function s(e){e.forEach(n)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,...n){if(null==t){for(const e of n)e(void 0);return e}const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function l(e){let t;return a(e,(e=>t=e))(),t}function c(e,t,n){e.$$.on_destroy.push(a(t,n))}function u(e,t,n,i){if(e){const s=h(e,t,n,i);return e[0](s)}}function h(e,n,i,s){return e[1]&&s?t(i.ctx.slice(),e[1](s(n))):i.ctx}function p(e,t,n,i){if(e[2]&&i){const s=e[2](i(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|s[i];return e}return t.dirty|s}return t.dirty}function d(e,t,n,i,s,r){if(s){const o=h(t,n,i,r);e.p(o,s)}}function m(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function v(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function f(e,t){const n={};t=new Set(t);for(const i in e)t.has(i)||"$"===i[0]||(n[i]=e[i]);return n}function g(e,t,n){return e.set(n),t}const b="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function w(e,t,n){e.insertBefore(t,n||null)}function _(e){e.parentNode&&e.parentNode.removeChild(e)}function y(e){return document.createElement(e)}function x(e){return document.createTextNode(e)}function C(){return x(" ")}function P(){return x("")}function $(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function E(e,t,n,i){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}let k,V;function S(){if(void 0===k){k=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){k=!0}}return k}function L(e,t,n){e.classList.toggle(t,!!n)}function M(e){V=e}function A(){if(!V)throw new Error("Function called outside component initialization");return V}function D(e){A().$$.on_mount.push(e)}function j(e){A().$$.on_destroy.push(e)}function T(){const e=A();return(t,n,{cancelable:i=!1}={})=>{const s=e.$$.callbacks[t];if(s){const r=function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:i})}(t,n,{cancelable:i});return s.slice().forEach((t=>{t.call(e,r)})),!r.defaultPrevented}return!0}}function O(e,t){return A().$$.context.set(e,t),t}function B(e){return A().$$.context.get(e)}function z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const N=[],F=[];let I=[];const R=[],q=Promise.resolve();let U=!1;function K(){U||(U=!0,q.then(W))}function H(e){I.push(e)}function G(e){R.push(e)}const Y=new Set;let X=0;function W(){if(0!==X)return;const e=V;do{try{for(;X<N.length;){const e=N[X];X++,M(e),Z(e.$$)}}catch(e){throw N.length=0,X=0,e}for(M(null),N.length=0,X=0;F.length;)F.pop()();for(let e=0;e<I.length;e+=1){const t=I[e];Y.has(t)||(Y.add(t),t())}I.length=0}while(N.length);for(;R.length;)R.pop()();U=!1,Y.clear(),M(e)}function Z(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(H)}}const Q=new Set;let J;function ee(){J={r:0,c:[],p:J}}function te(){J.r||s(J.c),J=J.p}function ne(e,t){e&&e.i&&(Q.delete(e),e.i(t))}function ie(e,t,n,i){if(e&&e.o){if(Q.has(e))return;Q.add(e),J.c.push((()=>{Q.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}function se(e){return void 0!==e?.length?e:Array.from(e)}function re(e,t){const n={},i={},s={$$scope:1};let r=e.length;for(;r--;){const o=e[r],a=t[r];if(a){for(const e in o)e in a||(i[e]=1);for(const e in a)s[e]||(n[e]=a[e],s[e]=1);e[r]=a}else for(const e in o)s[e]=1}for(const e in i)e in n||(n[e]=void 0);return n}function oe(e){return"object"==typeof e&&null!==e?e:{}}function ae(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function le(e){e&&e.c()}function ce(e,t,i){const{fragment:o,after_update:a}=e.$$;o&&o.m(t,i),H((()=>{const t=e.$$.on_mount.map(n).filter(r);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),a.forEach(H)}function ue(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];I.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),I=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function he(t,n,r,o,a,l,c=null,u=[-1]){const h=V;M(t);const p=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||h.$$.root};c&&c(p.root);let d=!1;if(p.ctx=r?r(t,n.props||{},((e,n,...i)=>{const s=i.length?i[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=s)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](s),d&&function(e,t){-1===e.$$.dirty[0]&&(N.push(e),K(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,s(p.before_update),p.fragment=!!o&&o(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(_)}else p.fragment&&p.fragment.c();n.intro&&ne(t.$$.fragment),ce(t,n.target,n.anchor),W()}M(h)}class pe{$$=void 0;$$set=void 0;$destroy(){ue(this,1),this.$destroy=e}$on(t,n){if(!r(n))return e;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const de=[];function me(t,n=e){let i;const s=new Set;function r(e){if(o(t,e)&&(t=e,i)){const e=!de.length;for(const e of s)e[1](),de.push(e,t);if(e){for(let e=0;e<de.length;e+=2)de[e][0](de[e+1]);de.length=0}}}function a(e){r(e(t))}return{set:r,update:a,subscribe:function(o,l=e){const c=[o,l];return s.add(c),1===s.size&&(i=n(r,a)||e),o(t),()=>{s.delete(c),0===s.size&&i&&(i(),i=null)}}}}class ve{#e;#t;#n="";#i="Arial";#s=48;#r=!1;#o=20;#a="#ffffff";#l="#ffffff";#c=1;#u=null;#h=0;#p=0;#d=0;#m=0;#v=null;#f="#000000";#g=null;#b=0;#w=document.createElement("canvas");#_=this.#w.getContext("2d");constructor(e,t){this.#e=e,this.#t=t}static create(e,t){return new ve(e,t)}text(e){return this.#n=e,this}fontFamily(e){return this.#i=e,this}fontSize(e){return this.#s=e,this.#r=!1,this}autoFontSize(e=!0){return this.#r=e,this}padding(e){return this.#o=e,this}fillStyle(e){return this.#a=e,this}strokeStyle(e,t=1){return this.#l=e,this.#c=t,this}glow(e,t,n=0,i=0){return this.#u=e,this.#h=t,this.#p=n,this.#d=i,this}blur(e){return this.#m=e,this}innerGlow(e,t){return this.#g=e,this.#b=t,this}gradient(e){return this.#v=e,this}background(e){return this.#f=e,this}#y(e,t,n){let i=10,s=i,r=0,o=0;const a=this.#_,l=this.#o;for(;a.font=`${i}px ${this.#i}`,r=a.measureText(e).width,o=i,!(r>t-2*l||o>n-2*l);)s=i,i+=2;return s}#x(){if(this.#r){return`${this.#y(this.#n,this.#e,this.#t)}px ${this.#i}`}return`${this.#s}px ${this.#i}`}#C(){const e=document.createElement("canvas");e.width=this.#e,e.height=this.#t;const t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.fillStyle=this.#f,i.fillRect(0,0,n.width,n.height),this.#u&&this.#h>0&&(i.shadowColor=this.#u,i.shadowBlur=this.#h,i.shadowOffsetX=this.#p,i.shadowOffsetY=this.#d),i.font=this.#x(),i.textAlign="center",i.textBaseline="middle";const s=n.width/2,r=n.height/2;if(this.#v){const e=i.createLinearGradient(0,0,n.width,0);this.#v.forEach(((t,n)=>{e.addColorStop(n/(this.#v.length-1),t)})),i.fillStyle=e}else i.fillStyle=this.#a;if(i.fillText(this.#n,s,r),this.#c>0&&(i.strokeStyle=this.#l,i.lineWidth=this.#c,i.strokeText(this.#n,s,r)),i.shadowColor="transparent",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0,i.filter="none",this.#m>0&&(i.filter=`blur(${this.#m}px)`,i.drawImage(n,0,0),i.filter="none"),t.drawImage(n,0,0),this.#g&&this.#b>0){const e=document.createElement("canvas");e.width=n.width,e.height=n.height;const i=e.getContext("2d");i.font=this.#x(),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#fff",i.fillText(this.#n,n.width/2,n.height/2);const s=i.getImageData(0,0,n.width,n.height),r=document.createElement("canvas");r.width=n.width,r.height=n.height;const o=r.getContext("2d");o.fillStyle=this.#a,o.fillRect(0,0,n.width,n.height),o.font=this.#x(),o.textAlign="center",o.textBaseline="middle",o.fillStyle=this.#g,o.fillText(this.#n,n.width/2,n.height/2);const a=document.createElement("canvas");a.width=n.width,a.height=n.height;const l=a.getContext("2d");l.filter=`blur(${this.#b}px)`,l.drawImage(r,0,0),l.filter="none",o.clearRect(0,0,n.width,n.height),o.drawImage(a,0,0);const c=o.getImageData(0,0,n.width,n.height);for(let e=0;e<c.data.length;e+=4)0===s.data[e+3]&&(c.data[e+3]=0);o.putImageData(c,0,0),t.drawImage(r,0,0)}return e}toCanvas(){return this.#C()}}class fe{constructor(e,t,n){this.x=e,this.y=t,this.z=n}dot3(e,t,n){return this.x*e+this.y*t+this.z*n}}const ge=[new fe(1,1,0),new fe(-1,1,0),new fe(1,-1,0),new fe(-1,-1,0),new fe(1,0,1),new fe(-1,0,1),new fe(1,0,-1),new fe(-1,0,-1),new fe(0,1,1),new fe(0,-1,1),new fe(0,1,-1),new fe(0,-1,-1)],be=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class we{#P=new Array(512);#$=new Array(512);#E=0;constructor(e={}){const{seed:t}=e;this.#k(t)}get time(){return this.#E}setTime(e){this.#E=e}advanceTime(e){this.#E+=e}getValue(e,t){return this.#V(e,t,this.#E)}#k(e){let t=this.#P,n=this.#$,i=be.slice();if("number"!=typeof e)for(let e=0;e<512;e++)t[e]=i[255&e],n[e]=ge[t[e]%12];else{let s=(e=>()=>(e=1664525*e+1013904223&4294967295)>>>0)(e);for(let e=255;e>0;e--){let t=s()%(e+1);[i[e],i[t]]=[i[t],i[e]]}for(let e=0;e<512;e++)t[e]=i[255&e],n[e]=ge[t[e]%12]}}static#S(e){return e*e*e*(e*(6*e-15)+10)}static#L(e,t,n){return e+n*(t-e)}#V(e,t,n){let i=Math.floor(e),s=Math.floor(t),r=Math.floor(n);e-=i,t-=s,n-=r,i&=255,s&=255,r&=255;const o=this.#$,a=this.#P,l=o[i+a[s+a[r]]].dot3(e,t,n),c=o[i+a[s+a[r+1]]].dot3(e,t,n-1),u=o[i+a[s+1+a[r]]].dot3(e,t-1,n),h=o[i+a[s+1+a[r+1]]].dot3(e,t-1,n-1),p=o[i+1+a[s+a[r]]].dot3(e-1,t,n),d=o[i+1+a[s+a[r+1]]].dot3(e-1,t,n-1),m=o[i+1+a[s+1+a[r]]].dot3(e-1,t-1,n),v=o[i+1+a[s+1+a[r+1]]].dot3(e-1,t-1,n-1),f=we.#S(e),g=we.#S(t),b=we.#S(n);return we.#L(we.#L(we.#L(l,p,f),we.#L(c,d,f),b),we.#L(we.#L(u,m,f),we.#L(h,v,f),b),g)}}class _e{static#L(e,t,n){return(1-n)*e+n*t}static#M(e){return e<0?0:e>1?1:e*e*e*(10+e*(6*e-15))}static#A(e){let t=2654435769*(12345391^e);return t^=t<<6^t>>>26,t=2654435769*t>>>0,t+=t<<5^t>>>12,t>>>0}static#D(e,t,n){return t+(n-t)*(_e.#A(e)/4294967295)}#j;#T;#P;#O;#B;#z;#N;#F;#I;constructor(e={}){let{seed:t=171717,spinVariation:n=.2,N:i=128}=e;this.#j=i,this.#T=new Array(this.#j),this.#P=new Array(this.#j),this.#O=new Array(this.#j),this.#B=new Array(this.#j),this.#z=new Array(this.#j),this.#N=new Array(this.#j);for(let e=0;e<this.#j;++e)this.#z[e]=1,this.#N[e]=0;this.#F=0,this.#I=0;for(let e=0;e<this.#j;++e){const t=e/this.#j*2*Math.PI,n={x:Math.cos(t),y:Math.sin(t)};this.#T[e]={x:n.x,y:n.y},this.#P[e]=e}this.#R(t),t+=this.#j;for(let e=0;e<this.#j;++e){this.#O[e]={x:this.#T[e].x,y:this.#T[e].y};const i=_e.#D(t++,1-.5*n,1+.5*n);this.#B[e]=2*Math.PI*i}}#R(e){for(let t=1;t<this.#j;++t){const n=_e.#A(e++)%(t+1),i=this.#P[n];this.#P[n]=this.#P[t],this.#P[t]=i}}#q(e,t){const n=this.#j,i=(e%n+n)%n,s=(t%n+n)%n;return this.#P[(this.#P[i]+s)%n]}get time(){return this.#F}setTime(e){if(e!==this.#F){this.#F=e;for(let t=0;t<this.#j;++t){const n=this.#B[t]*e,i=Math.cos(n),s=Math.sin(n),r=this.#O[t];this.#T[t].x=i*r.x+s*r.y,this.#T[t].y=-s*r.x+i*r.y}}}advanceTime(e){this.#F+=e;for(let t=0;t<this.#j;++t){e!==this.#I&&(this.#z[t]=Math.cos(this.#B[t]*e),this.#N[t]=Math.sin(this.#B[t]*e));const n=this.#T[t].x,i=this.#T[t].y;this.#T[t].x=n*this.#z[t]+i*this.#N[t],this.#T[t].y=-n*this.#N[t]+i*this.#z[t]}this.#I=e}getValue(e,t){const n=Math.floor(e),i=Math.floor(t),s=n,r=i,o=this.#T[this.#q(s,r)],a=this.#T[this.#q(s+1,r)],l=this.#T[this.#q(s,r+1)],c=this.#T[this.#q(s+1,r+1)],u=e-n,h=t-i,p=_e.#M(u),d=_e.#M(h),m=u*o.x+h*o.y,v=(u-1)*a.x+h*a.y,f=u*l.x+(h-1)*l.y,g=(u-1)*c.x+(h-1)*c.y,b=_e.#L(m,v,p),w=_e.#L(f,g,p);return _e.#L(b,w,d)/.7071}}function ye(e,t,n){let i=1,s=!1;for(const r of e)r.enabled&&(i*=r.getValue(t,n),s=!0);return s?i:1}function xe(e,t,n){return(n=Math.max(0,Math.min(1,(n-e)/(t-e))))*n*(3-2*n)}const Ce=[{text:"Additive",value:"additive"},{text:"Subtract",value:"subtract"},{text:"Multiply",value:"multiply"},{text:"Screen",value:"screen"},{text:"Overlay",value:"overlay"},{text:"Max",value:"max"},{text:"Min",value:"min"},{text:"Average",value:"average"}];const Pe=function(){const e={blendingMode:"additive"},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setBlendingMode(e){i((t=>({...t,blendingMode:e})))},reset(){n({...e})}}}();const $e=function(){const e={enableMasking:!0,radius:100,fadeOutDuration:1,autoFadeDuration:1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setEnableMasking(e){i((t=>({...t,enableMasking:e})))},setRadius(e){i((t=>({...t,radius:e})))},setFadeOutDuration(e){i((t=>({...t,fadeOutDuration:e})))},setAutoFadeDuration(e){i((t=>({...t,autoFadeDuration:e})))},reset(){n({...e})}}}();const Ee=function(){const e={enabled:!0,gain:1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setEnabled(e){i((t=>({...t,enabled:e})))},setGain(e){i((t=>({...t,gain:e})))},reset(){n({...e})}}}();const ke=function(){const e={seed:0},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSeed:e=>i((t=>({...t,seed:e}))),reset:()=>n({...e})}}();const Ve=function(){const e={seed:0,spinVariation:.2,N:128},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSeed:e=>i((t=>({...t,seed:e}))),setSpinVariation:e=>i((t=>({...t,spinVariation:e}))),setN:e=>i((t=>({...t,N:e}))),reset:()=>n({...e})}}();const Se=function(){const e={baseType:"PerlinNoise2DTime",perlinBaseParams:{seed:0},flowBaseParams:{seed:0,spinVariation:.2,N:128},octaves:4,persistence:.5,lacunarity:2},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setBaseType:e=>i((t=>({...t,baseType:e}))),setPerlinBaseParams:e=>i((t=>({...t,perlinBaseParams:e}))),setFlowBaseParams:e=>i((t=>({...t,flowBaseParams:e}))),setOctaves:e=>i((t=>({...t,octaves:e}))),setPersistence:e=>i((t=>({...t,persistence:e}))),setLacunarity:e=>i((t=>({...t,lacunarity:e}))),reset:()=>n({...e})}}();const Le=function(){const e={baseType:"PerlinNoise2DTime",perlinBaseParams:{seed:0},flowBaseParams:{seed:0,spinVariation:.2,N:128},octaves:4,persistence:.5,lacunarity:2},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setBaseType:e=>i((t=>({...t,baseType:e}))),setPerlinBaseParams:e=>i((t=>({...t,perlinBaseParams:e}))),setFlowBaseParams:e=>i((t=>({...t,flowBaseParams:e}))),setOctaves:e=>i((t=>({...t,octaves:e}))),setPersistence:e=>i((t=>({...t,persistence:e}))),setLacunarity:e=>i((t=>({...t,lacunarity:e}))),reset:()=>n({...e})}}(),Me={PerlinNoise2DTime:ke,FlowNoise2DTime:Ve,FBMNoise2DTime:Se,TurbulenceNoise2DTime:Le},Ae=[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"},{text:"FBMNoise2DTime",value:"FBMNoise2DTime"},{text:"TurbulenceNoise2DTime",value:"TurbulenceNoise2DTime"}];const De=function(){const e="PerlinNoise2DTime",{subscribe:t,set:n}=me(e);return{subscribe:t,set:n,reset:()=>n(e)}}();const je=function(){const{subscribe:e,set:t}=me(.05);return{subscribe:e,set:t,reset:()=>t(.05)}}();const Te=function(){const{subscribe:e,set:t}=me(20);return{subscribe:e,set:t,reset:()=>t(20)}}();const Oe=function(){const e={PerlinNoise2DTime:!1,FlowNoise2DTime:!1,FBMNoise2DTime:!1,TurbulenceNoise2DTime:!1,noiseType:!1,frequency:!1,noiseSpeed:!1},{subscribe:t,set:n,update:i}=me({...e});return ke.subscribe((()=>i((e=>({...e,PerlinNoise2DTime:!0}))))),Ve.subscribe((()=>i((e=>({...e,FlowNoise2DTime:!0}))))),Se.subscribe((()=>i((e=>({...e,FBMNoise2DTime:!0}))))),Le.subscribe((()=>i((e=>({...e,TurbulenceNoise2DTime:!0}))))),De.subscribe((()=>i((e=>({...e,noiseType:!0}))))),je.subscribe((()=>i((e=>({...e,frequency:!0}))))),Te.subscribe((()=>i((e=>({...e,noiseSpeed:!0}))))),{subscribe:t,clear:function(e){i((t=>({...t,[e]:!1})))},clearAll:function(){n({...e})}}}();const Be=function(){const e={enabled:!0,gain:1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setEnabled(e){i((t=>({...t,enabled:e})))},setGain(e){i((t=>({...t,gain:e})))},reset(){n({...e})}}}(),ze=Object.freeze({ARIAL:"Arial",VERDANA:"Verdana",TIMES_NEW_ROMAN:"Times New Roman"}),Ne=[{text:"Arial",value:ze.ARIAL},{text:"Verdana",value:ze.VERDANA},{text:"Times New Roman",value:ze.TIMES_NEW_ROMAN}];const Fe=function(){const e={text:"Hello World",fontFamily:ze.ARIAL,fontSizeAuto:!0,fontSizeManual:48,padding:20,fillStyle:"#0000ff",strokeStyle:"#000099",strokeWidth:3,glowColor:"#0000cc",glowSize:10,shadowOffsetX:0,shadowOffsetY:0,blurAmount:3,innerGlowColor:"#000044",innerGlowBlur:0,backgroundColor:"#000000",gradientColors:["#000066","#0000ff","#000066"],useGradient:!1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setText:e=>i((t=>({...t,text:e}))),setFontFamily:e=>i((t=>({...t,fontFamily:e}))),setFontSizeAuto:e=>i((t=>({...t,fontSizeAuto:e}))),setFontSizeManual:e=>i((t=>({...t,fontSizeManual:e}))),setPadding:e=>i((t=>({...t,padding:e}))),setFillStyle:e=>i((t=>({...t,fillStyle:e}))),setStrokeStyle:e=>i((t=>({...t,strokeStyle:e}))),setStrokeWidth:e=>i((t=>({...t,strokeWidth:e}))),setGlowColor:e=>i((t=>({...t,glowColor:e}))),setGlowSize:e=>i((t=>({...t,glowSize:e}))),setShadowOffsetX:e=>i((t=>({...t,shadowOffsetX:e}))),setShadowOffsetY:e=>i((t=>({...t,shadowOffsetY:e}))),setBlurAmount:e=>i((t=>({...t,blurAmount:e}))),setInnerGlowColor:e=>i((t=>({...t,innerGlowColor:e}))),setInnerGlowBlur:e=>i((t=>({...t,innerGlowBlur:e}))),setBackgroundColor:e=>i((t=>({...t,backgroundColor:e}))),setGradientColors:e=>i((t=>({...t,gradientColors:e}))),setUseGradient:e=>i((t=>({...t,useGradient:e}))),reset:()=>n({...e})}}();const Ie=function(){const e={animating:!0,speed:1,useAdvanceTime:!1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSpeed(e){i((t=>({...t,speed:e})))},setAnimating(e){i((t=>({...t,animating:e})))},setUseAdvanceTime(e){i((t=>({...t,useAdvanceTime:e})))},reset(){n({...e})}}}(),Re=Object.freeze({GRAYSCALE:"grayscale",HEIGHT_BANDS:"heightbands",GEOGRAPHICAL:"geographical"}),qe=[{text:"Grayscale",value:Re.GRAYSCALE},{text:"Height Bands",value:Re.HEIGHT_BANDS},{text:"Geographical",value:Re.GEOGRAPHICAL}];const Ue=function(){const e={colorMode:"grayscale",showScaleVisualization:!0},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setColorMode:e=>i((t=>({...t,colorMode:e}))),setShowScaleVisualization:e=>i((t=>({...t,showScaleVisualization:e}))),reset:()=>n({...e})}}();function Ke(e){return null==e}function He(e){return null!==e&&"object"==typeof e}function Ge(e){return null!==e&&"object"==typeof e}function Ye(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Xe(e,t){return Array.from(new Set([...Object.keys(e),...Object.keys(t)])).reduce(((n,i)=>{const s=e[i],r=t[i];return Ge(s)&&Ge(r)?Object.assign(Object.assign({},n),{[i]:Xe(s,r)}):Object.assign(Object.assign({},n),{[i]:i in t?r:s})}),{})}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const We={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:e=>`Not compatible with  plugin '${e.id}'`,propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Ze{static alreadyDisposed(){return new Ze({type:"alreadydisposed"})}static notBindable(){return new Ze({type:"notbindable"})}static notCompatible(e,t){return new Ze({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Ze({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Ze({type:"shouldneverhappen"})}constructor(e){var t;this.message=null!==(t=We[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Qe{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return null!==e&&("object"==typeof e||"function"==typeof e)}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const n=this.read();if(!Qe.isBindable(n))throw Ze.notBindable();if(!(e in n))throw Ze.propertyNotFound(e);n[e]=t}}class Je{constructor(){this.observers_={}}on(e,t,n){var i;let s=this.observers_[e];return s||(s=this.observers_[e]=[]),s.push({handler:t,key:null!==(i=null==n?void 0:n.key)&&void 0!==i?i:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter((e=>e.key!==t))),this}emit(e,t){const n=this.observers_[e];n&&n.forEach((e=>{e.handler(t)}))}}class et{constructor(e,t){var n;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(n=null==t?void 0:t.equals)&&void 0!==n?n:(e,t)=>e===t,this.emitter=new Je,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;(!this.equals_(s,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class tt{constructor(e){this.emitter=new Je,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.value_;(i!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}class nt{constructor(e){this.emitter=new Je,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function it(e,t){const n=null==t?void 0:t.constraint,i=null==t?void 0:t.equals;return n||i?new et(e,t):new tt(e)}class st{constructor(e){this.emitter=new Je,this.valMap_=e;for(const e in this.valMap_){this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}}static createCore(e){return Object.keys(e).reduce(((t,n)=>Object.assign(t,{[n]:it(e[n])})),{})}static fromObject(e){const t=this.createCore(e);return new st(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class rt{constructor(e){this.values=st.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class ot{constructor(e){this.values=st.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let i=e;return Ke(n)||(i=Math.max(i,n)),Ke(t)||(i=Math.min(i,t)),i}}class at{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}class lt{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const ct={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class ut{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=ct[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ht={"+":e=>e,"-":e=>-e,"~":e=>~e};class pt{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=ht[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function dt(e){return(t,n)=>{for(let i=0;i<e.length;i++){const s=e[i](t,n);if(""!==s)return s}return""}}function mt(e,t){var n;const i=e.substr(t).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function vt(e,t){var n;const i=e.substr(t).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function ft(e,t){const n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";const i=function(e,t){const n=vt(e,t);if(""!==n)return n;const i=e.substr(t,1);if("-"!==i&&"+"!==i)return"";const s=vt(e,t+=1);return""===s?"":i+s}(e,t);return""===i?"":n+i}function gt(e,t){const n=e.substr(t,1);if("0"===n)return n;const i=function(e,t){const n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=i.length,""===i?"":i+vt(e,t)}const bt=dt([function(e,t){const n=gt(e,t);if(t+=n.length,""===n)return"";const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const s=vt(e,t);return n+i+s+ft(e,t+=s.length)},function(e,t){const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const i=vt(e,t);return t+=i.length,""===i?"":n+i+ft(e,t)},function(e,t){const n=gt(e,t);return t+=n.length,""===n?"":n+ft(e,t)}]);const wt=dt([function(e,t){const n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i}]),_t=dt([wt,bt]);function yt(e,t){var n;return null!==(n=function(e,t){const n=_t(e,t);return t+=n.length,""===n?null:{evaluable:new lt(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){const n=e.substr(t,1);if(t+=n.length,"("!==n)return null;const i=Pt(e,t);if(!i)return null;t=i.cursor,t+=mt(e,t).length;const s=e.substr(t,1);return t+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:t}}(e,t)}function xt(e,t,n){n+=mt(t,n).length;const i=e.filter((e=>t.startsWith(e,n)))[0];return i?(n+=i.length,{cursor:n+=mt(t,n).length,operator:i}):null}const Ct=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(n,i)=>{const s=e(n,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const s=xt(t,n,i);if(!s)break;i=s.cursor;const o=e(n,i);if(!o)return null;i=o.cursor,r=new ut(s.operator,r,o.evaluable)}return r?{cursor:i,evaluable:r}:null}}(e,t)),(function e(t,n){const i=yt(t,n);if(i)return i;const s=t.substr(n,1);if(n+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=e(t,n);return r?{cursor:n=r.cursor,evaluable:new pt(s,r.evaluable)}:null}));function Pt(e,t){return t+=mt(e,t).length,Ct(e,t)}function $t(e){var t;const n=function(e){const t=Pt(e,0);return t?t.cursor+mt(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function Et(e){if("number"==typeof e)return e;if("string"==typeof e){const t=$t(e);if(!Ke(t))return t}return 0}function kt(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}function Vt(e,t,n,i,s){return i+(e-t)/(n-t)*(s-i)}function St(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Lt(e,t,n){return Math.min(Math.max(e,t),n)}function Mt(e,t){return(e%t+t)%t}function At(e,t){return Ke(e.step)?Math.max(St(t),2):St(e.step)}function Dt(e){var t;return null!==(t=e.step)&&void 0!==t?t:1}function jt(e,t){var n;const i=Math.abs(null!==(n=e.step)&&void 0!==n?n:t);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function Tt(e,t){return Ke(e.step)?null:new at(e.step,t)}function Ot(e){return Ke(e.max)||Ke(e.min)?Ke(e.max)&&Ke(e.min)?null:new ot({max:e.max,min:e.min}):new rt({max:e.max,min:e.min})}function Bt(e,t){var n,i,s;return{formatter:null!==(n=e.format)&&void 0!==n?n:kt(At(e,t)),keyScale:null!==(i=e.keyScale)&&void 0!==i?i:Dt(e),pointerScale:null!==(s=e.pointerScale)&&void 0!==s?s:jt(e,t)}}function zt(e){return{format:e.optional.function,keyScale:e.optional.number,max:e.optional.number,min:e.optional.number,pointerScale:e.optional.number,step:e.optional.number}}function Nt(e){return{constraint:e.constraint,textProps:st.fromObject(Bt(e.params,e.initialValue))}}class Ft{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class It{constructor(e){this.target=e}}class Rt extends It{constructor(e,t,n){super(e),this.value=t,this.last=null==n||n}}class qt extends It{constructor(e,t){super(e),this.expanded=t}}class Ut extends It{constructor(e,t){super(e),this.index=t}}class Kt extends It{constructor(e,t){super(e),this.native=t}}class Ht extends Ft{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Je,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Rt(this,t.binding.target.read(),e.options.last))}}function Gt(e){return t=>n=>{if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};const i=e(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Yt(e){return{custom:t=>Gt(t)(e),boolean:Gt((e=>"boolean"==typeof e?e:void 0))(e),number:Gt((e=>"number"==typeof e?e:void 0))(e),string:Gt((e=>"string"==typeof e?e:void 0))(e),function:Gt((e=>"function"==typeof e?e:void 0))(e),constant:t=>Gt((e=>e===t?t:void 0))(e),raw:Gt((e=>e))(e),object:t=>Gt((e=>{var n;if(null!==(n=e)&&"object"==typeof n)return function(e,t){return Object.keys(t).reduce(((n,i)=>{if(void 0===n)return;const s=(0,t[i])(e[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}(e,t)}))(e),array:t=>Gt((e=>{var n;if(Array.isArray(e))return n=t,e.reduce(((e,t)=>{if(void 0===e)return;const i=n(t);return i.succeeded&&void 0!==i.value?[...e,i.value]:void 0}),[])}))(e)}}const Xt={optional:Yt(!0),required:Yt(!1)};function Wt(e,t){const n=t(Xt),i=Xt.required.object(n)(e);return i.succeeded?i.value:void 0}function Zt(e,t,n,i){if(t&&!t(e))return!1;const s=Wt(e,n);return!!s&&i(s)}function Qt(e,t){var n;return Xe(null!==(n=null==e?void 0:e())&&void 0!==n?n:{},t)}function Jt(e){return"value"in e}function en(e){if(!He(e)||!("binding"in e))return!1;const t=e.binding;return!!He(n=t)&&"target"in n;var n}const tn="http://www.w3.org/2000/svg";function nn(e){e.offsetHeight}function sn(e){return void 0!==e.ontouchstart}function rn(){return globalThis.document}const on={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function an(e,t){const n=e.createElementNS(tn,"svg");return n.innerHTML=on[t],n}function ln(e,t,n){e.insertBefore(t,e.children[n])}function cn(e){e.parentElement&&e.parentElement.removeChild(e)}function un(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function hn(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}function pn(e,t){e.emitter.on("change",(e=>{t(e.rawValue)})),t(e.rawValue)}function dn(e,t,n){pn(e.value(t),n)}const mn="tp";function vn(e){return(t,n)=>[mn,"-",e,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}const fn=vn("lbl");class gn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(fn("l")),dn(t.props,"label",(t=>{Ke(t)?this.element.classList.add(fn(void 0,"nol")):(this.element.classList.remove(fn(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(n),n.appendChild(function(e,t){const n=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,i)=>{i>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(e,t)))})),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("div");i.classList.add(fn("v")),this.element.appendChild(i),this.valueElement=i}}class bn{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new gn(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Zt(e,null,(e=>({label:e.optional.string})),(e=>(this.props.set("label",e.label),!0)))}exportProps(){return Qt(null,{label:this.props.get("label")})}}const wn=vn(""),_n={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class yn{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(wn(void 0,_n[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(wn(void 0,_n[e]))}))})),this.viewProps.handleDispose((()=>{cn(t)}))}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Zt(e,null,(e=>({disabled:e.required.boolean,hidden:e.required.boolean})),(e=>(this.viewProps.importState(e),!0)))}exportState(){return Qt(null,Object.assign({},this.viewProps.exportState()))}}class xn extends yn{constructor(e,t){if(t.value!==t.valueController.value)throw Ze.shouldNeverHappen();const n=t.valueController.viewProps,i=new bn(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new gn(e,{props:t.props,viewProps:n}),viewProps:n})),this.labelController=i,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return Zt(e,(t=>{var n,i,s;return super.importState(t)&&this.labelController.importProps(t)&&(null===(s=null===(i=(n=this.valueController).importProps)||void 0===i?void 0:i.call(n,e))||void 0===s||s)}),(e=>({value:e.optional.raw})),(e=>(e.value&&(this.value.rawValue=e.value),!0)))}exportState(){var e,t,n;return Qt((()=>super.exportState()),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(n=null===(t=(e=this.valueController).exportProps)||void 0===t?void 0:t.call(e))&&void 0!==n?n:{}))}}function Cn(e,t){for(;e.length<t;)e.push(void 0)}function Pn(e){const t=[];return Cn(t,e),t}function $n(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}class En extends Ft{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return null!==(e=this.controller.buttonController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller.buttonController.emitter.on(e,(e=>{n(new Kt(this,e.nativeEvent))})),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function kn(e,t){return n=>{!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function Vn(e,t){pn(e,(e=>{t.textContent=null!=e?e:""}))}const Sn=vn("btn");class Ln{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Sn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(Sn("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(Sn("t")),Vn(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class Mn{constructor(e,t){this.emitter=new Je,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Ln(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Zt(e,null,(e=>({title:e.optional.string})),(e=>(this.props.set("title",e.title),!0)))}exportProps(){return Qt(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class An extends yn{constructor(e,t){const n=new Mn(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new bn(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:t.viewProps}),this.buttonController=n,this.labelController=i}importState(e){return Zt(e,(e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e)),(()=>({})),(()=>!0))}exportState(){return Qt((()=>super.exportState()),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}const Dn=new class{constructor(e){const[t,n]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}("2.0.5");function jn(e){return Object.assign({core:Dn},e)}jn({id:"button",type:"blade",accept(e){const t=Wt(e,(e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new An(e.document,{blade:e.blade,buttonProps:st.fromObject({title:e.params.title}),labelProps:st.fromObject({label:e.params.label}),viewProps:e.viewProps}),api:e=>e.controller instanceof An?new En(e.controller):null});class Tn{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Je,this.pool_=t;this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map((e=>this.pool_.createApi(e)))}addBinding(e,t,n){const i=null!=n?n:{},s=this.controller_.element.ownerDocument,r=this.pool_.createBinding(s,function(e,t){if(!Qe.isBindable(e))throw Ze.notBindable();return new Qe(e,t)}(e,t),i),o=this.pool_.createBindingApi(r);return this.add(o,i.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){const n=e.controller;return this.controller_.rack.add(n,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,n=this.pool_.createBlade(t,e),i=this.pool_.createApi(n);return this.add(i,e.index)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach((e=>{var t;He(t=e)&&"refresh"in t&&"function"==typeof t.refresh&&e.refresh()}))}onRackValueChange_(e){const t=e.bladeController,n=this.pool_.createApi(t),i=en(t.value)?t.value.binding:null;this.emitter_.emit("change",new Rt(n,i?i.target.read():t.value.rawValue,e.options.last))}}class On extends Ft{constructor(e,t){super(e),this.rackApi_=new Tn(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class Bn extends yn{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Zt(e,(e=>super.importState(e)),(e=>({children:e.required.array(e.required.raw)})),(e=>this.rackController.rack.children.every(((t,n)=>t.importState(e.children[n])))))}exportState(){return Qt((()=>super.exportState()),{children:this.rackController.rack.children.map((e=>e.exportState()))})}}function zn(e){return"rackController"in e}class Nn{constructor(e){this.emitter=new Je,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Ze.shouldNeverHappen();const n=void 0!==t?t:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.allItems().forEach((e=>{this.cache_.delete(e)})),n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function Fn(e){return zn(e)?e.rackController.rack.bcSet_:null}class In{constructor(e){var t,n;this.emitter=new Je,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(t=e.blade)&&void 0!==t?t:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new Nn(Fn),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),Jt(n))n.value.emitter.on("change",this.onChildValueChange_);else if(zn(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.on("layout",this.onRackLayout_),t.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const n=e.item;if(Jt(n))n.value.emitter.off("change",this.onChildValueChange_);else if(zn(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.off("layout",this.onRackLayout_),t.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],n=e[e.length-1];this.bcSet_.items.forEach((e=>{const i=[];e===t&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),e===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),e.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildValueChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(Jt(i)&&i.value===t)return i}return null}(this.find(Jt),e.sender);if(!t)throw Ze.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Rn{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new In({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--){this.rack.children[e].viewProps.set("disposed",!0)}}))}onRackAdd_(e){e.root&&ln(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&cn(e.bladeController.view.element)}}function qn(){return new st({positions:it([],{equals:Ye})})}class Un extends st{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=st.createCore(t);return new Un(n)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Ke(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};dn(this,"expanded",n),dn(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Kn(e,t){t.style.height=e.styleHeight}function Hn(e,t){e.value("expanded").emitter.on("beforechange",(()=>{if(e.set("completed",!1),Ke(e.get("expandedHeight"))){const n=function(e,t){let n=0;return function(e,t){const n=e.style.transition;e.style.transition="none",t(),e.style.transition=n}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),nn(t),n=t.clientHeight,e.set("temporaryExpanded",null),nn(t)})),n}(e,t);n>0&&e.set("expandedHeight",n)}e.set("shouldFixHeight",!0),nn(t)})),e.emitter.on("change",(()=>{Kn(e,t)})),Kn(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&e.cleanUpTransition()}))}class Gn extends On{constructor(e,t){super(e,t),this.emitter_=new Je,this.controller.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",new qt(this,e.sender.rawValue))})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)}))}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const Yn=vn("cnt");class Xn{constructor(e,t){var n;this.className_=vn(null!==(n=t.viewName)&&void 0!==n?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Yn()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),dn(this.foldable_,"completed",kn(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),dn(t.props,"title",(e=>{Ke(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(this.className_("t")),Vn(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class Wn extends Bn{constructor(e,t){var n;const i=Un.create(null===(n=t.expanded)||void 0===n||n),s=new Xn(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Rn({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,Hn(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Zt(e,(e=>super.importState(e)),(e=>({expanded:e.required.boolean,title:e.optional.string})),(e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0)))}exportState(){return Qt((()=>super.exportState()),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}jn({id:"folder",type:"blade",accept(e){const t=Wt(e,(e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean})));return t?{params:t}:null},controller:e=>new Wn(e.document,{blade:e.blade,expanded:e.params.expanded,props:st.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof Wn?new Gn(e.controller,e.pool):null});const Zn=vn("");function Qn(e,t){return kn(e,Zn(void 0,t))}class Jn extends st{constructor(e){var t,n;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=(n=it(this.getGlobalDisabled_()),[new nt(n),(e,t)=>{n.setRawValue(e,t)}]),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,i;const s=null!=e?e:{};return new Jn(st.createCore({disabled:null!==(t=s.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){pn(this.globalDisabled_,Qn(e,"disabled")),dn(this,"hidden",Qn(e,"hidden"))}bindDisabled(e){pn(this.globalDisabled_,(t=>{e.disabled=t}))}bindTabIndex(e){pn(this.globalDisabled_,(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const ei=vn("tbp");class ti{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ei()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(ei("c")),this.element.appendChild(n),this.containerElement=n}}const ni=vn("tbi");class ii{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ni()),t.viewProps.bindClassModifiers(this.element),dn(t.props,"selected",(e=>{e?this.element.classList.add(ni(void 0,"sel")):this.element.classList.remove(ni(void 0,"sel"))}));const n=e.createElement("button");n.classList.add(ni("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(ni("t")),Vn(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class si{constructor(e,t){this.emitter=new Je,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new ii(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ri extends Bn{constructor(e,t){const n=new ti(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Rn({blade:t.blade,element:n.containerElement,viewProps:t.viewProps}),view:n})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new si(e,{props:t.itemProps,viewProps:Jn.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,dn(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}importState(e){return Zt(e,(e=>super.importState(e)),(e=>({selected:e.required.boolean,title:e.required.string})),(e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0)))}exportState(){return Qt((()=>super.exportState()),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class oi extends On{constructor(e,t){super(e,t),this.emitter_=new Je,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)})),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,n=new ri(t,{blade:qn(),itemProps:st.fromObject({selected:!1,title:e.title}),props:st.fromObject({selected:!1}),viewProps:Jn.create()}),i=this.pool_.createApi(n);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Ut(this,e.rawValue))}}class ai extends On{get title(){var e;return null!==(e=this.controller.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addBlade(e){return this.rackApi_.addBlade(e)}}class li{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=it(!0),this.selectedIndex=it(-1),this.items_=[]}add(e,t){const n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const e=this.items_.findIndex((e=>e.rawValue));e<0?(this.items_.forEach(((e,t)=>{e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex((t=>t===e.sender));this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const ci=vn("tab");class ui{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ci(),Yn()),t.viewProps.bindClassModifiers(this.element),pn(t.empty,kn(this.element,ci(void 0,"nop")));const n=e.createElement("div");n.classList.add(ci("t")),this.element.appendChild(n),this.itemsElement=n;const i=e.createElement("div");i.classList.add(ci("i")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(ci("c")),this.element.appendChild(s),this.contentsElement=s}}class hi extends Bn{constructor(e,t){const n=new li,i=new ui(e,{empty:n.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Rn({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=n}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;ln(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;cn(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}jn({id:"tab",type:"blade",accept(e){const t=Wt(e,(e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")})));return t&&0!==t.pages.length?{params:t}:null},controller(e){const t=new hi(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((n=>{const i=new ri(e.document,{blade:qn(),itemProps:st.fromObject({selected:!1,title:n.title}),props:st.fromObject({selected:!1}),viewProps:Jn.create()});t.add(i)})),t},api:e=>e.controller instanceof hi?new oi(e.controller,e.pool):e.controller instanceof ri?new ai(e.controller,e.pool):null});class pi extends Ht{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class di{constructor(){this.disabled=!1,this.emitter=new Je}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class mi{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Je,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class vi{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function fi(e,t){if(e instanceof t)return e;if(e instanceof vi){const n=e.constraints.reduce(((e,n)=>e||(n instanceof t?n:null)),null);if(n)return n}return null}class gi{constructor(e){this.values=st.fromObject({options:e})}constrain(e){const t=this.values.get("options");if(0===t.length)return e;return t.filter((t=>t.value===e)).length>0?e:t[0].value}}function bi(e){var t;const n=Xt;return Array.isArray(e)?null===(t=Wt({items:e},(e=>({items:e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))}))))||void 0===t?void 0:t.items:"object"==typeof e?n.required.raw(e).value:void 0}function wi(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((n=>{t.push({text:n,value:e[n]})})),t}function _i(e){return Ke(e)?null:new gi(wi(e))}const yi=vn("lst");class xi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(yi()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(yi("s")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=e.createElement("div");i.classList.add(yi("m")),i.appendChild(an(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,dn(this.props_,"options",(t=>{un(this.selectElement),t.forEach((t=>{const n=e.createElement("option");n.textContent=t.text,this.selectElement.appendChild(n)})),this.update_()}))}update_(){const e=this.props_.get("options").map((e=>e.value));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ci{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new xi(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Zt(e,null,(e=>({options:e.required.custom(bi)})),(e=>(this.props.set("options",wi(e.options)),!0)))}exportProps(){return Qt(null,{options:this.props.get("options")})}}const Pi=vn("pop");class $i{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pi()),t.viewProps.bindClassModifiers(this.element),pn(t.shows,kn(this.element,Pi(void 0,"v")))}}class Ei{constructor(e,t){this.shows=it(!1),this.viewProps=t.viewProps,this.view=new $i(e,{shows:this.shows,viewProps:this.viewProps})}}const ki=vn("txt");class Vi{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ki()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(ki("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Si{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Vi(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);Ke(n)||(this.value.rawValue=n),this.view.refresh()}}function Li(e){return"false"!==e&&!!e}function Mi(e){return function(e){return String(e)}(e)}const Ai=kt(0);function Di(e){return Ai(e)+"%"}function ji(e){return String(e)}function Ti(e){return e}function Oi({primary:e,secondary:t,forward:n,backward:i}){let s=!1;function r(e){s||(s=!0,e(),s=!1)}e.emitter.on("change",(i=>{r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),i.options)}))})),t.emitter.on("change",(s=>{r((()=>{e.setRawValue(i(e.rawValue,t.rawValue),s.options)})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),s.options)}))})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),{forceEmit:!1,last:!0})}))}function Bi(e,t){const n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function zi(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function Ni(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function Fi(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Ii(e,t){var n,i;const s=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+r.left),y:e.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+r.top)}}class Ri{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Je,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Ii(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Ii(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Ii(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const qi=vn("txt");class Ui{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(qi(),qi(void 0,"num")),t.arrayPosition&&this.element.classList.add(qi(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(qi("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(qi()),this.inputElement.classList.add(qi("i"));const i=e.createElement("div");i.classList.add(qi("k")),this.element.appendChild(i),this.knobElement=i;const s=e.createElementNS(tn,"svg");s.classList.add(qi("g")),this.knobElement.appendChild(s);const r=e.createElementNS(tn,"path");r.classList.add(qi("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=e.createElementNS(tn,"path");o.classList.add(qi("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(vn("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(qi(void 0,"drg"));this.element.classList.add(qi(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),n=t+(t>0?-1:t<0?1:0),i=Lt(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Ki{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=null!==(n=t.sliderProps)&&void 0!==n?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=it(null),this.view=new Ui(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Ri(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const i=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("min"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("max");let r=e;return void 0!==i&&(r=Math.max(r,i)),void 0!==s&&(r=Math.min(r,s)),r}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);Ke(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(e){const t=Bi(this.props.get("keyScale"),zi(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Bi(this.props.get("keyScale"),zi(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Hi=vn("sld");class Gi{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Hi()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Hi("t")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(Hi("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Lt(Vt(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Yi{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Gi(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ri(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(Vt(Lt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bi(this.props.get("keyScale"),Ni(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bi(this.props.get("keyScale"),Ni(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Xi=vn("sldtxt");class Wi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xi());const n=e.createElement("div");n.classList.add(Xi("s")),this.sliderView_=t.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Xi("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class Zi{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Yi(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Ki(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Wi(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Zt(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>{const t=this.sliderC_.props;return t.set("max",e.max),t.set("min",e.min),!0}))}exportProps(){const e=this.sliderC_.props;return Qt(null,{max:e.get("max"),min:e.get("min")})}}const Qi={containerUnitSize:"cnt-usz"};function Ji(e){return`--${Qi[e]}`}class es{constructor(e,t){const n=vn(t.viewName);this.element=e.createElement("div"),this.element.classList.add(n()),t.viewProps.bindClassModifiers(this.element)}}function ts(e){return zt(e)}function ns(e){if(Ge(e))return Wt(e,ts)}function is(e,t){if(!e)return;const n=[],i=Tt(e,t);i&&n.push(i);const s=Ot(e);return s&&n.push(s),new vi(n)}function ss(e){if("inline"===e||"popup"===e)return e}function rs(e,t){e.write(t)}const os=vn("ckb");class as{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(os()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(os("l")),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("input");i.classList.add(os("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(os("w")),this.labelElement.appendChild(s);const r=an(e,"check");s.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ls{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new as(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}jn({id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=Wt(t,(e=>({options:e.optional.custom(bi),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Li,constraint:e=>function(e){const t=[],n=_i(e.options);return n&&t.push(n),new vi(t)}(e.params),writer:e=>rs},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&fi(i,gi);return s?new Ci(t,{props:new st({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new ls(t,{value:n,viewProps:e.viewProps})},api:e=>"boolean"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Ci?new pi(e.controller):null});const cs=vn("col");class us{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cs()),t.foldable.bindExpandedClass(this.element,cs(void 0,"expanded")),dn(t.foldable,"completed",kn(this.element,cs(void 0,"cpl")));const n=e.createElement("div");n.classList.add(cs("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(cs("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add(cs("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(cs("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function hs(e,t,n){const i=Mt(e,360),s=Lt(t/100,0,1),r=Lt(n/100,0,1),o=r*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}function ps(e){return[e[0],e[1],e[2]]}function ds(e,t){return[e[0],e[1],e[2],t]}const ms={hsl:{hsl:(e,t,n)=>[e,t,n],hsv:function(e,t,n){const i=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==i?t*(100-Math.abs(2*n-100))/i:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){const i=(e%360+360)%360,s=Lt(t/100,0,1),r=Lt(n/100,0,1),o=(1-Math.abs(2*r-1))*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o/2;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}},hsv:{hsl:function(e,t,n){const i=100-Math.abs(n*(200-t)/100-100);return[e,0!==i?t*n/i:0,n*(200-t)/200]},hsv:(e,t,n)=>[e,t,n],rgb:hs},rgb:{hsl:function(e,t,n){const i=Lt(e/255,0,1),s=Lt(t/255,0,1),r=Lt(n/255,0,1),o=Math.max(i,s,r),a=Math.min(i,s,r),l=o-a;let c=0,u=0;const h=(a+o)/2;return 0!==l&&(u=l/(1-Math.abs(o+a-1)),c=i===o?(s-r)/l:s===o?2+(r-i)/l:4+(i-s)/l,c=c/6+(c<0?1:0)),[360*c,100*u,100*h]},hsv:function(e,t,n){const i=Lt(e/255,0,1),s=Lt(t/255,0,1),r=Lt(n/255,0,1),o=Math.max(i,s,r),a=o-Math.min(i,s,r);let l;return l=0===a?0:o===i?((s-r)/a%6+6)%6*60:o===s?60*((r-i)/a+2):60*((i-s)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,n)=>[e,t,n]}};function vs(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function fs(e,t,n){var i;const s=vs(t,n);return["rgb"===t?Lt(e[0],0,s[0]):(r=e[0],o=s[0],r===o?o:Mt(r,o)),Lt(e[1],0,s[1]),Lt(e[2],0,s[2]),Lt(null!==(i=e[3])&&void 0!==i?i:1,0,1)];var r,o}function gs(e,t,n,i){const s=vs(t,n),r=vs(t,i);return e.map(((e,t)=>e/s[t]*r[t]))}function bs(e,t,n){const i=gs(e,t.mode,t.type,"int");return gs(ms[t.mode][n.mode](...i),n.mode,"int",n.type)}class ws{static black(){return new ws([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=fs(e,t,this.type)}getComponents(e){return ds(bs(ps(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const _s=vn("colp");class ys{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(_s()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(_s("hsv"));const i=e.createElement("div");i.classList.add(_s("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(_s("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);const r=e.createElement("div");if(r.classList.add(_s("rgb")),this.textsView_=t.textsView,r.appendChild(this.textsView_.element),this.element.appendChild(r),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const n=e.createElement("div");n.classList.add(_s("a"));const i=e.createElement("div");i.classList.add(_s("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(_s("at")),s.appendChild(this.alphaViews_.text.element),n.appendChild(s),this.element.appendChild(n)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function xs(e){return"int"===e?"int":"float"===e?"float":void 0}function Cs(e){return Wt(e,(e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(xs)}),expanded:e.optional.boolean,picker:e.optional.custom(ss),readonly:e.optional.constant(!1)})))}function Ps(e){return e?.1:1}function $s(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}class Es{constructor(e,t){this.type="float",this.mode=t,this.comps_=fs(e,t,this.type)}getComponents(e){return ds(bs(ps(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const ks={int:(e,t)=>new ws(e,t),float:(e,t)=>new Es(e,t)};function Vs(e,t,n){return ks[n](e,t)}function Ss(e,t){if(e.type===t)return e;if(function(e){return"int"===e.type}(e)&&"float"===t)return function(e){const t=e.getComponents(),n=vs(e.mode,"int");return new Es([Vt(t[0],0,n[0],0,1),Vt(t[1],0,n[1],0,1),Vt(t[2],0,n[2],0,1),t[3]],e.mode)}(e);if(function(e){return"float"===e.type}(e)&&"int"===t)return function(e){const t=e.getComponents(),n=vs(e.mode,"int");return new ws([Math.round(Vt(t[0],0,1,0,n[0])),Math.round(Vt(t[1],0,1,0,n[1])),Math.round(Vt(t[2],0,1,0,n[2])),t[3]],e.mode)}(e);throw Ze.shouldNeverHappen()}function Ls(e,t){const n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}const Ms={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function As(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const n=parseFloat(t[1]),i=t[2];return Ms[i](n)}function Ds(e){const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Ls(t[1],255),Ls(t[2],255),Ls(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function js(e){const t=Ds(e);return t?new ws(t,"rgb"):null}function Ts(e){const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Ls(t[1],255),Ls(t[2],255),Ls(t[3],255),Ls(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Os(e){const t=Ts(e);return t?new ws(t,"rgb"):null}function Bs(e){const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[As(t[1]),Ls(t[2],100),Ls(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function zs(e){const t=Bs(e);return t?new ws(t,"hsl"):null}function Ns(e){const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[As(t[1]),Ls(t[2],100),Ls(t[3],100),Ls(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Fs(e){const t=Ns(e);return t?new ws(t,"hsl"):null}function Is(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Rs(e){const t=Is(e);return t?new ws(t,"rgb"):null}function qs(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),Vt(parseInt(t[4]+t[4],16),0,255,0,1)];const n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Vt(parseInt(n[4],16),0,255,0,1)]:null}function Us(e){const t=qs(e);return t?new ws(t,"rgb"):null}function Ks(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Hs(e){return t=>{const n=Ks(t);return n?Vs(n,"rgb",e):null}}function Gs(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Ys(e){return t=>{const n=Gs(t);return n?Vs(n,"rgb",e):null}}const Xs=[{parser:Is,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:qs,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ds,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Ts,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Bs,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Ns,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Ks,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Gs,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Ws(e,t="int"){const n=function(e){return Xs.reduce(((t,{parser:n,result:i})=>t||(n(e)?i:null)),null)}(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}function Zs(e){const t=[Rs,Us,js,Os,zs,Fs];"int"===e&&t.push(Hs("int"),Ys("int")),"float"===e&&t.push(Hs("float"),Ys("float"));const n=function(e){return t=>e.reduce(((e,n)=>null!==e?e:n(t)),null)}(t);return t=>{const i=n(t);return i?Ss(i,e):null}}function Qs(e){const t=Zs("int");if("string"!=typeof e)return ws.black();const n=t(e);return null!=n?n:ws.black()}function Js(e){const t=Lt(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function er(e,t="#"){return`${t}${ps(e.getComponents("rgb")).map(Js).join("")}`}function tr(e,t="#"){const n=e.getComponents("rgb");return`${t}${[n[0],n[1],n[2],255*n[3]].map(Js).join("")}`}function nr(e){const t=kt(0);return`rgb(${ps(Ss(e,"int").getComponents("rgb")).map((e=>t(e))).join(", ")})`}function ir(e){const t=kt(2),n=kt(0),i=Ss(e,"int").getComponents("rgb").map(((e,i)=>(3===i?t:n)(e)));return`rgba(${i.join(", ")})`}function sr(e,t){const n=kt("float"===t?2:0),i=["r","g","b"],s=ps(Ss(e,t).getComponents("rgb")).map(((e,t)=>`${i[t]}: ${n(e)}`));return`{${s.join(", ")}}`}function rr(e){return t=>sr(t,e)}function or(e,t){const n=kt(2),i=kt("float"===t?2:0),s=["r","g","b","a"],r=Ss(e,t).getComponents("rgb").map(((e,t)=>`${s[t]}: ${(3===t?n:i)(e)}`));return`{${r.join(", ")}}`}function ar(e){return t=>or(t,e)}const lr=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:er},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:tr},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:nr},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:ir},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[kt(0),Di,Di],n=ps(Ss(e,"int").getComponents("hsl")).map(((e,n)=>t[n](e)));return`hsl(${n.join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[kt(0),Di,Di,kt(2)],n=Ss(e,"int").getComponents("hsl").map(((e,n)=>t[n](e)));return`hsla(${n.join(", ")})`}},...["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:rr(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:ar(t)}]),[])];function cr(e){return lr.reduce(((t,n)=>{return t||(i=n.format,s=e,i.alpha===s.alpha&&i.mode===s.mode&&i.notation===s.notation&&i.type===s.type?n.stringifier:null);var i,s}),null)}const ur=vn("apl");class hr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ur()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(ur("b")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(ur("c")),n.appendChild(i),this.colorElem_=i;const s=e.createElement("div");s.classList.add(ur("m")),this.element.appendChild(s),this.markerElem_=s;const r=e.createElement("div");r.classList.add(ur("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),n=new ws([t[0],t[1],t[2],0],"rgb"),i=new ws([t[0],t[1],t[2],255],"rgb"),s=["to right",ir(n),ir(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=ir(e);const r=Vt(t[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class pr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new hr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ri(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=e.point.x/e.bounds.width,i=this.value.rawValue,[s,r,o]=i.getComponents("hsv");this.value.setRawValue(new ws([s,r,o,n],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bi(Ps(!0),Ni(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new ws([i,s,r,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bi(Ps(!0),Ni(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const dr=vn("coltxt");class mr{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(dr()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(dr("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce(((t,n)=>{const i=e.createElement("option");return i.textContent=n.text,i.value=n.value,t.appendChild(i),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(dr("ms")),n.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(dr("mm")),i.appendChild(an(e,"dropdown")),n.appendChild(i),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(dr("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),pn(t.mode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){un(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach((t=>{const n=e.createElement("div");n.classList.add(dr("c")),n.appendChild(t.element),this.inputsElem_.appendChild(n)}))}}function vr(e,t,n){const i=vs(e,t)[n];return new rt({min:0,max:i})}function fr(e,t){const n={colorMode:t.colorMode,colorType:t.colorType,parser:$t,viewProps:t.viewProps};return[0,1,2].map((i=>{const s=function(e,t,n){return new Ki(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",parser:t.parser,props:st.fromObject({formatter:(i=t.colorType,kt("float"===i?2:0)),keyScale:Ps(!1),pointerScale:"float"===t.colorType?.01:1}),value:it(0,{constraint:vr(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var i}(e,n,i);return Oi({primary:t.value,secondary:s.value,forward:e=>Ss(e,t.colorType).getComponents(t.colorMode)[i],backward(e,n){const s=t.colorMode,r=Ss(e,t.colorType).getComponents(s);r[i]=n;return Ss(Vs(ds(ps(r),r[3]),s,t.colorType),"int")}}),s}))}class gr{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=it(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new mr(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return function(e){return"hex"!==e}(t)?fr(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(e,t){const n=new Si(e,{parser:Zs("int"),props:st.fromObject({formatter:er}),value:it(ws.black()),viewProps:t.viewProps});return Oi({primary:t.value,secondary:n.value,forward:e=>new ws(ps(e.getComponents()),e.mode),backward:(e,t)=>new ws(ds(ps(t.getComponents(e.mode)),e.getComponents()[3]),e.mode)}),[n]}(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((e=>e.view))}}const br=vn("hpl");class wr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(br()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(br("c")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(br("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=nr(new ws([t,100,100],"hsv"));const n=Vt(t,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class _r{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new wr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ri(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=Vt(Lt(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new ws([n,s,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bi(Ps(!1),Ni(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new ws([i+t,s,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bi(Ps(!1),Ni(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const yr=vn("svp");class xr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(yr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=64,n.width=64,n.classList.add(yr("c")),this.element.appendChild(n),this.canvasElement=n;const i=e.createElement("div");i.classList.add(yr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,s=e.getImageData(0,0,n,i),r=s.data;for(let e=0;e<i;e++)for(let s=0;s<n;s++){const o=Vt(s,0,n,0,100),a=Vt(e,0,i,100,0),l=hs(t[0],o,a),c=4*(e*n+s);r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=255}e.putImageData(s,0,0);const o=Vt(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=Vt(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Cr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new xr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ri(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=Vt(e.point.x,0,e.bounds.width,0,100),i=Vt(e.point.y,0,e.bounds.height,100,0),[s,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ws([s,n,i,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Fi(e.key)&&e.preventDefault();const[t,n,i,s]=this.value.rawValue.getComponents("hsv"),r=Ps(!1),o=Bi(r,Ni(e)),a=Bi(r,zi(e));0===o&&0===a||this.value.setRawValue(new ws([t,n+o,i+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Ps(!1),n=Bi(t,Ni(e)),i=Bi(t,zi(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Pr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new _r(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Cr(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new pr(e,{value:this.value,viewProps:this.viewProps}),text:new Ki(e,{parser:$t,props:st.fromObject({pointerScale:.01,keyScale:.1,formatter:kt(2)}),value:it(0,{constraint:new rt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Oi({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.getComponents()[3],backward:(e,t)=>{const n=e.getComponents();return n[3]=t,new ws(n,e.mode)}}),this.textsC_=new gr(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new ys(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const $r=vn("colsw");class Er{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add($r()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add($r("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=e.createElement("button");i.classList.add($r("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=tr(e)}onValueChange_(){this.update_()}}class kr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Er(e,{value:this.value,viewProps:this.viewProps})}}class Vr{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Un.create(t.expanded),this.swatchC_=new kr(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Si(e,{parser:t.parser,props:st.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new us(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Ei(e,{viewProps:this.viewProps}):null;const i=new Pr(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Oi({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Hn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=hn(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!sn(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Sr(e){return ps(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function Lr(e){return e.getComponents("rgb").reduce(((e,t,n)=>e<<8|255&Math.floor(3===n?255*t:t)),0)>>>0}function Mr(e){return"number"!=typeof e?ws.black():new ws([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function Ar(e){return"number"!=typeof e?ws.black():new ws([(t=e)>>24&255,t>>16&255,t>>8&255,Vt(255&t,0,255,0,1)],"rgb");var t}function Dr(e,t){return"object"==typeof e&&!Ke(e)&&(t in e&&"number"==typeof e[t])}function jr(e){return Dr(e,"r")&&Dr(e,"g")&&Dr(e,"b")}function Tr(e){return jr(e)&&Dr(e,"a")}function Or(e){return jr(e)}function Br(e,t){if(e.mode!==t.mode)return!1;if(e.type!==t.type)return!1;const n=e.getComponents(),i=t.getComponents();for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}function zr(e){return"a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b]}function Nr(e,t){return(n,i)=>{e?function(e,t,n){const i=Ss(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}(n,i,t):function(e,t,n){const i=Ss(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}(n,i,t)}}function Fr(e){var t;return!!(null===(t=null==e?void 0:e.color)||void 0===t?void 0:t.alpha)}function Ir(e){return t=>{const n=function(e,t){if(!Or(e))return Ss(ws.black(),t);if("int"===t){const t=zr(e);return new ws(t,"rgb")}if("float"===t){const t=zr(e);return new Es(t,"rgb")}return Ss(ws.black(),"int")}(t,e);return Ss(n,"int")}}function Rr(e,t){return n=>e?or(n,t):sr(n,t)}jn({id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!function(e){return"color"in e||"color"===e.view}(t))return null;const n=Cs(t);return n?{initialValue:e,params:Object.assign(Object.assign({},n),{supportsAlpha:Fr(t)})}:null},binding:{reader:e=>e.params.supportsAlpha?Ar:Mr,equals:Br,writer:e=>function(e){const t=e?Lr:Sr;return(e,n)=>{rs(e,t(n))}}(e.params.supportsAlpha)},controller:e=>{var t,n,i;return new Vr(e.document,{colorType:"int",expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:(i=e.params.supportsAlpha,i?e=>tr(e,"0x"):e=>er(e,"0x")),parser:Zs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.supportsAlpha,value:e.value,viewProps:e.viewProps})}}),jn({id:"input-color-object",type:"input",accept:(e,t)=>{var n;if(!Or(e))return null;const i=Cs(t);return i?{initialValue:e,params:Object.assign(Object.assign({},i),{colorType:null!==(n=$s(t))&&void 0!==n?n:"int"})}:null},binding:{reader:e=>Ir(e.params.colorType),equals:Br,writer:e=>Nr(Tr(e.initialValue),e.params.colorType)},controller:e=>{var t,n;const i=Tr(e.initialValue);return new Vr(e.document,{colorType:e.params.colorType,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:Rr(i,e.params.colorType),parser:Zs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:i,value:e.value,viewProps:e.viewProps})}}),jn({id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("text"===t.view)return null;const n=Ws(e,$s(t));if(!n)return null;const i=cr(n);if(!i)return null;const s=Cs(t);return s?{initialValue:e,params:Object.assign(Object.assign({},s),{format:n,stringifier:i})}:null},binding:{reader:()=>Qs,equals:Br,writer:e=>{const t=function(e){const t=cr(e);return t?(e,n)=>{rs(e,t(n))}:null}(e.params.format);if(!t)throw Ze.notBindable();return t}},controller:e=>{var t,n;return new Vr(e.document,{colorType:e.params.format.type,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:e.params.stringifier,parser:Zs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.format.alpha,value:e.value,viewProps:e.viewProps})}});class qr{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var n,i;return null!==(i=null===(n=this.components[t])||void 0===n?void 0:n.constrain(e))&&void 0!==i?i:e}));return this.asm_.fromComponents(t)}}const Ur=vn("pndtxt");class Kr{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Ur()),this.textViews.forEach((t=>{const n=e.createElement("div");n.classList.add(Ur("a")),n.appendChild(t.element),this.element.appendChild(n)}))}}class Hr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((n,i)=>function(e,t,n){return new Ki(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[n].textProps,value:it(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(e,t,i))),this.acs_.forEach(((e,n)=>{Oi({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e)[n],backward:(e,i)=>{const s=t.assembly.toComponents(e);return s[n]=i,t.assembly.fromComponents(s)}})})),this.view=new Kr(e,{textViews:this.acs_.map((e=>e.view))})}get textControllers(){return this.acs_}}class Gr extends Ht{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}jn({id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=Wt(t,(e=>Object.assign(Object.assign({},zt(e)),{options:e.optional.custom(bi),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Et,constraint:e=>function(e,t){const n=[],i=Tt(e,t);i&&n.push(i);const s=Ot(e);s&&n.push(s);const r=_i(e.options);return r&&n.push(r),new vi(n)}(e.params,e.initialValue),writer:e=>rs},controller:e=>{const t=e.value,n=e.constraint,i=n&&fi(n,gi);if(i)return new Ci(e.document,{props:new st({options:i.values.value("options")}),value:t,viewProps:e.viewProps});const s=Bt(e.params,t.rawValue),r=n&&fi(n,rt);return r?new Zi(e.document,Object.assign(Object.assign({},(o=Object.assign(Object.assign({},s),{keyScale:it(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}),{sliderProps:new st({keyScale:o.keyScale,max:o.max,min:o.min}),textProps:new st({formatter:it(o.formatter),keyScale:o.keyScale,pointerScale:it(o.pointerScale)})})),{parser:$t,value:t,viewProps:e.viewProps})):new Ki(e.document,{parser:$t,props:st.fromObject(s),value:t,viewProps:e.viewProps});var o},api:e=>"number"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Zi?new Gr(e.controller):e.controller.valueController instanceof Ci?new pi(e.controller):null});class Yr{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Ke(e))return!1;const t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const Xr={toComponents:e=>e.getComponents(),fromComponents:e=>new Yr(...e)},Wr=vn("p2d");class Zr{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Wr()),t.viewProps.bindClassModifiers(this.element),pn(t.expanded,kn(this.element,Wr(void 0,"expanded")));const n=e.createElement("div");n.classList.add(Wr("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(Wr("b")),i.appendChild(an(e,"p2dpad")),t.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const s=e.createElement("div");if(s.classList.add(Wr("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(Wr("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const Qr=vn("p2dp");class Jr{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Qr()),"popup"===t.layout&&this.element.classList.add(Qr(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Qr("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(tn,"svg");i.classList.add(Qr("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=e.createElementNS(tn,"line");s.classList.add(Qr("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const r=e.createElementNS(tn,"line");r.classList.add(Qr("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=e.createElementNS(tn,"line");o.classList.add(Qr("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(Qr("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),n=this.props_.get("max"),i=Vt(e,-n,+n,0,100),s=Vt(t,-n,+n,0,100),r=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function eo(e,t,n){return[Bi(t[0],Ni(e)),Bi(t[1],zi(e))*(n?1:-1)]}class to{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Jr(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ri(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=this.props.get("max"),i=Vt(e.point.x,0,e.bounds.width,-n,+n),s=Vt(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new Yr(i,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Fi(e.key)&&e.preventDefault();const[t,n]=eo(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(new Yr(this.value.rawValue.x+t,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,n]=eo(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class no{constructor(e,t){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Un.create(t.expanded),this.popC_="popup"===t.pickerLayout?new Ei(e,{viewProps:this.viewProps}):null;const s=new to(e,{layout:t.pickerLayout,props:new st({invertsY:it(t.invertsY),max:it(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new Hr(e,{assembly:Xr,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Zr(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Oi({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Hn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=hn(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!sn(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function io(e){return Yr.isObject(e)?new Yr(e.x,e.y):new Yr}function so(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function ro(e,t){var n,i;if(!Ke(e.min)||!Ke(e.max))return Math.max(Math.abs(null!==(n=e.min)&&void 0!==n?n:0),Math.abs(null!==(i=e.max)&&void 0!==i?i:0));const s=Dt(e);return Math.max(10*Math.abs(s),10*Math.abs(t))}function oo(e,t){var n,i;const s=ro(Xe(e,null!==(n=e.x)&&void 0!==n?n:{}),t.x),r=ro(Xe(e,null!==(i=e.y)&&void 0!==i?i:{}),t.y);return Math.max(s,r)}function ao(e){if(!("y"in e))return!1;const t=e.y;return!!t&&("inverted"in t&&!!t.inverted)}jn({id:"input-point2d",type:"input",accept:(e,t)=>{if(!Yr.isObject(e))return null;const n=Wt(t,(e=>Object.assign(Object.assign({},ts(e)),{expanded:e.optional.boolean,picker:e.optional.custom(ss),readonly:e.optional.constant(!1),x:e.optional.custom(ns),y:e.optional.object(Object.assign(Object.assign({},ts(e)),{inverted:e.optional.boolean}))})));return n?{initialValue:e,params:n}:null},binding:{reader:()=>io,constraint:e=>{return t=e.params,n=e.initialValue,new qr({assembly:Xr,components:[is(Object.assign(Object.assign({},t),t.x),n.x),is(Object.assign(Object.assign({},t),t.y),n.y)]});var t,n},equals:Yr.equals,writer:()=>so},controller:e=>{var t,n;const i=e.document,s=e.value,r=e.constraint,o=[e.params.x,e.params.y];return new no(i,{axes:s.rawValue.getComponents().map(((t,n)=>{var i;return Nt({constraint:r.components[n],initialValue:t,params:Xe(e.params,null!==(i=o[n])&&void 0!==i?i:{})})})),expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,invertsY:ao(e.params),max:oo(e.params,s.rawValue),parser:$t,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:s,viewProps:e.viewProps})}});class lo{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Ke(e))return!1;const t=e.x,n=e.y,i=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const co={toComponents:e=>e.getComponents(),fromComponents:e=>new lo(...e)};function uo(e){return lo.isObject(e)?new lo(e.x,e.y,e.z):new lo}function ho(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}jn({id:"input-point3d",type:"input",accept:(e,t)=>{if(!lo.isObject(e))return null;const n=Wt(t,(e=>Object.assign(Object.assign({},ts(e)),{readonly:e.optional.constant(!1),x:e.optional.custom(ns),y:e.optional.custom(ns),z:e.optional.custom(ns)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>uo,constraint:e=>{return t=e.params,n=e.initialValue,new qr({assembly:co,components:[is(Object.assign(Object.assign({},t),t.x),n.x),is(Object.assign(Object.assign({},t),t.y),n.y),is(Object.assign(Object.assign({},t),t.z),n.z)]});var t,n},equals:lo.equals,writer:e=>ho},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z];return new Hr(e.document,{assembly:co,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Nt({constraint:n.components[s],initialValue:t,params:Xe(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:$t,value:t,viewProps:e.viewProps})}});class po{constructor(e=0,t=0,n=0,i=0){this.x=e,this.y=t,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Ke(e))return!1;const t=e.x,n=e.y,i=e.z,s=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i&&"number"==typeof s}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const mo={toComponents:e=>e.getComponents(),fromComponents:e=>new po(...e)};function vo(e){return po.isObject(e)?new po(e.x,e.y,e.z,e.w):new po}function fo(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}jn({id:"input-point4d",type:"input",accept:(e,t)=>{if(!po.isObject(e))return null;const n=Wt(t,(e=>Object.assign(Object.assign({},ts(e)),{readonly:e.optional.constant(!1),w:e.optional.custom(ns),x:e.optional.custom(ns),y:e.optional.custom(ns),z:e.optional.custom(ns)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>vo,constraint:e=>{return t=e.params,n=e.initialValue,new qr({assembly:mo,components:[is(Object.assign(Object.assign({},t),t.x),n.x),is(Object.assign(Object.assign({},t),t.y),n.y),is(Object.assign(Object.assign({},t),t.z),n.z),is(Object.assign(Object.assign({},t),t.w),n.w)]});var t,n},equals:po.equals,writer:e=>fo},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z,e.params.w];return new Hr(e.document,{assembly:mo,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Nt({constraint:n.components[s],initialValue:t,params:Xe(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:$t,value:t,viewProps:e.viewProps})}}),jn({id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const n=Wt(t,(e=>({readonly:e.optional.constant(!1),options:e.optional.custom(bi)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>ji,constraint:e=>function(e){const t=[],n=_i(e.options);return n&&t.push(n),new vi(t)}(e.params),writer:e=>rs},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&fi(i,gi);return s?new Ci(t,{props:new st({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new Si(t,{parser:e=>e,props:st.fromObject({formatter:Ti}),value:n,viewProps:e.viewProps})},api:e=>"string"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Ci?new pi(e.controller):null});const go={defaultInterval:200,defaultRows:3},bo=vn("mll");class wo{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(bo()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(bo("i")),n.style.height=`calc(var(${Ji("containerUnitSize")}) * ${t.rows})`,n.readOnly=!0,t.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach((e=>{void 0!==e&&n.push(this.formatter_(e))})),e.textContent=n.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class _o{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new wo(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const yo=vn("sgl");class xo{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(yo()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(yo("i")),n.readOnly=!0,n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Co{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new xo(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}jn({id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=Wt(t,(e=>({readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Li},controller:e=>{var t;return 1===e.value.rawValue.length?new Co(e.document,{formatter:Mi,value:e.value,viewProps:e.viewProps}):new _o(e.document,{formatter:Mi,rows:null!==(t=e.params.rows)&&void 0!==t?t:go.defaultRows,value:e.value,viewProps:e.viewProps})}});class Po extends Ht{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const $o=vn("grl");class Eo{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add($o()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(tn,"svg");n.classList.add($o("g")),n.style.height=`calc(var(${Ji("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(tn,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=e.createElement("div");s.classList.add($o("t"),vn("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,n=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach(((o,a)=>{if(void 0===o)return;const l=Vt(a,0,n,0,e),c=Vt(o,i,s,t,0);r.push([l,c].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove($o("t","a"));const l=Vt(this.cursor_.rawValue,0,n,0,e),c=Vt(a,i,s,t,0);o.style.left=`${l}px`,o.style.top=`${c}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains($o("t","a"))||(o.classList.add($o("t","a"),$o("t","in")),nn(o),o.classList.remove($o("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class ko{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=it(-1),this.view=new Eo(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),sn(e)){const e=new Ri(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}importProps(e){return Zt(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0)))}exportProps(){return Qt(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(Vt(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.rawValue=Math.floor(Vt(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Vo(e){return Ke(e.format)?kt(2):e.format}function So(e){return"graph"===e.view}jn({id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const n=Wt(t,(e=>({format:e.optional.function,max:e.optional.number,min:e.optional.number,readonly:e.required.constant(!0),rows:e.optional.number,view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>So(e)?64:1,reader:e=>Et},controller:e=>So(e.params)?function(e){var t,n,i;return new ko(e.document,{formatter:Vo(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:go.defaultRows,props:st.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:100,min:null!==(i=e.params.min)&&void 0!==i?i:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new Co(e.document,{formatter:Vo(e.params),value:e.value,viewProps:e.viewProps}):new _o(e.document,{formatter:Vo(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:go.defaultRows,value:e.value,viewProps:e.viewProps})}(e),api:e=>e.controller.valueController instanceof ko?new Po(e.controller):null}),jn({id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const n=Wt(t,(e=>({multiline:e.optional.boolean,readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>ji},controller:e=>{var t;const n=e.value;return n.rawValue.length>1||e.params.multiline?new _o(e.document,{formatter:Ti,rows:null!==(t=e.params.rows)&&void 0!==t?t:go.defaultRows,value:n,viewProps:e.viewProps}):new Co(e.document,{formatter:Ti,value:n,viewProps:e.viewProps})}});const Lo={baseBackgroundColor:"hsl(230, 7%, 17%)",baseBorderRadius:"6px",baseFontFamily:"Roboto Mono, Source Code Pro, Menlo, Courier, monospace",baseShadowColor:"rgba(0, 0, 0, 0.2)",bladeBorderRadius:"2px",bladeHorizontalPadding:"4px",bladeValueWidth:"160px",buttonBackgroundColor:"hsl(230, 7%, 70%)",buttonBackgroundColorActive:"#d6d7db",buttonBackgroundColorFocus:"#c8cad0",buttonBackgroundColorHover:"#bbbcc4",buttonForegroundColor:"hsl(230, 7%, 17%)",containerBackgroundColor:"rgba(187, 188, 196, 0.1)",containerBackgroundColorActive:"rgba(187, 188, 196, 0.25)",containerBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",containerBackgroundColorHover:"rgba(187, 188, 196, 0.15)",containerForegroundColor:"hsl(230, 7%, 75%)",containerHorizontalPadding:"4px",containerUnitSize:"20px",containerUnitSpacing:"4px",containerVerticalPadding:"4px",grooveForegroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColorActive:"rgba(187, 188, 196, 0.25)",inputBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",inputBackgroundColorHover:"rgba(187, 188, 196, 0.15)",inputForegroundColor:"hsl(230, 7%, 75%)",labelForegroundColor:"rgba(187, 188, 196, 0.7)",monitorBackgroundColor:"rgba(0, 0, 0, 0.2)",monitorForegroundColor:"rgba(187, 188, 196, 0.7)",pluginImageDraggingColor:"hsla(230, 100%, 66%, 1)"};Object.keys(Lo).reduce(((e,t)=>(e[t]=t,e)),{});const Mo=new Map([["baseBackgroundColor","--tp-base-background-color"],["baseBorderRadius","--tp-base-border-radius"],["baseFontFamily","--tp-base-font-family"],["baseShadowColor","--tp-base-shadow-color"],["bladeBorderRadius","--tp-blade-border-radius"],["bladeHorizontalPadding","--tp-blade-horizontal-padding"],["bladeValueWidth","--tp-blade-value-width"],["buttonBackgroundColor","--tp-button-background-color"],["buttonBackgroundColorActive","--tp-button-background-color-active"],["buttonBackgroundColorFocus","--tp-button-background-color-focus"],["buttonBackgroundColorHover","--tp-button-background-color-hover"],["buttonForegroundColor","--tp-button-foreground-color"],["containerBackgroundColor","--tp-container-background-color"],["containerBackgroundColorActive","--tp-container-background-color-active"],["containerBackgroundColorFocus","--tp-container-background-color-focus"],["containerBackgroundColorHover","--tp-container-background-color-hover"],["containerForegroundColor","--tp-container-foreground-color"],["containerHorizontalPadding","--tp-container-horizontal-padding"],["containerUnitSize","--tp-container-unit-size"],["containerUnitSpacing","--tp-container-unit-spacing"],["containerVerticalPadding","--tp-container-vertical-padding"],["grooveForegroundColor","--tp-groove-foreground-color"],["inputBackgroundColor","--tp-input-background-color"],["inputBackgroundColorActive","--tp-input-background-color-active"],["inputBackgroundColorFocus","--tp-input-background-color-focus"],["inputBackgroundColorHover","--tp-input-background-color-hover"],["inputForegroundColor","--tp-input-foreground-color"],["labelForegroundColor","--tp-label-foreground-color"],["monitorBackgroundColor","--tp-monitor-background-color"],["monitorForegroundColor","--tp-monitor-foreground-color"],["pluginImageDraggingColor","--tp-plugin-image-dragging-color"]]);function Ao(e){if(void 0!==e)return"string"==typeof e?e:Tr(e)?`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`:jr(e)?`rgb(${e.r}, ${e.g}, ${e.b})`:void 0}function Do(e){if(e.startsWith("--tp-"))return e;const t=Mo.get(e);if(t)return t;throw new Error(`Unknown Tweakpane CSS theme map variable key: "${e}"`)}function jo(e,t){return Ao(void 0===e?.[t]?Lo[t]:e[t])}function To(e){let t,n=`${e[0]}px`;return{c(){t=y("div"),E(t,"background",null),E(t,"height",n)},m(e,n){w(e,t,n)},p(e,i){1&i&&n!==(n=`${e[0]}px`)&&E(t,"height",n)},d(e){e&&_(t)}}}function Oo(t){let n,i=t[0]>0&&To(t);return{c(){i&&i.c(),n=P()},m(e,t){i&&i.m(e,t),w(e,n,t)},p(e,[t]){e[0]>0?i?i.p(e,t):(i=To(e),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},i:e,o:e,d(e){e&&_(n),i&&i.d(e)}}}function Bo(e){return Number.parseFloat(e.replace("px",""))}function zo(e,t,n){let i,{theme:s}=t,{keysAdd:r=[]}=t,{keysSubtract:o=[]}=t,{extra:a}=t;return e.$$set=e=>{"theme"in e&&n(1,s=e.theme),"keysAdd"in e&&n(2,r=e.keysAdd),"keysSubtract"in e&&n(3,o=e.keysSubtract),"extra"in e&&n(4,a=e.extra)},e.$$.update=()=>{28&e.$$.dirty&&n(0,i=function(e,t,n=0){return e.reduce(((e,t)=>e+Bo(jo(s,t))),0)-t.reduce(((e,t)=>e+Bo(jo(s,t))),0)+n}(r,o,a))},[i,s,r,o,a]}class No extends pe{constructor(e){super(),he(this,e,zo,Oo,o,{theme:1,keysAdd:2,keysSubtract:3,extra:4})}}function Fo(e){return"Pane"===e.constructor.name}function Io(e,t,n){return Math.min(Math.max(e,t),n)}function Ro(e){let t=0,n=e;for(;null!==(n=n.previousElementSibling);)n.classList.contains("skip-element-index")||t++;return t}function qo(e,...t){for(const n of t)n in e&&delete e[n];return e}function Uo(e){e.isTrusted&&e.stopPropagation()}function Ko(e,t,n,i){if(t){const s=t.querySelector(`.${n}`);if(s){const n=i?t.querySelector(`.${i}`):void 0;e?(s.removeEventListener("click",Uo,{capture:!0}),s.style.cursor="pointer",n&&(n.style.display="block")):(s.addEventListener("click",Uo,{capture:!0}),s.style.cursor="default",n&&(n.style.display="none"))}}else console.warn(`Title bar element not found with class "${n}"`)}function Ho(e,t){return t.map((t=>e[t]))}function Go(e){return Boolean(e.controller.valueController?.foldable_?.valMap_?.expanded?.value_)}function Yo(e){return null==e}function Xo(e){return null!==e&&"object"==typeof e}function Wo(e){return null!==e&&"object"==typeof e}function Zo(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Qo(e,t){return Array.from(new Set([...Object.keys(e),...Object.keys(t)])).reduce(((n,i)=>{const s=e[i],r=t[i];return Wo(s)&&Wo(r)?Object.assign(Object.assign({},n),{[i]:Qo(s,r)}):Object.assign(Object.assign({},n),{[i]:i in t?r:s})}),{})}function Jo(e){return!!Xo(e)&&"target"in e}const ea={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:e=>`Not compatible with  plugin '${e.id}'`,propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class ta{static alreadyDisposed(){return new ta({type:"alreadydisposed"})}static notBindable(){return new ta({type:"notbindable"})}static notCompatible(e,t){return new ta({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new ta({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new ta({type:"shouldneverhappen"})}constructor(e){var t;this.message=null!==(t=ea[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class na{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return null!==e&&("object"==typeof e||"function"==typeof e)}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const n=this.read();if(!na.isBindable(n))throw ta.notBindable();if(!(e in n))throw ta.propertyNotFound(e);n[e]=t}}class ia{constructor(){this.observers_={}}on(e,t,n){var i;let s=this.observers_[e];return s||(s=this.observers_[e]=[]),s.push({handler:t,key:null!==(i=null==n?void 0:n.key)&&void 0!==i?i:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter((e=>e.key!==t))),this}emit(e,t){const n=this.observers_[e];n&&n.forEach((e=>{e.handler(t)}))}}class sa{constructor(e,t){var n;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(n=null==t?void 0:t.equals)&&void 0!==n?n:(e,t)=>e===t,this.emitter=new ia,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;(!this.equals_(s,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class ra{constructor(e){this.emitter=new ia,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.value_;(i!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}class oa{constructor(e){this.emitter=new ia,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function aa(e,t){const n=null==t?void 0:t.constraint,i=null==t?void 0:t.equals;return n||i?new sa(e,t):new ra(e)}class la{constructor(e){this.emitter=new ia,this.valMap_=e;for(const e in this.valMap_){this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}}static createCore(e){return Object.keys(e).reduce(((t,n)=>Object.assign(t,{[n]:aa(e[n])})),{})}static fromObject(e){const t=this.createCore(e);return new la(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class ca{constructor(e){this.values=la.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class ua{constructor(e){this.values=la.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let i=e;return Yo(n)||(i=Math.max(i,n)),Yo(t)||(i=Math.min(i,t)),i}}class ha{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}class pa{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const da={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class ma{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=da[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const va={"+":e=>e,"-":e=>-e,"~":e=>~e};class fa{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=va[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ga(e){return(t,n)=>{for(let i=0;i<e.length;i++){const s=e[i](t,n);if(""!==s)return s}return""}}function ba(e,t){var n;const i=e.substr(t).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function wa(e,t){var n;const i=e.substr(t).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function _a(e,t){const n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";const i=function(e,t){const n=wa(e,t);if(""!==n)return n;const i=e.substr(t,1);if("-"!==i&&"+"!==i)return"";const s=wa(e,t+=1);return""===s?"":i+s}(e,t);return""===i?"":n+i}function ya(e,t){const n=e.substr(t,1);if("0"===n)return n;const i=function(e,t){const n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=i.length,""===i?"":i+wa(e,t)}const xa=ga([function(e,t){const n=ya(e,t);if(t+=n.length,""===n)return"";const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const s=wa(e,t);return n+i+s+_a(e,t+=s.length)},function(e,t){const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const i=wa(e,t);return t+=i.length,""===i?"":n+i+_a(e,t)},function(e,t){const n=ya(e,t);return t+=n.length,""===n?"":n+_a(e,t)}]);const Ca=ga([function(e,t){const n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i}]),Pa=ga([Ca,xa]);function $a(e,t){var n;return null!==(n=function(e,t){const n=Pa(e,t);return t+=n.length,""===n?null:{evaluable:new pa(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){const n=e.substr(t,1);if(t+=n.length,"("!==n)return null;const i=Va(e,t);if(!i)return null;t=i.cursor,t+=ba(e,t).length;const s=e.substr(t,1);return t+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:t}}(e,t)}function Ea(e,t,n){n+=ba(t,n).length;const i=e.filter((e=>t.startsWith(e,n)))[0];return i?(n+=i.length,{cursor:n+=ba(t,n).length,operator:i}):null}const ka=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(n,i)=>{const s=e(n,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const s=Ea(t,n,i);if(!s)break;i=s.cursor;const o=e(n,i);if(!o)return null;i=o.cursor,r=new ma(s.operator,r,o.evaluable)}return r?{cursor:i,evaluable:r}:null}}(e,t)),(function e(t,n){const i=$a(t,n);if(i)return i;const s=t.substr(n,1);if(n+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=e(t,n);return r?{cursor:n=r.cursor,evaluable:new fa(s,r.evaluable)}:null}));function Va(e,t){return t+=ba(e,t).length,ka(e,t)}function Sa(e){var t;const n=function(e){const t=Va(e,0);return t?t.cursor+ba(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function La(e){if("number"==typeof e)return e;if("string"==typeof e){const t=Sa(e);if(!Yo(t))return t}return 0}function Ma(e){return String(e)}function Aa(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}function Da(e,t,n,i,s){return i+(e-t)/(n-t)*(s-i)}function ja(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ta(e,t,n){return Math.min(Math.max(e,t),n)}function Oa(e,t){return(e%t+t)%t}function Ba(e,t){return Yo(e.step)?Math.max(ja(t),2):ja(e.step)}function za(e){var t;return null!==(t=e.step)&&void 0!==t?t:1}function Na(e,t){var n;const i=Math.abs(null!==(n=e.step)&&void 0!==n?n:t);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function Fa(e,t){return Yo(e.step)?null:new ha(e.step,t)}function Ia(e){return Yo(e.max)||Yo(e.min)?Yo(e.max)&&Yo(e.min)?null:new ua({max:e.max,min:e.min}):new ca({max:e.max,min:e.min})}function Ra(e,t){var n,i,s;return{formatter:null!==(n=e.format)&&void 0!==n?n:Aa(Ba(e,t)),keyScale:null!==(i=e.keyScale)&&void 0!==i?i:za(e),pointerScale:null!==(s=e.pointerScale)&&void 0!==s?s:Na(e,t)}}function qa(e){return{format:e.optional.function,keyScale:e.optional.number,max:e.optional.number,min:e.optional.number,pointerScale:e.optional.number,step:e.optional.number}}function Ua(e){return{constraint:e.constraint,textProps:la.fromObject(Ra(e.params,e.initialValue))}}class Ka{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class Ha{constructor(e){this.target=e}}class Ga extends Ha{constructor(e,t,n){super(e),this.value=t,this.last=null==n||n}}class Ya extends Ha{constructor(e,t){super(e),this.expanded=t}}class Xa extends Ha{constructor(e,t){super(e),this.index=t}}class Wa extends Ha{constructor(e,t){super(e),this.native=t}}class Za extends Ka{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new ia,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Ga(this,t.binding.target.read(),e.options.last))}}class Qa{constructor(e,t){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t,this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new ia}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Ja(e){return t=>n=>{if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};const i=e(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function el(e){return{custom:t=>Ja(t)(e),boolean:Ja((e=>"boolean"==typeof e?e:void 0))(e),number:Ja((e=>"number"==typeof e?e:void 0))(e),string:Ja((e=>"string"==typeof e?e:void 0))(e),function:Ja((e=>"function"==typeof e?e:void 0))(e),constant:t=>Ja((e=>e===t?t:void 0))(e),raw:Ja((e=>e))(e),object:t=>Ja((e=>{var n;if(null!==(n=e)&&"object"==typeof n)return function(e,t){return Object.keys(t).reduce(((n,i)=>{if(void 0===n)return;const s=(0,t[i])(e[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}(e,t)}))(e),array:t=>Ja((e=>{var n;if(Array.isArray(e))return n=t,e.reduce(((e,t)=>{if(void 0===e)return;const i=n(t);return i.succeeded&&void 0!==i.value?[...e,i.value]:void 0}),[])}))(e)}}const tl={optional:el(!0),required:el(!1)};function nl(e,t){const n=t(tl),i=tl.required.object(n)(e);return i.succeeded?i.value:void 0}function il(e,t,n,i){if(t&&!t(e))return!1;const s=nl(e,n);return!!s&&i(s)}function sl(e,t){var n;return Qo(null!==(n=null==e?void 0:e())&&void 0!==n?n:{},t)}function rl(e){return"value"in e}function ol(e){if(!Xo(e)||!("binding"in e))return!1;return Jo(e.binding)}const al="http://www.w3.org/2000/svg";function ll(e){e.offsetHeight}function cl(e){return void 0!==e.ontouchstart}function ul(){return globalThis.document}const hl={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function pl(e,t){const n=e.createElementNS(al,"svg");return n.innerHTML=hl[t],n}function dl(e,t,n){e.insertBefore(t,e.children[n])}function ml(e){e.parentElement&&e.parentElement.removeChild(e)}function vl(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function fl(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}function gl(e,t){e.emitter.on("change",(e=>{t(e.rawValue)})),t(e.rawValue)}function bl(e,t,n){gl(e.value(t),n)}const wl="tp";function _l(e){return(t,n)=>[wl,"-",e,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}const yl=_l("lbl");class xl{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yl()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(yl("l")),bl(t.props,"label",(t=>{Yo(t)?this.element.classList.add(yl(void 0,"nol")):(this.element.classList.remove(yl(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(n),n.appendChild(function(e,t){const n=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,i)=>{i>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(e,t)))})),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("div");i.classList.add(yl("v")),this.element.appendChild(i),this.valueElement=i}}class Cl{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new xl(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return il(e,null,(e=>({label:e.optional.string})),(e=>(this.props.set("label",e.label),!0)))}exportProps(){return sl(null,{label:this.props.get("label")})}}const Pl=_l(""),$l={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class El{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(Pl(void 0,$l[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(Pl(void 0,$l[e]))}))})),this.viewProps.handleDispose((()=>{ml(t)}))}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return il(e,null,(e=>({disabled:e.required.boolean,hidden:e.required.boolean})),(e=>(this.viewProps.importState(e),!0)))}exportState(){return sl(null,Object.assign({},this.viewProps.exportState()))}}class kl extends El{constructor(e,t){if(t.value!==t.valueController.value)throw ta.shouldNeverHappen();const n=t.valueController.viewProps,i=new Cl(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new xl(e,{props:t.props,viewProps:n}),viewProps:n})),this.labelController=i,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return il(e,(t=>{var n,i,s;return super.importState(t)&&this.labelController.importProps(t)&&(null===(s=null===(i=(n=this.valueController).importProps)||void 0===i?void 0:i.call(n,e))||void 0===s||s)}),(e=>({value:e.optional.raw})),(e=>(e.value&&(this.value.rawValue=e.value),!0)))}exportState(){var e,t,n;return sl((()=>super.exportState()),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(n=null===(t=(e=this.valueController).exportProps)||void 0===t?void 0:t.call(e))&&void 0!==n?n:{}))}}function Vl(e){const t=Object.assign({},e);return delete t.value,t}class Sl extends kl{constructor(e,t){super(e,t),this.tag=t.tag}importState(e){return il(e,(t=>super.importState(Vl(e))),(e=>({tag:e.optional.string})),(e=>(this.tag=e.tag,!0)))}exportState(){return sl((()=>Vl(super.exportState())),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}class Ll extends Sl{importState(e){return il(e,(e=>super.importState(e)),(e=>({binding:e.required.object({value:e.required.raw})})),(e=>(this.value.binding.inject(e.binding.value),this.value.fetch(),!0)))}}function Ml(e){return rl(e)&&function(e){if(!("binding"in e))return!1;const t=e.binding;return Jo(t)&&"read"in t&&"write"in t}(e.value)}function Al(e,t){for(;e.length<t;)e.push(void 0)}function Dl(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}class jl{constructor(e){this.emitter=new ia,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e.binding,this.value_=aa(function(e){const t=[];return Al(t,e),t}(e.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=function(e,t){const n=[...Dl(e),t];return n.length>e.length?n.splice(0,n.length-e.length):Al(n,e.length),n}(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}class Tl extends Sl{exportState(){return sl((()=>super.exportState()),{binding:{readonly:!0}})}}function Ol(e){return rl(e)&&function(e){if(!("binding"in e))return!1;const t=e.binding;return Jo(t)&&"read"in t&&!("write"in t)}(e.value)}class Bl extends Ka{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return null!==(e=this.controller.buttonController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller.buttonController.emitter.on(e,(e=>{n(new Wa(this,e.nativeEvent))})),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function zl(e,t){return n=>{!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function Nl(e,t){gl(e,(e=>{t.textContent=null!=e?e:""}))}const Fl=_l("btn");class Il{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Fl()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(Fl("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(Fl("t")),Nl(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class Rl{constructor(e,t){this.emitter=new ia,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Il(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return il(e,null,(e=>({title:e.optional.string})),(e=>(this.props.set("title",e.title),!0)))}exportProps(){return sl(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class ql extends El{constructor(e,t){const n=new Rl(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new Cl(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:t.viewProps}),this.buttonController=n,this.labelController=i}importState(e){return il(e,(e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e)),(()=>({})),(()=>!0))}exportState(){return sl((()=>super.exportState()),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Ul{constructor(e){const[t,n]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}const Kl=new Ul("2.0.5");function Hl(e){return Object.assign({core:Kl},e)}const Gl=Hl({id:"button",type:"blade",accept(e){const t=nl(e,(e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new ql(e.document,{blade:e.blade,buttonProps:la.fromObject({title:e.params.title}),labelProps:la.fromObject({label:e.params.label}),viewProps:e.viewProps}),api:e=>e.controller instanceof ql?new Bl(e.controller):null});class Yl{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new ia,this.pool_=t;this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map((e=>this.pool_.createApi(e)))}addBinding(e,t,n){const i=null!=n?n:{},s=this.controller_.element.ownerDocument,r=this.pool_.createBinding(s,function(e,t){if(!na.isBindable(e))throw ta.notBindable();return new na(e,t)}(e,t),i),o=this.pool_.createBindingApi(r);return this.add(o,i.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){const n=e.controller;return this.controller_.rack.add(n,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,n=this.pool_.createBlade(t,e),i=this.pool_.createApi(n);return this.add(i,e.index)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach((e=>{var t;Xo(t=e)&&"refresh"in t&&"function"==typeof t.refresh&&e.refresh()}))}onRackValueChange_(e){const t=e.bladeController,n=this.pool_.createApi(t),i=ol(t.value)?t.value.binding:null;this.emitter_.emit("change",new Ga(n,i?i.target.read():t.value.rawValue,e.options.last))}}class Xl extends Ka{constructor(e,t){super(e),this.rackApi_=new Yl(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class Wl extends El{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return il(e,(e=>super.importState(e)),(e=>({children:e.required.array(e.required.raw)})),(e=>this.rackController.rack.children.every(((t,n)=>t.importState(e.children[n])))))}exportState(){return sl((()=>super.exportState()),{children:this.rackController.rack.children.map((e=>e.exportState()))})}}function Zl(e){return"rackController"in e}class Ql{constructor(e){this.emitter=new ia,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw ta.shouldNeverHappen();const n=void 0!==t?t:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.allItems().forEach((e=>{this.cache_.delete(e)})),n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function Jl(e){return Zl(e)?e.rackController.rack.bcSet_:null}class ec{constructor(e){var t,n;this.emitter=new ia,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(t=e.blade)&&void 0!==t?t:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new Ql(Jl),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),rl(n))n.value.emitter.on("change",this.onChildValueChange_);else if(Zl(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.on("layout",this.onRackLayout_),t.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const n=e.item;if(rl(n))n.value.emitter.off("change",this.onChildValueChange_);else if(Zl(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.off("layout",this.onRackLayout_),t.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],n=e[e.length-1];this.bcSet_.items.forEach((e=>{const i=[];e===t&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),e===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),e.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildValueChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(rl(i)&&i.value===t)return i}return null}(this.find(rl),e.sender);if(!t)throw ta.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class tc{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new ec({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--){this.rack.children[e].viewProps.set("disposed",!0)}}))}onRackAdd_(e){e.root&&dl(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&ml(e.bladeController.view.element)}}function nc(){return new la({positions:aa([],{equals:Zo})})}class ic extends la{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=la.createCore(t);return new ic(n)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Yo(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};bl(this,"expanded",n),bl(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function sc(e,t){t.style.height=e.styleHeight}function rc(e,t){e.value("expanded").emitter.on("beforechange",(()=>{if(e.set("completed",!1),Yo(e.get("expandedHeight"))){const n=function(e,t){let n=0;return function(e,t){const n=e.style.transition;e.style.transition="none",t(),e.style.transition=n}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),ll(t),n=t.clientHeight,e.set("temporaryExpanded",null),ll(t)})),n}(e,t);n>0&&e.set("expandedHeight",n)}e.set("shouldFixHeight",!0),ll(t)})),e.emitter.on("change",(()=>{sc(e,t)})),sc(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&e.cleanUpTransition()}))}class oc extends Xl{constructor(e,t){super(e,t),this.emitter_=new ia,this.controller.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",new Ya(this,e.sender.rawValue))})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)}))}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const ac=_l("cnt");class lc{constructor(e,t){var n;this.className_=_l(null!==(n=t.viewName)&&void 0!==n?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),ac()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),bl(this.foldable_,"completed",zl(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),bl(t.props,"title",(e=>{Yo(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(this.className_("t")),Nl(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class cc extends Wl{constructor(e,t){var n;const i=ic.create(null===(n=t.expanded)||void 0===n||n),s=new lc(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new tc({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,rc(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return il(e,(e=>super.importState(e)),(e=>({expanded:e.required.boolean,title:e.optional.string})),(e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0)))}exportState(){return sl((()=>super.exportState()),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const uc=Hl({id:"folder",type:"blade",accept(e){const t=nl(e,(e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean})));return t?{params:t}:null},controller:e=>new cc(e.document,{blade:e.blade,expanded:e.params.expanded,props:la.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof cc?new oc(e.controller,e.pool):null}),hc=_l("");function pc(e,t){return zl(e,hc(void 0,t))}class dc extends la{constructor(e){var t,n;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=(n=aa(this.getGlobalDisabled_()),[new oa(n),(e,t)=>{n.setRawValue(e,t)}]),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,i;const s=null!=e?e:{};return new dc(la.createCore({disabled:null!==(t=s.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){gl(this.globalDisabled_,pc(e,"disabled")),bl(this,"hidden",pc(e,"hidden"))}bindDisabled(e){gl(this.globalDisabled_,(t=>{e.disabled=t}))}bindTabIndex(e){gl(this.globalDisabled_,(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const mc=_l("tbp");class vc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(mc()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(mc("c")),this.element.appendChild(n),this.containerElement=n}}const fc=_l("tbi");class gc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fc()),t.viewProps.bindClassModifiers(this.element),bl(t.props,"selected",(e=>{e?this.element.classList.add(fc(void 0,"sel")):this.element.classList.remove(fc(void 0,"sel"))}));const n=e.createElement("button");n.classList.add(fc("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(fc("t")),Nl(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class bc{constructor(e,t){this.emitter=new ia,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new gc(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class wc extends Wl{constructor(e,t){const n=new vc(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new tc({blade:t.blade,element:n.containerElement,viewProps:t.viewProps}),view:n})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new bc(e,{props:t.itemProps,viewProps:dc.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,bl(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}importState(e){return il(e,(e=>super.importState(e)),(e=>({selected:e.required.boolean,title:e.required.string})),(e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0)))}exportState(){return sl((()=>super.exportState()),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class _c extends Xl{constructor(e,t){super(e,t),this.emitter_=new ia,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)})),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,n=new wc(t,{blade:nc(),itemProps:la.fromObject({selected:!1,title:e.title}),props:la.fromObject({selected:!1}),viewProps:dc.create()}),i=this.pool_.createApi(n);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Xa(this,e.rawValue))}}class yc extends Xl{get title(){var e;return null!==(e=this.controller.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addBlade(e){return this.rackApi_.addBlade(e)}}class xc{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=aa(!0),this.selectedIndex=aa(-1),this.items_=[]}add(e,t){const n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const e=this.items_.findIndex((e=>e.rawValue));e<0?(this.items_.forEach(((e,t)=>{e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex((t=>t===e.sender));this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const Cc=_l("tab");class Pc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Cc(),ac()),t.viewProps.bindClassModifiers(this.element),gl(t.empty,zl(this.element,Cc(void 0,"nop")));const n=e.createElement("div");n.classList.add(Cc("t")),this.element.appendChild(n),this.itemsElement=n;const i=e.createElement("div");i.classList.add(Cc("i")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Cc("c")),this.element.appendChild(s),this.contentsElement=s}}class $c extends Wl{constructor(e,t){const n=new xc,i=new Pc(e,{empty:n.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new tc({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=n}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;dl(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;ml(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}const Ec=Hl({id:"tab",type:"blade",accept(e){const t=nl(e,(e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")})));return t&&0!==t.pages.length?{params:t}:null},controller(e){const t=new $c(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((n=>{const i=new wc(e.document,{blade:nc(),itemProps:la.fromObject({selected:!1,title:n.title}),props:la.fromObject({selected:!1}),viewProps:dc.create()});t.add(i)})),t},api:e=>e.controller instanceof $c?new _c(e.controller,e.pool):e.controller instanceof wc?new yc(e.controller,e.pool):null});class kc extends Za{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class Vc{constructor(){this.disabled=!1,this.emitter=new ia}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Sc{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new ia,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Lc{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function Mc(e,t){if(e instanceof t)return e;if(e instanceof Lc){const n=e.constraints.reduce(((e,n)=>e||(n instanceof t?n:null)),null);if(n)return n}return null}class Ac{constructor(e){this.values=la.fromObject({options:e})}constrain(e){const t=this.values.get("options");if(0===t.length)return e;return t.filter((t=>t.value===e)).length>0?e:t[0].value}}function Dc(e){var t;const n=tl;return Array.isArray(e)?null===(t=nl({items:e},(e=>({items:e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))}))))||void 0===t?void 0:t.items:"object"==typeof e?n.required.raw(e).value:void 0}function jc(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((n=>{t.push({text:n,value:e[n]})})),t}function Tc(e){return Yo(e)?null:new Ac(jc(e))}const Oc=_l("lst");class Bc{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Oc()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(Oc("s")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=e.createElement("div");i.classList.add(Oc("m")),i.appendChild(pl(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,bl(this.props_,"options",(t=>{vl(this.selectElement),t.forEach((t=>{const n=e.createElement("option");n.textContent=t.text,this.selectElement.appendChild(n)})),this.update_()}))}update_(){const e=this.props_.get("options").map((e=>e.value));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class zc{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Bc(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return il(e,null,(e=>({options:e.required.custom(Dc)})),(e=>(this.props.set("options",jc(e.options)),!0)))}exportProps(){return sl(null,{options:this.props.get("options")})}}const Nc=_l("pop");class Fc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Nc()),t.viewProps.bindClassModifiers(this.element),gl(t.shows,zl(this.element,Nc(void 0,"v")))}}class Ic{constructor(e,t){this.shows=aa(!1),this.viewProps=t.viewProps,this.view=new Fc(e,{shows:this.shows,viewProps:this.viewProps})}}const Rc=_l("txt");class qc{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Rc()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(Rc("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Uc{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new qc(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);Yo(n)||(this.value.rawValue=n),this.view.refresh()}}function Kc(e){return"false"!==e&&!!e}function Hc(e){return function(e){return String(e)}(e)}const Gc=Aa(0);function Yc(e){return Gc(e)+"%"}function Xc(e){return String(e)}function Wc(e){return e}function Zc({primary:e,secondary:t,forward:n,backward:i}){let s=!1;function r(e){s||(s=!0,e(),s=!1)}e.emitter.on("change",(i=>{r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),i.options)}))})),t.emitter.on("change",(s=>{r((()=>{e.setRawValue(i(e.rawValue,t.rawValue),s.options)})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),s.options)}))})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),{forceEmit:!1,last:!0})}))}function Qc(e,t){const n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function Jc(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function eu(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function tu(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function nu(e,t){var n,i;const s=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+r.left),y:e.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+r.top)}}class iu{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new ia,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(nu(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(nu(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(nu(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const su=_l("txt");class ru{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(su(),su(void 0,"num")),t.arrayPosition&&this.element.classList.add(su(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(su("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(su()),this.inputElement.classList.add(su("i"));const i=e.createElement("div");i.classList.add(su("k")),this.element.appendChild(i),this.knobElement=i;const s=e.createElementNS(al,"svg");s.classList.add(su("g")),this.knobElement.appendChild(s);const r=e.createElementNS(al,"path");r.classList.add(su("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=e.createElementNS(al,"path");o.classList.add(su("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(_l("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(su(void 0,"drg"));this.element.classList.add(su(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),n=t+(t>0?-1:t<0?1:0),i=Ta(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class ou{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=null!==(n=t.sliderProps)&&void 0!==n?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=aa(null),this.view=new ru(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new iu(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const i=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("min"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("max");let r=e;return void 0!==i&&(r=Math.max(r,i)),void 0!==s&&(r=Math.min(r,s)),r}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);Yo(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(e){const t=Qc(this.props.get("keyScale"),Jc(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Qc(this.props.get("keyScale"),Jc(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const au=_l("sld");class lu{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(au()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(au("t")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(au("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Ta(Da(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class cu{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new lu(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new iu(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(Da(Ta(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Qc(this.props.get("keyScale"),eu(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Qc(this.props.get("keyScale"),eu(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const uu=_l("sldtxt");class hu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(uu());const n=e.createElement("div");n.classList.add(uu("s")),this.sliderView_=t.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(uu("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class pu{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new cu(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new ou(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new hu(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return il(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>{const t=this.sliderC_.props;return t.set("max",e.max),t.set("min",e.min),!0}))}exportProps(){const e=this.sliderC_.props;return sl(null,{max:e.get("max"),min:e.get("min")})}}function du(e){return{sliderProps:new la({keyScale:e.keyScale,max:e.max,min:e.min}),textProps:new la({formatter:aa(e.formatter),keyScale:e.keyScale,pointerScale:aa(e.pointerScale)})}}const mu={containerUnitSize:"cnt-usz"};function vu(e){return`--${mu[e]}`}function fu(e){return qa(e)}function gu(e){if(Wo(e))return nl(e,fu)}function bu(e,t){if(!e)return;const n=[],i=Fa(e,t);i&&n.push(i);const s=Ia(e);return s&&n.push(s),new Lc(n)}function wu(e){if("inline"===e||"popup"===e)return e}function _u(e,t){e.write(t)}const yu=_l("ckb");class xu{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(yu()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(yu("l")),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("input");i.classList.add(yu("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(yu("w")),this.labelElement.appendChild(s);const r=pl(e,"check");s.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Cu{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new xu(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}const Pu=Hl({id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=nl(t,(e=>({options:e.optional.custom(Dc),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Kc,constraint:e=>function(e){const t=[],n=Tc(e.options);return n&&t.push(n),new Lc(t)}(e.params),writer:e=>_u},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&Mc(i,Ac);return s?new zc(t,{props:new la({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new Cu(t,{value:n,viewProps:e.viewProps})},api:e=>"boolean"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof zc?new kc(e.controller):null}),$u=_l("col");class Eu{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add($u()),t.foldable.bindExpandedClass(this.element,$u(void 0,"expanded")),bl(t.foldable,"completed",zl(this.element,$u(void 0,"cpl")));const n=e.createElement("div");n.classList.add($u("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add($u("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add($u("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add($u("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function ku(e,t,n){const i=Oa(e,360),s=Ta(t/100,0,1),r=Ta(n/100,0,1),o=r*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}function Vu(e){return[e[0],e[1],e[2]]}function Su(e,t){return[e[0],e[1],e[2],t]}const Lu={hsl:{hsl:(e,t,n)=>[e,t,n],hsv:function(e,t,n){const i=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==i?t*(100-Math.abs(2*n-100))/i:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){const i=(e%360+360)%360,s=Ta(t/100,0,1),r=Ta(n/100,0,1),o=(1-Math.abs(2*r-1))*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o/2;let c,u,h;return[c,u,h]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(u+l),255*(h+l)]}},hsv:{hsl:function(e,t,n){const i=100-Math.abs(n*(200-t)/100-100);return[e,0!==i?t*n/i:0,n*(200-t)/200]},hsv:(e,t,n)=>[e,t,n],rgb:ku},rgb:{hsl:function(e,t,n){const i=Ta(e/255,0,1),s=Ta(t/255,0,1),r=Ta(n/255,0,1),o=Math.max(i,s,r),a=Math.min(i,s,r),l=o-a;let c=0,u=0;const h=(a+o)/2;return 0!==l&&(u=l/(1-Math.abs(o+a-1)),c=i===o?(s-r)/l:s===o?2+(r-i)/l:4+(i-s)/l,c=c/6+(c<0?1:0)),[360*c,100*u,100*h]},hsv:function(e,t,n){const i=Ta(e/255,0,1),s=Ta(t/255,0,1),r=Ta(n/255,0,1),o=Math.max(i,s,r),a=o-Math.min(i,s,r);let l;return l=0===a?0:o===i?((s-r)/a%6+6)%6*60:o===s?60*((r-i)/a+2):60*((i-s)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,n)=>[e,t,n]}};function Mu(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function Au(e,t,n){var i;const s=Mu(t,n);return["rgb"===t?Ta(e[0],0,s[0]):(r=e[0],o=s[0],r===o?o:Oa(r,o)),Ta(e[1],0,s[1]),Ta(e[2],0,s[2]),Ta(null!==(i=e[3])&&void 0!==i?i:1,0,1)];var r,o}function Du(e,t,n,i){const s=Mu(t,n),r=Mu(t,i);return e.map(((e,t)=>e/s[t]*r[t]))}function ju(e,t,n){const i=Du(e,t.mode,t.type,"int");return Du(Lu[t.mode][n.mode](...i),n.mode,"int",n.type)}class Tu{static black(){return new Tu([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=Au(e,t,this.type)}getComponents(e){return Su(ju(Vu(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Ou=_l("colp");class Bu{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Ou()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ou("hsv"));const i=e.createElement("div");i.classList.add(Ou("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(Ou("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);const r=e.createElement("div");if(r.classList.add(Ou("rgb")),this.textsView_=t.textsView,r.appendChild(this.textsView_.element),this.element.appendChild(r),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const n=e.createElement("div");n.classList.add(Ou("a"));const i=e.createElement("div");i.classList.add(Ou("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(Ou("at")),s.appendChild(this.alphaViews_.text.element),n.appendChild(s),this.element.appendChild(n)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function zu(e){return"int"===e?"int":"float"===e?"float":void 0}function Nu(e){return nl(e,(e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(zu)}),expanded:e.optional.boolean,picker:e.optional.custom(wu),readonly:e.optional.constant(!1)})))}function Fu(e){return e?.1:1}function Iu(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}class Ru{constructor(e,t){this.type="float",this.mode=t,this.comps_=Au(e,t,this.type)}getComponents(e){return Su(ju(Vu(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const qu={int:(e,t)=>new Tu(e,t),float:(e,t)=>new Ru(e,t)};function Uu(e,t,n){return qu[n](e,t)}function Ku(e,t){if(e.type===t)return e;if(function(e){return"int"===e.type}(e)&&"float"===t)return function(e){const t=e.getComponents(),n=Mu(e.mode,"int");return new Ru([Da(t[0],0,n[0],0,1),Da(t[1],0,n[1],0,1),Da(t[2],0,n[2],0,1),t[3]],e.mode)}(e);if(function(e){return"float"===e.type}(e)&&"int"===t)return function(e){const t=e.getComponents(),n=Mu(e.mode,"int");return new Tu([Math.round(Da(t[0],0,1,0,n[0])),Math.round(Da(t[1],0,1,0,n[1])),Math.round(Da(t[2],0,1,0,n[2])),t[3]],e.mode)}(e);throw ta.shouldNeverHappen()}function Hu(e,t){const n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}const Gu={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function Yu(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const n=parseFloat(t[1]),i=t[2];return Gu[i](n)}function Xu(e){const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Hu(t[1],255),Hu(t[2],255),Hu(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Wu(e){const t=Xu(e);return t?new Tu(t,"rgb"):null}function Zu(e){const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Hu(t[1],255),Hu(t[2],255),Hu(t[3],255),Hu(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Qu(e){const t=Zu(e);return t?new Tu(t,"rgb"):null}function Ju(e){const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Yu(t[1]),Hu(t[2],100),Hu(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function eh(e){const t=Ju(e);return t?new Tu(t,"hsl"):null}function th(e){const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Yu(t[1]),Hu(t[2],100),Hu(t[3],100),Hu(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function nh(e){const t=th(e);return t?new Tu(t,"hsl"):null}function ih(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function sh(e){const t=ih(e);return t?new Tu(t,"rgb"):null}function rh(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),Da(parseInt(t[4]+t[4],16),0,255,0,1)];const n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Da(parseInt(n[4],16),0,255,0,1)]:null}function oh(e){const t=rh(e);return t?new Tu(t,"rgb"):null}function ah(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function lh(e){return t=>{const n=ah(t);return n?Uu(n,"rgb",e):null}}function ch(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function uh(e){return t=>{const n=ch(t);return n?Uu(n,"rgb",e):null}}const hh=[{parser:ih,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:rh,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Xu,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Zu,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Ju,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:th,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:ah,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ch,result:{alpha:!0,mode:"rgb",notation:"object"}}];function ph(e,t="int"){const n=function(e){return hh.reduce(((t,{parser:n,result:i})=>t||(n(e)?i:null)),null)}(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}function dh(e){const t=[sh,oh,Wu,Qu,eh,nh];"int"===e&&t.push(lh("int"),uh("int")),"float"===e&&t.push(lh("float"),uh("float"));const n=function(e){return t=>e.reduce(((e,n)=>null!==e?e:n(t)),null)}(t);return t=>{const i=n(t);return i?Ku(i,e):null}}function mh(e){const t=dh("int");if("string"!=typeof e)return Tu.black();const n=t(e);return null!=n?n:Tu.black()}function vh(e){const t=Ta(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function fh(e,t="#"){return`${t}${Vu(e.getComponents("rgb")).map(vh).join("")}`}function gh(e,t="#"){const n=e.getComponents("rgb");return`${t}${[n[0],n[1],n[2],255*n[3]].map(vh).join("")}`}function bh(e){const t=Aa(0);return`rgb(${Vu(Ku(e,"int").getComponents("rgb")).map((e=>t(e))).join(", ")})`}function wh(e){const t=Aa(2),n=Aa(0),i=Ku(e,"int").getComponents("rgb").map(((e,i)=>(3===i?t:n)(e)));return`rgba(${i.join(", ")})`}function _h(e,t){const n=Aa("float"===t?2:0),i=["r","g","b"],s=Vu(Ku(e,t).getComponents("rgb")).map(((e,t)=>`${i[t]}: ${n(e)}`));return`{${s.join(", ")}}`}function yh(e){return t=>_h(t,e)}function xh(e,t){const n=Aa(2),i=Aa("float"===t?2:0),s=["r","g","b","a"],r=Ku(e,t).getComponents("rgb").map(((e,t)=>`${s[t]}: ${(3===t?n:i)(e)}`));return`{${r.join(", ")}}`}function Ch(e){return t=>xh(t,e)}const Ph=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:fh},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:gh},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:bh},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:wh},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[Aa(0),Yc,Yc],n=Vu(Ku(e,"int").getComponents("hsl")).map(((e,n)=>t[n](e)));return`hsl(${n.join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[Aa(0),Yc,Yc,Aa(2)],n=Ku(e,"int").getComponents("hsl").map(((e,n)=>t[n](e)));return`hsla(${n.join(", ")})`}},...["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:yh(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:Ch(t)}]),[])];function $h(e){return Ph.reduce(((t,n)=>{return t||(i=n.format,s=e,i.alpha===s.alpha&&i.mode===s.mode&&i.notation===s.notation&&i.type===s.type?n.stringifier:null);var i,s}),null)}const Eh=_l("apl");class kh{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Eh()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(Eh("b")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Eh("c")),n.appendChild(i),this.colorElem_=i;const s=e.createElement("div");s.classList.add(Eh("m")),this.element.appendChild(s),this.markerElem_=s;const r=e.createElement("div");r.classList.add(Eh("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),n=new Tu([t[0],t[1],t[2],0],"rgb"),i=new Tu([t[0],t[1],t[2],255],"rgb"),s=["to right",wh(n),wh(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=wh(e);const r=Da(t[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class Vh{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new kh(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new iu(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=e.point.x/e.bounds.width,i=this.value.rawValue,[s,r,o]=i.getComponents("hsv");this.value.setRawValue(new Tu([s,r,o,n],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Qc(Fu(!0),eu(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new Tu([i,s,r,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Qc(Fu(!0),eu(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Sh=_l("coltxt");class Lh{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Sh()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Sh("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce(((t,n)=>{const i=e.createElement("option");return i.textContent=n.text,i.value=n.value,t.appendChild(i),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(Sh("ms")),n.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(Sh("mm")),i.appendChild(pl(e,"dropdown")),n.appendChild(i),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(Sh("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),gl(t.mode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){vl(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach((t=>{const n=e.createElement("div");n.classList.add(Sh("c")),n.appendChild(t.element),this.inputsElem_.appendChild(n)}))}}function Mh(e,t,n){const i=Mu(e,t)[n];return new ca({min:0,max:i})}function Ah(e,t){const n={colorMode:t.colorMode,colorType:t.colorType,parser:Sa,viewProps:t.viewProps};return[0,1,2].map((i=>{const s=function(e,t,n){return new ou(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",parser:t.parser,props:la.fromObject({formatter:(i=t.colorType,Aa("float"===i?2:0)),keyScale:Fu(!1),pointerScale:"float"===t.colorType?.01:1}),value:aa(0,{constraint:Mh(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var i}(e,n,i);return Zc({primary:t.value,secondary:s.value,forward:e=>Ku(e,t.colorType).getComponents(t.colorMode)[i],backward(e,n){const s=t.colorMode,r=Ku(e,t.colorType).getComponents(s);r[i]=n;return Ku(Uu(Su(Vu(r),r[3]),s,t.colorType),"int")}}),s}))}class Dh{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=aa(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Lh(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return function(e){return"hex"!==e}(t)?Ah(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(e,t){const n=new Uc(e,{parser:dh("int"),props:la.fromObject({formatter:fh}),value:aa(Tu.black()),viewProps:t.viewProps});return Zc({primary:t.value,secondary:n.value,forward:e=>new Tu(Vu(e.getComponents()),e.mode),backward:(e,t)=>new Tu(Su(Vu(t.getComponents(e.mode)),e.getComponents()[3]),e.mode)}),[n]}(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((e=>e.view))}}const jh=_l("hpl");class Th{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(jh()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(jh("c")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(jh("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=bh(new Tu([t,100,100],"hsv"));const n=Da(t,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class Oh{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Th(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new iu(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=Da(Ta(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new Tu([n,s,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Qc(Fu(!1),eu(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new Tu([i+t,s,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Qc(Fu(!1),eu(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Bh=_l("svp");class zh{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Bh()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=64,n.width=64,n.classList.add(Bh("c")),this.element.appendChild(n),this.canvasElement=n;const i=e.createElement("div");i.classList.add(Bh("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,s=e.getImageData(0,0,n,i),r=s.data;for(let e=0;e<i;e++)for(let s=0;s<n;s++){const o=Da(s,0,n,0,100),a=Da(e,0,i,100,0),l=ku(t[0],o,a),c=4*(e*n+s);r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=255}e.putImageData(s,0,0);const o=Da(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=Da(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Nh{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new zh(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new iu(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=Da(e.point.x,0,e.bounds.width,0,100),i=Da(e.point.y,0,e.bounds.height,100,0),[s,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Tu([s,n,i,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){tu(e.key)&&e.preventDefault();const[t,n,i,s]=this.value.rawValue.getComponents("hsv"),r=Fu(!1),o=Qc(r,eu(e)),a=Qc(r,Jc(e));0===o&&0===a||this.value.setRawValue(new Tu([t,n+o,i+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Fu(!1),n=Qc(t,eu(e)),i=Qc(t,Jc(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Fh{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Oh(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Nh(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new Vh(e,{value:this.value,viewProps:this.viewProps}),text:new ou(e,{parser:Sa,props:la.fromObject({pointerScale:.01,keyScale:.1,formatter:Aa(2)}),value:aa(0,{constraint:new ca({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Zc({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.getComponents()[3],backward:(e,t)=>{const n=e.getComponents();return n[3]=t,new Tu(n,e.mode)}}),this.textsC_=new Dh(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Bu(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Ih=_l("colsw");class Rh{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Ih()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ih("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=e.createElement("button");i.classList.add(Ih("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=gh(e)}onValueChange_(){this.update_()}}class qh{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Rh(e,{value:this.value,viewProps:this.viewProps})}}class Uh{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=ic.create(t.expanded),this.swatchC_=new qh(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Uc(e,{parser:t.parser,props:la.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Eu(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Ic(e,{viewProps:this.viewProps}):null;const i=new Fh(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Zc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),rc(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=fl(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!cl(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Kh(e){return Vu(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function Hh(e){return e.getComponents("rgb").reduce(((e,t,n)=>e<<8|255&Math.floor(3===n?255*t:t)),0)>>>0}function Gh(e){return"number"!=typeof e?Tu.black():new Tu([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function Yh(e){return"number"!=typeof e?Tu.black():new Tu([(t=e)>>24&255,t>>16&255,t>>8&255,Da(255&t,0,255,0,1)],"rgb");var t}function Xh(e,t){return"object"==typeof e&&!Yo(e)&&(t in e&&"number"==typeof e[t])}function Wh(e){return Xh(e,"r")&&Xh(e,"g")&&Xh(e,"b")}function Zh(e){return Wh(e)&&Xh(e,"a")}function Qh(e){return Wh(e)}function Jh(e,t){if(e.mode!==t.mode)return!1;if(e.type!==t.type)return!1;const n=e.getComponents(),i=t.getComponents();for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}function ep(e){return"a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b]}function tp(e,t){return(n,i)=>{e?function(e,t,n){const i=Ku(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}(n,i,t):function(e,t,n){const i=Ku(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}(n,i,t)}}function np(e){var t;return!!(null===(t=null==e?void 0:e.color)||void 0===t?void 0:t.alpha)}const ip=Hl({id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!function(e){return"color"in e||"color"===e.view}(t))return null;const n=Nu(t);return n?{initialValue:e,params:Object.assign(Object.assign({},n),{supportsAlpha:np(t)})}:null},binding:{reader:e=>e.params.supportsAlpha?Yh:Gh,equals:Jh,writer:e=>function(e){const t=e?Hh:Kh;return(e,n)=>{_u(e,t(n))}}(e.params.supportsAlpha)},controller:e=>{var t,n,i;return new Uh(e.document,{colorType:"int",expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:(i=e.params.supportsAlpha,i?e=>gh(e,"0x"):e=>fh(e,"0x")),parser:dh("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.supportsAlpha,value:e.value,viewProps:e.viewProps})}});function sp(e){return t=>{const n=function(e,t){if(!Qh(e))return Ku(Tu.black(),t);if("int"===t){const t=ep(e);return new Tu(t,"rgb")}if("float"===t){const t=ep(e);return new Ru(t,"rgb")}return Ku(Tu.black(),"int")}(t,e);return Ku(n,"int")}}function rp(e,t){return n=>e?xh(n,t):_h(n,t)}const op=Hl({id:"input-color-object",type:"input",accept:(e,t)=>{var n;if(!Qh(e))return null;const i=Nu(t);return i?{initialValue:e,params:Object.assign(Object.assign({},i),{colorType:null!==(n=Iu(t))&&void 0!==n?n:"int"})}:null},binding:{reader:e=>sp(e.params.colorType),equals:Jh,writer:e=>tp(Zh(e.initialValue),e.params.colorType)},controller:e=>{var t,n;const i=Zh(e.initialValue);return new Uh(e.document,{colorType:e.params.colorType,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:rp(i,e.params.colorType),parser:dh("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:i,value:e.value,viewProps:e.viewProps})}}),ap=Hl({id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("text"===t.view)return null;const n=ph(e,Iu(t));if(!n)return null;const i=$h(n);if(!i)return null;const s=Nu(t);return s?{initialValue:e,params:Object.assign(Object.assign({},s),{format:n,stringifier:i})}:null},binding:{reader:()=>mh,equals:Jh,writer:e=>{const t=function(e){const t=$h(e);return t?(e,n)=>{_u(e,t(n))}:null}(e.params.format);if(!t)throw ta.notBindable();return t}},controller:e=>{var t,n;return new Uh(e.document,{colorType:e.params.format.type,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:e.params.stringifier,parser:dh("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.format.alpha,value:e.value,viewProps:e.viewProps})}});class lp{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var n,i;return null!==(i=null===(n=this.components[t])||void 0===n?void 0:n.constrain(e))&&void 0!==i?i:e}));return this.asm_.fromComponents(t)}}const cp=_l("pndtxt");class up{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(cp()),this.textViews.forEach((t=>{const n=e.createElement("div");n.classList.add(cp("a")),n.appendChild(t.element),this.element.appendChild(n)}))}}class hp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((n,i)=>function(e,t,n){return new ou(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[n].textProps,value:aa(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(e,t,i))),this.acs_.forEach(((e,n)=>{Zc({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e)[n],backward:(e,i)=>{const s=t.assembly.toComponents(e);return s[n]=i,t.assembly.fromComponents(s)}})})),this.view=new up(e,{textViews:this.acs_.map((e=>e.view))})}get textControllers(){return this.acs_}}class pp extends Za{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}const dp=Hl({id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=nl(t,(e=>Object.assign(Object.assign({},qa(e)),{options:e.optional.custom(Dc),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>La,constraint:e=>function(e,t){const n=[],i=Fa(e,t);i&&n.push(i);const s=Ia(e);s&&n.push(s);const r=Tc(e.options);return r&&n.push(r),new Lc(n)}(e.params,e.initialValue),writer:e=>_u},controller:e=>{const t=e.value,n=e.constraint,i=n&&Mc(n,Ac);if(i)return new zc(e.document,{props:new la({options:i.values.value("options")}),value:t,viewProps:e.viewProps});const s=Ra(e.params,t.rawValue),r=n&&Mc(n,ca);return r?new pu(e.document,Object.assign(Object.assign({},du(Object.assign(Object.assign({},s),{keyScale:aa(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Sa,value:t,viewProps:e.viewProps})):new ou(e.document,{parser:Sa,props:la.fromObject(s),value:t,viewProps:e.viewProps})},api:e=>"number"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof pu?new pp(e.controller):e.controller.valueController instanceof zc?new kc(e.controller):null});class mp{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Yo(e))return!1;const t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const vp={toComponents:e=>e.getComponents(),fromComponents:e=>new mp(...e)},fp=_l("p2d");class gp{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fp()),t.viewProps.bindClassModifiers(this.element),gl(t.expanded,zl(this.element,fp(void 0,"expanded")));const n=e.createElement("div");n.classList.add(fp("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(fp("b")),i.appendChild(pl(e,"p2dpad")),t.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const s=e.createElement("div");if(s.classList.add(fp("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(fp("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const bp=_l("p2dp");class wp{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(bp()),"popup"===t.layout&&this.element.classList.add(bp(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(bp("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(al,"svg");i.classList.add(bp("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=e.createElementNS(al,"line");s.classList.add(bp("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const r=e.createElementNS(al,"line");r.classList.add(bp("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=e.createElementNS(al,"line");o.classList.add(bp("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(bp("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),n=this.props_.get("max"),i=Da(e,-n,+n,0,100),s=Da(t,-n,+n,0,100),r=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function _p(e,t,n){return[Qc(t[0],eu(e)),Qc(t[1],Jc(e))*(n?1:-1)]}class yp{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new wp(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new iu(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=this.props.get("max"),i=Da(e.point.x,0,e.bounds.width,-n,+n),s=Da(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new mp(i,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){tu(e.key)&&e.preventDefault();const[t,n]=_p(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(new mp(this.value.rawValue.x+t,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,n]=_p(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class xp{constructor(e,t){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=ic.create(t.expanded),this.popC_="popup"===t.pickerLayout?new Ic(e,{viewProps:this.viewProps}):null;const s=new yp(e,{layout:t.pickerLayout,props:new la({invertsY:aa(t.invertsY),max:aa(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new hp(e,{assembly:vp,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new gp(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Zc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),rc(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=fl(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!cl(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function Cp(e){return mp.isObject(e)?new mp(e.x,e.y):new mp}function Pp(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function $p(e,t){var n,i;if(!Yo(e.min)||!Yo(e.max))return Math.max(Math.abs(null!==(n=e.min)&&void 0!==n?n:0),Math.abs(null!==(i=e.max)&&void 0!==i?i:0));const s=za(e);return Math.max(10*Math.abs(s),10*Math.abs(t))}function Ep(e,t){var n,i;const s=$p(Qo(e,null!==(n=e.x)&&void 0!==n?n:{}),t.x),r=$p(Qo(e,null!==(i=e.y)&&void 0!==i?i:{}),t.y);return Math.max(s,r)}function kp(e){if(!("y"in e))return!1;const t=e.y;return!!t&&("inverted"in t&&!!t.inverted)}const Vp=Hl({id:"input-point2d",type:"input",accept:(e,t)=>{if(!mp.isObject(e))return null;const n=nl(t,(e=>Object.assign(Object.assign({},fu(e)),{expanded:e.optional.boolean,picker:e.optional.custom(wu),readonly:e.optional.constant(!1),x:e.optional.custom(gu),y:e.optional.object(Object.assign(Object.assign({},fu(e)),{inverted:e.optional.boolean}))})));return n?{initialValue:e,params:n}:null},binding:{reader:()=>Cp,constraint:e=>{return t=e.params,n=e.initialValue,new lp({assembly:vp,components:[bu(Object.assign(Object.assign({},t),t.x),n.x),bu(Object.assign(Object.assign({},t),t.y),n.y)]});var t,n},equals:mp.equals,writer:()=>Pp},controller:e=>{var t,n;const i=e.document,s=e.value,r=e.constraint,o=[e.params.x,e.params.y];return new xp(i,{axes:s.rawValue.getComponents().map(((t,n)=>{var i;return Ua({constraint:r.components[n],initialValue:t,params:Qo(e.params,null!==(i=o[n])&&void 0!==i?i:{})})})),expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,invertsY:kp(e.params),max:Ep(e.params,s.rawValue),parser:Sa,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:s,viewProps:e.viewProps})}});class Sp{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Yo(e))return!1;const t=e.x,n=e.y,i=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Lp={toComponents:e=>e.getComponents(),fromComponents:e=>new Sp(...e)};function Mp(e){return Sp.isObject(e)?new Sp(e.x,e.y,e.z):new Sp}function Ap(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}const Dp=Hl({id:"input-point3d",type:"input",accept:(e,t)=>{if(!Sp.isObject(e))return null;const n=nl(t,(e=>Object.assign(Object.assign({},fu(e)),{readonly:e.optional.constant(!1),x:e.optional.custom(gu),y:e.optional.custom(gu),z:e.optional.custom(gu)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Mp,constraint:e=>{return t=e.params,n=e.initialValue,new lp({assembly:Lp,components:[bu(Object.assign(Object.assign({},t),t.x),n.x),bu(Object.assign(Object.assign({},t),t.y),n.y),bu(Object.assign(Object.assign({},t),t.z),n.z)]});var t,n},equals:Sp.equals,writer:e=>Ap},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z];return new hp(e.document,{assembly:Lp,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Ua({constraint:n.components[s],initialValue:t,params:Qo(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:Sa,value:t,viewProps:e.viewProps})}});class jp{constructor(e=0,t=0,n=0,i=0){this.x=e,this.y=t,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Yo(e))return!1;const t=e.x,n=e.y,i=e.z,s=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i&&"number"==typeof s}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Tp={toComponents:e=>e.getComponents(),fromComponents:e=>new jp(...e)};function Op(e){return jp.isObject(e)?new jp(e.x,e.y,e.z,e.w):new jp}function Bp(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}const zp=Hl({id:"input-point4d",type:"input",accept:(e,t)=>{if(!jp.isObject(e))return null;const n=nl(t,(e=>Object.assign(Object.assign({},fu(e)),{readonly:e.optional.constant(!1),w:e.optional.custom(gu),x:e.optional.custom(gu),y:e.optional.custom(gu),z:e.optional.custom(gu)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Op,constraint:e=>{return t=e.params,n=e.initialValue,new lp({assembly:Tp,components:[bu(Object.assign(Object.assign({},t),t.x),n.x),bu(Object.assign(Object.assign({},t),t.y),n.y),bu(Object.assign(Object.assign({},t),t.z),n.z),bu(Object.assign(Object.assign({},t),t.w),n.w)]});var t,n},equals:jp.equals,writer:e=>Bp},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z,e.params.w];return new hp(e.document,{assembly:Tp,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Ua({constraint:n.components[s],initialValue:t,params:Qo(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:Sa,value:t,viewProps:e.viewProps})}});const Np=Hl({id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const n=nl(t,(e=>({readonly:e.optional.constant(!1),options:e.optional.custom(Dc)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Xc,constraint:e=>function(e){const t=[],n=Tc(e.options);return n&&t.push(n),new Lc(t)}(e.params),writer:e=>_u},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&Mc(i,Ac);return s?new zc(t,{props:new la({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new Uc(t,{parser:e=>e,props:la.fromObject({formatter:Wc}),value:n,viewProps:e.viewProps})},api:e=>"string"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof zc?new kc(e.controller):null}),Fp={defaultInterval:200,defaultRows:3},Ip=_l("mll");class Rp{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Ip()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(Ip("i")),n.style.height=`calc(var(${vu("containerUnitSize")}) * ${t.rows})`,n.readOnly=!0,t.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach((e=>{void 0!==e&&n.push(this.formatter_(e))})),e.textContent=n.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class qp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Rp(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const Up=_l("sgl");class Kp{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Up()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Up("i")),n.readOnly=!0,n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Hp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Kp(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const Gp=Hl({id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=nl(t,(e=>({readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Kc},controller:e=>{var t;return 1===e.value.rawValue.length?new Hp(e.document,{formatter:Hc,value:e.value,viewProps:e.viewProps}):new qp(e.document,{formatter:Hc,rows:null!==(t=e.params.rows)&&void 0!==t?t:Fp.defaultRows,value:e.value,viewProps:e.viewProps})}});class Yp extends Za{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const Xp=_l("grl");class Wp{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Xp()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(al,"svg");n.classList.add(Xp("g")),n.style.height=`calc(var(${vu("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(al,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=e.createElement("div");s.classList.add(Xp("t"),_l("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,n=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach(((o,a)=>{if(void 0===o)return;const l=Da(a,0,n,0,e),c=Da(o,i,s,t,0);r.push([l,c].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(Xp("t","a"));const l=Da(this.cursor_.rawValue,0,n,0,e),c=Da(a,i,s,t,0);o.style.left=`${l}px`,o.style.top=`${c}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(Xp("t","a"))||(o.classList.add(Xp("t","a"),Xp("t","in")),ll(o),o.classList.remove(Xp("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Zp{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=aa(-1),this.view=new Wp(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),cl(e)){const e=new iu(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}importProps(e){return il(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0)))}exportProps(){return sl(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(Da(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.rawValue=Math.floor(Da(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Qp(e){return Yo(e.format)?Aa(2):e.format}function Jp(e){return"graph"===e.view}const ed=Hl({id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const n=nl(t,(e=>({format:e.optional.function,max:e.optional.number,min:e.optional.number,readonly:e.required.constant(!0),rows:e.optional.number,view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>Jp(e)?64:1,reader:e=>La},controller:e=>Jp(e.params)?function(e){var t,n,i;return new Zp(e.document,{formatter:Qp(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Fp.defaultRows,props:la.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:100,min:null!==(i=e.params.min)&&void 0!==i?i:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new Hp(e.document,{formatter:Qp(e.params),value:e.value,viewProps:e.viewProps}):new qp(e.document,{formatter:Qp(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Fp.defaultRows,value:e.value,viewProps:e.viewProps})}(e),api:e=>e.controller.valueController instanceof Zp?new Yp(e.controller):null}),td=Hl({id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const n=nl(t,(e=>({multiline:e.optional.boolean,readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Xc},controller:e=>{var t;const n=e.value;return n.rawValue.length>1||e.params.multiline?new qp(e.document,{formatter:Wc,rows:null!==(t=e.params.rows)&&void 0!==t?t:Fp.defaultRows,value:n,viewProps:e.viewProps}):new Hp(e.document,{formatter:Wc,value:n,viewProps:e.viewProps})}});class nd{constructor(e){this.target=e.target,this.reader_=e.reader,this.writer_=e.writer}read(){return this.reader_(this.target.read())}write(e){this.writer_(this.target,e)}inject(e){this.write(this.reader_(e))}}class id{constructor(e){this.target=e.target,this.reader_=e.reader}read(){return this.reader_(this.target.read())}}function sd(e,t){return 0===t?new Vc:new Sc(e,null!=t?t:Fp.defaultInterval)}class rd{constructor(e){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=e}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e,t){if(!(n=t.core)||n.major!==Kl.major)throw ta.notCompatible(e,t.id);var n;"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput_(e,t,n){return this.pluginsMap_.inputs.reduce(((i,s)=>null!=i?i:function(e,t){var n;const i=e.accept(t.target.read(),t.params);if(Yo(i))return null;const s={target:t.target,initialValue:i.initialValue,params:i.params},r=nl(t.params,(e=>({disabled:e.optional.boolean,hidden:e.optional.boolean,label:e.optional.string,tag:e.optional.string}))),o=e.binding.reader(s),a=e.binding.constraint?e.binding.constraint(s):void 0,l=new nd({reader:o,target:t.target,writer:e.binding.writer(s)}),c=new Qa(aa(o(i.initialValue),{constraint:a,equals:e.binding.equals}),l),u=e.controller({constraint:a,document:t.document,initialValue:i.initialValue,params:i.params,value:c,viewProps:dc.create({disabled:null==r?void 0:r.disabled,hidden:null==r?void 0:r.hidden})});return new Ll(t.document,{blade:nc(),props:la.fromObject({label:"label"in t.params?null!==(n=null==r?void 0:r.label)&&void 0!==n?n:null:t.target.key}),tag:null==r?void 0:r.tag,value:c,valueController:u})}(s,{document:e,target:t,params:n})),null)}createMonitor_(e,t,n){return this.pluginsMap_.monitors.reduce(((i,s)=>null!=i?i:function(e,t){var n,i,s;const r=e.accept(t.target.read(),t.params);if(Yo(r))return null;const o={target:t.target,initialValue:r.initialValue,params:r.params},a=nl(t.params,(e=>({bufferSize:e.optional.number,disabled:e.optional.boolean,hidden:e.optional.boolean,interval:e.optional.number,label:e.optional.string}))),l=e.binding.reader(o),c=null!==(i=null!==(n=null==a?void 0:a.bufferSize)&&void 0!==n?n:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(r.params))&&void 0!==i?i:1,u=new jl({binding:new id({reader:l,target:t.target}),bufferSize:c,ticker:sd(t.document,null==a?void 0:a.interval)}),h=e.controller({document:t.document,params:r.params,value:u,viewProps:dc.create({disabled:null==a?void 0:a.disabled,hidden:null==a?void 0:a.hidden})});return h.viewProps.bindDisabled(u.ticker),h.viewProps.handleDispose((()=>{u.ticker.dispose()})),new Tl(t.document,{blade:nc(),props:la.fromObject({label:"label"in t.params?null!==(s=null==a?void 0:a.label)&&void 0!==s?s:null:t.target.key}),value:u,valueController:h})}(s,{document:e,params:n,target:t})),null)}createBinding(e,t,n){if(Yo(t.read()))throw new ta({context:{key:t.key},type:"nomatchingcontroller"});const i=this.createInput_(e,t,n);if(i)return i;const s=this.createMonitor_(e,t,n);if(s)return s;throw new ta({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const n=this.pluginsMap_.blades.reduce(((n,i)=>null!=n?n:function(e,t){const n=e.accept(t.params);if(!n)return null;const i=nl(t.params,(e=>({disabled:e.optional.boolean,hidden:e.optional.boolean})));return e.controller({blade:nc(),document:t.document,params:Object.assign(Object.assign({},n.params),{disabled:null==i?void 0:i.disabled,hidden:null==i?void 0:i.hidden}),viewProps:dc.create({disabled:null==i?void 0:i.disabled,hidden:null==i?void 0:i.hidden})})}(i,{document:e,params:t})),null);if(!n)throw new ta({type:"nomatchingview",context:{params:t}});return n}createInputBindingApi_(e){const t=this.pluginsMap_.inputs.reduce(((t,n)=>{var i,s;return t||(null!==(s=null===(i=n.api)||void 0===i?void 0:i.call(n,{controller:e}))&&void 0!==s?s:null)}),null);return this.apiCache_.add(e,null!=t?t:new Za(e))}createMonitorBindingApi_(e){const t=this.pluginsMap_.monitors.reduce(((t,n)=>{var i,s;return t||(null!==(s=null===(i=n.api)||void 0===i?void 0:i.call(n,{controller:e}))&&void 0!==s?s:null)}),null);return this.apiCache_.add(e,null!=t?t:new Za(e))}createBindingApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(Ml(e))return this.createInputBindingApi_(e);if(Ol(e))return this.createMonitorBindingApi_(e);throw ta.shouldNeverHappen()}createApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(function(e){return rl(e)&&ol(e.value)}(e))return this.createBindingApi(e);const t=this.pluginsMap_.blades.reduce(((t,n)=>null!=t?t:n.api({controller:e,pool:this})),null);if(!t)throw ta.shouldNeverHappen();return this.apiCache_.add(e,t)}}const od=new class{constructor(){this.map_=new Map}get(e){var t;return null!==(t=this.map_.get(e))&&void 0!==t?t:null}has(e){return this.map_.has(e)}add(e,t){return this.map_.set(e,t),e.viewProps.handleDispose((()=>{this.map_.delete(e)})),t}};class ad extends Ka{constructor(e){super(e),this.emitter_=new ia,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ga(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class ld extends Ka{}class cd extends Ka{constructor(e){super(e),this.emitter_=new ia,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ga(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class ud extends Ka{constructor(e){super(e),this.emitter_=new ia,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ga(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(e){this.controller.valueController.props.set("formatter",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const hd={id:"list",type:"blade",core:Kl,accept(e){const t=nl(e,(e=>({options:e.required.custom(Dc),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string})));return t?{params:t}:null},controller(e){const t=new Ac(jc(e.params.options)),n=aa(e.params.value,{constraint:t}),i=new zc(e.document,{props:new la({options:t.values.value("options")}),value:n,viewProps:e.viewProps});return new kl(e.document,{blade:e.blade,props:la.fromObject({label:e.params.label}),value:n,valueController:i})},api:e=>e.controller instanceof kl&&e.controller.valueController instanceof zc?new ad(e.controller):null};class pd extends oc{constructor(e,t){super(e,t)}get element(){return this.controller.view.element}}class dd extends cc{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const md=_l("spr");class vd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(md()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("hr");n.classList.add(md("r")),this.element.appendChild(n)}}class fd extends El{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new vd(e,{viewProps:t.viewProps})}))}}const gd={id:"separator",type:"blade",core:Kl,accept(e){const t=nl(e,(e=>({view:e.required.constant("separator")})));return t?{params:t}:null},controller:e=>new fd(e.document,{blade:e.blade,viewProps:e.viewProps}),api:e=>e.controller instanceof fd?new ld(e.controller):null},bd={id:"slider",type:"blade",core:Kl,accept(e){const t=nl(e,(e=>({max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number})));return t?{params:t}:null},controller(e){var t,n;const i=null!==(t=e.params.value)&&void 0!==t?t:0,s=new ca({max:e.params.max,min:e.params.min}),r=aa(i,{constraint:s}),o=new pu(e.document,Object.assign(Object.assign({},du({formatter:null!==(n=e.params.format)&&void 0!==n?n:Ma,keyScale:aa(1),max:s.values.value("max"),min:s.values.value("min"),pointerScale:Na(e.params,i)})),{parser:Sa,value:r,viewProps:e.viewProps}));return new kl(e.document,{blade:e.blade,props:la.fromObject({label:e.params.label}),value:r,valueController:o})},api:e=>e.controller instanceof kl&&e.controller.valueController instanceof pu?new cd(e.controller):null},wd={id:"text",type:"blade",core:Kl,accept(e){const t=nl(e,(e=>({parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string})));return t?{params:t}:null},controller(e){var t;const n=aa(e.params.value),i=new Uc(e.document,{parser:e.params.parse,props:la.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:e=>String(e)}),value:n,viewProps:e.viewProps});return new kl(e.document,{blade:e.blade,props:la.fromObject({label:e.params.label}),value:n,valueController:i})},api:e=>e.controller instanceof kl&&e.controller.valueController instanceof Uc?new ud(e.controller):null};class _d extends pd{constructor(e){var t,n;const i=null!=e?e:{},s=null!==(t=i.document)&&void 0!==t?t:ul(),r=function(){const e=new rd(od);return[Vp,Dp,zp,Np,dp,ap,op,ip,Pu,Gp,td,ed,Gl,uc,Ec].forEach((t=>{e.register("core",t)})),e}();super(new dd(s,{expanded:i.expanded,blade:nc(),props:la.fromObject({title:i.title}),viewProps:dc.create()}),r),this.pool_=r,this.containerElem_=null!==(n=i.container)&&void 0!==n?n:function(e){const t=e.createElement("div");return t.classList.add(_l("dfw")()),e.body&&e.body.appendChild(t),t}(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw ta.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw ta.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){e.css&&function(e,t,n){if(e.querySelector(`style[data-tp-style=${t}]`))return;const i=e.createElement("style");i.dataset.tpStyle=t,i.textContent=n,e.head.appendChild(i)}(this.document,`plugin-${e.id}`,e.css);("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((t=>{this.pool_.register(e.id,t)}))}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:"";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:"";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[hd,gd,bd,Ec,wd]})}}function yd(e){let t,n;return t=new No({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function xd(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Cd(e){let t,n,i,s;const r=[Ed,$d],o=[];function a(e,t){return void 0===e[1]?0:1}t=a(e),n=o[t]=r[t](e);const l=e[10].default,c=u(l,e,e[9],null);return{c(){n.c(),i=C(),c&&c.c()},m(e,n){o[t].m(e,n),w(e,i,n),c&&c.m(e,n),s=!0},p(e,u){let h=t;t=a(e),t===h?o[t].p(e,u):(ee(),ie(o[h],1,1,(()=>{o[h]=null})),te(),n=o[t],n?n.p(e,u):(n=o[t]=r[t](e),n.c()),ne(n,1),n.m(i.parentNode,i)),c&&c.p&&(!s||512&u)&&d(c,l,e,e[9],s?p(l,e[9],u,null):m(e[9]),null)},i(e){s||(ne(n),ne(c,e),s=!0)},o(e){ie(n),ie(c,e),s=!1},d(e){e&&_(i),o[t].d(e),c&&c.d(e)}}}function Pd(e){let t;const n=e[10].default,i=u(n,e,e[9],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||512&s)&&d(i,n,e,e[9],t?p(n,e[9],s,null):m(e[9]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function $d(e){let t,n;return t=new No({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding","containerVerticalPadding","containerUnitSize"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Ed(e){let t,n;return t=new No({props:{keysAdd:["containerVerticalPadding"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function kd(e){let t,n,i,s;const r=[Pd,Cd,xd,yd],o=[];return t=0,n=o[t]=r[t](e),{c(){n.c(),i=P()},m(e,n){o[t].m(e,n),w(e,i,n),s=!0},p(e,[s]){let a=t;t=0,t===a?o[t].p(e,s):(ee(),ie(o[a],1,1,(()=>{o[a]=null})),te(),n=o[t],n?n.p(e,s):(n=o[t]=r[t](e),n.c()),ne(n,1),n.m(i.parentNode,i))},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[t].d(e)}}}function Vd(e,t,n){let i,s,{$$slots:r={},$$scope:o}=t,{title:a}=t,{userExpandable:l=!0}=t,{expanded:u=!0}=t,{theme:h}=t,{scale:p=1}=t,{userCreatedPane:d=!0}=t,{tpPane:m}=t;const v=me();c(e,v,(e=>n(11,i=e)));const f=B("parentStore");c(e,f,(e=>n(12,s=e)));let b=[];function w(e){(K(),q).then((()=>{void 0!==m?.expanded&&void 0!==e&&m.expanded!==e&&n(5,m.expanded=e,m)}))}return O("registerPlugin",(e=>{void 0===m?console.warn(`tpPane is undefined, failed to register plugin "${e.id}"`):b.includes(e.id)||(m?.registerPlugin(e),b.push(e.id))})),O("userCreatedPane",d),void 0!==s&&console.warn("<Panes> must not be nested"),g(v,i=new _d({expanded:u,title:a}),i),i.on("fold",(()=>{void 0!==i.expanded&&u!==i.expanded&&n(0,u=i.expanded)})),m=i,O("parentStore",v),j((()=>{i.dispose()})),e.$$set=e=>{"title"in e&&n(1,a=e.title),"userExpandable"in e&&n(6,l=e.userExpandable),"expanded"in e&&n(0,u=e.expanded),"theme"in e&&n(2,h=e.theme),"scale"in e&&n(7,p=e.scale),"userCreatedPane"in e&&n(8,d=e.userCreatedPane),"tpPane"in e&&n(5,m=e.tpPane),"$$scope"in e&&n(9,o=e.$$scope)},e.$$.update=()=>{34&e.$$.dirty&&m&&void 0!==a&&n(5,m.title=a.length>0?a:" ",m),32&e.$$.dirty&&m?.element&&m?.element.classList.add("svelte-tweakpane-ui"),160&e.$$.dirty&&m&&function(e){if(m)if(1===e)m.element.style.removeProperty("transform-origin"),m.element.style.removeProperty("transform"),m.element.style.removeProperty("width");else{const t=Math.max(0,e);n(5,m.element.style.transformOrigin="0 0",m),n(5,m.element.style.transform=`scale(${t})`,m),n(5,m.element.style.width=100/t+"%",m)}}(p),96&e.$$.dirty&&m&&Ko(l,m.element,"tp-rotv_b","tp-rotv_m"),36&e.$$.dirty&&m&&function(e,t){const n=rn().documentElement;if(void 0===t)for(const t of Object.keys(Lo)){const n=Do(t);e.style.getPropertyValue(n).length>0&&e.style.removeProperty(n)}else for(const[i,s]of Object.entries(t)){const t=Do(i),r=Ao(s),o=Lo[i]||void 0,a=n.style.getPropertyValue(t)||void 0;void 0!==r&&(a&&r!==a||!a&&o&&r!==o)?e.style.setProperty(t,r):e.style.getPropertyValue(t).length>0&&e.style.removeProperty(t)}}(m.element,h),33&e.$$.dirty&&m&&w(u)},[u,a,h,v,f,m,l,p,d,o,r]}new Ul("4.0.5");class Sd extends pe{constructor(e){super(),he(this,e,Vd,kd,o,{title:1,userExpandable:6,expanded:0,theme:2,scale:7,userCreatedPane:8,tpPane:5})}}function Ld(e){let t;const n=e[6].default,i=u(n,e,e[10],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||1024&s)&&d(i,n,e,e[10],t?p(n,e[10],s,null):m(e[10]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function Md(e){let n,i,s,r,o;const a=[{theme:e[3]},qo(e[5],"position")];function l(t){e[7](t)}function c(t){e[8](t)}let u={$$slots:{default:[Ld]},$$scope:{ctx:e}};for(let e=0;e<a.length;e+=1)u=t(u,a[e]);return void 0!==e[0]&&(u.expanded=e[0]),void 0!==e[1]&&(u.tpPane=e[1]),i=new Sd({props:u}),F.push((()=>ae(i,"expanded",l))),F.push((()=>ae(i,"tpPane",c))),{c(){n=y("div"),le(i.$$.fragment),E(n,"width",void 0===e[2]?null:`${e[2]}px`)},m(t,s){w(t,n,s),ce(i,n,null),e[9](n),o=!0},p(e,[t]){const o=40&t?re(a,[8&t&&{theme:e[3]},32&t&&oe(qo(e[5],"position"))]):{};1024&t&&(o.$$scope={dirty:t,ctx:e}),!s&&1&t&&(s=!0,o.expanded=e[0],G((()=>s=!1))),!r&&2&t&&(r=!0,o.tpPane=e[1],G((()=>r=!1))),i.$set(o),4&t&&E(n,"width",void 0===e[2]?null:`${e[2]}px`)},i(e){o||(ne(i.$$.fragment,e),o=!0)},o(e){ie(i.$$.fragment,e),o=!1},d(t){t&&_(n),ue(i),e[9](null)}}}function Ad(e,n,i){const s=["expanded","width","tpPane","theme"];let r,o=f(n,s),{$$slots:a={},$$scope:l}=n,{expanded:c}=n,{width:u}=n,{tpPane:h}=n,{theme:p={baseBorderRadius:"0px",baseShadowColor:"hsla(0, 0%, 0%, 0)"}}=n;return D((()=>{if(h){const e=h.element.parentElement;r.append(h.element),e?.remove()}else console.warn("tpPane is undefined")})),e.$$set=e=>{n=t(t({},n),v(e)),i(5,o=f(n,s)),"expanded"in e&&i(0,c=e.expanded),"width"in e&&i(2,u=e.width),"tpPane"in e&&i(1,h=e.tpPane),"theme"in e&&i(3,p=e.theme),"$$scope"in e&&i(10,l=e.$$scope)},[c,h,u,p,r,o,a,function(e){c=e,i(0,c)},function(e){h=e,i(1,h)},function(e){F[e?"unshift":"push"]((()=>{r=e,i(4,r)}))},l]}class Dd extends pe{constructor(e){super(),he(this,e,Ad,Md,o,{expanded:0,width:2,tpPane:1,theme:3})}}function jd(e){let t,n;return t=new Dd({props:{theme:e[3],userCreatedPane:!1,$$slots:{default:[Od]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};8&n&&(i.theme=e[3]),16391&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Td(e){let t,n,i,s;const r=[zd,Bd],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function Od(e){let t,n;return t=new Id({props:{disabled:e[2],label:e[1],title:e[0]}}),t.$on("click",e[10]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.disabled=e[2]),2&n&&(i.label=e[1]),1&n&&(i.title=e[0]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Bd(e){let t,n;return t=new No({props:{keysAdd:["containerUnitSize","containerVerticalPadding"],theme:e[3]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};8&n&&(i.theme=e[3]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function zd(t){let n;return{c(){n=y("div"),E(n,"display","none")},m(e,i){w(e,n,i),t[9](n)},p:e,i:e,o:e,d(e){e&&_(n),t[9](null)}}}function Nd(e){let t,n,i,s;const r=[Td,jd],o=[];return t=function(e){return e[5]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=P()},m(e,n){o[t].m(e,n),w(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[t].d(e)}}}function Fd(e,t,n){let i,{title:s="Button"}=t,{label:r}=t,{disabled:o=!1}=t,{theme:a}=t;const l=B("parentStore");c(e,l,(e=>n(8,i=e)));const u=B("userCreatedPane"),h=T();let p,d,m;return D((()=>{n(7,m=p?Ro(p):0)})),j((()=>{d?.dispose()})),e.$$set=e=>{"title"in e&&n(0,s=e.title),"label"in e&&n(1,r=e.label),"disabled"in e&&n(2,o=e.disabled),"theme"in e&&n(3,a=e.theme)},e.$$.update=()=>{65&e.$$.dirty&&d&&n(6,d.title=s,d),66&e.$$.dirty&&d&&n(6,d.label=r,d),68&e.$$.dirty&&d&&n(6,d.disabled=o,d),448&e.$$.dirty&&void 0!==m&&i&&!d&&(d&&d.dispose(),n(6,d=i.addButton({disabled:o,index:m,label:r,title:s})),d.on("click",(()=>{h("click")}))),264&e.$$.dirty&&a&&i&&(u||!Fo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Button> components for a theme prop.)")},[s,r,o,a,p,l,d,m,i,function(e){F[e?"unshift":"push"]((()=>{p=e,n(4,p)}))},function(t){z.call(this,e,t)}]}class Id extends pe{constructor(e){super(),he(this,e,Fd,Nd,o,{title:0,label:1,disabled:2,theme:3})}}function Rd(e){let t,n;return t=new Dd({props:{theme:e[4],userCreatedPane:!1,$$slots:{default:[Ud]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),262159&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function qd(e){let t,n,i,s;const r=[Hd,Kd],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function Ud(e){let t,n,i,s,r,o;function a(t){e[11](t)}function l(t){e[12](t)}function c(t){e[13](t)}function u(t){e[14](t)}let h={};return void 0!==e[1]&&(h.disabled=e[1]),void 0!==e[0]&&(h.options=e[0]),void 0!==e[3]&&(h.plugin=e[3]),void 0!==e[2]&&(h.ref=e[2]),t=new Xd({props:h}),F.push((()=>ae(t,"disabled",a))),F.push((()=>ae(t,"options",l))),F.push((()=>ae(t,"plugin",c))),F.push((()=>ae(t,"ref",u))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),o=!0},p(e,o){const a={};!n&&2&o&&(n=!0,a.disabled=e[1],G((()=>n=!1))),!i&&1&o&&(i=!0,a.options=e[0],G((()=>i=!1))),!s&&8&o&&(s=!0,a.plugin=e[3],G((()=>s=!1))),!r&&4&o&&(r=!0,a.ref=e[2],G((()=>r=!1))),t.$set(a)},i(e){o||(ne(t.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),o=!1},d(e){ue(t,e)}}}function Kd(e){let t,n;return t=new No({props:{keysAdd:["containerVerticalPadding"],theme:e[4]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Hd(t){let n;return{c(){n=y("div"),E(n,"display","none")},m(e,i){w(e,n,i),t[10](n)},p:e,i:e,o:e,d(e){e&&_(n),t[10](null)}}}function Gd(e){let t,n,i,s;const r=[qd,Rd],o=[];return t=function(e){return e[6]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=P()},m(e,n){o[t].m(e,n),w(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[t].d(e)}}}function Yd(e,t,n){let i,{options:s}=t,{disabled:r=!1}=t,{theme:o}=t,{ref:a}=t,{plugin:l}=t;const u=B("registerPlugin"),h=B("parentStore");c(e,h,(e=>n(9,i=e)));const p=B("userCreatedPane");let d,m,v;return D((()=>{n(7,m=d?Ro(d):0)})),j((()=>{v?.dispose()})),e.$$set=e=>{"options"in e&&n(0,s=e.options),"disabled"in e&&n(1,r=e.disabled),"theme"in e&&n(4,o=e.theme),"ref"in e&&n(2,a=e.ref),"plugin"in e&&n(3,l=e.plugin)},e.$$.update=()=>{258&e.$$.dirty&&v&&n(8,v.disabled=r,v),e.$$.dirty,641&e.$$.dirty&&s&&i&&void 0!==m&&(v&&v.dispose(),void 0!==l&&u(l),n(8,v=i.addBlade({index:m,...s,disabled:r})),n(2,a=v)),528&e.$$.dirty&&o&&i&&(p||!Fo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Blade> components for a theme prop.)")},[s,r,a,l,o,d,h,m,v,i,function(e){F[e?"unshift":"push"]((()=>{d=e,n(5,d)}))},function(e){r=e,n(1,r)},function(e){s=e,n(0,s)},function(e){l=e,n(3,l)},function(e){a=e,n(2,a)}]}class Xd extends pe{constructor(e){super(),he(this,e,Yd,Gd,o,{options:0,disabled:1,theme:4,ref:2,plugin:3})}}class Wd{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return null!==(e=this.controller_.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.emitter.on(e,(()=>{n(new It(this))})),this}}class Zd extends It{constructor(e,t,n){super(e),this.cell=t,this.index=n}}class Qd extends Ft{constructor(e){super(e),this.cellToApiMap_=new Map,this.emitter_=new Je;const t=this.controller.valueController;t.cellControllers.forEach(((e,n)=>{const i=new Wd(e);this.cellToApiMap_.set(e,i),e.emitter.on("click",(()=>{const e=n%t.size[0],s=Math.floor(n/t.size[0]);this.emitter_.emit("click",{event:new Zd(this,i,[e,s])})}))}))}cell(e,t){const n=this.controller.valueController,i=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(i)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}class Jd{constructor(e,t){this.size=t.size;const[n,i]=this.size,s=[];for(let r=0;r<i;r++)for(let i=0;i<n;i++){const n=new Mn(e,{props:st.fromObject(Object.assign({},t.cellConfig(i,r))),viewProps:Jn.create()});s.push(n)}this.cellCs_=s,this.viewProps=Jn.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((e=>{e.viewProps.set("disposed",!0)}))})),this.view=new es(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((e=>{this.view.element.appendChild(e.view.element)}))}get cellControllers(){return this.cellCs_}}class em extends yn{constructor(e,t){const n=t.valueController,i=new bn(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}jn({id:"buttongrid",type:"blade",accept(e){const t=Wt(e,(e=>({cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new em(e.document,{blade:e.blade,labelProps:st.fromObject({label:e.params.label}),valueController:new Jd(e.document,{cellConfig:e.params.cells,size:e.params.size})}),api:e=>e.controller instanceof em?new Qd(e.controller):null});class tm extends Ft{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get value(){return this.controller.valueController.value.rawValue}set value(e){this.controller.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.controller.valueController.value.emitter.on(e,(e=>{n(new Rt(this,e.rawValue,e.options.last))})),this}}function nm(e,t,n){return e*(1-n)+t*n}function im(e,t){let n=.25,i=.5,s=-1;for(let r=0;r<20;r++){const[r,o]=e.curve(i);if(i+=n*(r<t?1:-1),s=o,n*=.5,Math.abs(t-r)<.001)break}return s}class sm{constructor(e=0,t=0,n=1,i=1){this.cache_=[],this.comps_=[e,t,n,i]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(e){return!Ke(e)&&(!!Array.isArray(e)&&("number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]&&"number"==typeof e[3]))}static equals(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}curve(e){const t=nm(0,this.x1,e),n=nm(0,this.y1,e),i=nm(this.x1,this.x2,e),s=nm(this.y1,this.y2,e),r=nm(this.x2,1,e),o=nm(this.y2,1,e),a=nm(t,i,e),l=nm(n,s,e),c=nm(i,r,e),u=nm(s,o,e);return[nm(a,c,e),nm(l,u,e)]}y(e){if(0===this.cache_.length){const e=[];for(let t=0;t<100;t++)e.push(im(this,Vt(t,0,99,0,1)));this.cache_=e}return this.cache_[Math.round(Vt(Lt(e,0,1),0,1,0,99))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const rm={toComponents:e=>e.toObject(),fromComponents:e=>new sm(...e)};function om(e){const t=kt(2);return`cubic-bezier(${e.toObject().map((e=>t(e))).join(", ")})`}const am=[0,.5,.5,1];function lm(e){const t=e.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!t)return new sm(...am);const n=[t[1],t[2],t[3],t[4]].reduce(((e,t)=>{if(!e)return null;const n=Number(t);return isNaN(n)?null:[...e,n]}),[]);return new sm(...null!=n?n:am)}const cm=vn("cbz");class um{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cm()),t.viewProps.bindClassModifiers(this.element),t.foldable.bindExpandedClass(this.element,cm(void 0,"expanded")),dn(t.foldable,"completed",kn(this.element,cm(void 0,"cpl")));const n=e.createElement("div");n.classList.add(cm("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(cm("b")),t.viewProps.bindDisabled(i);const s=e.createElementNS(tn,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',i.appendChild(s),n.appendChild(i),this.buttonElement=i;const r=e.createElement("div");if(r.classList.add(cm("t")),n.appendChild(r),this.textElement=r,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(cm("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const hm=vn("cbzp");class pm{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(hm()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(hm("g")),this.element.appendChild(n),this.graphElement=n;const i=e.createElement("div");i.classList.add(hm("t")),this.element.appendChild(i),this.textElement=i}}function dm(e,t){const n=new MutationObserver((e=>{for(const i of e)"childList"===i.type&&i.addedNodes.forEach((e=>{e.contains(e)&&(t(),n.disconnect())}))})),i=e.ownerDocument;n.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}const mm=vn("cbzg");class vm{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(mm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(mm("p")),this.element.appendChild(n),this.previewElement=n;const i=e.createElementNS(tn,"svg");i.classList.add(mm("g")),this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(tn,"path");s.classList.add(mm("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const r=e.createElementNS(tn,"polyline");r.classList.add(mm("l")),this.svgElem_.appendChild(r),this.lineElem_=r,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach((e=>{e.classList.add(mm("h")),this.element.appendChild(e)})),this.vectorElems_=[e.createElementNS(tn,"line"),e.createElementNS(tn,"line")],this.vectorElems_.forEach((e=>{e.classList.add(mm("v")),this.svgElem_.appendChild(e)})),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=t.selection,this.handleElems_.forEach(((e,t)=>{var n,i;pn(this.sel_,(n=e=>e===t,i=kn(e,mm("h","sel")),e=>i(n(e))))})),dm(this.element,(()=>{this.refresh()}))}getVertMargin_(e){return.25*e}valueToPosition(e,t){const{clientWidth:n,clientHeight:i}=this.element,s=this.getVertMargin_(i);return{x:Vt(e,0,1,0,n),y:Vt(t,0,1,i-s,s)}}positionToValue(e,t){const n=this.element.getBoundingClientRect(),i=n.width,s=n.height,r=this.getVertMargin_(s);return{x:Lt(Vt(e,0,i,0,1),0,1),y:Vt(t,s-r,r,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((e=>{const t=this.valueToPosition(0,e),n=this.valueToPosition(1,e);return[`M ${t.x},${t.y}`,`L ${n.x},${n.y}`].join(" ")})).join(" "));const e=this.value_.rawValue,t=[];let n=0;for(;;){const i=this.valueToPosition(...e.curve(n));if(t.push([i.x,i.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",t.join(" "));const i=e.toObject();[0,1].forEach((e=>{const t=this.valueToPosition(e,e),n=this.valueToPosition(i[2*e],i[2*e+1]),s=this.vectorElems_[e];s.setAttributeNS(null,"x1",String(t.x)),s.setAttributeNS(null,"y1",String(t.y)),s.setAttributeNS(null,"x2",String(n.x)),s.setAttributeNS(null,"y2",String(n.y));const r=this.handleElems_[e];r.style.left=`${n.x}px`,r.style.top=`${n.y}px`}))}onValueChange_(){this.refresh()}}const fm=vn("cbzprv");class gm{constructor(e,t){this.stopped_=!0,this.startTime_=-1,this.requestId_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(fm()),t.viewProps.bindClassModifiers(this.element);const n=e.createElementNS(tn,"svg");n.classList.add(fm("g")),this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(tn,"path");i.classList.add(fm("t")),this.svgElem_.appendChild(i),this.ticksElem_=i;const s=e.createElement("div");s.classList.add(fm("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.viewProps.handleDispose(this.onDispose_),dm(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(fm("m","a")),this.startTime_=(new Date).getTime()+400,this.stopped_=!1,this.requestId_=requestAnimationFrame(this.onTimer_)}stop(){cancelAnimationFrame(this.requestId_),this.stopped_=!0,this.markerElem_.classList.remove(fm("m","a"))}onDispose_(){this.stop()}updateMarker_(e){const t=this.value_.rawValue.y(Lt(e,0,1));this.markerElem_.style.left=100*t+"%"}refresh(){const{clientWidth:e,clientHeight:t}=this.svgElem_,n=[],i=this.value_.rawValue;for(let s=0;s<24;s++){const r=Vt(s,0,23,0,1),o=Vt(i.y(r),0,1,0,e);n.push(`M ${o},0 v${t}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const e=(new Date).getTime()-this.startTime_,t=e/1e3;this.updateMarker_(t),e>1400&&this.stop(),this.stopped_||(this.requestId_=requestAnimationFrame(this.onTimer_))}onValueChange_(){this.refresh(),this.play()}}function bm(e,t,n,i){const s=n-e,r=i-t;return Math.sqrt(s*s+r*r)}class wm{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.keyScale_=t.keyScale,this.value=t.value,this.sel_=it(0),this.viewProps=t.viewProps,this.view=new vm(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new gm(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(e=>{e.stopImmediatePropagation(),e.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const n=new Ri(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(e,t,n){const i=this.sel_.rawValue,s=this.value.rawValue.toObject(),r=this.view.positionToValue(e.x,e.y),o=t?function(e,t,n,i){const s=bm(e,t,n,i),r=Math.atan2(i-t,n-e),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:e+Math.cos(o)*s,y:t+Math.sin(o)*s}}(i,i,r.x,r.y):r;s[2*i]=o.x,s[2*i+1]=o.y,this.value.setRawValue(new sm(...s),n)}onPointerDown_(e){const t=e.data;if(!t.point)return;const n=this.value.rawValue,i=this.view.valueToPosition(n.x1,n.y1),s=bm(t.point.x,t.point.y,i.x,i.y),r=this.view.valueToPosition(n.x2,n.y2),o=bm(t.point.x,t.point.y,r.x,r.y);this.sel_.rawValue=s<=o?0:1,this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(e){Fi(e.key)&&e.preventDefault();const t=this.sel_.rawValue,n=this.value.rawValue.toObject(),i=this.keyScale_.rawValue;n[2*t]+=Bi(i,Ni(e)),n[2*t+1]+=Bi(i,zi(e)),this.value.setRawValue(new sm(...n),{forceEmit:!1,last:!1})}onKeyUp_(e){Fi(e.key)&&e.preventDefault();const t=this.keyScale_.rawValue,n=Bi(t,Ni(e)),i=Bi(t,zi(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class _m{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new pm(e,{viewProps:this.viewProps}),this.gc_=new wm(e,{keyScale:t.axis.textProps.value("keyScale"),value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},t.axis),{constraint:new ot({max:1,min:0})}),i=Object.assign(Object.assign({},t.axis),{constraint:void 0});this.tc_=new Hr(e,{assembly:rm,axes:[n,i,n,i],parser:$t,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((e=>e.inputElement))]}refresh(){this.gc_.refresh()}}class ym{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Un.create(t.expanded),this.view=new um(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Si(e,{parser:lm,props:st.fromObject({formatter:om}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===t.pickerLayout?new Ei(e,{viewProps:this.viewProps}):null;const n=new _m(e,{axis:t.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),pn(this.popC_.shows,(e=>{e&&n.refresh()})),Oi({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Hn(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=e.relatedTarget;t&&this.popC_.view.element.contains(t)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=hn(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!sn(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_&&"Escape"===e.key&&(this.popC_.shows.rawValue=!1)}}jn({id:"cubicbezier",type:"blade",accept(e){const t=Wt(e,(e=>({value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((e=>"inline"===e||"popup"===e?e:void 0))})));return t?{params:t}:null},controller(e){var t,n;const i=it(new sm(...e.params.value),{constraint:new qr({assembly:rm,components:[0,1,2,3].map((e=>e%2==0?new ot({min:0,max:1}):void 0))}),equals:sm.equals}),s=new ym(e.document,{axis:{textProps:st.fromObject({keyScale:.1,pointerScale:.01,formatter:kt(2)})},expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:i,viewProps:e.viewProps});return new xn(e.document,{blade:e.blade,props:st.fromObject({label:e.params.label}),value:i,valueController:s})},api:e=>e.controller instanceof xn&&e.controller.valueController instanceof ym?new tm(e.controller):null});class xm extends Ft{get fps(){return this.controller.valueController.fps}get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}begin(){this.controller.valueController.begin()}end(){this.controller.valueController.end()}on(e,t){const n=t.bind(this);return this.controller.valueController.ticker.emitter.on(e,(()=>{n(new It(this))})),this}}class Cm{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(e){this.start_=e.getTime()}calculateFps_(e){if(0===this.timestamps_.length)return null;const t=this.timestamps_[0];return 1e3*(this.frameCount_-t.frameCount)/(e-t.time)}compactTimestamps_(){if(this.timestamps_.length<=20)return;const e=this.timestamps_.length-20;this.timestamps_.splice(0,e);const t=this.timestamps_[0].frameCount;this.timestamps_.forEach((e=>{e.frameCount-=t})),this.frameCount_-=t}end(e){if(null===this.start_)return;const t=e.getTime();this.duration_=t-this.start_,this.start_=null,this.fps_=this.calculateFps_(t),this.timestamps_.push({frameCount:this.frameCount_,time:t}),++this.frameCount_,this.compactTimestamps_()}}const Pm=vn("fps");class $m{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pm()),t.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(Pm("g")),this.element.appendChild(this.graphElement);const n=e.createElement("div");n.classList.add(Pm("l")),this.element.appendChild(n);const i=e.createElement("span");i.classList.add(Pm("v")),i.textContent="--",n.appendChild(i),this.valueElement=i;const s=e.createElement("span");s.classList.add(Pm("u")),s.textContent="FPS",n.appendChild(s)}}class Em{constructor(e,t){this.stopwatch_=new Cm,this.onTick_=this.onTick_.bind(this),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.props=t.props,this.value_=t.value,this.viewProps=t.viewProps,this.view=new $m(e,{viewProps:this.viewProps}),this.graphC_=new ko(e,{formatter:kt(0),props:this.props,rows:t.rows,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker.dispose()}))}get fps(){return this.stopwatch_.fps}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const e=this.fps;if(null!==e){const t=this.value_.rawValue;this.value_.rawValue=function(e,t){const n=[...$n(e),t];return n.length>e.length?n.splice(0,n.length-e.length):Cn(n,e.length),n}(t,e),this.view.valueElement.textContent=e.toFixed(0)}}}class km extends yn{constructor(e,t){const n=t.valueController,i=new bn(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}function Vm(e,t){return 0===t?new di:new mi(e,null!=t?t:go.defaultInterval)}jn({id:"fpsgraph",type:"blade",accept(e){const t=Wt(e,(e=>({view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,rows:e.optional.number,max:e.optional.number,min:e.optional.number})));return t?{params:t}:null},controller(e){var t,n,i,s;const r=null!==(t=e.params.interval)&&void 0!==t?t:500;return new km(e.document,{blade:e.blade,labelProps:st.fromObject({label:e.params.label}),valueController:new Em(e.document,{props:st.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:90,min:null!==(i=e.params.min)&&void 0!==i?i:0}),rows:null!==(s=e.params.rows)&&void 0!==s?s:2,ticker:Vm(e.document,r),value:it(Pn(80)),viewProps:e.viewProps})})},api:e=>e.controller instanceof km?new xm(e.controller):null});class Sm{constructor(e,t){this.min=e,this.max=t}static isObject(e){if("object"!=typeof e||null===e)return!1;const t=e.min,n=e.max;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.min===t.min&&e.max===t.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Lm={fromComponents:e=>new Sm(e[0],e[1]),toComponents:e=>[e.min,e.max]};class Mm{constructor(e){this.edge=e}constrain(e){var t,n,i,s,r,o,a,l;if(e.min<=e.max)return new Sm(null!==(n=null===(t=this.edge)||void 0===t?void 0:t.constrain(e.min))&&void 0!==n?n:e.min,null!==(s=null===(i=this.edge)||void 0===i?void 0:i.constrain(e.max))&&void 0!==s?s:e.max);const c=(e.min+e.max)/2;return new Sm(null!==(o=null===(r=this.edge)||void 0===r?void 0:r.constrain(c))&&void 0!==o?o:c,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(c))&&void 0!==l?l:c)}}const Am=vn("rsltxt");class Dm{constructor(e,t){this.sliderView_=t.sliderView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(Am());const n=e.createElement("div");n.classList.add(Am("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Am("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const jm=vn("rsl");class Tm{constructor(e,t){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=t.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=e.createElement("div"),this.element.classList.add(jm()),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_);const n=e.createElement("div");n.classList.add(jm("t")),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(jm("b")),n.appendChild(i),this.barElement=i;const s=["min","max"].map((t=>{const i=e.createElement("div");return i.classList.add(jm("k"),jm("k",t)),n.appendChild(i),i}));this.knobElements=[s[0],s[1]],this.update_()}valueToX_(e){return 100*Lt(Vt(e,this.sliderProps_.get("min"),this.sliderProps_.get("max"),0,1),0,1)}update_(){const e=this.value_.rawValue;0===e.length?this.element.classList.add(jm(void 0,"zero")):this.element.classList.remove(jm(void 0,"zero"));const t=[this.valueToX_(e.min),this.valueToX_(e.max)];this.barElement.style.left=`${t[0]}%`,this.barElement.style.right=100-t[1]+"%",this.knobElements.forEach(((e,n)=>{e.style.left=`${t[n]}%`}))}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Om{constructor(e,t){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=t.sliderProps,this.viewProps=t.viewProps,this.value=t.value,this.view=new Tm(e,{sliderProps:this.sliderProps,value:this.value,viewProps:t.viewProps});const n=new Ri(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(e){if(!e.point)return null;return Vt((e.point.x+this.ofs_())/e.bounds.width,0,1,this.sliderProps.get("min"),this.sliderProps.get("max"))}onPointerDown_(e){if(!e.data.point)return;const t=e.data.point.x/e.data.bounds.width,n=this.value.rawValue,i=this.sliderProps.get("min"),s=this.sliderProps.get("max"),r=Vt(n.min,i,s,0,1),o=Vt(n.max,i,s,0,1);Math.abs(o-t)<=.025?this.grabbing_="max":Math.abs(r-t)<=.025?this.grabbing_="min":t>=r&&t<=o?(this.grabbing_="length",this.grabOffset_=Vt(t-r,0,1,0,s-i)):t<r?(this.grabbing_="min",this.onPointerMove_(e)):t>o&&(this.grabbing_="max",this.onPointerMove_(e))}applyPointToValue_(e,t){const n=this.valueFromData_(e);if(null===n)return;const i=this.sliderProps.get("min"),s=this.sliderProps.get("max");if("min"===this.grabbing_)this.value.setRawValue(new Sm(n,this.value.rawValue.max),t);else if("max"===this.grabbing_)this.value.setRawValue(new Sm(this.value.rawValue.min,n),t);else if("length"===this.grabbing_){const e=this.value.rawValue.length;let r=n-this.grabOffset_,o=r+e;r<i?(r=i,o=i+e):o>s&&(r=s-e,o=s),this.value.setRawValue(new Sm(r,o),t)}}onPointerMove_(e){this.applyPointToValue_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.applyPointToValue_(e.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Bm{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new Om(e,t);const n={constraint:t.constraint,textProps:t.textProps};this.tc_=new Hr(e,{assembly:Lm,axes:[n,n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new Dm(e,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function zm(e){return Sm.isObject(e)?new Sm(e.min,e.max):new Sm(0,0)}function Nm(e,t){e.writeProperty("max",t.max),e.writeProperty("min",t.min)}jn({id:"input-interval",type:"input",accept:(e,t)=>{if(!Sm.isObject(e))return null;const n=Wt(t,(e=>Object.assign(Object.assign({},zt(e)),{readonly:e.optional.constant(!1)})));return n?{initialValue:new Sm(e.min,e.max),params:n}:null},binding:{reader:e=>zm,constraint:e=>function(e){const t=[],n=Ot(e);n&&t.push(n);const i=Tt(e);return i&&t.push(i),new Mm(new vi(t))}(e.params),equals:Sm.equals,writer:e=>Nm},controller(e){const t=e.value,n=e.constraint;if(!(n instanceof Mm))throw Ze.shouldNeverHappen();const i=(t.rawValue.min+t.rawValue.max)/2,s=st.fromObject(Bt(e.params,i)),r=n.edge&&fi(n.edge,rt);if(r)return new Bm(e.document,{constraint:n.edge,parser:$t,sliderProps:new st({keyScale:s.value("keyScale"),max:r.values.value("max"),min:r.values.value("min")}),textProps:s,value:t,viewProps:e.viewProps});const o={constraint:n.edge,textProps:s};return new Hr(e.document,{assembly:Lm,axes:[o,o],parser:$t,value:t,viewProps:e.viewProps})}});class Fm{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return null!==(e=this.controller_.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.props.set("title",e)}}class Im extends Rt{constructor(e,t,n,i,s){super(e,i,s),this.cell=t,this.index=n}}class Rm extends Ft{constructor(e){super(e),this.cellToApiMap_=new Map;this.controller.valueController.cellControllers.forEach((e=>{const t=new Fm(e);this.cellToApiMap_.set(e,t)}))}get value(){return this.controller.value}cell(e,t){const n=this.controller.valueController,i=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(i)}on(e,t){const n=t.bind(this);this.controller.value.emitter.on(e,(e=>{const t=this.controller.valueController,i=t.findCellByValue(e.rawValue);if(!i)return;const s=this.cellToApiMap_.get(i);if(!s)return;const r=t.cellControllers.indexOf(i);n(new Im(this,s,[r%t.size[0],Math.floor(r/t.size[0])],e.rawValue))}))}}const qm=vn("rad");class Um{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qm()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(qm("l")),this.element.appendChild(n);const i=e.createElement("input");i.classList.add(qm("i")),i.name=t.name,i.type="radio",t.viewProps.bindDisabled(i),n.appendChild(i),this.inputElement=i;const s=e.createElement("div");s.classList.add(qm("b")),n.appendChild(s);const r=e.createElement("div");r.classList.add(qm("t")),s.appendChild(r),dn(t.props,"title",(e=>{r.textContent=e}))}}class Km{constructor(e,t){this.props=t.props,this.viewProps=t.viewProps,this.view=new Um(e,{name:t.name,props:this.props,viewProps:this.viewProps})}}class Hm{constructor(e,t){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=t.size;const[n,i]=this.size;for(let s=0;s<i;s++)for(let i=0;i<n;i++){const n=new Km(e,{name:t.groupName,props:st.fromObject(Object.assign({},t.cellConfig(i,s))),viewProps:Jn.create()});this.cellCs_.push(n),this.cellValues_.push(t.cellConfig(i,s).value)}this.value=t.value,pn(this.value,(e=>{const t=this.findCellByValue(e);t&&(t.view.inputElement.checked=!0)})),this.viewProps=Jn.create(),this.view=new es(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((e=>{e.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(e.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(e){const t=this.cellValues_.findIndex((t=>t===e));return t<0?null:this.cellCs_[t]}onCellInputChange_(e){const t=e.currentTarget,n=this.cellCs_.findIndex((e=>e.view.inputElement===t));n<0||(this.value.rawValue=this.cellValues_[n])}}function Gm(e){return jn({id:"input-radiogrid",type:"input",accept(t,n){if(!e.isType(t))return null;const i=Wt(n,(e=>({cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),view:e.required.constant("radiogrid")})));return i?{initialValue:t,params:i}:null},binding:e.binding,controller:e=>new Hm(e.document,{cellConfig:e.params.cells,groupName:e.params.groupName,size:e.params.size,value:e.value})})}jn({id:"radiogrid",type:"blade",accept(e){const t=Wt(e,(e=>({cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string})));return t?{params:t}:null},controller(e){const t=it(e.params.value);return new xn(e.document,{blade:e.blade,props:st.fromObject({label:e.params.label}),value:t,valueController:new Hm(e.document,{groupName:e.params.groupName,cellConfig:e.params.cells,size:e.params.size,value:t})})},api:e=>e.controller instanceof xn&&e.controller.valueController instanceof Hm?new Rm(e.controller):null}),Gm({isType:e=>"number"==typeof e,binding:{reader:e=>Et,writer:e=>rs}}),Gm({isType:e=>"string"==typeof e,binding:{reader:e=>ji,writer:e=>rs}}),Gm({isType:e=>"boolean"==typeof e,binding:{reader:e=>Li,writer:e=>rs}});var Ym=Function.prototype.toString,Xm=Object.create,Wm=Object.prototype.toString,Zm=function(){function e(){this._keys=[],this._values=[]}return e.prototype.has=function(e){return!!~this._keys.indexOf(e)},e.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},e.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},e}();var Qm="undefined"!=typeof WeakMap?function(){return new WeakMap}:function(){return new Zm};function Jm(e){if(!e)return Xm(null);var t=e.constructor;if(t===Object)return e===Object.prototype?{}:Xm(e);if(t&&~Ym.call(t).indexOf("[native code]"))try{return new t}catch(e){}return Xm(e)}var ev="g"===/test/g.flags?function(e){return e.flags}:function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function tv(e){var t=Wm.call(e);return t.substring(8,t.length-1)}var nv="undefined"!=typeof Symbol?function(e){return e[Symbol.toStringTag]||tv(e)}:tv,iv=Object.defineProperty,sv=Object.getOwnPropertyDescriptor,rv=Object.getOwnPropertyNames,ov=Object.getOwnPropertySymbols,av=Object.prototype,lv=av.hasOwnProperty,cv=av.propertyIsEnumerable,uv="function"==typeof ov;var hv=uv?function(e){return rv(e).concat(ov(e))}:rv;function pv(e,t,n){for(var i=hv(e),s=0,r=i.length,o=void 0,a=void 0;s<r;++s)if("callee"!==(o=i[s])&&"caller"!==o)if(a=sv(e,o)){a.get||a.set||(a.value=n.copier(a.value,n));try{iv(t,o,a)}catch(e){t[o]=a.value}}else t[o]=n.copier(e[o],n);return t}function dv(e,t){return e.slice(0)}function mv(e,t){var n=new t.Constructor;return t.cache.set(e,n),e.forEach((function(e,i){n.set(i,t.copier(e,t))})),n}var vv=uv?function(e,t){var n=Jm(t.prototype);for(var i in t.cache.set(e,n),e)lv.call(e,i)&&(n[i]=t.copier(e[i],t));for(var s=ov(e),r=0,o=s.length,a=void 0;r<o;++r)a=s[r],cv.call(e,a)&&(n[a]=t.copier(e[a],t));return n}:function(e,t){var n=Jm(t.prototype);for(var i in t.cache.set(e,n),e)lv.call(e,i)&&(n[i]=t.copier(e[i],t));return n};function fv(e,t){return new t.Constructor(e.valueOf())}function gv(e,t){return e}function bv(e,t){var n=new t.Constructor;return t.cache.set(e,n),e.forEach((function(e){n.add(t.copier(e,t))})),n}var wv=Array.isArray,_v=Object.assign,yv=Object.getPrototypeOf||function(e){return e.__proto__},xv={array:function(e,t){var n=new t.Constructor;t.cache.set(e,n);for(var i=0,s=e.length;i<s;++i)n[i]=t.copier(e[i],t);return n},arrayBuffer:dv,blob:function(e,t){return e.slice(0,e.size,e.type)},dataView:function(e,t){return new t.Constructor(dv(e.buffer))},date:function(e,t){return new t.Constructor(e.getTime())},error:gv,map:mv,object:vv,regExp:function(e,t){var n=new t.Constructor(e.source,ev(e));return n.lastIndex=e.lastIndex,n},set:bv},Cv=_v({},xv,{array:function(e,t){var n=new t.Constructor;return t.cache.set(e,n),pv(e,n,t)},map:function(e,t){return pv(e,mv(e,t),t)},object:function(e,t){var n=Jm(t.prototype);return t.cache.set(e,n),pv(e,n,t)},set:function(e,t){return pv(e,bv(e,t),t)}});function Pv(e){var t=function(e){return{Arguments:e.object,Array:e.array,ArrayBuffer:e.arrayBuffer,Blob:e.blob,Boolean:fv,DataView:e.dataView,Date:e.date,Error:e.error,Float32Array:e.arrayBuffer,Float64Array:e.arrayBuffer,Int8Array:e.arrayBuffer,Int16Array:e.arrayBuffer,Int32Array:e.arrayBuffer,Map:e.map,Number:fv,Object:e.object,Promise:gv,RegExp:e.regExp,Set:e.set,String:fv,WeakMap:gv,WeakSet:gv,Uint8Array:e.arrayBuffer,Uint8ClampedArray:e.arrayBuffer,Uint16Array:e.arrayBuffer,Uint32Array:e.arrayBuffer,Uint64Array:e.arrayBuffer}}(_v({},xv,e)),n=t.Array,i=t.Object;function s(e,s){if(s.prototype=s.Constructor=void 0,!e||"object"!=typeof e)return e;if(s.cache.has(e))return s.cache.get(e);if(s.prototype=yv(e),s.Constructor=s.prototype&&s.prototype.constructor,!s.Constructor||s.Constructor===Object)return i(e,s);if(wv(e))return n(e,s);var r=t[nv(e)];return r?r(e,s):"function"==typeof e.then?e:i(e,s)}return function(e){return s(e,{Constructor:void 0,cache:Qm(),copier:s,prototype:void 0})}}Pv(_v({},Cv,{}));var $v=Pv({}),Ev=Object.getOwnPropertyNames,kv=Object.getOwnPropertySymbols,Vv=Object.prototype.hasOwnProperty;function Sv(e,t){return function(n,i,s){return e(n,i,s)&&t(n,i,s)}}function Lv(e){return function(t,n,i){if(!t||!n||"object"!=typeof t||"object"!=typeof n)return e(t,n,i);var s=i.cache,r=s.get(t),o=s.get(n);if(r&&o)return r===n&&o===t;s.set(t,n),s.set(n,t);var a=e(t,n,i);return s.delete(t),s.delete(n),a}}function Mv(e){return Ev(e).concat(kv(e))}var Av=Object.hasOwn||function(e,t){return Vv.call(e,t)};function Dv(e,t){return e===t||!e&&!t&&e!=e&&t!=t}var jv=Object.getOwnPropertyDescriptor,Tv=Object.keys;function Ov(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function Bv(e,t){return Dv(e.getTime(),t.getTime())}function zv(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Nv(e,t){return e===t}function Fv(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var s,r,o=new Array(i),a=e.entries(),l=0;(s=a.next())&&!s.done;){for(var c=t.entries(),u=!1,h=0;(r=c.next())&&!r.done;)if(o[h])h++;else{var p=s.value,d=r.value;if(n.equals(p[0],d[0],l,h,e,t,n)&&n.equals(p[1],d[1],p[0],d[0],e,t,n)){u=o[h]=!0;break}h++}if(!u)return!1;l++}return!0}var Iv=Dv;function Rv(e,t,n){var i=Tv(e),s=i.length;if(Tv(t).length!==s)return!1;for(;s-- >0;)if(!Xv(e,t,n,i[s]))return!1;return!0}function qv(e,t,n){var i,s,r,o=Mv(e),a=o.length;if(Mv(t).length!==a)return!1;for(;a-- >0;){if(!Xv(e,t,n,i=o[a]))return!1;if(s=jv(e,i),r=jv(t,i),(s||r)&&(!s||!r||s.configurable!==r.configurable||s.enumerable!==r.enumerable||s.writable!==r.writable))return!1}return!0}function Uv(e,t){return Dv(e.valueOf(),t.valueOf())}function Kv(e,t){return e.source===t.source&&e.flags===t.flags}function Hv(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var s,r,o=new Array(i),a=e.values();(s=a.next())&&!s.done;){for(var l=t.values(),c=!1,u=0;(r=l.next())&&!r.done;){if(!o[u]&&n.equals(s.value,r.value,s.value,r.value,e,t,n)){c=o[u]=!0;break}u++}if(!c)return!1}return!0}function Gv(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Yv(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Xv(e,t,n,i){return!("_owner"!==i&&"__o"!==i&&"__v"!==i||!e.$$typeof&&!t.$$typeof)||Av(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var Wv=Array.isArray,Zv="function"==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,Qv=Object.assign,Jv=Object.prototype.toString.call.bind(Object.prototype.toString);tf(),tf({strict:!0}),tf({circular:!0}),tf({circular:!0,strict:!0});var ef=tf({createInternalComparator:function(){return Dv}});function tf(e){void 0===e&&(e={});var t,n=e.circular,i=void 0!==n&&n,s=e.createInternalComparator,r=e.createState,o=e.strict,a=void 0!==o&&o,l=function(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,s={areArraysEqual:i?qv:Ov,areDatesEqual:Bv,areErrorsEqual:zv,areFunctionsEqual:Nv,areMapsEqual:i?Sv(Fv,qv):Fv,areNumbersEqual:Iv,areObjectsEqual:i?qv:Rv,arePrimitiveWrappersEqual:Uv,areRegExpsEqual:Kv,areSetsEqual:i?Sv(Hv,qv):Hv,areTypedArraysEqual:i?qv:Gv,areUrlsEqual:Yv};if(n&&(s=Qv({},s,n(s))),t){var r=Lv(s.areArraysEqual),o=Lv(s.areMapsEqual),a=Lv(s.areObjectsEqual),l=Lv(s.areSetsEqual);s=Qv({},s,{areArraysEqual:r,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return s}(e),c=function(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,s=e.areFunctionsEqual,r=e.areMapsEqual,o=e.areNumbersEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,p=e.areUrlsEqual;return function(e,d,m){if(e===d)return!0;if(null==e||null==d)return!1;var v=typeof e;if(v!==typeof d)return!1;if("object"!==v)return"number"===v?o(e,d,m):"function"===v&&s(e,d,m);var f=e.constructor;if(f!==d.constructor)return!1;if(f===Object)return a(e,d,m);if(Wv(e))return t(e,d,m);if(null!=Zv&&Zv(e))return h(e,d,m);if(f===Date)return n(e,d,m);if(f===RegExp)return c(e,d,m);if(f===Map)return r(e,d,m);if(f===Set)return u(e,d,m);var g=Jv(e);return"[object Date]"===g?n(e,d,m):"[object RegExp]"===g?c(e,d,m):"[object Map]"===g?r(e,d,m):"[object Set]"===g?u(e,d,m):"[object Object]"===g?"function"!=typeof e.then&&"function"!=typeof d.then&&a(e,d,m):"[object URL]"===g?p(e,d,m):"[object Error]"===g?i(e,d,m):"[object Arguments]"===g?a(e,d,m):("[object Boolean]"===g||"[object Number]"===g||"[object String]"===g)&&l(e,d,m)}}(l),u=s?s(c):(t=c,function(e,n,i,s,r,o,a){return t(e,n,a)});return function(e){var t=e.circular,n=e.comparator,i=e.createState,s=e.equals,r=e.strict;if(i)return function(e,o){var a=i(),l=a.cache,c=void 0===l?t?new WeakMap:void 0:l,u=a.meta;return n(e,o,{cache:c,equals:s,meta:u,strict:r})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:s,meta:void 0,strict:r})};var o={cache:void 0,equals:s,meta:void 0,strict:r};return function(e,t){return n(e,t,o)}}({circular:i,comparator:c,createState:r,equals:u,strict:a})}function nf(e){let t,n;return t=new Dd({props:{theme:e[7],userCreatedPane:!1,$$slots:{default:[rf]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]&&(i.theme=e[7]),127&n[0]|2&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function sf(e){let t,n,i,s;const r=[af,of],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function rf(e){let t,n,i,s,r,o,a,l,c;function u(t){e[14](t)}function h(t){e[15](t)}function p(t){e[16](t)}function d(t){e[17](t)}function m(t){e[18](t)}function v(t){e[19](t)}function f(t){e[20](t)}let g={};return void 0!==e[1]&&(g.disabled=e[1]),void 0!==e[5]&&(g.key=e[5]),void 0!==e[2]&&(g.label=e[2]),void 0!==e[0]&&(g.object=e[0]),void 0!==e[3]&&(g.options=e[3]),void 0!==e[6]&&(g.plugin=e[6]),void 0!==e[4]&&(g.ref=e[4]),t=new uf({props:g}),F.push((()=>ae(t,"disabled",u))),F.push((()=>ae(t,"key",h))),F.push((()=>ae(t,"label",p))),F.push((()=>ae(t,"object",d))),F.push((()=>ae(t,"options",m))),F.push((()=>ae(t,"plugin",v))),F.push((()=>ae(t,"ref",f))),t.$on("change",e[21]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),c=!0},p(e,c){const u={};!n&&2&c[0]&&(n=!0,u.disabled=e[1],G((()=>n=!1))),!i&&32&c[0]&&(i=!0,u.key=e[5],G((()=>i=!1))),!s&&4&c[0]&&(s=!0,u.label=e[2],G((()=>s=!1))),!r&&1&c[0]&&(r=!0,u.object=e[0],G((()=>r=!1))),!o&&8&c[0]&&(o=!0,u.options=e[3],G((()=>o=!1))),!a&&64&c[0]&&(a=!0,u.plugin=e[6],G((()=>a=!1))),!l&&16&c[0]&&(l=!0,u.ref=e[4],G((()=>l=!1))),t.$set(u)},i(e){c||(ne(t.$$.fragment,e),c=!0)},o(e){ie(t.$$.fragment,e),c=!1},d(e){ue(t,e)}}}function of(e){let t,n;return t=new No({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:e[7]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]&&(i.theme=e[7]),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function af(t){let n;return{c(){n=y("div"),E(n,"display","none")},m(e,i){w(e,n,i),t[13](n)},p:e,i:e,o:e,d(e){e&&_(n),t[13](null)}}}function lf(e){let t,n,i,s;const r=[sf,nf],o=[];return t=function(e){return e[9]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=P()},m(e,n){o[t].m(e,n),w(e,i,n),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[t].d(e)}}}function cf(e,t,n){let i,{object:s}=t,{key:r}=t,{disabled:o=!1}=t,{label:a}=t,{options:l}=t,{theme:u}=t,{ref:h}=t,{plugin:p}=t;const d=B("registerPlugin"),m=B("parentStore");c(e,m,(e=>n(12,i=e)));const v=B("userCreatedPane");let f,g,b;function w(){f&&f.dispose(),void 0!==p&&d(p),n(10,f=i.addBinding(s,r,{index:b,label:a,...l,disabled:o})),n(4,h=f),f.on("change",$)}D((()=>{n(11,b=g?Ro(g):0)})),j((()=>{f?.dispose()}));const _=T();function y(e){if(e instanceof File)return new File([e],e.name,{lastModified:e.lastModified,type:e.type});if(e instanceof HTMLImageElement){const t=new Image;return t.src=e.src,t}return $v(e)}let x=s,C=y(s[r]),P=!1;function $(){P=!0,n(0,s[r]=y(s[r]),s)}return e.$$set=e=>{"object"in e&&n(0,s=e.object),"key"in e&&n(5,r=e.key),"disabled"in e&&n(1,o=e.disabled),"label"in e&&n(2,a=e.label),"options"in e&&n(3,l=e.options),"theme"in e&&n(7,u=e.theme),"ref"in e&&n(4,h=e.ref),"plugin"in e&&n(6,p=e.plugin)},e.$$.update=()=>{var t;1026&e.$$.dirty[0]&&void 0!==f&&n(10,f.disabled=o,f),1028&e.$$.dirty[0]&&void 0!==f&&n(10,f.label=a,f),e.$$.dirty[0],6152&e.$$.dirty[0]&&void 0!==i&&void 0!==b&&w(),4097&e.$$.dirty[0]&&void 0!==i&&(x!==(t=s)&&(P=!1),ef(t[r],C)||(C=y(t[r]),_("change",{value:y(t[r]),origin:P?"internal":"external"}),!P&&f&&(f.off("change",$),f.refresh(),f.on("change",$))),P=!1,x!==t&&(x=t,w())),4224&e.$$.dirty[0]&&u&&void 0!==i&&(v||!Fo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Binding> components for a theme prop.)")},[s,o,a,l,h,r,p,u,g,m,f,b,i,function(e){F[e?"unshift":"push"]((()=>{g=e,n(8,g)}))},function(e){o=e,n(1,o)},function(e){r=e,n(5,r)},function(e){a=e,n(2,a)},function(e){s=e,n(0,s)},function(e){l=e,n(3,l)},function(e){p=e,n(6,p)},function(e){h=e,n(4,h)},function(t){z.call(this,e,t)}]}tf({strict:!0,createInternalComparator:function(){return Dv}}),tf({circular:!0,createInternalComparator:function(){return Dv}}),tf({circular:!0,createInternalComparator:function(){return Dv},strict:!0});class uf extends pe{constructor(e){super(),he(this,e,cf,lf,o,{object:0,key:5,disabled:1,label:2,options:3,theme:7,ref:4,plugin:6},null,[-1,-1])}}function hf(e){let n,i,s,r;const o=[{key:e[3]},{options:e[1]},e[4]];function a(t){e[6](t)}function l(t){e[7](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[2]&&(c.object=e[2]),void 0!==e[0]&&(c.ref=e[0]),n=new uf({props:c}),F.push((()=>ae(n,"object",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[8]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=26&t?re(o,[8&t&&{key:e[3]},2&t&&{options:e[1]},16&t&&oe(e[4])]):{};!i&&4&t&&(i=!0,r.object=e[2],G((()=>i=!1))),!s&&1&t&&(s=!0,r.ref=e[0],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function pf(e,n,i){let s;const r=["value","ref","options"];let o=f(n,r),{value:a}=n,{ref:l}=n,{options:c}=n;const u=Symbol("key");return e.$$set=e=>{n=t(t({},n),v(e)),i(4,o=f(n,r)),"value"in e&&i(5,a=e.value),"ref"in e&&i(0,l=e.ref),"options"in e&&i(1,c=e.options)},e.$$.update=()=>{4&e.$$.dirty&&i(5,a=s[u]),32&e.$$.dirty&&(ef(a,s[u])||i(2,s[u]=a,s))},i(2,s={[u]:a}),[l,c,s,u,o,a,function(e){s=e,i(2,s)},function(e){l=e,i(0,l)},function(t){z.call(this,e,t)}]}class df extends pe{constructor(e){super(),he(this,e,pf,hf,o,{value:5,ref:0,options:1})}}function mf(e){let n,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[5](t)}function l(t){e[6](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[1]&&(c.value=e[1]),void 0!==e[0]&&(c.ref=e[0]),n=new df({props:c}),F.push((()=>ae(n,"value",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[7]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=12&t?re(o,[4&t&&{options:e[2]},8&t&&oe(e[3])]):{};!i&&2&t&&(i=!0,r.value=e[1],G((()=>i=!1))),!s&&1&t&&(s=!0,r.ref=e[0],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function vf(e,n,i){const s=["options","ref","value"];let r,o=f(n,s),{options:a}=n,{ref:l}=n,{value:c}=n;return e.$$set=e=>{n=t(t({},n),v(e)),i(3,o=f(n,s)),"options"in e&&i(4,a=e.options),"ref"in e&&i(0,l=e.ref),"value"in e&&i(1,c=e.value)},e.$$.update=()=>{16&e.$$.dirty&&i(2,r={...a,readonly:!1})},[l,c,r,o,a,function(e){c=e,i(1,c)},function(e){l=e,i(0,l)},function(t){z.call(this,e,t)}]}class ff extends pe{constructor(e){super(),he(this,e,vf,mf,o,{options:4,ref:0,value:1})}}function gf(e){let n,i,s;const r=[e[1]];function o(t){e[2](t)}let a={};for(let e=0;e<r.length;e+=1)a=t(a,r[e]);return void 0!==e[0]&&(a.value=e[0]),n=new ff({props:a}),F.push((()=>ae(n,"value",o))),n.$on("change",e[3]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),s=!0},p(e,[t]){const s=2&t?re(r,[oe(e[1])]):{};!i&&1&t&&(i=!0,s.value=e[0],G((()=>i=!1))),n.$set(s)},i(e){s||(ne(n.$$.fragment,e),s=!0)},o(e){ie(n.$$.fragment,e),s=!1},d(e){ue(n,e)}}}function bf(e,n,i){const s=["value"];let r=f(n,s),{value:o}=n;return e.$$set=e=>{n=t(t({},n),v(e)),i(1,r=f(n,s)),"value"in e&&i(0,o=e.value)},[o,r,function(e){o=e,i(0,o)},function(t){z.call(this,e,t)}]}class wf extends pe{constructor(e){super(),he(this,e,bf,gf,o,{value:0})}}function _f(e){let n,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[11](t)}function l(t){e[12](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[1]&&(c.value=e[1]),void 0!==e[0]&&(c.ref=e[0]),n=new ff({props:c}),F.push((()=>ae(n,"value",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[13]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=12&t?re(o,[4&t&&{options:e[2]},8&t&&oe(e[3])]):{};!i&&2&t&&(i=!0,r.value=e[1],G((()=>i=!1))),!s&&1&t&&(s=!0,r.ref=e[0],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function yf(e,n,i){const s=["value","ref","options","userExpandable","expanded","buttonClass","picker"];let r,o=f(n,s),{value:a}=n,{ref:l}=n,{options:c}=n,{userExpandable:u=!0}=n,{expanded:h=!1}=n,{buttonClass:p=""}=n,{picker:d}=n,m=!1;const g=h;let b=g;return e.$$set=e=>{n=t(t({},n),v(e)),i(3,o=f(n,s)),"value"in e&&i(1,a=e.value),"ref"in e&&i(0,l=e.ref),"options"in e&&i(5,c=e.options),"userExpandable"in e&&i(6,u=e.userExpandable),"expanded"in e&&i(4,h=e.expanded),"buttonClass"in e&&i(7,p=e.buttonClass),"picker"in e&&i(8,d=e.picker)},e.$$.update=()=>{1537&e.$$.dirty&&!m&&l&&(i(9,m=!0),l.controller?.valueController?.foldable_?.value("expanded").emitter.on("change",(e=>{i(10,b=e.rawValue),i(4,h=b)}))),288&e.$$.dirty&&i(2,r={...c,expanded:g,picker:d}),193&e.$$.dirty&&l&&p&&Ko(u??!0,l.element,p),1169&e.$$.dirty&&l&&p&&h!==b&&l.element.querySelectorAll(`.${p}`).length>0&&l.element.querySelector(`.${p}`)?.click()},[l,a,r,o,h,c,u,p,d,m,b,function(e){a=e,i(1,a)},function(e){l=e,i(0,l)},function(t){z.call(this,e,t)}]}class xf extends pe{constructor(e){super(),he(this,e,yf,_f,o,{value:1,ref:0,options:5,userExpandable:6,expanded:4,buttonClass:7,picker:8})}}function Cf(e){let n,i,s,r,o,a,l;const c=[{buttonClass:Pf},{options:e[3]},e[4]];function u(t){e[8](t)}function h(t){e[9](t)}function p(t){e[10](t)}let d={};for(let e=0;e<c.length;e+=1)d=t(d,c[e]);void 0!==e[1]&&(d.value=e[1]),void 0!==e[0]&&(d.expanded=e[0]),void 0!==e[2]&&(d.ref=e[2]),n=new xf({props:d}),F.push((()=>ae(n,"value",u))),F.push((()=>ae(n,"expanded",h))),F.push((()=>ae(n,"ref",p))),n.$on("change",e[11]);let m=!1;return{c(){le(n.$$.fragment),o=C(),a=P()},m(e,t){ce(n,e,t),w(e,o,t),w(e,a,t),l=!0},p(e,[t]){const o=24&t?re(c,[0&t&&{buttonClass:Pf},8&t&&{options:e[3]},16&t&&oe(e[4])]):{};!i&&2&t&&(i=!0,o.value=e[1],G((()=>i=!1))),!s&&1&t&&(s=!0,o.expanded=e[0],G((()=>s=!1))),!r&&4&t&&(r=!0,o.ref=e[2],G((()=>r=!1))),n.$set(o)},i(e){l||(ne(n.$$.fragment,e),ne(m),l=!0)},o(e){ie(n.$$.fragment,e),ie(m),l=!1},d(e){e&&(_(o),_(a)),ue(n,e)}}}const Pf="tp-colswv_b";function $f(e,n,i){const s=["value","expanded","type"];let r,o,a,l=f(n,s),{value:c}=n,{expanded:u}=n,{type:h}=n;return e.$$set=e=>{i(5,n=t(t({},n),v(e))),i(4,l=f(n,s)),"value"in e&&i(6,c=e.value),"expanded"in e&&i(0,u=e.expanded),"type"in e&&i(7,h=e.type)},e.$$.update=()=>{64&e.$$.dirty&&function(){if("string"==typeof c)r!==c&&i(1,r=c);else if(Or(c))ef(c,r)||i(1,r={...c});else if(Array.isArray(c)){let e=4===c.length?{r:c[0],g:c[1],b:c[2],a:c[3]}:3===c.length?{r:c[0],g:c[1],b:c[2]}:void 0;void 0===e?console.error("Unreachable"):ef(e,r)||i(1,r=e)}else console.error("Unreachable")}(),2&e.$$.dirty&&function(){if("string"==typeof c&&"string"==typeof r)r!==c&&i(6,c=r);else if(Array.isArray(c)&&Or(r)){const e=Tr(r)?Ho(r,["r","g","b","a"]):jr(r)?Ho(r,["r","g","b"]):void 0;void 0===e?console.error("Unreachable color type mismatch"):ef(e,c)||i(6,c=e)}else Or(c)&&Or(r)?ef(r,c)||i(6,c={...r}):console.error("Unreachable color type mismatch")}(),4&e.$$.dirty&&void 0!==a&&a.on("change",(()=>{a.refresh()})),128&e.$$.dirty&&i(3,o={color:{type:h},view:"color"})},n=v(n),[u,r,a,o,l,n,c,h,function(e){r=e,i(1,r)},function(e){u=e,i(0,u)},function(e){a=e,i(2,a)},function(t){z.call(this,e,t)}]}class Ef extends pe{constructor(e){super(),he(this,e,$f,Cf,o,{value:6,expanded:0,type:7})}}const kf=vn("ctn"),Vf=vn("input"),Sf=vn("btn");class Lf{constructor(e,t){this.element=e.createElement("div"),this.container=e.createElement("div"),this.container.classList.add(kf()),t.viewProps.bindClassModifiers(this.container),this.input=e.createElement("input"),this.input.classList.add(Vf()),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.filetypes?t.filetypes.join(","):"*"),this.input.style.height=`calc(20px * ${t.lineCount})`,this.fileIcon=e.createElement("div"),this.fileIcon.classList.add(kf("icon")),this.text=e.createElement("span"),this.text.classList.add(kf("text")),this.warning=e.createElement("span"),this.warning.classList.add(kf("warning")),this.warning.innerHTML=t.invalidFiletypeMessage,this.warning.style.display="none",this.deleteButton=e.createElement("button"),this.deleteButton.classList.add(Sf("b")),this.deleteButton.innerHTML="Delete",this.deleteButton.style.display="none",this.container.appendChild(this.input),this.container.appendChild(this.fileIcon),this.element.appendChild(this.container),this.element.appendChild(this.warning),this.element.appendChild(this.deleteButton)}changeDraggingState(e){var t,n;e?null===(t=this.container)||void 0===t||t.classList.add(kf("input_area_dragging")):null===(n=this.container)||void 0===n||n.classList.remove(kf("input_area_dragging"))}}class Mf{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Lf(e,{viewProps:this.viewProps,value:t.value,invalidFiletypeMessage:t.invalidFiletypeMessage,lineCount:t.lineCount,filetypes:t.filetypes}),this.config=t,this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.onDeleteClick=this.onDeleteClick.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.view.deleteButton.addEventListener("click",this.onDeleteClick),this.value.emitter.on("change",(()=>this.handleValueChange())),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.element.removeEventListener("drop",this.onDrop),this.view.element.removeEventListener("dragover",this.onDragOver),this.view.element.removeEventListener("dragleave",this.onDragLeave),this.view.deleteButton.removeEventListener("click",this.onDeleteClick)}))}onFile(e){const t=this.view.input;if(t.files&&t.files.length>0){const e=t.files[0];this.isFileValid(e)?this.value.setRawValue(e):this.showWarning()}}showWarning(){this.view.warning.style.display="block",setTimeout((()=>{this.view.warning.style.display="none"}),5e3)}isFileValid(e){var t;const n=this.config.filetypes,i="."+(null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase());return!(n&&n.length>0&&!n.includes(i)&&i)}onDeleteClick(){this.value.rawValue&&(this.value.setRawValue(null),this.view.input.value="",this.view.warning.style.display="none")}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}onDrop(e){if(e instanceof DragEvent&&(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files)){const t=e.dataTransfer.files;if(1==t.length){const e=t.item(0);e&&(this.isFileValid(e)?this.value.setRawValue(e):this.showWarning())}}this.view.changeDraggingState(!1)}handleValueChange(){const e=this.value.rawValue,t=this.view.container,n=this.view.text,i=this.view.fileIcon,s=this.view.deleteButton;e?(n.textContent=e.name,t.appendChild(n),t.contains(i)&&t.removeChild(i),this.view.warning.style.display="none",s.style.display="block",t.style.border="unset"):(n.textContent="",t.appendChild(i),t.removeChild(n),this.view.warning.style.display="none",s.style.display="none",t.style.border="1px dashed #717070")}}function Af(e){const t=new Image;return t.crossOrigin="anonymous",t.src=e,t}jn({id:"file-input",type:"input",accept(e,t){if("string"!=typeof e)return null;const n=Wt(t,(e=>({view:e.required.constant("file-input"),invalidFiletypeMessage:e.optional.string,lineCount:e.optional.number,filetypes:e.optional.array(e.required.string)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>e instanceof File?e:null,constraint:e=>new vi([]),writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new Mf(e.document,{value:e.value,viewProps:e.viewProps,invalidFiletypeMessage:null!==(t=e.params.invalidFiletypeMessage)&&void 0!==t?t:"Unaccepted file type.",lineCount:null!==(n=e.params.lineCount)&&void 0!==n?n:3,filetypes:e.params.filetypes})}});const Df=vn("img");class jf{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Df()),t.viewProps.bindClassModifiers(this.element),this.input=e.createElement("input"),this.input.classList.add(Df("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.extensions.join(",")),this.image_=e.createElement("img"),this.image_.id="tpimg_"+Math.random().toString(36).slice(2),this.image_.classList.add(Df("image")),this.image_.classList.add(Df(`image_${t.imageFit}`)),this.image_.crossOrigin="anonymous",this.image_.onclick=e=>t.clickCallback?t.clickCallback(e,this.input):this.input.click(),this.element.classList.add(Df("area_root")),this.element.appendChild(this.image_),this.element.appendChild(this.input)}changeImage(e){this.image_.src=e}changeDraggingState(e){const t=this.element;e?null==t||t.classList.add(Df("area_dragging")):null==t||t.classList.remove(Df("area_dragging"))}}let Tf=null;class Of{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new jf(e,{viewProps:this.viewProps,extensions:t.extensions,imageFit:t.imageFit,clickCallback:t.clickCallback}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragstart",this.onDragStart),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.element.removeEventListener("drop",this.onDrop),this.view.element.removeEventListener("dragstart",this.onDragStart),this.view.element.removeEventListener("dragover",this.onDragOver),this.view.element.removeEventListener("dragleave",this.onDragLeave)})),this.value.emitter.on("change",(()=>this.handleValueChange())),this.handleValueChange()}onFile(e){const t=(null==e?void 0:e.target).files;if(!t||!t.length)return;const n=t[0];this.setValue(n)}onDrop(e){e.preventDefault();try{const{dataTransfer:t}=e,n=null==t?void 0:t.files[0];if(n)this.setValue(n);else{const e=null==t?void 0:t.getData("img-id");if(e){const t=document.getElementById(e);this.setValue(t)}else{const e=null==t?void 0:t.getData("url");if(!e)throw new Error("No url");this.setValue(e)}}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}}onDragStart(e){var t,n;null===(t=e.dataTransfer)||void 0===t||t.setData("img-id",this.view.image_.id),null===(n=e.dataTransfer)||void 0===n||n.setDragImage(this.view.image_,0,0)}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(e){e instanceof HTMLImageElement?this.updateImage(e.src):"string"!=typeof e&&e?this.setValue(e):("placeholder"!==e&&e||(e=this.handlePlaceholderImage().src),this.updateImage(e))}updateImage(e){this.view.changeImage(e)}setValue(e){if(e instanceof HTMLImageElement)this.value.setRawValue(e);else if(e instanceof File){const t=URL.createObjectURL(e)+"#"+e.name;e.src=t;const n=Af(t);this.value.setRawValue(n||e)}else e?this.value.setRawValue(Af(e)):this.value.setRawValue(this.handlePlaceholderImage())}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return Tf||(Tf=function(){const e=new Blob(['\n\t<svg width="320" height="50" xmlns="http://www.w3.org/2000/svg">\n  <style>\n    text {\n      font-family: "Menlo", monospace;\n      font-size: 12px;\n\t\t\tfill: gray;\n    }\n  </style>\n  <text x="50%" y="55%" text-anchor="middle">\n    No Image\n  </text>\n</svg>'],{type:"image/svg+xml"}),t=new Image;return t.src=URL.createObjectURL(e),t}()),Tf}}const Bf=[".jpg",".png",".gif"];function zf(e){let n,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[12](t)}function l(t){e[13](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[0]&&(c.value=e[0]),void 0!==e[1]&&(c.ref=e[1]),n=new ff({props:c}),F.push((()=>ae(n,"value",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[14]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=12&t?re(o,[4&t&&{options:e[2]},8&t&&oe(e[3])]):{};!i&&1&t&&(i=!0,r.value=e[0],G((()=>i=!1))),!s&&2&t&&(s=!0,r.ref=e[1],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function Nf(e,n,i){const s=["value","options","min","max","step","pointerScale","keyScale","format","ref"];let r,o=f(n,s),{value:a}=n,{options:l}=n,{min:c}=n,{max:u}=n,{step:h}=n,{pointerScale:p}=n,{keyScale:d}=n,{format:m}=n,{ref:g}=n,b=m;return e.$$set=e=>{n=t(t({},n),v(e)),i(3,o=f(n,s)),"value"in e&&i(0,a=e.value),"options"in e&&i(4,l=e.options),"min"in e&&i(5,c=e.min),"max"in e&&i(6,u=e.max),"step"in e&&i(7,h=e.step),"pointerScale"in e&&i(8,p=e.pointerScale),"keyScale"in e&&i(9,d=e.keyScale),"format"in e&&i(10,m=e.format),"ref"in e&&i(1,g=e.ref)},e.$$.update=()=>{3072&e.$$.dirty&&b!==m&&i(11,b=m),3056&e.$$.dirty&&i(2,r={min:c,max:u,format:b,keyScale:d,pointerScale:p,step:h,...l})},[a,g,r,o,l,c,u,h,p,d,m,b,function(e){a=e,i(0,a)},function(e){g=e,i(1,g)},function(t){z.call(this,e,t)}]}jn({id:"input-image",type:"input",accept(e,t){if(!(e instanceof HTMLImageElement||"string"==typeof e))return null;const n=Wt(t,(e=>({view:e.required.constant("input-image"),acceptUrl:e.optional.boolean,clickCallback:e.optional.function,imageFit:e.optional.custom((e=>"contain"===e||"cover"===e?e:void 0)),extensions:e.optional.array(e.required.string)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>void 0!==e.src?""===e.src?"placeholder":e.src:e,writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new Of(e.document,{value:e.value,imageFit:null!==(t=e.params.imageFit)&&void 0!==t?t:"cover",clickCallback:e.params.clickCallback,viewProps:e.viewProps,extensions:null!==(n=e.params.extensions)&&void 0!==n?n:Bf})}});class Ff extends pe{constructor(e){super(),he(this,e,Nf,zf,o,{value:0,options:4,min:5,max:6,step:7,pointerScale:8,keyScale:9,format:10,ref:1})}}function If(e){let n,i,s,r,o;const a=[{options:e[1]},e[2]];function l(t){e[7](t)}let c={};for(let e=0;e<a.length;e+=1)c=t(c,a[e]);void 0!==e[0]&&(c.ref=e[0]),n=new Xd({props:c}),F.push((()=>ae(n,"ref",l)));let u=!1;return{c(){le(n.$$.fragment),s=C(),r=P()},m(e,t){ce(n,e,t),w(e,s,t),w(e,r,t),o=!0},p(e,[t]){const s=6&t?re(a,[2&t&&{options:e[1]},4&t&&oe(e[2])]):{};!i&&1&t&&(i=!0,s.ref=e[0],G((()=>i=!1))),n.$set(s)},i(e){o||(ne(n.$$.fragment,e),ne(u),o=!0)},o(e){ie(n.$$.fragment,e),ie(u),o=!1},d(e){e&&(_(s),_(r)),ue(n,e)}}}function Rf(e){return t=e,Array.isArray(t)&&t.every((e=>"object"==typeof e&&null!==e&&"text"in e&&"value"in e))||function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}(e)?e:e.map((e=>({value:e,text:"object"==typeof e?JSON.stringify(e):String(e)})));var t}function qf(e,n,i){const s=["value","options","label"];let r=f(n,s),{value:o}=n,{options:a}=n,{label:l}=n;const c=T();let u,h;function p(){if(void 0===o){const e=Rf(a);return Array.isArray(e)?(i(4,o=e[0].value),o):(i(4,o=e[Object.keys(e)[0]]),o)}return o}return e.$$set=e=>{i(3,n=t(t({},n),v(e))),i(2,r=f(n,s)),"value"in e&&i(4,o=e.value),"options"in e&&i(5,a=e.options),"label"in e&&i(6,l=e.label)},e.$$.update=()=>{96&e.$$.dirty&&i(1,h={value:p(),label:l,options:Rf(a),view:"list"}),1&e.$$.dirty&&u&&u.on("change",(e=>{ef(e.value,o)||(i(4,o=e.value),c("change",{value:$v(o),origin:"internal"}))})),17&e.$$.dirty&&u&&(ef(u.value,o)||(i(0,u.value=o,u),c("change",{value:$v(o),origin:"external"})))},n=v(n),[u,h,r,n,o,a,l,function(e){u=e,i(0,u)}]}class Uf extends pe{constructor(e){super(),he(this,e,qf,If,o,{value:4,options:5,label:6})}}const Kf=vn("ckr");class Hf{constructor(e,t){this.tickElems_=[],this.labelElems_=[],this.boundsWidth_=-1,this.onShowsTooltipChange_=this.onShowsTooltipChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.formatters_=t.formatters,this.unit_=t.unit,this.element=e.createElement("div"),this.element.classList.add(Kf(),Kf(void 0,`m${t.seriesId}`)),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.showsTooltip.emitter.on("change",this.onShowsTooltipChange_);const n=e.createElement("div");n.classList.add(Kf("w")),this.element.appendChild(n),this.offsetElem_=e.createElement("div"),this.offsetElem_.classList.add(Kf("o")),n.appendChild(this.offsetElem_),this.svgElem_=e.createElementNS(tn,"svg"),this.svgElem_.classList.add(Kf("g")),this.offsetElem_.appendChild(this.svgElem_),this.tooltipElem_=e.createElement("div"),this.tooltipElem_.classList.add(vn("tt")(),Kf("tt")),this.element.appendChild(this.tooltipElem_),this.waitToBeAdded_()}waitToBeAdded_(){const e=new IntersectionObserver((t=>{t.forEach((t=>{t.target===this.element&&0!==t.intersectionRatio&&(this.update(),e.disconnect())}))}),{root:null});e.observe(this.element)}rebuildScaleIfNeeded_(e){if(this.boundsWidth_===e)return;this.boundsWidth_=e,this.tickElems_.forEach((e=>{cn(e)})),this.tickElems_=[],this.labelElems_.forEach((e=>{cn(e)})),this.labelElems_=[];const t=this.element.ownerDocument,n=this.unit_.ticks,i=this.unit_.pixels,s=(2*(Math.ceil(e/2/i)+1)+1)*n,r=i/n;for(let e=0;e<s;e++){const i=e*r;if(e%n===0){const e=t.createElementNS(tn,"line");e.classList.add(Kf("mjt")),e.setAttributeNS(null,"x1",String(i)),e.setAttributeNS(null,"y1","0"),e.setAttributeNS(null,"x2",String(i)),e.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(e),this.tickElems_.push(e);const n=t.createElement("div");n.classList.add(Kf("l")),n.style.left=`${i}px`,this.offsetElem_.appendChild(n),this.labelElems_.push(n)}else{const e=t.createElementNS(tn,"line");e.classList.add(Kf("mnt")),e.setAttributeNS(null,"x1",String(i)),e.setAttributeNS(null,"y1","0"),e.setAttributeNS(null,"x2",String(i)),e.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(e),this.tickElems_.push(e)}}}updateScale_(e){const t=this.unit_.value,n=this.unit_.pixels,i=this.value_.rawValue,s=Math.ceil(e/2/n)+1,r=i-i%t-t*s,o=s=>1-Math.pow(Lt(Math.abs(i-s)/(e/2*(t/n)),0,1),10);this.labelElems_.forEach(((e,n)=>{const i=r+n*t;e.textContent=this.formatters_.ring(i),e.style.opacity=String(o(i))}));const a=this.unit_.ticks;this.tickElems_.forEach(((e,n)=>{const i=r+n/a*t;e.style.opacity=String(o(i))}))}update(){const e=this.element.getBoundingClientRect().width,t=this.unit_.value,n=this.unit_.pixels,i=this.value_.rawValue,s=e/2-n/t*(i%t+t*(Math.ceil(e/2/n)+1));this.offsetElem_.style.transform=`translateX(${s}px)`,this.tooltipElem_.textContent=this.formatters_.text(i),this.rebuildScaleIfNeeded_(e),this.updateScale_(e)}onValueChange_(){this.update()}onShowsTooltipChange_(e){e.rawValue?this.element.classList.add(Kf(void 0,"tt")):this.element.classList.remove(Kf(void 0,"tt"))}}class Gf{constructor(e,t){this.ox_=0,this.ov_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.tooltipEnabled_=t.tooltipEnabled,this.unit_=t.unit,this.showsTooltip_=it(!1),this.view=new Hf(e,{formatters:t.formatters,seriesId:t.seriesId,showsTooltip:this.showsTooltip_,unit:t.unit,value:this.value,viewProps:this.viewProps});const n=new Ri(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}onPointerDown_(e){const t=e.data;t.point&&(this.ox_=t.point.x,this.ov_=this.value.rawValue,this.tooltipEnabled_&&(this.showsTooltip_.rawValue=!0))}onPointerMove_(e){const t=e.data;if(!t.point)return;const n=t.point.x-this.ox_,i=this.unit_.pixels,s=this.unit_.value;this.value.setRawValue(this.ov_-n/i*s,{forceEmit:!1,last:!1})}onPointerUp_(){this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0}),this.showsTooltip_.rawValue=!1}}const Yf=vn("ckrtxt");class Xf{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Yf());const n=e.createElement("div");n.classList.add(Yf("r")),n.appendChild(t.ringView.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Yf("t")),i.appendChild(t.textView.element),this.element.appendChild(i)}}class Wf{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.rc_=new Gf(e,{formatters:{ring:t.ringFormatter,text:t.textProps.get("formatter")},seriesId:t.seriesId,tooltipEnabled:!1,unit:t.ringUnit,value:this.value,viewProps:this.viewProps}),this.tc_=new Ki(e,{parser:t.parser,props:t.textProps,value:this.value,viewProps:this.viewProps}),this.view=new Xf(e,{ringView:this.rc_.view,textView:this.tc_.view})}}function Zf(e){const t=[],n=Ot(e);n&&t.push(n);const i=Tt(e);return i&&t.push(i),new vi(t)}function Qf(e){return 0===e||1===e||2===e?e:void 0}function Jf(e){return void 0!==e?String(e):"0"}jn({id:"input-ring",type:"input",accept(e,t){if("number"!=typeof e)return null;const n=Wt(t,(e=>Object.assign(Object.assign({},zt(e)),{series:e.optional.custom(Qf),unit:e.optional.object({pixels:e.required.number,ticks:e.required.number,value:e.required.number}),view:e.required.constant("cameraring"),wide:e.optional.boolean})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Et,constraint:e=>Zf(e.params),writer:e=>rs},controller(e){var t,n,i;const s=null!==(t=e.params.unit)&&void 0!==t?t:{ticks:5,pixels:40,value:10},r=function(e){const t=kt(St(e.value));return e=>{const n=t(e),i=n.substr(0,1);return n+("-"===i||"+"===i?" ":"")}}(s),o=Bt(e.params,e.initialValue);if(e.params.wide)return new Gf(e.document,{formatters:{ring:r,text:o.formatter},seriesId:null!==(n=Jf(e.params.series))&&void 0!==n?n:"0",tooltipEnabled:!0,unit:s,value:e.value,viewProps:e.viewProps});const a=st.fromObject(o);return new Wf(e.document,{parser:$t,ringFormatter:r,ringUnit:s,seriesId:null!==(i=Jf(e.params.series))&&void 0!==i?i:"0",textProps:a,value:e.value,viewProps:e.viewProps})}}),jn({id:"input-wheel",type:"input",accept(e,t){if("number"!=typeof e)return null;const n=Wt(t,(e=>Object.assign(Object.assign({},zt(e)),{amount:e.optional.number,view:e.required.constant("camerawheel"),wide:e.optional.boolean})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Et,constraint:e=>Zf(e.params),writer:e=>rs},controller(e){var t,n;const i=kt(0),s=Bt(e.params,e.initialValue);return e.params.wide?new Gf(e.document,{formatters:{ring:i,text:s.formatter},seriesId:"w",tooltipEnabled:!0,unit:{ticks:10,pixels:40,value:40*(null!==(t=e.params.amount)&&void 0!==t?t:s.pointerScale)},value:e.value,viewProps:e.viewProps}):new Wf(e.document,{parser:$t,ringFormatter:i,ringUnit:{ticks:10,pixels:40,value:40*(null!==(n=e.params.amount)&&void 0!==n?n:s.pointerScale)},seriesId:"w",textProps:st.fromObject(s),value:e.value,viewProps:e.viewProps})}});class eg{multiply(e){return this.format(this.quat.multiply(e.quat))}premultiply(e){return this.format(e.multiply(this))}slerp(e,t){return this.format(this.quat.slerp(e.quat,t))}}function tg(e,t,n){return Math.min(Math.max(e,t),n)}function ng(e,t){return e-function(e,t){return Math.floor(e/t)*t}(e,t)}function ig(e){return ng(e+Math.PI,2*Math.PI)-Math.PI}class sg extends eg{static fromQuaternion(e,t,n){const i=e.toMat3(),[s,r,o,a]="XYZ"===t?[0,1,2,1]:"XZY"===t?[0,2,1,-1]:"YXZ"===t?[1,0,2,-1]:"YZX"===t?[1,2,0,1]:"ZXY"===t?[2,0,1,1]:[2,1,0,-1],l=[0,0,0],c=i[o+3*s];return l[r]=-a*Math.asin(tg(c,-1,1)),Math.abs(c)<.999999?(l[s]=a*Math.atan2(i[o+3*r],i[4*o]),l[o]=a*Math.atan2(i[r+3*s],i[4*s])):l[s]=a*Math.atan2(-i[r+3*o],i[4*r]),Math.abs(l[s])+Math.abs(l[o])>Math.PI&&(l[s]=ig(l[s]+Math.PI),l[r]=ig(Math.PI-l[r]),l[o]=ig(l[o]+Math.PI)),new sg(...l,t).reunit(n)}constructor(e,t,n,i,s){super(),this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0,this.order=null!=i?i:"XYZ",this.unit=null!=s?s:"rad"}get quat(){return rg.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(e,t){return this.reorder(e).reunit(t)}format(e){return e instanceof sg?e.reorder(this.order):e.toEuler(this.order,this.unit)}reorder(e){return e===this.order?this:this.quat.toEuler(e,this.unit)}reunit(e){const t={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit]*{deg:180/Math.PI,rad:1,turn:.5/Math.PI}[e];return new sg(t*this.x,t*this.y,t*this.z,this.order,e)}}class rg extends eg{static fromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return new rg(e.x*i,e.y*i,e.z*i,Math.cos(n))}static fromEuler(e){const t=e.reunit("rad"),[n,i,s,r]="XYZ"===t.order?[0,1,2,1]:"XZY"===t.order?[0,2,1,-1]:"YXZ"===t.order?[1,0,2,-1]:"YZX"===t.order?[1,2,0,1]:"ZXY"===t.order?[2,0,1,1]:[2,1,0,-1],o=t.getComponents(),a=.5*o[n],l=.5*r*o[i],c=.5*o[s],u=Math.cos(a),h=Math.cos(l),p=Math.cos(c),d=Math.sin(a),m=Math.sin(l),v=Math.sin(c),f=[0,0,0,p*h*u+v*m*d];return f[n]=p*h*d-v*m*u,f[i]=r*(p*m*u+v*h*d),f[s]=v*h*u-p*m*d,new rg(...f)}static lookRotation(e,t){const{normal:n,tangent:i,binormal:s}=e.orthoNormalize(t),r=s.x,o=i.x,a=n.x,l=s.y,c=i.y,u=n.y,h=s.z,p=i.z,d=n.z,m=r+c+d;if(m>0){const e=.5/Math.sqrt(m+1);return new rg((p-u)*e,(a-h)*e,(l-o)*e,.25/e)}if(r>c&&r>d){const e=2*Math.sqrt(1+r-c-d);return new rg(.25*e,(o+l)/e,(a+h)/e,(p-u)/e)}if(c>d){const e=2*Math.sqrt(1+c-r-d);return new rg((o+l)/e,.25*e,(u+p)/e,(a-h)/e)}{const e=2*Math.sqrt(1+d-r-c);return new rg((a+h)/e,(u+p)/e,.25*e,(l-o)/e)}}constructor(e,t,n,i){super(),this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0,this.w=null!=i?i:1}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(e,t){return sg.fromQuaternion(this,e,t)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return 0===e?new rg:new rg(this.x/e,this.y/e,this.z/e,this.w/e)}get negated(){return new rg(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(e){const t=e.quat;return new rg(this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w,this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z)}format(e){return e.quat}slerp(e,t){let n=e.quat;if(0===t)return this;if(1===t)return n;const i=this.ban360s;n=n.ban360s;let s=i.w*n.w+i.x*n.x+i.y*n.y+i.z*n.z;if(s<0&&(n=n.negated,s=-s),s>=1)return i;const r=1-s*s;if(r<=Number.EPSILON){const e=1-t;return new rg(e*i.x+t*n.x,e*i.y+t*n.y,e*i.z+t*n.z,e*i.w+t*n.w).normalized}const o=Math.sqrt(r),a=Math.atan2(o,s),l=Math.sin((1-t)*a)/o,c=Math.sin(t*a)/o;return new rg(i.x*l+n.x*c,i.y*l+n.y*c,i.z*l+n.z*c,i.w*l+n.w*c)}toMat3(){const{x:e,y:t,z:n,w:i}=this;return[1-2*t*t-2*n*n,2*e*t+2*n*i,2*e*n-2*t*i,2*e*t-2*n*i,1-2*e*e-2*n*n,2*t*n+2*e*i,2*e*n+2*t*i,2*t*n-2*e*i,1-2*e*e-2*t*t]}}class og{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(e){const t=.5*(this.viewport[0]+this.viewport[2]),n=.5*(this.viewport[1]+this.viewport[3]),i=this.viewport[2]-this.viewport[0],s=this.viewport[3]-this.viewport[1],r=1/Math.tan(this.fov*Math.PI/360),o=-(e.z+this.offset[2]);return[t+(e.x+this.offset[0])/o*r*i*.5/this.aspect,n-(e.y+this.offset[1])/o*r*s*.5]}}class ag{constructor(e,t,n){this.element=e.createElementNS(tn,"path"),this.vertices=t,this.projector=n}setRotation(e){let t="";return this.vertices.forEach(((n,i)=>{const s=n.applyQuaternion(e),[r,o]=this.projector.project(s);t+=`${0===i?"M":"L"}${r} ${o}`})),this.element.setAttributeNS(null,"d",t),this}}class lg{constructor(e,t,n){this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return 0===e?new lg:new lg(this.x/e,this.y/e,this.z/e)}get negated(){return new lg(-this.x,-this.y,-this.z)}add(e){return new lg(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return new lg(this.x-e.x,this.y-e.y,this.z-e.z)}scale(e){return new lg(this.x*e,this.y*e,this.z*e)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){return new lg(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}orthoNormalize(e){const t=this.normalized;e=e.normalized;let n=t.dot(e);1===n&&(e=Math.abs(t.y)>Math.abs(t.z)?new lg(0,0,1):new lg(0,1,0),n=t.dot(e));const i=(e=e.sub(t.scale(n)).normalized).cross(t);return{normal:t,tangent:e,binormal:i}}applyQuaternion(e){const t=e.w*this.x+e.y*this.z-e.z*this.y,n=e.w*this.y+e.z*this.x-e.x*this.z,i=e.w*this.z+e.x*this.y-e.y*this.x,s=-e.x*this.x-e.y*this.y-e.z*this.z;return new lg(t*e.w+s*-e.x+n*-e.z-i*-e.y,n*e.w+s*-e.y+i*-e.x-t*-e.z,i*e.w+s*-e.z+t*-e.y-n*-e.x)}}function cg(e,t){const n=t.z>0?new rg(0,0,0,1):new rg(0,0,1,0);return Math.abs(e.z)>.9999?n:rg.lookRotation(e,t)}function ug(e,t,n,i,s,r=1){const o=[];for(let a=0;a<n;a++){const l=e+t*a/(n-1),c=new lg;c[i]=r*Math.cos(l),c[s]=r*Math.sin(l),o.push(c)}return o}const hg=vn("rotationgizmo"),pg=new lg(0,0,0),dg=new lg(1,0,0),mg=new lg(0,1,0),vg=new lg(0,0,1),fg=new lg(0,0,-1),gg=new lg(.7,0,0),bg=new lg(0,.7,0),wg=new lg(0,0,.7),_g=new lg(-.7,0,0),yg=new lg(0,-.7,0),xg=new lg(0,0,-.7),Cg=new rg(0,0,0,1);function Pg(e,t,n){const i=e.createElementNS(tn,"g"),s=e.createElementNS(tn,"circle");s.classList.add(hg(t)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),i.appendChild(s);const r=e.createElementNS(tn,"text");return r.classList.add(hg("labeltext")),r.setAttributeNS(null,"y","4"),r.setAttributeNS(null,"text-anchor","middle"),r.setAttributeNS(null,"font-size","10"),r.textContent=n,i.appendChild(r),i}class $g{get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(hg()),"popup"===t.pickerLayout&&this.element.classList.add(hg(void 0,"p"));const n=e.createElement("div");n.classList.add(hg("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(tn,"svg");i.classList.add(hg("g")),this.padElement.appendChild(i),this.svgElem_=i,this.projector_=new og,this.projector_.viewport=[0,0,136,136];const s=ug(0,Math.PI,33,"x","y"),r=ug(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new ag(e,s,this.projector_),this.xArcB_.element.classList.add(hg("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new ag(e,s,this.projector_),this.yArcB_.element.classList.add(hg("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new ag(e,s,this.projector_),this.zArcB_.element.classList.add(hg("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new ag(e,s,this.projector_),this.xArcBC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new ag(e,s,this.projector_),this.yArcBC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new ag(e,s,this.projector_),this.zArcBC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const o=e.createElementNS(tn,"g");i.classList.add(hg("axes")),this.svgElem_.appendChild(o),this.axesElem_=o,this.xAxis_=new ag(e,[pg,gg],this.projector_),this.xAxis_.element.classList.add(hg("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new ag(e,[pg,bg],this.projector_),this.yAxis_.element.classList.add(hg("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new ag(e,[pg,wg],this.projector_),this.zAxis_.element.classList.add(hg("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new ag(e,[pg,_g],this.projector_),this.xnAxis_.element.classList.add(hg("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new ag(e,[pg,yg],this.projector_),this.ynAxis_.element.classList.add(hg("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new ag(e,[pg,xg],this.projector_),this.znAxis_.element.classList.add(hg("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new ag(e,s,this.projector_),this.xArcF_.element.classList.add(hg("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new ag(e,s,this.projector_),this.yArcF_.element.classList.add(hg("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new ag(e,s,this.projector_),this.zArcF_.element.classList.add(hg("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new ag(e,s,this.projector_),this.xArcFC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new ag(e,s,this.projector_),this.yArcFC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new ag(e,s,this.projector_),this.zArcFC_.element.classList.add(hg("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new ag(e,r,this.projector_),this.rArc_.element.classList.add(hg("arcr")),this.rArc_.setRotation(Cg),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new ag(e,r,this.projector_),this.rArcC_.element.classList.add(hg("arcc")),this.rArcC_.setRotation(Cg),this.svgElem_.appendChild(this.rArcC_.element);const a=e.createElementNS(tn,"g");i.classList.add(hg("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=Pg(e,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=Pg(e,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=Pg(e,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=Pg(e,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=Pg(e,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=Pg(e,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const l=()=>{this.xArcB_.element.classList.add(hg("arcx_hover")),this.xArcF_.element.classList.add(hg("arcx_hover"))},c=()=>{this.xArcB_.element.classList.remove(hg("arcx_hover")),this.xArcF_.element.classList.remove(hg("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",l),this.xArcBC_.element.addEventListener("mouseleave",c),this.xArcFC_.element.addEventListener("mouseenter",l),this.xArcFC_.element.addEventListener("mouseleave",c);const u=()=>{this.yArcB_.element.classList.add(hg("arcy_hover")),this.yArcF_.element.classList.add(hg("arcy_hover"))},h=()=>{this.yArcB_.element.classList.remove(hg("arcy_hover")),this.yArcF_.element.classList.remove(hg("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",u),this.yArcBC_.element.addEventListener("mouseleave",h),this.yArcFC_.element.addEventListener("mouseenter",u),this.yArcFC_.element.addEventListener("mouseleave",h);const p=()=>{this.zArcB_.element.classList.add(hg("arcz_hover")),this.zArcF_.element.classList.add(hg("arcz_hover"))},d=()=>{this.zArcB_.element.classList.remove(hg("arcz_hover")),this.zArcF_.element.classList.remove(hg("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",p),this.zArcBC_.element.addEventListener("mouseleave",d),this.zArcFC_.element.addEventListener("mouseenter",p),this.zArcFC_.element.addEventListener("mouseleave",d);this.rArcC_.element.addEventListener("mouseenter",(()=>{this.rArc_.element.classList.add(hg("arcr_hover"))})),this.rArcC_.element.addEventListener("mouseleave",(()=>{this.rArc_.element.classList.remove(hg("arcr_hover"))})),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,t.mode.emitter.on("change",this.onModeChange_),this.mode_=t.mode,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const e=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(e),this.yAxis_.setRotation(e),this.zAxis_.setRotation(e),this.xnAxis_.setRotation(e),this.ynAxis_.setRotation(e),this.znAxis_.setRotation(e);const t=dg.applyQuaternion(e),n=mg.applyQuaternion(e),i=vg.applyQuaternion(e),s=t.negated,r=n.negated,o=i.negated;[{el:this.xAxis_.element,v:t},{el:this.yAxis_.element,v:n},{el:this.zAxis_.element,v:i},{el:this.xnAxis_.element,v:s},{el:this.ynAxis_.element,v:r},{el:this.znAxis_.element,v:o}].map((({el:e,v:t})=>(this.axesElem_.removeChild(e),{el:e,v:t}))).sort(((e,t)=>e.v.z-t.v.z)).forEach((({el:e})=>{this.axesElem_.appendChild(e)})),this.xArcB_.setRotation(cg(t,fg)),this.yArcB_.setRotation(cg(n,fg)),this.zArcB_.setRotation(cg(i,fg)),this.xArcBC_.setRotation(cg(t,fg)),this.yArcBC_.setRotation(cg(n,fg)),this.zArcBC_.setRotation(cg(i,fg)),this.xArcF_.setRotation(cg(t,vg)),this.yArcF_.setRotation(cg(n,vg)),this.zArcF_.setRotation(cg(i,vg)),this.xArcFC_.setRotation(cg(t,vg)),this.yArcFC_.setRotation(cg(n,vg)),this.zArcFC_.setRotation(cg(i,vg)),[{el:this.xLabel,v:gg},{el:this.yLabel,v:bg},{el:this.zLabel,v:wg},{el:this.xnLabel,v:_g},{el:this.ynLabel,v:yg},{el:this.znLabel,v:xg}].forEach((({el:t,v:n})=>{const[i,s]=this.projector_.project(n.applyQuaternion(e));t.setAttributeNS(null,"transform",`translate( ${i}, ${s} )`)})),[{el:this.xLabel,v:t},{el:this.yLabel,v:n},{el:this.zLabel,v:i},{el:this.xnLabel,v:s},{el:this.ynLabel,v:r},{el:this.znLabel,v:o}].map((({el:e,v:t})=>(this.labelsElem_.removeChild(e),{el:e,v:t}))).sort(((e,t)=>e.v.z-t.v.z)).forEach((({el:e})=>{this.labelsElem_.appendChild(e)}))}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const e=this.mode_.rawValue,t="angle-x"===e?"add":"remove",n="angle-y"===e?"add":"remove",i="angle-z"===e?"add":"remove",s="angle-r"===e?"add":"remove";this.xArcB_.element.classList[t](hg("arcx_active")),this.yArcB_.element.classList[n](hg("arcy_active")),this.zArcB_.element.classList[i](hg("arcz_active")),this.xArcF_.element.classList[t](hg("arcx_active")),this.yArcF_.element.classList[n](hg("arcy_active")),this.zArcF_.element.classList[i](hg("arcz_active")),this.rArc_.element.classList[s](hg("arcr_active"))}}function Eg(e){return tg(e,0,1)}const kg=1/Math.sqrt(2),Vg=new lg(1,0,0),Sg=new lg(0,1,0),Lg=new lg(0,0,1),Mg=new rg(0,0,0,1),Ag=new rg(kg,0,0,kg),Dg=new rg(0,-kg,0,kg),jg=new rg(-kg,0,0,kg),Tg=new rg(0,kg,0,kg),Og=new rg(0,1,0,0);class Bg{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.mode_=it("free"),this.view=new $g(e,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:t.pickerLayout}),this.ptHandler_=new Ri(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const n=new Ri(this.view.xArcBElement);n.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),n.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const i=new Ri(this.view.xArcFElement);i.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),i.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const s=new Ri(this.view.yArcBElement);s.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),s.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const r=new Ri(this.view.yArcFElement);r.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),r.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const o=new Ri(this.view.zArcBElement);o.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),o.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const a=new Ri(this.view.zArcFElement);a.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),a.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const l=new Ri(this.view.rArcElement);l.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-r"))),l.emitter.on("up",(()=>this.changeModeIfNotAuto_("free"))),[{el:this.view.xLabel,q:Dg},{el:this.view.yLabel,q:Ag},{el:this.view.zLabel,q:Mg},{el:this.view.xnLabel,q:Tg},{el:this.view.ynLabel,q:jg},{el:this.view.znLabel,q:Og}].forEach((({el:e,q:t})=>{new Ri(e).emitter.on("down",(()=>this.autoRotate_(t)))})),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(e){if(!e.point)return;const t=this.mode_.rawValue,n=e.point.x,i=e.point.y;if("auto"===t);else if("free"===t){if(null!=this.px_&&null!=this.py_){const e=n-this.px_,t=i-this.py_,s=Math.sqrt(e*e+t*t);if(0===s)return;const r=new lg(t/s,e/s,0),o=rg.fromAxisAngle(r,s/68);this.value.rawValue=this.value.rawValue.premultiply(o)}this.px_=n,this.py_=i}else if("angle-r"===t){const t=e.bounds.width/2,s=e.bounds.height/2,r=Math.atan2(i-s,n-t);if(null==this.angleState_){const e=new lg(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:r,axis:e,reverseAngle:!0}}else{const{initialRotation:e,initialAngle:t,axis:n}=this.angleState_,i=-ig(r-t),s=rg.fromAxisAngle(n,i);this.value.rawValue=e.premultiply(s)}}else{const s=e.bounds.width/2,r=e.bounds.height/2,o=Math.atan2(i-r,n-s);if(null==this.angleState_){const e="angle-x"===t?Vg:"angle-y"===t?Sg:Lg,n=e.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:o,axis:e,reverseAngle:n}}else{const{initialRotation:e,initialAngle:t,axis:n,reverseAngle:i}=this.angleState_;let s=ig(o-t);s=i?-s:s;const r=rg.fromAxisAngle(n,s);this.value.rawValue=e.multiply(r)}}}onPointerDown_(e){this.handlePointerEvent_(e.data)}onPointerMove_(e){this.handlePointerEvent_(e.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(e){Fi(e.key)&&e.preventDefault();const t=Bi(1,Ni(e)),n=Bi(1,zi(e));if(0!==t||0!==n){const e=new lg(-n,t,0),i=rg.fromAxisAngle(e,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(i)}}changeModeIfNotAuto_(e){"auto"!==this.mode_.rawValue&&(this.mode_.rawValue=e)}autoRotate_(e){this.mode_.rawValue="auto";const t=this.value.rawValue,n=Date.now(),i=()=>{const s=Date.now(),r=function(e){if(e<=0)return 0;if(e>=1)return 1;const t=1-e;return Eg(1-t*(t*(t*(t*(t*(t*(-6*t+7)))))))}(Eg((s-n-(o=0))/(300-o)));var o;this.value.rawValue=t.slerp(e,r),1!==r?requestAnimationFrame(i):this.mode_.rawValue="free"};requestAnimationFrame(i)}}const zg=vn("rotationswatch"),Ng=new lg(1,0,0),Fg=new lg(0,1,0),Ig=new lg(0,0,1),Rg=new rg(0,0,0,1);class qg{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(zg()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(zg("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElementNS(tn,"svg");i.classList.add(zg("g")),n.appendChild(i),this.svgElem_=i,this.projector_=new og,this.projector_.viewport=[0,0,20,20];const s=ug(0,Math.PI,33,"x","y"),r=ug(0,2*Math.PI,65,"x","y");this.rArc_=new ag(e,r,this.projector_),this.rArc_.element.classList.add(zg("arcr")),i.appendChild(this.rArc_.element),this.rArc_.setRotation(Rg),this.xArc_=new ag(e,s,this.projector_),this.xArc_.element.classList.add(zg("arc")),i.appendChild(this.xArc_.element),this.yArc_=new ag(e,s,this.projector_),this.yArc_.element.classList.add(zg("arc")),i.appendChild(this.yArc_.element),this.zArc_=new ag(e,s,this.projector_),this.zArc_.element.classList.add(zg("arc")),i.appendChild(this.zArc_.element),this.update_()}update_(){const e=this.value.rawValue.quat.normalized,t=Ng.applyQuaternion(e),n=Fg.applyQuaternion(e),i=Ig.applyQuaternion(e);this.xArc_.setRotation(cg(t,Ig)),this.yArc_.setRotation(cg(n,Ig)),this.zArc_.setRotation(cg(i,Ig))}onValueChange_(){this.update_()}}class Ug{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new qg(e,{value:this.value,viewProps:this.viewProps})}}const Kg=vn("rotation");class Hg{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Kg()),t.foldable.bindExpandedClass(this.element,Kg(void 0,"expanded")),dn(t.foldable,"completed",kn(this.element,Kg(void 0,"cpl"))),"quaternion"===t.rotationMode&&this.element.classList.add(Kg("quat"));const n=e.createElement("div");n.classList.add(Kg("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Kg("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add(Kg("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(Kg("g")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}class Gg{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Un.create(t.expanded),this.swatchC_=new Ug(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Hr(e,{assembly:t.assembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Hg(e,{rotationMode:t.rotationMode,foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Ei(e,{viewProps:this.viewProps}):null;const i=new Bg(e,{value:this.value,viewProps:this.viewProps,pickerLayout:t.pickerLayout});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.gizmoC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Oi({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),Hn(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=hn(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!sn(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Yg(e,t){const n=Math.pow(.1,e);return{baseStep:n,constraint:t,textProps:st.fromObject({formatter:kt(e),keyScale:n,pointerScale:n})}}function Xg(e){if(!e)return;const t=[];return Ke(e.step)||t.push(new at(e.step)),Ke(e.max)&&Ke(e.min)||t.push(new ot({max:e.max,min:e.min})),new vi(t)}function Wg(e,t){return{toComponents:e=>e.getComponents(),fromComponents:n=>new sg(n[0],n[1],n[2],e,t)}}function Zg(e,t,n){return"number"==typeof(null==e?void 0:e.x)&&"number"==typeof(null==e?void 0:e.y)&&"number"==typeof(null==e?void 0:e.z)?new sg(e.x,e.y,e.z,t,n):new sg(0,0,0,t,n)}function Qg(e){switch(e){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return e;default:return}}function Jg(e){switch(e){case"rad":case"deg":case"turn":return e;default:return}}jn({id:"rotation",type:"input",accept(e,t){var n,i;const s=Wt(t,(e=>({view:e.required.constant("rotation"),label:e.optional.string,picker:e.optional.custom(ss),expanded:e.optional.boolean,rotationMode:e.required.constant("euler"),x:e.optional.custom(ns),y:e.optional.custom(ns),z:e.optional.custom(ns),order:e.optional.custom(Qg),unit:e.optional.custom(Jg)})));return s?{initialValue:Zg(e,null!==(n=s.order)&&void 0!==n?n:"XYZ",null!==(i=s.unit)&&void 0!==i?i:"rad"),params:s}:null},binding:{reader:({params:e})=>t=>{var n,i;return Zg(t,null!==(n=e.order)&&void 0!==n?n:"XYZ",null!==(i=e.unit)&&void 0!==i?i:"rad")},constraint({params:e}){var t,n;return new qr({assembly:Wg(null!==(t=e.order)&&void 0!==t?t:"XYZ",null!==(n=e.unit)&&void 0!==n?n:"rad"),components:[Xg("x"in e?e.x:void 0),Xg("y"in e?e.y:void 0),Xg("z"in e?e.z:void 0)]})},writer:e=>(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}},controller({document:e,value:t,constraint:n,params:i,viewProps:s}){var r,o;if(!(n instanceof qr))throw Ze.shouldNeverHappen();const a="expanded"in i?i.expanded:void 0,l="picker"in i?i.picker:void 0,c=null!==(r=i.unit)&&void 0!==r?r:"rad",u={rad:2,deg:0,turn:2}[c];return new Gg(e,{axes:[Yg(u,n.components[0]),Yg(u,n.components[1]),Yg(u,n.components[2])],assembly:Wg(null!==(o=i.order)&&void 0!==o?o:"XYZ",c),rotationMode:"euler",expanded:null!=a&&a,parser:$t,pickerLayout:null!=l?l:"popup",value:t,viewProps:s})}});const eb={toComponents:e=>[e.x,e.y,e.z,e.w],fromComponents:e=>new rg(e[0],e[1],e[2],e[3])};function tb(e){return{baseStep:.01,constraint:e,textProps:st.fromObject({formatter:e=>Math.abs(e)<.995?e.toFixed(2).replace("0.","."):e.toFixed(1),keyScale:.01,pointerScale:.01})}}function nb(e){return"number"==typeof(null==e?void 0:e.x)&&"number"==typeof(null==e?void 0:e.y)&&"number"==typeof(null==e?void 0:e.z)&&"number"==typeof(null==e?void 0:e.w)?new rg(e.x,e.y,e.z,e.w):new rg(0,0,0,1)}function ib(e){let n,i,s,r;const o=[e[2]];function a(t){e[4](t)}function l(t){e[5](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[0]&&(c.value=e[0]),void 0!==e[1]&&(c.ref=e[1]),n=new Ff({props:c}),F.push((()=>ae(n,"value",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[6]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=4&t?re(o,[oe(e[2])]):{};!i&&1&t&&(i=!0,r.value=e[0],G((()=>i=!1))),!s&&2&t&&(s=!0,r.ref=e[1],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function sb(e,n,i){const s=["value","wide"];let r,o=f(n,s),{value:a}=n,{wide:l}=n;return e.$$set=e=>{n=t(t({},n),v(e)),i(2,o=f(n,s)),"value"in e&&i(0,a=e.value),"wide"in e&&i(3,l=e.wide)},e.$$.update=()=>{10&e.$$.dirty&&r&&void 0!==l&&function(e){const t=r?.element.querySelector("div.tp-sldtxtv_t");e?t?.style.setProperty("display","none"):t?.style.removeProperty("display")}(l)},[a,r,o,l,function(e){a=e,i(0,a)},function(e){r=e,i(1,r)},function(t){z.call(this,e,t)}]}jn({id:"rotation",type:"input",accept(e,t){const n=Wt(t,(e=>({view:e.required.constant("rotation"),label:e.optional.string,picker:e.optional.custom(ss),expanded:e.optional.boolean,rotationMode:e.optional.constant("quaternion"),x:e.optional.custom(ns),y:e.optional.custom(ns),z:e.optional.custom(ns),w:e.optional.custom(ns)})));return n?{initialValue:nb(e),params:n}:null},binding:{reader:e=>e=>nb(e),constraint:({params:e})=>new qr({assembly:eb,components:[Xg("x"in e?e.x:void 0),Xg("y"in e?e.y:void 0),Xg("z"in e?e.z:void 0),Xg("w"in e?e.w:void 0)]}),writer:e=>(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}},controller({document:e,value:t,constraint:n,params:i,viewProps:s}){if(!(n instanceof qr))throw Ze.shouldNeverHappen();const r="expanded"in i?i.expanded:void 0,o="picker"in i?i.picker:void 0;return new Gg(e,{axes:[tb(n.components[0]),tb(n.components[1]),tb(n.components[2]),tb(n.components[3])],assembly:eb,rotationMode:"quaternion",expanded:null!=r&&r,parser:$t,pickerLayout:null!=o?o:"popup",value:t,viewProps:s})}});class rb extends pe{constructor(e){super(),he(this,e,sb,ib,o,{value:0,wide:3})}}class ob{constructor(e,t){this.step=e,this.edge=t}constrain(e){var t,n;return null!==(n=null===(t=this.edge)||void 0===t?void 0:t.constrain(e))&&void 0!==n?n:e}}const ab={fromComponents:e=>e[0],toComponents:e=>[e]},lb=vn("step");class cb{constructor(e,t){this.buttonsView_=t.buttonsView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(lb());const n=e.createElement("div");n.classList.add(lb("s")),n.appendChild(this.buttonsView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(lb("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const ub=vn("step");class hb{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ub()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.textContent="-",n.classList.add(ub("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.btnMinus=n;const i=e.createElement("button");i.textContent="+",i.classList.add(ub("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.btnPlus=i}}class pb{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.step=t.constraint?t.constraint.step:1,this.view=new hb(e,{value:this.value,viewProps:t.viewProps}),this.view.btnMinus.addEventListener("click",(()=>{var e;const t=null!==(e=this.value.rawValue)&&void 0!==e?e:0;this.value.setRawValue(t-this.step,{forceEmit:!0,last:!0})})),this.view.btnPlus.addEventListener("click",(()=>{var e;const t=null!==(e=this.value.rawValue)&&void 0!==e?e:0;this.value.setRawValue(t+this.step,{forceEmit:!0,last:!0})}))}}class db{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new pb(e,t);const n={constraint:t.constraint.edge,textProps:t.textProps};this.tc_=new Hr(e,{assembly:ab,axes:[n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new cb(e,{buttonsView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function mb(e){let n,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[5](t)}function l(t){e[6](t)}let c={};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[0]&&(c.value=e[0]),void 0!==e[1]&&(c.ref=e[1]),n=new ff({props:c}),F.push((()=>ae(n,"value",a))),F.push((()=>ae(n,"ref",l))),n.$on("change",e[7]),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,[t]){const r=12&t?re(o,[4&t&&{options:e[2]},8&t&&oe(e[3])]):{};!i&&1&t&&(i=!0,r.value=e[0],G((()=>i=!1))),!s&&2&t&&(s=!0,r.ref=e[1],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function vb(e){e.target?.dispatchEvent(new Event("change"))}function fb(e,n,i){const s=["value","live"];let r=f(n,s),{value:o}=n,{live:a=!0}=n;let l;function c(e,t=!1){const n=l?.controller.valueController.view.element.querySelector("input");n?.removeEventListener("input",vb),!t&&e&&n?.addEventListener("input",vb)}return j((()=>{c(a??!0,!0)})),e.$$set=e=>{n=t(t({},n),v(e)),i(3,r=f(n,s)),"value"in e&&i(0,o=e.value),"live"in e&&i(4,a=e.live)},e.$$.update=()=>{18&e.$$.dirty&&l&&void 0!==a&&c(a)},[o,l,{view:"text"},r,a,function(e){o=e,i(0,o)},function(e){l=e,i(1,l)},function(t){z.call(this,e,t)}]}jn({id:"input-stepper",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=Wt(t,(e=>Object.assign(Object.assign({},zt(e)),{view:e.required.constant("stepper")})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>"number"==typeof e?e:0,writer:e=>(e,t)=>{e.write(t)},constraint(e){const t=[],n=Ot(e.params);n&&t.push(n);const i=Tt(e.params);return i&&t.push(i),new ob(e.params.step?e.params.step:1,new vi(t))}},controller(e){const t=e.value,n=e.constraint;if(!(n instanceof ob))throw Ze.shouldNeverHappen();const i=st.fromObject(Bt(e.params,t.rawValue));return new db(e.document,{constraint:n,parser:$t,textProps:i,value:t,viewProps:e.viewProps})}});class gb extends pe{constructor(e){super(),he(this,e,fb,mb,o,{value:0,live:4})}}const bb=vn("txtr");class wb{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(bb()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.rows=t.rows,n.cols=22,n.placeholder=t.placeholder,n.classList.add(bb("i")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class _b{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.rows=t.rows,this.placeholder=t.placeholder,this.view=new wb(e,{value:this.value,viewProps:this.viewProps,rows:this.rows,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value;this.value.rawValue=t,this.view.refresh()}}function yb(e){let t,n;return t=new Dd({props:{theme:e[4],userCreatedPane:!1,$$slots:{default:[Pb]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),16399&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function xb(e){let t,n,i,s;const r=[Eb,$b],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function Cb(e){let t;const n=e[11].default,i=u(n,e,e[14],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||16384&s)&&d(i,n,e,e[14],t?p(n,e[14],s,null):m(e[14]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function Pb(e){let t,n,i;function s(t){e[13](t)}let r={disabled:e[2],title:e[1],userExpandable:e[3],$$slots:{default:[Cb]},$$scope:{ctx:e}};return void 0!==e[0]&&(r.expanded=e[0]),t=new Lb({props:r}),F.push((()=>ae(t,"expanded",s))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),i=!0},p(e,i){const s={};4&i&&(s.disabled=e[2]),2&i&&(s.title=e[1]),8&i&&(s.userExpandable=e[3]),16384&i&&(s.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,s.expanded=e[0],G((()=>n=!1))),t.$set(s)},i(e){i||(ne(t.$$.fragment,e),i=!0)},o(e){ie(t.$$.fragment,e),i=!1},d(e){ue(t,e)}}}function $b(e){let t,n,i,s;t=new No({props:{keysAdd:["containerUnitSize"],theme:e[4]}});let r=e[0]&&kb(e);return{c(){le(t.$$.fragment),n=C(),r&&r.c(),i=P()},m(e,o){ce(t,e,o),w(e,n,o),r&&r.m(e,o),w(e,i,o),s=!0},p(e,n){const s={};16&n&&(s.theme=e[4]),t.$set(s),e[0]?r?(r.p(e,n),1&n&&ne(r,1)):(r=kb(e),r.c(),ne(r,1),r.m(i.parentNode,i)):r&&(ee(),ie(r,1,1,(()=>{r=null})),te())},i(e){s||(ne(t.$$.fragment,e),ne(r),s=!0)},o(e){ie(t.$$.fragment,e),ie(r),s=!1},d(e){e&&(_(n),_(i)),ue(t,e),r&&r.d(e)}}}function Eb(e){let t,n;const i=e[11].default,s=u(i,e,e[14],null);return{c(){t=y("div"),s&&s.c(),E(t,"display","none")},m(i,r){w(i,t,r),s&&s.m(t,null),e[12](t),n=!0},p(e,t){s&&s.p&&(!n||16384&t)&&d(s,i,e,e[14],n?p(i,e[14],t,null):m(e[14]),null)},i(e){n||(ne(s,e),n=!0)},o(e){ie(s,e),n=!1},d(n){n&&_(t),s&&s.d(n),e[12](null)}}}function kb(e){let t,n,i;t=new No({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding"],theme:e[4]}});const s=e[11].default,r=u(s,e,e[14],null);return{c(){le(t.$$.fragment),n=C(),r&&r.c()},m(e,s){ce(t,e,s),w(e,n,s),r&&r.m(e,s),i=!0},p(e,n){const o={};16&n&&(o.theme=e[4]),t.$set(o),r&&r.p&&(!i||16384&n)&&d(r,s,e,e[14],i?p(s,e[14],n,null):m(e[14]),null)},i(e){i||(ne(t.$$.fragment,e),ne(r,e),i=!0)},o(e){ie(t.$$.fragment,e),ie(r,e),i=!1},d(e){e&&_(n),ue(t,e),r&&r.d(e)}}}function Vb(e){let t,n,i,s;const r=[xb,yb],o=[];return t=function(e){return e[6]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=P()},m(e,n){o[t].m(e,n),w(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[t].d(e)}}}function Sb(e,t,n){let i,s,{$$slots:r={},$$scope:o}=t,{title:a="Folder"}=t,{disabled:l=!1}=t,{expanded:u=!0}=t,{userExpandable:h=!0}=t,{theme:p}=t;const d=B("parentStore");c(e,d,(e=>n(10,i=e)));const m=me();c(e,m,(e=>n(15,s=e)));const v=B("userCreatedPane");let f,b,w;return O("parentStore",m),D((()=>{n(8,b=f?Ro(f):0)})),j((()=>{s?.dispose()})),e.$$set=e=>{"title"in e&&n(1,a=e.title),"disabled"in e&&n(2,l=e.disabled),"expanded"in e&&n(0,u=e.expanded),"userExpandable"in e&&n(3,h=e.userExpandable),"theme"in e&&n(4,p=e.theme),"$$scope"in e&&n(14,o=e.$$scope)},e.$$.update=()=>{514&e.$$.dirty&&w&&n(9,w.title=a,w),516&e.$$.dirty&&w&&n(9,w.disabled=l,w),513&e.$$.dirty&&w&&void 0!==u&&n(9,w.expanded=u,w),1792&e.$$.dirty&&i&&!w&&void 0!==b&&(g(m,s=i.addFolder({disabled:l,expanded:u,index:b,title:a}),s),s.on("fold",(()=>{n(0,u=s.expanded)})),n(9,w=s)),520&e.$$.dirty&&w&&Ko(h,w.element,"tp-fldv_b","tp-fldv_m"),1040&e.$$.dirty&&p&&i&&(v||!Fo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Folder> components for a theme prop.)")},[u,a,l,h,p,f,d,m,b,w,i,r,function(e){F[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},function(e){u=e,n(0,u)},o]}jn({id:"input-template",type:"input",accept(e,t){if("string"!=typeof e)return null;const n=Wt(t,(e=>({view:e.required.constant("textarea"),rows:e.optional.number,placeholder:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>"string"==typeof e?e:"",writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new _b(e.document,{value:e.value,rows:null!==(t=e.params.rows)&&void 0!==t?t:3,placeholder:null!==(n=e.params.placeholder)&&void 0!==n?n:"Enter text here",viewProps:e.viewProps})}});class Lb extends pe{constructor(e){super(),he(this,e,Sb,Vb,o,{title:1,disabled:2,expanded:0,userExpandable:3,theme:4})}}var Mb={local:{},session:{}};function Ab(e,t,n){var i,s,r,o,a,l,c,u;(null==n?void 0:n.onError)&&console.warn("onError has been deprecated. Please use onWriteError instead");const h=null!=(i=null==n?void 0:n.serializer)?i:JSON,p=null!=(s=null==n?void 0:n.storage)?s:"local",d=null==(r=null==n?void 0:n.syncTabs)||r,m=null!=(a=null!=(o=null==n?void 0:n.onWriteError)?o:null==n?void 0:n.onError)?a:t=>console.error(`Error when writing value from persisted store "${e}" to ${p}`,t),v=null!=(l=null==n?void 0:n.onParseError)?l:(t,n)=>console.error(`Error when parsing ${t?'"'+t+'"':"value"} from persisted store "${e}"`,n),f=null!=(c=null==n?void 0:n.beforeRead)?c:e=>e,g=null!=(u=null==n?void 0:n.beforeWrite)?u:e=>e,b="undefined"!=typeof window&&"undefined"!=typeof document,w=b?"local"===p?localStorage:sessionStorage:null;function _(e,t){const n=g(t);try{null==w||w.setItem(e,h.stringify(n))}catch(e){m(e)}}if(!Mb[p][e]){const n=me(function(){const n=null==w?void 0:w.getItem(e);if(null==n)return t;const i=function(e){try{return h.parse(e)}catch(t){v(e,t)}}(n);return null==i?t:f(i)}(),(t=>{if(b&&"local"==p&&d){const n=n=>{if(n.key===e&&n.newValue){let e;try{e=h.parse(n.newValue)}catch(e){return void v(n.newValue,e)}const i=f(e);t(i)}};return window.addEventListener("storage",n),()=>window.removeEventListener("storage",n)}})),{subscribe:i,set:s}=n;Mb[p][e]={set(t){s(t),_(e,t)},update:t=>n.update((n=>{const i=t(n);return _(e,i),i})),reset(){this.set(t)},subscribe:i}}return Mb[p][e]}const{window:Db}=b;function jb(e){let t;const n=e[25].default,i=u(n,e,e[32],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||2&s[1])&&d(i,n,e,e[32],t?p(n,e[32],s,null):m(e[32]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function Tb(e){let n,i,r,o,a,l,c,u,h=`${e[2]}px`,p=`${e[3]}px`,d=`${e[4]}px`;const m=[{scale:e[8]},{title:e[7]},qo(e[16],"position")];function v(t){e[26](t)}function f(t){e[27](t)}let g={$$slots:{default:[jb]},$$scope:{ctx:e}};for(let e=0;e<m.length;e+=1)g=t(g,m[e]);return void 0!==e[1]&&(g.expanded=e[1]),void 0!==e[0]&&(g.tpPane=e[0]),i=new Sd({props:g}),F.push((()=>ae(i,"expanded",v))),F.push((()=>ae(i,"tpPane",f))),{c(){var t,s,r;n=y("div"),le(i.$$.fragment),t=n,s="class",null==(r="draggable-container svelte-ex9mcb")?t.removeAttribute(s):t.getAttribute(s)!==r&&t.setAttribute(s,r),H((()=>e[28].call(n))),L(n,"not-collapsable",!e[6]),L(n,"not-resizable",!e[5]),E(n,"left",h),E(n,"padding",e[9]),E(n,"top",p),E(n,"width",d),E(n,"z-index",e[14])},m(t,s){w(t,n,s),ce(i,n,null),a=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=y("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const i=S();let s;return i?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=$(window,"message",(e=>{e.source===n.contentWindow&&t()}))):(n.src="about:blank",n.onload=()=>{s=$(n.contentWindow,"resize",t),t()}),function(e,t){e.appendChild(t)}(e,n),()=>{(i||s&&n.contentWindow)&&s(),_(n)}}(n,e[28].bind(n)),e[29](n),l=!0,c||(u=[$(Db,"resize",e[15]),$(n,"focus",e[30],!0),$(n,"pointerdown",e[31],!0)],c=!0)},p(e,t){const s=65920&t[0]?re(m,[256&t[0]&&{scale:e[8]},128&t[0]&&{title:e[7]},65536&t[0]&&oe(qo(e[16],"position"))]):{};2&t[1]&&(s.$$scope={dirty:t,ctx:e}),!r&&2&t[0]&&(r=!0,s.expanded=e[1],G((()=>r=!1))),!o&&1&t[0]&&(o=!0,s.tpPane=e[0],G((()=>o=!1))),i.$set(s),(!l||64&t[0])&&L(n,"not-collapsable",!e[6]),(!l||32&t[0])&&L(n,"not-resizable",!e[5]),4&t[0]&&h!==(h=`${e[2]}px`)&&E(n,"left",h),512&t[0]&&E(n,"padding",e[9]),8&t[0]&&p!==(p=`${e[3]}px`)&&E(n,"top",p),16&t[0]&&d!==(d=`${e[4]}px`)&&E(n,"width",d),16384&t[0]&&E(n,"z-index",e[14])},i(e){l||(ne(i.$$.fragment,e),l=!0)},o(e){ie(i.$$.fragment,e),l=!1},d(t){t&&_(n),ue(i),a(),e[29](null),c=!1,s(u)}}}const Ob="svelte-tweakpane-ui-draggable-position-",Bb="1",zb=[];let Nb=1e3;function Fb(n,i,s){let r;const o=["storePositionLocally","localStoreId","tpPane","expanded","collapseChildrenToFit","x","y","width","resizable","userExpandable","minWidth","maxWidth","title","scale","padding"];let l,c=f(i,o),u=e,h=()=>(u(),u=a(d,(e=>s(41,l=e))),d);n.$$.on_destroy.push((()=>u()));let p,d,{$$slots:m={},$$scope:g}=i,{storePositionLocally:b=!0}=i,{localStoreId:w=Bb}=i,{tpPane:_}=i;b&&h(d=Ab(`${Ob}${w}`,{x:0,y:0,expanded:!0,width:350}));let y,x,C,P,$,E,k,V,{expanded:S=l?.expanded??!0}=i,{collapseChildrenToFit:L=!1}=i,{x:M=l?.x??0}=i,{y:A=l?.y??0}=i,{width:T=l?.width??256}=i,{resizable:O=!0}=i,{userExpandable:B=!0}=i,{minWidth:z=200}=i,{maxWidth:N=600}=i,{title:I="Tweakpane"}=i,{scale:R=1}=i,{padding:q="0"}=i,U=Nb;function K(){if(void 0!==M&&void 0!==A&&void 0!==T){const e=k,t=V;s(23,k=document.documentElement.clientWidth),s(24,V=document.documentElement.clientHeight);const n=k-e,i=V-t,r=(M+T/2)/k,o=(A+$/2)/V;!Number.isNaN(n)&&r>=.5&&s(2,M+=n),!Number.isNaN(i)&&o>=.5&&s(3,A+=i)}}const H=e=>{e.stopPropagation()};let G=0,Y=0,X=0,W=0;const Z=e=>{e.stopPropagation(),e.target&&void 0!==T&&e.target===C&&s(4,T=T<r?r:z)},Q=e=>{void 0!==M&&void 0!==A&&0===e.button&&e.target instanceof HTMLElement&&(W=0,p=e,ie(),se(),e.target===x&&(x.style.cursor="grabbing"),s(11,y.style.transition="width 0s ease",y),e.target.setPointerCapture(e.pointerId),G=T??0,Y=M-e.pageX,X=A-e.pageY)},J=e=>{e.target instanceof HTMLElement&&void 0!==T&&void 0!==z&&void 0!==M&&void 0!==A&&(e.target===x?(W+=Math.hypot(e.movementX,e.movementY),s(2,M=e.pageX+Y),s(3,A=e.pageY+X)):e.target===C&&s(4,T=Io(e.pageX+Y+G-M,z,r)))},ee=()=>{if(p?.target instanceof HTMLElement){const{target:e}=p,t=e.getBoundingClientRect(),n=new PointerEvent("pointercancel",{bubbles:!0,clientX:t.left+t.width/2,clientY:t.top+t.height/2,composed:!0,pointerId:p.pointerId,pointerType:p.pointerType});e.dispatchEvent(n)}},te=e=>{e.stopImmediatePropagation(),e.target instanceof HTMLElement&&(e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId),e.target===x&&x.style.removeProperty("cursor"),y.style.removeProperty("transition"),"pointerup"===e.type&&e.target===x&&W<3&&B&&_&&s(0,_.expanded=!_.expanded,_),p=void 0,re(),ne())},ne=()=>{x.addEventListener("pointerdown",Q),C?.addEventListener("pointerdown",Q)},ie=()=>{x.removeEventListener("pointerdown",Q),C?.removeEventListener("pointerdown",Q)},se=()=>{window.addEventListener("blur",ee),x.addEventListener("pointermove",J),x.addEventListener("pointerup",te),x.addEventListener("pointercancel",te),C?.addEventListener("pointermove",J),C?.addEventListener("pointerup",te),C?.addEventListener("pointercancel",te)},re=()=>{window.removeEventListener("blur",ee),x.removeEventListener("pointermove",J),x.removeEventListener("pointerup",te),x.removeEventListener("pointercancel",te),C?.removeEventListener("pointermove",J),C?.removeEventListener("pointerup",te),C?.removeEventListener("pointercancel",te)},oe=e=>{e.preventDefault()};function ae(e,t=Number.MAX_SAFE_INTEGER){if(t>0)for(const i of e)if("expanded"in i)i.expanded&&(t--,i.expanded=!1),"children"in i&&ae(i.children,t);else{const e=(n=i,n.controller?.valueController?.view?.swatchElement?.querySelector("button")??n.controller?.valueController?.view?.buttonElement);e&&Go(i)&&(t--,e.click())}var n;
/*! Tweakpane 4.0.5 (c) 2016 cocopon, licensed under the MIT license. */}D((()=>{K(),_?y.append(_.element):console.warn("no tpPane in draggable"),y.addEventListener("touchmove",oe,{passive:!1});const e=y.querySelector(".tp-rotv_t");e&&(x=e,x.addEventListener("click",H),x.addEventListener("dblclick",Z),C=x.parentElement?.appendChild(document.createElement("div")),C&&(C.className="tp-custom-width-handle",C.textContent="",C.addEventListener("click",H),C.addEventListener("dblclick",Z)),ne())})),j((()=>{ie(),re(),x.removeEventListener("click",H),x.removeEventListener("dblclick",Z),C?.removeEventListener("click",H),C?.removeEventListener("dblclick",Z),y?.removeEventListener("touchmove",oe),void 0!==w&&zb.splice(zb.indexOf(w),1)}));return n.$$set=e=>{i=t(t({},i),v(e)),s(16,c=f(i,o)),"storePositionLocally"in e&&s(17,b=e.storePositionLocally),"localStoreId"in e&&s(18,w=e.localStoreId),"tpPane"in e&&s(0,_=e.tpPane),"expanded"in e&&s(1,S=e.expanded),"collapseChildrenToFit"in e&&s(19,L=e.collapseChildrenToFit),"x"in e&&s(2,M=e.x),"y"in e&&s(3,A=e.y),"width"in e&&s(4,T=e.width),"resizable"in e&&s(5,O=e.resizable),"userExpandable"in e&&s(6,B=e.userExpandable),"minWidth"in e&&s(20,z=e.minWidth),"maxWidth"in e&&s(21,N=e.maxWidth),"title"in e&&s(7,I=e.title),"scale"in e&&s(8,R=e.scale),"padding"in e&&s(9,q=e.padding),"$$scope"in e&&s(32,g=e.$$scope)},n.$$.update=()=>{var e;if(33&n.$$.dirty[0]&&_&&O&&(e=O,C&&(C.style.display=e?"block":"none")),6400&n.$$.dirty[0]&&y)if(void 0===R||1===R)s(22,$=P);else{const e=window.getComputedStyle(y),t=Number.parseFloat(e.paddingTop)+Number.parseFloat(e.paddingBottom);s(22,$=(P-t)*R+t)}33038365&n.$$.dirty[0]&&void 0!==$&&void 0!==k&&void 0!==V&&void 0!==M&&void 0!==A&&void 0!==T&&void 0!==z&&void 0!==N&&(L&&$>V&&_&&ae(_.children),s(2,M=Io(M,0,Math.max(0,k-E))),s(3,A=Io(A,0,Math.max(0,V-$))),k<E&&s(4,T=Math.max(z,Math.min(N,k)))),10485764&n.$$.dirty[0]&&(r=Math.min(N??600,k-(M??0))),393216&n.$$.dirty[0]&&b&&void 0!==w&&(zb.includes(w)&&console.warn('Multiple instances of <Pane> with `mode="draggable"` and `storePositionLocally=true` detected. You must explicitly set unique localStoreId property on each component to avoid collisions.'),zb.push(w)),393216&n.$$.dirty[0]&&!b&&w&&(zb.splice(zb.indexOf(w),1),localStorage.removeItem(`${Ob}${w}`)),262144&n.$$.dirty[0]&&w!==`${Ob}${w}`&&void 0!==w&&void 0!==d&&void 0!==S&&void 0!==T&&void 0!==M&&void 0!==A&&h(s(10,d=Ab(`${Ob}${w}`,{x:M,y:A,expanded:S,width:T}))),394270&n.$$.dirty[0]&&b&&void 0!==w&&void 0!==M&&void 0!==A&&void 0!==T&&void 0!==S&&d?.set({x:M,y:A,expanded:S,width:T})},[_,S,M,A,T,O,B,I,R,q,d,y,P,E,U,K,c,b,w,L,z,N,$,k,V,m,function(e){S=e,s(1,S)},function(e){_=e,s(0,_)},function(){P=this.clientHeight,E=this.clientWidth,s(12,P),s(13,E)},function(e){F[e?"unshift":"push"]((()=>{y=e,s(11,y)}))},()=>{s(14,U=++Nb)},()=>{s(14,U=++Nb)},g]}class Ib extends pe{constructor(e){super(),he(this,e,Fb,Tb,o,{storePositionLocally:17,localStoreId:18,tpPane:0,expanded:1,collapseChildrenToFit:19,x:2,y:3,width:4,resizable:5,userExpandable:6,minWidth:20,maxWidth:21,title:7,scale:8,padding:9},null,[-1,-1])}}function Rb(e){let t;const n=e[8].default,i=u(n,e,e[11],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||2048&s)&&d(i,n,e,e[11],t?p(n,e[11],s,null):m(e[11]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function qb(e){let n,i,s,r,o;const a=[{title:e[2]},qo(e[3],"position")];function l(t){e[9](t)}function c(t){e[10](t)}let u={$$slots:{default:[Rb]},$$scope:{ctx:e}};for(let e=0;e<a.length;e+=1)u=t(u,a[e]);return void 0!==e[1]&&(u.expanded=e[1]),void 0!==e[0]&&(u.tpPane=e[0]),i=new Sd({props:u}),F.push((()=>ae(i,"expanded",l))),F.push((()=>ae(i,"tpPane",c))),{c(){n=y("div"),le(i.$$.fragment),E(n,"display","none")},m(e,t){w(e,n,t),ce(i,n,null),o=!0},p(e,[t]){const n=12&t?re(a,[4&t&&{title:e[2]},8&t&&oe(qo(e[3],"position"))]):{};2048&t&&(n.$$scope={dirty:t,ctx:e}),!s&&2&t&&(s=!0,n.expanded=e[1],G((()=>s=!1))),!r&&1&t&&(r=!0,n.tpPane=e[0],G((()=>r=!1))),i.$set(n)},i(e){o||(ne(i.$$.fragment,e),o=!0)},o(e){ie(i.$$.fragment,e),o=!1},d(e){e&&_(n),ue(i)}}}function Ub(e,n,i){const s=["expanded","x","y","width","title","tpPane"];let r,o=f(n,s),{$$slots:a={},$$scope:l}=n,{expanded:c}=n,{x:u}=n,{y:h}=n,{width:p}=n,{title:d="Tweakpane"}=n,{tpPane:m}=n;return e.$$set=e=>{n=t(t({},n),v(e)),i(3,o=f(n,s)),"expanded"in e&&i(1,c=e.expanded),"x"in e&&i(4,u=e.x),"y"in e&&i(5,h=e.y),"width"in e&&i(6,p=e.width),"title"in e&&i(2,d=e.title),"tpPane"in e&&i(0,m=e.tpPane),"$$scope"in e&&i(11,l=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&m?.element.parentElement&&i(7,r=m.element.parentElement),144&e.$$.dirty&&void 0!==r&&void 0!==u&&(r.style.setProperty("right","unset"),r.style.setProperty("left",`${u}px`)),160&e.$$.dirty&&void 0!==r&&void 0!==h&&r.style.setProperty("top",`${h}px`),192&e.$$.dirty&&void 0!==r&&void 0!==p&&r.style.setProperty("width",`${p}px`)},[m,c,d,o,u,h,p,r,a,function(e){c=e,i(1,c)},function(e){m=e,i(0,m)},l]}class Kb extends pe{constructor(e){super(),he(this,e,Ub,qb,o,{expanded:1,x:4,y:5,width:6,title:2,tpPane:0})}}function Hb(e){let t,n,i,s;const r=[Wb,Xb],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function Gb(e){let n,i,s,r;const o=[{width:e[1]},qo(e[6],"storePositionLocally")];function a(t){e[13](t)}function l(t){e[14](t)}let c={$$slots:{default:[Qb]},$$scope:{ctx:e}};for(let e=0;e<o.length;e+=1)c=t(c,o[e]);return void 0!==e[0]&&(c.expanded=e[0]),void 0!==e[2]&&(c.tpPane=e[2]),n=new Dd({props:c}),F.push((()=>ae(n,"expanded",a))),F.push((()=>ae(n,"tpPane",l))),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),r=!0},p(e,t){const r=66&t?re(o,[2&t&&{width:e[1]},64&t&&oe(qo(e[6],"storePositionLocally"))]):{};524288&t&&(r.$$scope={dirty:t,ctx:e}),!i&&1&t&&(i=!0,r.expanded=e[0],G((()=>i=!1))),!s&&4&t&&(s=!0,r.tpPane=e[2],G((()=>s=!1))),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){ie(n.$$.fragment,e),r=!1},d(e){ue(n,e)}}}function Yb(e){let t,n,i,s;const r=[ew,Jb],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=P()},m(e,t){o[0].m(e,t),w(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),o[0].d(e)}}}function Xb(e){let t,n;const i=e[7].default,s=u(i,e,e[19],null);return{c(){t=y("div"),s&&s.c(),E(t,"display","none")},m(e,i){w(e,t,i),s&&s.m(t,null),n=!0},p(e,t){s&&s.p&&(!n||524288&t)&&d(s,i,e,e[19],n?p(i,e[19],t,null):m(e[19]),null)},i(e){n||(ne(s,e),n=!0)},o(e){ie(s,e),n=!1},d(e){e&&_(t),s&&s.d(e)}}}function Wb(e){let n,i,s,r,o,a;const l=[{width:e[1]},e[6]];function c(t){e[15](t)}function u(t){e[16](t)}function h(t){e[17](t)}function p(t){e[18](t)}let d={$$slots:{default:[Zb]},$$scope:{ctx:e}};for(let e=0;e<l.length;e+=1)d=t(d,l[e]);return void 0!==e[0]&&(d.expanded=e[0]),void 0!==e[2]&&(d.tpPane=e[2]),void 0!==e[3]&&(d.x=e[3]),void 0!==e[4]&&(d.y=e[4]),n=new Kb({props:d}),F.push((()=>ae(n,"expanded",c))),F.push((()=>ae(n,"tpPane",u))),F.push((()=>ae(n,"x",h))),F.push((()=>ae(n,"y",p))),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),a=!0},p(e,t){const a=66&t?re(l,[2&t&&{width:e[1]},64&t&&oe(e[6])]):{};524288&t&&(a.$$scope={dirty:t,ctx:e}),!i&&1&t&&(i=!0,a.expanded=e[0],G((()=>i=!1))),!s&&4&t&&(s=!0,a.tpPane=e[2],G((()=>s=!1))),!r&&8&t&&(r=!0,a.x=e[3],G((()=>r=!1))),!o&&16&t&&(o=!0,a.y=e[4],G((()=>o=!1))),n.$set(a)},i(e){a||(ne(n.$$.fragment,e),a=!0)},o(e){ie(n.$$.fragment,e),a=!1},d(e){ue(n,e)}}}function Zb(e){let t;const n=e[7].default,i=u(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&d(i,n,e,e[19],t?p(n,e[19],s,null):m(e[19]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function Qb(e){let t;const n=e[7].default,i=u(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&d(i,n,e,e[19],t?p(n,e[19],s,null):m(e[19]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function Jb(e){let t,n;const i=e[7].default,s=u(i,e,e[19],null);return{c(){t=y("div"),s&&s.c(),E(t,"display","none")},m(e,i){w(e,t,i),s&&s.m(t,null),n=!0},p(e,t){s&&s.p&&(!n||524288&t)&&d(s,i,e,e[19],n?p(i,e[19],t,null):m(e[19]),null)},i(e){n||(ne(s,e),n=!0)},o(e){ie(s,e),n=!1},d(e){e&&_(t),s&&s.d(e)}}}function ew(e){let n,i,s,r,o,a,l;const c=[e[6]];function u(t){e[8](t)}function h(t){e[9](t)}function p(t){e[10](t)}function d(t){e[11](t)}function m(t){e[12](t)}let v={$$slots:{default:[tw]},$$scope:{ctx:e}};for(let e=0;e<c.length;e+=1)v=t(v,c[e]);return void 0!==e[0]&&(v.expanded=e[0]),void 0!==e[2]&&(v.tpPane=e[2]),void 0!==e[1]&&(v.width=e[1]),void 0!==e[3]&&(v.x=e[3]),void 0!==e[4]&&(v.y=e[4]),n=new Ib({props:v}),F.push((()=>ae(n,"expanded",u))),F.push((()=>ae(n,"tpPane",h))),F.push((()=>ae(n,"width",p))),F.push((()=>ae(n,"x",d))),F.push((()=>ae(n,"y",m))),{c(){le(n.$$.fragment)},m(e,t){ce(n,e,t),l=!0},p(e,t){const l=64&t?re(c,[oe(e[6])]):{};524288&t&&(l.$$scope={dirty:t,ctx:e}),!i&&1&t&&(i=!0,l.expanded=e[0],G((()=>i=!1))),!s&&4&t&&(s=!0,l.tpPane=e[2],G((()=>s=!1))),!r&&2&t&&(r=!0,l.width=e[1],G((()=>r=!1))),!o&&8&t&&(o=!0,l.x=e[3],G((()=>o=!1))),!a&&16&t&&(a=!0,l.y=e[4],G((()=>a=!1))),n.$set(l)},i(e){l||(ne(n.$$.fragment,e),l=!0)},o(e){ie(n.$$.fragment,e),l=!1},d(e){ue(n,e)}}}function tw(e){let t;const n=e[7].default,i=u(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&d(i,n,e,e[19],t?p(n,e[19],s,null):m(e[19]),null)},i(e){t||(ne(i,e),t=!0)},o(e){ie(i,e),t=!1},d(e){i&&i.d(e)}}}function nw(e){let t,n,i,s;const r=[Yb,Gb,Hb],o=[];function a(e,t){return void 0===e[5]||"draggable"===e[5]?0:"inline"===e[5]?1:"fixed"===e[5]?2:-1}return~(t=a(e))&&(n=o[t]=r[t](e)),{c(){n&&n.c(),i=P()},m(e,n){~t&&o[t].m(e,n),w(e,i,n),s=!0},p(e,[s]){let l=t;t=a(e),t===l?~t&&o[t].p(e,s):(n&&(ee(),ie(o[l],1,1,(()=>{o[l]=null})),te()),~t?(n=o[t],n?n.p(e,s):(n=o[t]=r[t](e),n.c()),ne(n,1),n.m(i.parentNode,i)):n=null)},i(e){s||(ne(n),s=!0)},o(e){ie(n),s=!1},d(e){e&&_(i),~t&&o[t].d(e)}}}function iw(e,n,i){const s=["expanded","position","width","tpPane","x","y"];let r=f(n,s),{$$slots:o={},$$scope:a}=n,{expanded:l}=n,{position:c}=n,{width:u}=n,{tpPane:h}=n,{x:p}=n,{y:d}=n;var m;return m=()=>{"inline"!==n.position&&"fixed"!==n.position||(i(3,p=n.x),i(4,d=n.y),i(1,u=n.width),i(0,l=n.expanded))},A().$$.before_update.push(m),e.$$set=e=>{i(20,n=t(t({},n),v(e))),i(6,r=f(n,s)),"expanded"in e&&i(0,l=e.expanded),"position"in e&&i(5,c=e.position),"width"in e&&i(1,u=e.width),"tpPane"in e&&i(2,h=e.tpPane),"x"in e&&i(3,p=e.x),"y"in e&&i(4,d=e.y),"$$scope"in e&&i(19,a=e.$$scope)},n=v(n),[l,u,h,p,d,c,r,o,function(e){l=e,i(0,l)},function(e){h=e,i(2,h)},function(e){u=e,i(1,u)},function(e){p=e,i(3,p)},function(e){d=e,i(4,d)},function(e){l=e,i(0,l)},function(e){h=e,i(2,h)},function(e){l=e,i(0,l)},function(e){h=e,i(2,h)},function(e){p=e,i(3,p)},function(e){d=e,i(4,d)},a]}class sw extends pe{constructor(e){super(),he(this,e,iw,nw,o,{expanded:0,position:5,width:1,tpPane:2,x:3,y:4})}}class rw extends Ft{measureStart(e){this.controller.valueController.measureStart(e)}measureEnd(){return this.controller.valueController.measureEnd()}measure(e,t){this.controller.valueController.measure(e,t)}measureAsync(e,t){return this.controller.valueController.measureAsync(e,t)}get measureHandler(){return this.controller.valueController.measureHandler}set measureHandler(e){this.controller.valueController.measureHandler=e}}class ow extends yn{constructor(e,t){const n=t.valueController,i=new bn(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}class aw{measureStart(){const e=performance.now();return()=>performance.now()-e}}function lw(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class cw{constructor(){this.map=new Map,this.keySet=new Set}get(e){return this.map.get(e)}getOrCreate(e,t){this.keySet.has(e)||this.keySet.add(e);let n=this.map.get(e);return null==n&&(n=t(),this.map.set(e,n)),n}set(e,t){this.keySet.has(e)||this.keySet.add(e),this.map.set(e,t)}resetUsedSet(){this.keySet.clear()}vaporize(e){for(const[t,n]of this.map.entries())this.keySet.has(t)||(this.map.delete(t),null==e||e([t,n]))}}function uw(e){let t=0;return e.forEach((e=>t+=e)),t}class hw{constructor(e){this.__recalcForEach=0,this.__countUntilRecalc=0,this.__history=[],this.__index=0,this.__count=0,this.__cache=0,this.__length=e,this.__recalcForEach=e;for(let t=0;t<e;t++)this.__history[t]=0}get mean(){const e=Math.min(this.__count,this.__length);return 0===e?0:this.__cache/e}get recalcForEach(){return this.__recalcForEach}set recalcForEach(e){const t=e-this.__recalcForEach;this.__recalcForEach=e,this.__countUntilRecalc=Math.max(0,this.__countUntilRecalc+t)}reset(){this.__index=0,this.__count=0,this.__cache=0,this.__countUntilRecalc=0;for(let e=0;e<this.__length;e++)this.__history[e]=0}push(e){const t=this.__history[this.__index];this.__history[this.__index]=e,this.__count++,this.__index=(this.__index+1)%this.__length,0===this.__countUntilRecalc?this.recalc():(this.__countUntilRecalc--,this.__cache-=t,this.__cache+=e)}recalc(){this.__countUntilRecalc=this.__recalcForEach;const e=this.__history.slice(0,Math.min(this.__count,this.__length)).reduce(((e,t)=>e+t),0);this.__cache=e}}function pw(e,t){if("function"!=typeof t)return pw(e,(e=>e<t));const n=t;let i=0,s=e.length;for(;i<s;){const t=i+s>>1;n(e[t])?i=t+1:s=t}return i}class dw{constructor(e){this.__history=[],this.__sorted=[],this.__index=0,this.__length=e}get median(){return this.percentile(50)}percentile(e){return 0===this.__history.length?0:this.__sorted[Math.round(.01*e*(this.__history.length-1))]}reset(){this.__index=0,this.__history=[],this.__sorted=[]}push(e){const t=this.__history[this.__index];if(this.__history[this.__index]=e,this.__index=(this.__index+1)%this.__length,this.__sorted.length===this.__length){const e=pw(this.__sorted,t);this.__sorted.splice(e,1)}const n=pw(this.__sorted,e);this.__sorted.splice(n,0,e)}}function mw(e,t){let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}function vw(e){return Math.min(Math.max(e,0),1)}function fw(e){const t=[1,e=vw(e),e*e,e*e*e],n=[t[2],t[3]].map((e=>e*t[2])),i=[mw(t,[.13572138,4.6153926,-42.66032258,132.13108234])+mw(n,[-152.94239396,59.28637943]),mw(t,[.09140261,2.19418839,4.84296658,-14.18503333])+mw(n,[4.27729857,2.82956604]),mw(t,[.1066733,12.64194608,-60.58204836,110.36276771])+mw(n,[-89.90310912,27.34824973])];return`rgb( ${i.map((e=>256*vw(e))).join(", ")} )`}const gw=vn("profiler");class bw{constructor(e,t){this.targetDelta=t.targetDelta,this.deltaUnit=t.deltaUnit,this.fractionDigits=t.fractionDigits,this.calcMode=t.calcMode,this.element=e.createElement("div"),this.element.classList.add(gw()),t.viewProps.bindClassModifiers(this.element),this.svgRootElement_=e.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgRootElement_.classList.add(gw("root")),this.element.appendChild(this.svgRootElement_),this.entryContainerElement_=e.createElementNS("http://www.w3.org/2000/svg","g"),this.entryContainerElement_.classList.add(gw("container")),this.entryContainerElement_.setAttribute("transform","translate( 1, 1 )"),this.svgRootElement_.appendChild(this.entryContainerElement_),this.tooltipElement_=e.createElement("div"),this.tooltipElement_.classList.add(gw("tooltip")),this.tooltipElement_.style.display="none",this.element.appendChild(this.tooltipElement_),this.tooltipInsideElement_=e.createElement("div"),this.tooltipInsideElement_.classList.add(gw("tooltipinside")),this.tooltipElement_.appendChild(this.tooltipInsideElement_),this.labelElement_=e.createElement("div"),this.labelElement_.classList.add(gw("label")),this.labelElement_.textContent=this.deltaToDisplayDelta_(0),this.element.appendChild(this.labelElement_),this.entryElementCacheMap_=new cw,this.hoveringEntry_=null}update(e){const t=this.entryToDelta_(e);this.labelElement_.textContent=this.deltaToDisplayDelta_(t),this.entryElementCacheMap_.resetUsedSet();const n=160/Math.max(this.targetDelta,t);let i=0;for(const t of e.children){this.addEntry_(t,"",this.entryContainerElement_,n).setAttribute("transform",`translate( ${i}, 0 )`),i+=this.entryToDelta_(t)*n}this.entryElementCacheMap_.vaporize((([e,t])=>{t.remove(),this.hoveringEntry_===e&&(this.hoveringEntry_=null)})),this.updateTooltip_()}updateTooltip_(){const e=this.hoveringEntry_;if(e){const t=this.entryElementCacheMap_.get(e),n=null==t?void 0:t.getAttribute("data-delta"),i=`${e}\n${this.deltaToDisplayDelta_(parseFloat(null!=n?n:"0.0"))}`;this.tooltipElement_.style.display="block",this.tooltipInsideElement_.textContent=i}else this.tooltipElement_.style.display="none"}addEntry_(e,t,n,i){const s=`${t}/${e.name}`,r=this.entryElementCacheMap_.getOrCreate(s,(()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.classList.add(gw("entry")),n.appendChild(e),this.entryElementCacheMap_.set(s,e);const t=document.createElementNS("http://www.w3.org/2000/svg","rect");return t.classList.add(gw("entryrect")),e.appendChild(t),t.addEventListener("mouseenter",(()=>{this.hoveringEntry_=s,this.updateTooltip_()})),t.addEventListener("mouseleave",(()=>{this.hoveringEntry_=null,this.updateTooltip_()})),e})),o=this.entryToDelta_(e);r.setAttribute("data-delta",`${o}`);const a=r.childNodes[0];a.setAttribute("width",`${Math.max(.01,o*i-1)}px`),a.setAttribute("height","9px");const l=.15+.7*vw(o/this.targetDelta);if(a.setAttribute("fill",fw(l)),e.children.length>0){let t=0;e.children.forEach((e=>{this.addEntry_(e,s,r,i).setAttribute("transform",`translate( ${t}, 10 )`),t+=this.entryToDelta_(e)*i}))}return r}entryToDelta_(e){if("frame"===this.calcMode)return e.delta;if("mean"===this.calcMode)return e.deltaMean;if("median"===this.calcMode)return e.deltaMedian;throw new Error('Unreachable! calcMode must be one of "frame", "mean", or "median"')}deltaToDisplayDelta_(e){return`${e.toFixed(this.fractionDigits)} ${this.deltaUnit}`}}class ww{constructor(e,t){this.targetDelta=t.targetDelta,this.bufferSize=t.bufferSize,this.onTick_=this.onTick_.bind(this),this.ticker_=t.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.viewProps=t.viewProps,this.view=new bw(e,{targetDelta:this.targetDelta,deltaUnit:t.deltaUnit,fractionDigits:t.fractionDigits,calcMode:t.calcMode,viewProps:this.viewProps}),this.viewProps.handleDispose((()=>{this.ticker_.dispose()})),this.measureHandler=t.measureHandler,this.rootCalcCacheStack_=[this.createNewEntryCalcCache_()]}measureStart(e){const t=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1].childrenCacheMap.getOrCreate(e,(()=>this.createNewEntryCalcCache_()));var n;t.childrenCacheMap.resetUsedSet(),(n=t.childrenPromiseDelta).splice(0,n.length),this.rootCalcCacheStack_.push(t),t.measureEnd=this.measureHandler.measureStart()}measureEnd(){return lw(this,void 0,void 0,(function*(){const e=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1],t=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-2],n=Promise.resolve(e.measureEnd());e.measureEnd=null,t.childrenPromiseDelta.push(n),this.rootCalcCacheStack_.pop(),e.childrenCacheMap.vaporize();const i=uw(yield Promise.all(e.childrenPromiseDelta)),s=(yield n)-i;e.meanCalc.push(s),e.medianCalc.push(s),e.latest=s}))}measure(e,t){this.measureStart(e),t(),this.measureEnd()}measureAsync(e,t){return lw(this,void 0,void 0,(function*(){this.measureStart(e),yield t(),this.measureEnd()}))}renderEntry(){return this.renderEntryFromCalcCache_("",this.rootCalcCacheStack_[0])}renderEntryFromCalcCache_(e,t){const n=[];for(const e of t.childrenCacheMap.keySet){const i=t.childrenCacheMap.get(e);n.push(this.renderEntryFromCalcCache_(e,i))}const i=t.latest,s=t.meanCalc.mean,r=t.medianCalc.median;return{name:e,delta:i+uw(n.map((e=>e.delta))),deltaMean:s+uw(n.map((e=>e.deltaMean))),deltaMedian:r+uw(n.map((e=>e.deltaMedian))),selfDelta:i,selfDeltaMean:s,selfDeltaMedian:r,children:n}}onTick_(){this.view.update(this.renderEntry())}createNewEntryCalcCache_(){return{meanCalc:new hw(this.bufferSize),medianCalc:new dw(this.bufferSize),latest:0,measureEnd:null,childrenCacheMap:new cw,childrenPromiseDelta:[]}}}function _w(e,t){return 0===t?new di:new mi(e,null!=t?t:go.defaultInterval)}function yw(e){switch(e){case"frame":case"mean":case"median":return e;default:return}}function xw(e){return"object"==typeof e&&null!=e&&"measureStart"in e?e:void("object"==typeof e&&null!=e&&"measure"in e&&console.warn("The API of `ProfilerBladeDefaultMeasureHandler` has been changed in v0.4.0! Please define `measureStart` instead of `measure`. Fallback to the default measure handler."))}jn({id:"profiler",type:"blade",accept(e){const t=Wt(e,(e=>({view:e.required.constant("profiler"),targetDelta:e.optional.number,bufferSize:e.optional.number,deltaUnit:e.optional.string,fractionDigits:e.optional.number,calcMode:e.optional.custom(yw),label:e.optional.string,interval:e.optional.number,measureHandler:e.optional.custom(xw)})));return t?{params:t}:null},controller(e){var t,n,i,s,r,o,a;const l=null!==(t=e.params.interval)&&void 0!==t?t:500,c=null!==(n=e.params.targetDelta)&&void 0!==n?n:16.67,u=null!==(i=e.params.bufferSize)&&void 0!==i?i:30,h=null!==(s=e.params.deltaUnit)&&void 0!==s?s:"ms",p=null!==(r=e.params.fractionDigits)&&void 0!==r?r:2,d=null!==(o=e.params.calcMode)&&void 0!==o?o:"mean",m=null!==(a=e.params.measureHandler)&&void 0!==a?a:new aw;return new ow(e.document,{blade:e.blade,labelProps:st.fromObject({label:e.params.label}),valueController:new ww(e.document,{ticker:_w(e.document,l),targetDelta:c,bufferSize:u,deltaUnit:h,fractionDigits:p,calcMode:d,viewProps:e.viewProps,measureHandler:m})})},api:e=>e.controller instanceof ow?new rw(e.controller):null});class Cw{constructor(){this.drawer=e=>`L ${e[0]} ${e[1]}`}}class Pw{constructor(){this.drawer=(e,t,n)=>{const[i,s]=this.controlPoint(n[t-1],n[t-2],e),[r,o]=this.controlPoint(e,n[t-1],n[t+1],!0);return`C ${i},${s} ${r},${o} ${e[0]},${e[1]}`}}controlPoint(e,t,n,i){const s=t||e,r=n||e,o=r[0]-s[0],a=r[1]-s[1],l=.2*Math.sqrt(Math.pow(o,2)+Math.pow(a,2)),c=Math.atan2(a,o)+(i?Math.PI:0);return[e[0]+Math.cos(c)*l,e[1]+Math.sin(c)*l]}}const $w=vn("wfm");class Ew{constructor(e,t){switch(this.element=e.createElement("div"),this.element.classList.add($w()),t.viewProps.bindClassModifiers(this.element),this.svgElem=e.createElementNS(tn,"svg"),this.svgElem.classList.add($w("g")),this.element.appendChild(this.svgElem),this.pathElem=e.createElementNS(tn,"path"),this.svgElem.appendChild(this.pathElem),this.props=t.props,this.value=t.value,this.value.emitter.on("change",this.onValueChange_.bind(this)),this.props.get("lineStyle")){case"linear":default:this.lineDrawerProvider=new Cw;break;case"bezier":this.lineDrawerProvider=new Pw}this.refresh(),t.viewProps.handleDispose((()=>{this.value.emitter.off("change",this.onValueChange_)}))}svgPath(e,t){return e.reduce(((e,n,i,s)=>0===i?`M ${n[0]},${n[1]}`:`${e} ${t(n,i,s)}`),"")}refresh(){var e,t;const n=this.svgElem.getBoundingClientRect(),i=this.value.rawValue[0];if(i){const s=null!==(e=this.props.get("min"))&&void 0!==e?e:Math.min(...i)-1,r=null!==(t=this.props.get("max"))&&void 0!==t?t:Math.max(...i)+1,o=r-s,a=[],l=i.length-1,c=i.length>32?0:n.width/(i.length-1),u=o>50?0:n.height/o;this.element.style.backgroundSize=`${c}px ${u}px`,i.forEach(((e,t)=>{if(void 0===e)return;const i=Vt(t,0,l,0,n.width),o=Vt(e,s,r,n.height,0);a.push([Math.floor(i),Math.floor(o)])}));const h=this.svgPath(a,this.lineDrawerProvider.drawer);this.pathElem.setAttributeNS(null,"d",h)}}onValueChange_(){this.refresh()}}class kw{constructor(e,t){this.value=t.value,this.props=t.props,this.viewProps=t.viewProps,this.viewProps.handleDispose((()=>{})),this.view=new Ew(e,{value:this.value,viewProps:this.viewProps,props:this.props})}}function Vw(e){return"object"==typeof e&&"length"in e}function Sw(e,t,n){const i=e.slice();return i[73]=t[n],i}function Lw(e){let t,n,i,s,r,o,a,l;return t=new wf({props:{label:"Enable Masking",value:e[1].enableMasking}}),t.$on("change",e[17]),i=new rb({props:{label:"Radius",min:0,max:500,step:1,value:e[1].radius}}),i.$on("change",e[18]),r=new rb({props:{label:"Fade Out Duration",min:0,max:10,step:.01,value:e[1].fadeOutDuration}}),r.$on("change",e[19]),a=new rb({props:{label:"Auto Fade Duration",min:0,max:10,step:.01,value:e[1].autoFadeDuration}}),a.$on("change",e[20]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment)},m(e,c){ce(t,e,c),w(e,n,c),ce(i,e,c),w(e,s,c),ce(r,e,c),w(e,o,c),ce(a,e,c),l=!0},p(e,n){const s={};2&n[0]&&(s.value=e[1].enableMasking),t.$set(s);const o={};2&n[0]&&(o.value=e[1].radius),i.$set(o);const l={};2&n[0]&&(l.value=e[1].fadeOutDuration),r.$set(l);const c={};2&n[0]&&(c.value=e[1].autoFadeDuration),a.$set(c)},i(e){l||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),l=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),l=!1},d(e){e&&(_(n),_(s),_(o)),ue(t,e),ue(i,e),ue(r,e),ue(a,e)}}}function Mw(e){let t,n;return t=new Lb({props:{title:"PerlinNoise2DTime Params",$$slots:{default:[Aw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Aw(e){let t,n;return t=new rb({props:{label:"Seed",value:e[4].seed,min:0,max:4294967295,step:1}}),t.$on("change",e[24]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n[0]&&(i.value=e[4].seed),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Dw(e){let t,n;return t=new Lb({props:{title:"FlowNoise2DTime Params",$$slots:{default:[jw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};32&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function jw(e){let t,n,i,s,r,o;return t=new rb({props:{label:"Seed",value:e[5].seed,min:0,max:4294967295,step:1}}),t.$on("change",e[25]),i=new rb({props:{label:"Spin Variation",value:e[5].spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[26]),r=new rb({props:{label:"N",value:e[5].N,min:1,max:512,step:1}}),r.$on("change",e[27]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};32&n[0]&&(s.value=e[5].seed),t.$set(s);const o={};32&n[0]&&(o.value=e[5].spinVariation),i.$set(o);const a={};32&n[0]&&(a.value=e[5].N),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function Tw(e){let t,n;return t=new Lb({props:{title:"FBMNoise2DTime Params",$$slots:{default:[Iw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};224&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Ow(e){let t,n;return t=new Lb({props:{title:"Flow Base Params",$$slots:{default:[zw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};96&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Bw(e){let t,n;return t=new Lb({props:{title:"Perlin Base Params",$$slots:{default:[Nw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};192&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function zw(e){let t,n,i,s,r,o;return t=new rb({props:{label:"Flow Seed",value:e[6].flowBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[30]),i=new rb({props:{label:"Spin Variation",value:e[6].flowBaseParams.spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[31]),r=new rb({props:{label:"N",value:e[5].N,min:1,max:512,step:1}}),r.$on("change",e[32]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};64&n[0]&&(s.value=e[6].flowBaseParams.seed),t.$set(s);const o={};64&n[0]&&(o.value=e[6].flowBaseParams.spinVariation),i.$set(o);const a={};32&n[0]&&(a.value=e[5].N),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function Nw(e){let t,n;return t=new rb({props:{label:"Seed",value:e[6].perlinBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[29]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};64&n[0]&&(i.value=e[6].perlinBaseParams.seed),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Fw(e){let t,n,i,s,r,o;return t=new rb({props:{label:"Octaves",value:e[6].octaves,min:1,max:8,step:1}}),t.$on("change",e[33]),i=new rb({props:{label:"Persistence",value:e[6].persistence,min:0,max:1,step:.01}}),i.$on("change",e[34]),r=new rb({props:{label:"Lacunarity",value:e[6].lacunarity,min:1,max:4,step:.01}}),r.$on("change",e[35]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};64&n[0]&&(s.value=e[6].octaves),t.$set(s);const o={};64&n[0]&&(o.value=e[6].persistence),i.$set(o);const a={};64&n[0]&&(a.value=e[6].lacunarity),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function Iw(e){let t,n,i,s,r,o,a;t=new Uf({props:{label:"Base Type",value:e[6].baseType,options:[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"}]}}),t.$on("change",e[28]);const l=[Bw,Ow],c=[];function u(e,t){return"PerlinNoise2DTime"===e[6].baseType?0:"FlowNoise2DTime"===e[6].baseType?1:-1}return~(i=u(e))&&(s=c[i]=l[i](e)),o=new Lb({props:{title:"Octave Params",$$slots:{default:[Fw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=C(),s&&s.c(),r=C(),le(o.$$.fragment)},m(e,s){ce(t,e,s),w(e,n,s),~i&&c[i].m(e,s),w(e,r,s),ce(o,e,s),a=!0},p(e,n){const a={};64&n[0]&&(a.value=e[6].baseType),t.$set(a);let h=i;i=u(e),i===h?~i&&c[i].p(e,n):(s&&(ee(),ie(c[h],1,1,(()=>{c[h]=null})),te()),~i?(s=c[i],s?s.p(e,n):(s=c[i]=l[i](e),s.c()),ne(s,1),s.m(r.parentNode,r)):s=null);const p={};64&n[0]|16384&n[2]&&(p.$$scope={dirty:n,ctx:e}),o.$set(p)},i(e){a||(ne(t.$$.fragment,e),ne(s),ne(o.$$.fragment,e),a=!0)},o(e){ie(t.$$.fragment,e),ie(s),ie(o.$$.fragment,e),a=!1},d(e){e&&(_(n),_(r)),ue(t,e),~i&&c[i].d(e),ue(o,e)}}}function Rw(e){let t,n;return t=new Lb({props:{title:"TurbulenceNoise2DTime Params",$$slots:{default:[Yw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};160&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function qw(e){let t,n;return t=new Lb({props:{title:"Flow Base Params",$$slots:{default:[Kw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};160&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Uw(e){let t,n;return t=new Lb({props:{title:"Perlin Base Params",$$slots:{default:[Hw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Kw(e){let t,n,i,s,r,o;return t=new rb({props:{label:"Flow Seed",value:e[7].flowBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[38]),i=new rb({props:{label:"Spin Variation",value:e[7].flowBaseParams.spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[39]),r=new rb({props:{label:"N",value:e[5].N,min:1,max:512,step:1}}),r.$on("change",e[40]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};128&n[0]&&(s.value=e[7].flowBaseParams.seed),t.$set(s);const o={};128&n[0]&&(o.value=e[7].flowBaseParams.spinVariation),i.$set(o);const a={};32&n[0]&&(a.value=e[5].N),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function Hw(e){let t,n;return t=new rb({props:{label:"Seed",value:e[7].perlinBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[37]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]&&(i.value=e[7].perlinBaseParams.seed),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Gw(e){let t,n,i,s,r,o;return t=new rb({props:{label:"Octaves",value:e[7].octaves,min:1,max:8,step:1}}),t.$on("change",e[41]),i=new rb({props:{label:"Persistence",value:e[7].persistence,min:0,max:1,step:.01}}),i.$on("change",e[42]),r=new rb({props:{label:"Lacunarity",value:e[7].lacunarity,min:1,max:4,step:.01}}),r.$on("change",e[43]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};128&n[0]&&(s.value=e[7].octaves),t.$set(s);const o={};128&n[0]&&(o.value=e[7].persistence),i.$set(o);const a={};128&n[0]&&(a.value=e[7].lacunarity),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function Yw(e){let t,n,i,s,r,o,a;t=new Uf({props:{label:"Base Type",value:e[7].baseType,options:[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"}]}}),t.$on("change",e[36]);const l=[Uw,qw],c=[];function u(e,t){return"PerlinNoise2DTime"===e[7].baseType?0:"FlowNoise2DTime"===e[7].baseType?1:-1}return~(i=u(e))&&(s=c[i]=l[i](e)),o=new Lb({props:{title:"Octave Params",$$slots:{default:[Gw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=C(),s&&s.c(),r=C(),le(o.$$.fragment)},m(e,s){ce(t,e,s),w(e,n,s),~i&&c[i].m(e,s),w(e,r,s),ce(o,e,s),a=!0},p(e,n){const a={};128&n[0]&&(a.value=e[7].baseType),t.$set(a);let h=i;i=u(e),i===h?~i&&c[i].p(e,n):(s&&(ee(),ie(c[h],1,1,(()=>{c[h]=null})),te()),~i?(s=c[i],s?s.p(e,n):(s=c[i]=l[i](e),s.c()),ne(s,1),s.m(r.parentNode,r)):s=null);const p={};128&n[0]|16384&n[2]&&(p.$$scope={dirty:n,ctx:e}),o.$set(p)},i(e){a||(ne(t.$$.fragment,e),ne(s),ne(o.$$.fragment,e),a=!0)},o(e){ie(t.$$.fragment,e),ie(s),ie(o.$$.fragment,e),a=!1},d(e){e&&(_(n),_(r)),ue(t,e),~i&&c[i].d(e),ue(o,e)}}}function Xw(e){let t,n,i,s,r,o,a,l,c,u,h,p,d,m,v;function f(t){e[23](t)}t=new wf({props:{label:"Layer Enabled",value:e[2].enabled}}),t.$on("change",e[21]),i=new rb({props:{label:"Gain",min:0,max:20,step:.1,value:e[2].gain}}),i.$on("change",e[22]);let g={label:"Noise Type",options:Ae};void 0!==e[3]&&(g.value=e[3]),r=new Uf({props:g}),F.push((()=>ae(r,"value",f)));let b="PerlinNoise2DTime"===e[3]&&Mw(e),y="FlowNoise2DTime"===e[3]&&Dw(e),x="FBMNoise2DTime"===e[3]&&Tw(e),P="TurbulenceNoise2DTime"===e[3]&&Rw(e);return p=new rb({props:{label:"Frequency",min:.001,max:1,step:.001,value:e[8]}}),p.$on("change",e[44]),m=new rb({props:{label:"Noise Speed",min:.1,max:1e3,step:.1,value:e[9]}}),m.$on("change",e[45]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),a=C(),b&&b.c(),l=C(),y&&y.c(),c=C(),x&&x.c(),u=C(),P&&P.c(),h=C(),le(p.$$.fragment),d=C(),le(m.$$.fragment)},m(e,o){ce(t,e,o),w(e,n,o),ce(i,e,o),w(e,s,o),ce(r,e,o),w(e,a,o),b&&b.m(e,o),w(e,l,o),y&&y.m(e,o),w(e,c,o),x&&x.m(e,o),w(e,u,o),P&&P.m(e,o),w(e,h,o),ce(p,e,o),w(e,d,o),ce(m,e,o),v=!0},p(e,n){const s={};4&n[0]&&(s.value=e[2].enabled),t.$set(s);const a={};4&n[0]&&(a.value=e[2].gain),i.$set(a);const d={};!o&&8&n[0]&&(o=!0,d.value=e[3],G((()=>o=!1))),r.$set(d),"PerlinNoise2DTime"===e[3]?b?(b.p(e,n),8&n[0]&&ne(b,1)):(b=Mw(e),b.c(),ne(b,1),b.m(l.parentNode,l)):b&&(ee(),ie(b,1,1,(()=>{b=null})),te()),"FlowNoise2DTime"===e[3]?y?(y.p(e,n),8&n[0]&&ne(y,1)):(y=Dw(e),y.c(),ne(y,1),y.m(c.parentNode,c)):y&&(ee(),ie(y,1,1,(()=>{y=null})),te()),"FBMNoise2DTime"===e[3]?x?(x.p(e,n),8&n[0]&&ne(x,1)):(x=Tw(e),x.c(),ne(x,1),x.m(u.parentNode,u)):x&&(ee(),ie(x,1,1,(()=>{x=null})),te()),"TurbulenceNoise2DTime"===e[3]?P?(P.p(e,n),8&n[0]&&ne(P,1)):(P=Rw(e),P.c(),ne(P,1),P.m(h.parentNode,h)):P&&(ee(),ie(P,1,1,(()=>{P=null})),te());const v={};256&n[0]&&(v.value=e[8]),p.$set(v);const f={};512&n[0]&&(f.value=e[9]),m.$set(f)},i(e){v||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(b),ne(y),ne(x),ne(P),ne(p.$$.fragment,e),ne(m.$$.fragment,e),v=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(b),ie(y),ie(x),ie(P),ie(p.$$.fragment,e),ie(m.$$.fragment,e),v=!1},d(e){e&&(_(n),_(s),_(a),_(l),_(c),_(u),_(h),_(d)),ue(t,e),ue(i,e),ue(r,e),b&&b.d(e),y&&y.d(e),x&&x.d(e),P&&P.d(e),ue(p,e),ue(m,e)}}}function Ww(e){let t,n,i,s,r,o,a,l,c,u;return t=new gb({props:{value:e[11].text,label:"Text"}}),t.$on("change",e[48]),i=new Uf({props:{value:e[11].fontFamily,label:"Font Family",options:Ne}}),i.$on("change",e[49]),r=new wf({props:{value:e[11].fontSizeAuto,label:"Auto Font Size"}}),r.$on("change",e[50]),a=new rb({props:{value:e[11].padding,label:"Padding for Auto Font Size",min:0,max:100,step:1,disabled:!e[11].fontSizeAuto}}),a.$on("change",e[51]),c=new rb({props:{value:e[11].fontSizeManual,label:"Manual Font Size",min:8,max:200,step:1,disabled:e[11].fontSizeAuto}}),c.$on("change",e[52]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment),l=C(),le(c.$$.fragment)},m(e,h){ce(t,e,h),w(e,n,h),ce(i,e,h),w(e,s,h),ce(r,e,h),w(e,o,h),ce(a,e,h),w(e,l,h),ce(c,e,h),u=!0},p(e,n){const s={};2048&n[0]&&(s.value=e[11].text),t.$set(s);const o={};2048&n[0]&&(o.value=e[11].fontFamily),i.$set(o);const l={};2048&n[0]&&(l.value=e[11].fontSizeAuto),r.$set(l);const u={};2048&n[0]&&(u.value=e[11].padding),2048&n[0]&&(u.disabled=!e[11].fontSizeAuto),a.$set(u);const h={};2048&n[0]&&(h.value=e[11].fontSizeManual),2048&n[0]&&(h.disabled=e[11].fontSizeAuto),c.$set(h)},i(e){u||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),ne(c.$$.fragment,e),u=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),ie(c.$$.fragment,e),u=!1},d(e){e&&(_(n),_(s),_(o),_(l)),ue(t,e),ue(i,e),ue(r,e),ue(a,e),ue(c,e)}}}function Zw(e){let t,n;return t=new Ef({props:{value:e[11].gradientColors[e[73]],label:e[14][e[73]]}}),t.$on("change",(function(...t){return e[57](e[73],...t)})),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(n,i){e=n;const s={};2048&i[0]&&(s.value=e[11].gradientColors[e[73]]),t.$set(s)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Qw(e){let t,n,i,s,r,o,a,l,c,u;t=new Ef({props:{value:e[11].fillStyle,label:"Fill Style"}}),t.$on("change",e[53]),i=new Ef({props:{value:e[11].strokeStyle,label:"Stroke Style"}}),i.$on("change",e[54]),r=new rb({props:{value:e[11].strokeWidth,label:"Stroke Width",min:0,max:10,step:1}}),r.$on("change",e[55]),a=new wf({props:{value:e[11].useGradient,label:"Use Gradient Fill"}}),a.$on("change",e[56]);let h=se([0,1,2]),p=[];for(let t=0;t<3;t+=1)p[t]=Zw(Sw(e,h,t));const d=e=>ie(p[e],1,1,(()=>{p[e]=null}));return{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment),l=C();for(let e=0;e<3;e+=1)p[e].c();c=P()},m(e,h){ce(t,e,h),w(e,n,h),ce(i,e,h),w(e,s,h),ce(r,e,h),w(e,o,h),ce(a,e,h),w(e,l,h);for(let t=0;t<3;t+=1)p[t]&&p[t].m(e,h);w(e,c,h),u=!0},p(e,n){const s={};2048&n[0]&&(s.value=e[11].fillStyle),t.$set(s);const o={};2048&n[0]&&(o.value=e[11].strokeStyle),i.$set(o);const l={};2048&n[0]&&(l.value=e[11].strokeWidth),r.$set(l);const u={};if(2048&n[0]&&(u.value=e[11].useGradient),a.$set(u),18432&n[0]){let t;for(h=se([0,1,2]),t=0;t<3;t+=1){const i=Sw(e,h,t);p[t]?(p[t].p(i,n),ne(p[t],1)):(p[t]=Zw(i),p[t].c(),ne(p[t],1),p[t].m(c.parentNode,c))}for(ee(),t=3;t<3;t+=1)d(t);te()}},i(e){if(!u){ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e);for(let e=0;e<3;e+=1)ne(p[e]);u=!0}},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),p=p.filter(Boolean);for(let e=0;e<3;e+=1)ie(p[e]);u=!1},d(e){e&&(_(n),_(s),_(o),_(l),_(c)),ue(t,e),ue(i,e),ue(r,e),ue(a,e),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(p,e)}}}function Jw(e){let t,n,i,s,r,o,a,l;return t=new Ef({props:{value:e[11].glowColor,label:"Glow Color"}}),t.$on("change",e[58]),i=new rb({props:{value:e[11].glowSize,label:"Glow Size",min:0,max:100,step:1}}),i.$on("change",e[59]),r=new rb({props:{value:e[11].shadowOffsetX,label:"Shadow Offset X",min:-50,max:50,step:1}}),r.$on("change",e[60]),a=new rb({props:{value:e[11].shadowOffsetY,label:"Shadow Offset Y",min:-50,max:50,step:1}}),a.$on("change",e[61]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment)},m(e,c){ce(t,e,c),w(e,n,c),ce(i,e,c),w(e,s,c),ce(r,e,c),w(e,o,c),ce(a,e,c),l=!0},p(e,n){const s={};2048&n[0]&&(s.value=e[11].glowColor),t.$set(s);const o={};2048&n[0]&&(o.value=e[11].glowSize),i.$set(o);const l={};2048&n[0]&&(l.value=e[11].shadowOffsetX),r.$set(l);const c={};2048&n[0]&&(c.value=e[11].shadowOffsetY),a.$set(c)},i(e){l||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),l=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),l=!1},d(e){e&&(_(n),_(s),_(o)),ue(t,e),ue(i,e),ue(r,e),ue(a,e)}}}function e_(e){let t,n;return t=new rb({props:{value:e[11].blurAmount,label:"Blur Amount",min:0,max:50,step:1}}),t.$on("change",e[62]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};2048&n[0]&&(i.value=e[11].blurAmount),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function t_(e){let t,n,i,s;return t=new Ef({props:{value:e[11].innerGlowColor,label:"Inner Glow Color"}}),t.$on("change",e[63]),i=new rb({props:{value:e[11].innerGlowBlur,label:"Inner Glow Blur",min:0,max:50,step:1}}),i.$on("change",e[64]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment)},m(e,r){ce(t,e,r),w(e,n,r),ce(i,e,r),s=!0},p(e,n){const s={};2048&n[0]&&(s.value=e[11].innerGlowColor),t.$set(s);const r={};2048&n[0]&&(r.value=e[11].innerGlowBlur),i.$set(r)},i(e){s||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),s=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),s=!1},d(e){e&&_(n),ue(t,e),ue(i,e)}}}function n_(e){let t,n;return t=new Ef({props:{value:e[11].backgroundColor,label:"Background Color"}}),t.$on("change",e[65]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};2048&n[0]&&(i.value=e[11].backgroundColor),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function i_(e){let t,n,i,s,r,o,a,l,c,u,h,p,d,m,v,f;return t=new wf({props:{label:"Layer Enabled",value:e[10].enabled}}),t.$on("change",e[46]),i=new rb({props:{label:"Gain",min:0,max:20,step:.1,value:e[10].gain}}),i.$on("change",e[47]),r=new Lb({props:{title:"Text",expanded:!1,$$slots:{default:[Ww]},$$scope:{ctx:e}}}),a=new Lb({props:{title:"Fill & Stroke",expanded:!1,$$slots:{default:[Qw]},$$scope:{ctx:e}}}),c=new Lb({props:{title:"Glow & Shadow",expanded:!1,$$slots:{default:[Jw]},$$scope:{ctx:e}}}),h=new Lb({props:{title:"Blur",expanded:!1,$$slots:{default:[e_]},$$scope:{ctx:e}}}),d=new Lb({props:{title:"Inner Glow",expanded:!1,$$slots:{default:[t_]},$$scope:{ctx:e}}}),v=new Lb({props:{title:"Background",expanded:!1,$$slots:{default:[n_]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment),l=C(),le(c.$$.fragment),u=C(),le(h.$$.fragment),p=C(),le(d.$$.fragment),m=C(),le(v.$$.fragment)},m(e,g){ce(t,e,g),w(e,n,g),ce(i,e,g),w(e,s,g),ce(r,e,g),w(e,o,g),ce(a,e,g),w(e,l,g),ce(c,e,g),w(e,u,g),ce(h,e,g),w(e,p,g),ce(d,e,g),w(e,m,g),ce(v,e,g),f=!0},p(e,n){const s={};1024&n[0]&&(s.value=e[10].enabled),t.$set(s);const o={};1024&n[0]&&(o.value=e[10].gain),i.$set(o);const l={};2048&n[0]|16384&n[2]&&(l.$$scope={dirty:n,ctx:e}),r.$set(l);const u={};2048&n[0]|16384&n[2]&&(u.$$scope={dirty:n,ctx:e}),a.$set(u);const p={};2048&n[0]|16384&n[2]&&(p.$$scope={dirty:n,ctx:e}),c.$set(p);const m={};2048&n[0]|16384&n[2]&&(m.$$scope={dirty:n,ctx:e}),h.$set(m);const f={};2048&n[0]|16384&n[2]&&(f.$$scope={dirty:n,ctx:e}),d.$set(f);const g={};2048&n[0]|16384&n[2]&&(g.$$scope={dirty:n,ctx:e}),v.$set(g)},i(e){f||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),ne(c.$$.fragment,e),ne(h.$$.fragment,e),ne(d.$$.fragment,e),ne(v.$$.fragment,e),f=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),ie(c.$$.fragment,e),ie(h.$$.fragment,e),ie(d.$$.fragment,e),ie(v.$$.fragment,e),f=!1},d(e){e&&(_(n),_(s),_(o),_(l),_(u),_(p),_(m)),ue(t,e),ue(i,e),ue(r,e),ue(a,e),ue(c,e),ue(h,e),ue(d,e),ue(v,e)}}}function s_(e){let t,n,i,s,r,o,a,l;return t=new Uf({props:{label:"Blending Mode",value:e[0].blendingMode,options:Ce}}),t.$on("change",e[16]),i=new Lb({props:{title:"Mask Layer",expanded:!1,$$slots:{default:[Lw]},$$scope:{ctx:e}}}),r=new Lb({props:{title:"Noise Layer",expanded:!1,$$slots:{default:[Xw]},$$scope:{ctx:e}}}),a=new Lb({props:{title:"Typography Layer",expanded:!1,$$slots:{default:[i_]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment)},m(e,c){ce(t,e,c),w(e,n,c),ce(i,e,c),w(e,s,c),ce(r,e,c),w(e,o,c),ce(a,e,c),l=!0},p(e,n){const s={};1&n[0]&&(s.value=e[0].blendingMode),t.$set(s);const o={};2&n[0]|16384&n[2]&&(o.$$scope={dirty:n,ctx:e}),i.$set(o);const l={};1020&n[0]|16384&n[2]&&(l.$$scope={dirty:n,ctx:e}),r.$set(l);const c={};3072&n[0]|16384&n[2]&&(c.$$scope={dirty:n,ctx:e}),a.$set(c)},i(e){l||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),l=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),l=!1},d(e){e&&(_(n),_(s),_(o)),ue(t,e),ue(i,e),ue(r,e),ue(a,e)}}}function r_(e){let t,n,i,s,r,o;return t=new wf({props:{label:"Animating",value:e[12].animating}}),t.$on("change",e[66]),i=new rb({props:{label:"Speed",min:.1,max:20,step:.1,value:e[12].speed}}),i.$on("change",e[67]),r=new wf({props:{label:"Use advanceTime()",value:e[12].useAdvanceTime}}),r.$on("change",e[68]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment)},m(e,a){ce(t,e,a),w(e,n,a),ce(i,e,a),w(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};4096&n[0]&&(s.value=e[12].animating),t.$set(s);const o={};4096&n[0]&&(o.value=e[12].speed),i.$set(o);const a={};4096&n[0]&&(a.value=e[12].useAdvanceTime),r.$set(a)},i(e){o||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),o=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!1},d(e){e&&(_(n),_(s)),ue(t,e),ue(i,e),ue(r,e)}}}function o_(e){let t,n,i,s;return t=new Uf({props:{label:"Color Mode",value:e[13].colorMode,options:qe}}),t.$on("change",e[69]),i=new wf({props:{label:"Show Scale Visualization",value:e[13].showScaleVisualization}}),i.$on("change",e[70]),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment)},m(e,r){ce(t,e,r),w(e,n,r),ce(i,e,r),s=!0},p(e,n){const s={};8192&n[0]&&(s.value=e[13].colorMode),t.$set(s);const r={};8192&n[0]&&(r.value=e[13].showScaleVisualization),i.$set(r)},i(e){s||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),s=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),s=!1},d(e){e&&_(n),ue(t,e),ue(i,e)}}}function a_(t){let n,i,s,r,o,a;return n=new Id({props:{title:"Pause"}}),n.$on("click",t[71]),s=new Id({props:{title:"Resume"}}),s.$on("click",t[72]),o=new Id({props:{title:"Reset to Defaults"}}),o.$on("click",t[15]),{c(){le(n.$$.fragment),i=C(),le(s.$$.fragment),r=C(),le(o.$$.fragment)},m(e,t){ce(n,e,t),w(e,i,t),ce(s,e,t),w(e,r,t),ce(o,e,t),a=!0},p:e,i(e){a||(ne(n.$$.fragment,e),ne(s.$$.fragment,e),ne(o.$$.fragment,e),a=!0)},o(e){ie(n.$$.fragment,e),ie(s.$$.fragment,e),ie(o.$$.fragment,e),a=!1},d(e){e&&(_(i),_(r)),ue(n,e),ue(s,e),ue(o,e)}}}function l_(e){let t,n,i,s,r,o,a,l;return t=new Lb({props:{title:"Layer Stack",$$slots:{default:[s_]},$$scope:{ctx:e}}}),i=new Lb({props:{title:"Simulation",$$slots:{default:[r_]},$$scope:{ctx:e}}}),r=new Lb({props:{title:"UI",$$slots:{default:[o_]},$$scope:{ctx:e}}}),a=new Lb({props:{title:"Actions",expanded:!0,$$slots:{default:[a_]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=C(),le(i.$$.fragment),s=C(),le(r.$$.fragment),o=C(),le(a.$$.fragment)},m(e,c){ce(t,e,c),w(e,n,c),ce(i,e,c),w(e,s,c),ce(r,e,c),w(e,o,c),ce(a,e,c),l=!0},p(e,n){const s={};4095&n[0]|16384&n[2]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};4096&n[0]|16384&n[2]&&(o.$$scope={dirty:n,ctx:e}),i.$set(o);const l={};8192&n[0]|16384&n[2]&&(l.$$scope={dirty:n,ctx:e}),r.$set(l);const c={};16384&n[2]&&(c.$$scope={dirty:n,ctx:e}),a.$set(c)},i(e){l||(ne(t.$$.fragment,e),ne(i.$$.fragment,e),ne(r.$$.fragment,e),ne(a.$$.fragment,e),l=!0)},o(e){ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),l=!1},d(e){e&&(_(n),_(s),_(o)),ue(t,e),ue(i,e),ue(r,e),ue(a,e)}}}function c_(e){let t,n;return t=new sw({props:{$$slots:{default:[l_]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16383&n[0]|16384&n[2]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){ie(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function u_(e,t,n){let i,s,r,o,a,l,u,h,p,d,m,v,f,g;c(e,Pe,(e=>n(0,i=e))),c(e,$e,(e=>n(1,s=e))),c(e,Ee,(e=>n(2,r=e))),c(e,De,(e=>n(3,o=e))),c(e,ke,(e=>n(4,a=e))),c(e,Ve,(e=>n(5,l=e))),c(e,Se,(e=>n(6,u=e))),c(e,Le,(e=>n(7,h=e))),c(e,je,(e=>n(8,p=e))),c(e,Te,(e=>n(9,d=e))),c(e,Be,(e=>n(10,m=e))),c(e,Fe,(e=>n(11,v=e))),c(e,Ie,(e=>n(12,f=e))),c(e,Ue,(e=>n(13,g=e)));return[i,s,r,o,a,l,u,h,p,d,m,v,f,g,["Gradient Color 1","Gradient Color 2","Gradient Color 3"],function(){Pe.reset(),$e.reset(),Ee.reset(),De.reset(),ke.reset(),Ve.reset(),Se.reset(),Le.reset(),je.reset(),Te.reset(),Be.reset(),Fe.reset(),Ie.reset(),Ue.reset()},e=>Pe.setBlendingMode(e.detail.value),e=>$e.setEnableMasking(e.detail.value),e=>$e.setRadius(e.detail.value),e=>$e.setFadeOutDuration(e.detail.value),e=>$e.setAutoFadeDuration(e.detail.value),e=>Ee.setEnabled(e.detail.value),e=>Ee.setGain(e.detail.value),function(e){o=e,De.set(o)},e=>ke.setSeed(e.detail.value),e=>Ve.setSeed(e.detail.value),e=>Ve.setSpinVariation(e.detail.value),e=>Ve.setN(e.detail.value),e=>Se.setBaseType(e.detail.value),e=>Se.setPerlinBaseParams({...h.perlinBaseParams,seed:e.detail.value}),e=>Se.setFlowBaseParams({...u.flowBaseParams,seed:e.detail.value}),e=>Se.setFlowBaseParams({...u.flowBaseParams,spinVariation:e.detail.value}),e=>Ve.setN(e.detail.value),e=>Se.setOctaves(e.detail.value),e=>Se.setPersistence(e.detail.value),e=>Se.setLacunarity(e.detail.value),e=>Le.setBaseType(e.detail.value),e=>Le.setPerlinBaseParams({...h.perlinBaseParams,seed:e.detail.value}),e=>Le.setFlowBaseParams({...h.flowBaseParams,seed:e.detail.value}),e=>Le.setFlowBaseParams({...h.flowBaseParams,spinVariation:e.detail.value}),e=>Ve.setN(e.detail.value),e=>Le.setOctaves(e.detail.value),e=>Le.setPersistence(e.detail.value),e=>Le.setLacunarity(e.detail.value),e=>je.set(e.detail.value),e=>Te.set(e.detail.value),e=>Be.setEnabled(e.detail.value),e=>Be.setGain(e.detail.value),e=>Fe.setText(e.detail.value),e=>Fe.setFontFamily(e.detail.value),e=>Fe.setFontSizeAuto(e.detail.value),e=>Fe.setPadding(e.detail.value),e=>Fe.setFontSizeManual(e.detail.value),e=>Fe.setFillStyle(e.detail.value),e=>Fe.setStrokeStyle(e.detail.value),e=>Fe.setStrokeWidth(e.detail.value),e=>Fe.setUseGradient(e.detail.value),(e,t)=>{const n=[...v.gradientColors];n[e]=t.detail.value,Fe.setGradientColors(n)},e=>Fe.setGlowColor(e.detail.value),e=>Fe.setGlowSize(e.detail.value),e=>Fe.setShadowOffsetX(e.detail.value),e=>Fe.setShadowOffsetY(e.detail.value),e=>Fe.setBlurAmount(e.detail.value),e=>Fe.setInnerGlowColor(e.detail.value),e=>Fe.setInnerGlowBlur(e.detail.value),e=>Fe.setBackgroundColor(e.detail.value),e=>Ie.setAnimating(e.detail.value),e=>Ie.setSpeed(e.detail.value),e=>Ie.setUseAdvanceTime(e.detail.value),e=>Ue.setColorMode(e.detail.value),e=>Ue.setShowScaleVisualization(e.detail.value),()=>Ie.update((e=>({...e,animating:!1}))),()=>Ie.update((e=>({...e,animating:!0})))]}jn({id:"monitor-waveform",type:"monitor",accept:(e,t)=>{if(!Vw(e))return null;const n=Wt(t,(e=>({max:e.optional.number,min:e.optional.number,style:e.optional.custom((e=>"linear"===e||"bezier"===e?e:void 0)),view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>function(e){return"view"in e&&"waveform"===e.view}(e)?64:1,reader:e=>e=>Vw(e)?e:[]},controller:e=>{var t,n,i;return new kw(e.document,{props:st.fromObject({max:null!==(t="max"in e.params?e.params.max:null)&&void 0!==t?t:null,min:null!==(n="min"in e.params?e.params.min:null)&&void 0!==n?n:null,lineStyle:null!==(i="style"in e.params?e.params.style:null)&&void 0!==i?i:"linear"}),value:e.value,viewProps:e.viewProps})}});new class extends pe{constructor(e){super(),he(this,e,u_,c_,o,{},null,[-1,-1,-1])}}({target:document.getElementById("ui")});const h_=new class{constructor(e,{width:t=100,height:n=10,maxFps:i=60}={}){this.canvas=e,this.ctx=e.getContext("2d"),this.width=t,this.height=n,this.maxFps=i,this.history=new Array(t).fill(0),this.frameCount=0,this.lastFpsUpdate=performance.now(),this.currentFps=0}record(e=performance.now()){this.frameCount++;const t=e-this.lastFpsUpdate;t>=200&&(this.currentFps=this.frameCount/(t/1e3),this.frameCount=0,this.lastFpsUpdate=e,this.history.push(this.currentFps),this.history.length>this.width&&this.history.shift())}draw(){this.ctx.clearRect(0,0,this.width,this.height),this.ctx.fillStyle="#4af";for(let e=0;e<this.history.length;e++){const t=Math.round(this.history[e]/this.maxFps*this.height);this.ctx.fillRect(e,this.height-t,1,t)}this.ctx.fillStyle="#fff",this.ctx.font="8px monospace",this.ctx.fillText(Math.round(this.currentFps)+" fps",2,8)}}(document.getElementById("fps-canvas")),p_=document.getElementById("demo-canvas"),d_=p_.getContext("2d"),m_=p_.width,v_=p_.height,f_={t:0},g_=new ImageData(m_,v_),b_=new class{enabled=!0;gain=1;imageData;width;height;channel;constructor(e,t,n,i=!0,s=1,r=3){this.imageData=e,this.width=t,this.height=n,this.enabled=i,this.gain=s,this.channel=r}getValue(e,t){if(!this.enabled)throw new Error("getValue() called on disabled layer");const n=Math.floor(e),i=Math.floor(t);if(n>=0&&n<this.width&&i>=0&&i<this.height){const e=4*(i*this.width+n);return this.imageData.data[e+this.channel]/255*this.gain}return 0}get time(){}setTime(e){if(!this.enabled)throw new Error("setTime() called on disabled layer")}advanceTime(e){if(!this.enabled)throw new Error("advanceTime() called on disabled layer")}}(g_,m_,v_,!0,1,2);let w_=!0;function __(){if(w_){const e={...l(Be),...l(Fe)};if(b_.enabled=e.enabled,b_.enabled){b_.gain=e.gain;const t=ve.create(m_,v_).text(e.text).fontFamily(e.fontFamily).padding(e.padding).fillStyle(e.fillStyle).strokeStyle(e.strokeStyle,e.strokeWidth).background(e.backgroundColor).glow(e.glowColor,e.glowSize,e.shadowOffsetX,e.shadowOffsetY).blur(e.blurAmount).innerGlow(e.innerGlowColor,e.innerGlowBlur);e.useGradient&&t.gradient(e.gradientColors),e.fontSizeAuto?t.autoFontSize(!0):t.fontSize(e.fontSizeManual);const n=t.toCanvas();b_.imageData=n.getContext("2d").getImageData(0,0,m_,v_)}w_=!1}}Be.subscribe((e=>{w_=!0})),Fe.subscribe((e=>{w_=!0})),__();let y_={};Oe.subscribe((e=>{y_=e}));let x_=null,C_=null;const P_={PerlinNoise2DTime:we,FlowNoise2DTime:_e,FBMNoise2DTime:class{#F=0;constructor(e,{octaves:t=4,persistence:n=.5,lacunarity:i=2}={}){this.baseNoise=e,this.octaves=t,this.persistence=n,this.lacunarity=i}get time(){return this.#F}setTime(e){this.#F=e,this.baseNoise.setTime(e)}advanceTime(e){this.#F+=e,this.baseNoise.advanceTime(e)}getValue(e,t){let n=0,i=1,s=0,r=1;for(let o=0;o<this.octaves;o++)this.baseNoise.setTime(this.time*r),n+=this.baseNoise.getValue(e*r,t*r)*i,s+=i,i*=this.persistence,r*=this.lacunarity;return this.baseNoise.setTime(this.time),n/s}},TurbulenceNoise2DTime:class{#F=0;constructor(e,{octaves:t=4,persistence:n=.5,lacunarity:i=2}={}){this.baseNoise=e,this.octaves=t,this.persistence=n,this.lacunarity=i}get time(){return this.#F}setTime(e){this.#F=e,this.baseNoise.setTime(e)}advanceTime(e){this.#F+=e,this.baseNoise.advanceTime(e)}getValue(e,t){let n=0,i=1,s=0,r=1;for(let o=0;o<this.octaves;o++)this.baseNoise.setTime(this.time*r),n+=Math.abs(this.baseNoise.getValue(e*r,t*r))*i,s+=i,i*=this.persistence,r*=this.lacunarity;return this.baseNoise.setTime(this.time),n/s}}};function $_(){const e=l(De),t=Me[e];if(!t)throw new Error("Unknown noise type: "+e);const n=l(t),i=y_;if(i[e]||i.noiseType){let t;if("FBMNoise2DTime"===e||"TurbulenceNoise2DTime"===e){const i=n.baseType,s="PerlinNoise2DTime"===i?n.perlinBaseParams:n.flowBaseParams,r=P_[i];if(!r)throw new Error("Unknown base noise type: "+i);const o=new r(s),a={octaves:n.octaves,persistence:n.persistence,lacunarity:n.lacunarity};t=new(0,P_[e])(o,a)}else{t=new(0,P_[e])(n)}t.setTime(f_.t*l(Te)*l(je)),x_=t,Oe.clear(e),Oe.clear("noiseType")}}$_();const E_=l(Ee),k_=l(je),V_=l(Te);C_=new class{enabled=!0;gain=1;noise;frequency;noiseSpeed;constructor(e,t=!0,n=1,i=1,s=1){this.noise=e,this.enabled=t,this.gain=n,this.frequency=i,this.noiseSpeed=s}getValue(e,t){if(!this.enabled)throw new Error("getValue() called on disabled layer");return.5*this.gain*(this.noise.getValue(e*this.frequency,t*this.frequency)+1)}get time(){return this.noise.time}setTime(e){if(!this.enabled)throw new Error("setTime() called on disabled layer");this.noise.setTime(e*this.noiseSpeed*this.frequency)}advanceTime(e){if(!this.enabled)throw new Error("advanceTime() called on disabled layer");this.noise.advanceTime(e*this.noiseSpeed*this.frequency)}}(x_,E_.enabled,E_.gain,k_,V_);const S_=l($e),L_=new class{layer;enableMasking=!0;radius;fadeOutDuration;autoFadeDuration;#U=null;#K=null;#H=!1;#G=!1;#Y=null;#X=null;#W=null;constructor(e,t){this.layer=e,this.enableMasking=void 0===t.enableMasking||t.enableMasking,this.radius=t.radius,this.fadeOutDuration=t.fadeOutDuration,this.autoFadeDuration=t.autoFadeDuration}get enabled(){return this.layer.enabled}set enabled(e){this.layer.enabled=e}activate(e,t){this.enableMasking&&(this.#H=!0,this.#G=!1,this.#U=e,this.#K=t,this.#Y=null,this.#X=this.#W,console.log(`[Mask] Activated at (${e}, ${t}) t=${this.#W}`))}update(e,t){this.enableMasking&&(this.#U=e,this.#K=t,this.#X=this.#W,!this.#H||this.#G?(this.#H=!0,this.#G=!1,this.#Y=null,console.log(`[Mask] Reactivated by update at (${e}, ${t}) t=${this.#W}`)):console.log(`[Mask] Updated at (${e}, ${t}) t=${this.#W}`))}deactivate(){this.enableMasking&&this.#H&&!this.#G&&(this.#G=!0,this.#Y=this.#W,console.log(`[Mask] Deactivated at t=${this.#W}, starting fade out`))}#Z(){this.enableMasking&&this.#H&&!this.#G&&null!==this.#X&&this.#W-this.#X>this.autoFadeDuration&&this.deactivate(this.#W)}get time(){return this.layer.time}setTime(e){this.layer.setTime(e),this.#W=e,this.#Z()}advanceTime(e){this.layer.advanceTime(e),this.#W=(this.#W??0)+e,this.#Z()}getValue(e,t){if(!this.enableMasking)return this.layer.getValue(e,t);if(null===this.#W||null===this.#U||null===this.#K||!this.#H)return 0;let n=1;if(this.#G){const e=this.#W-this.#Y;if(e>this.fadeOutDuration)return this.#U=null,this.#K=null,this.#Y=null,this.#X=null,this.#H=!1,this.#G=!1,0;n=xe(1,0,e/this.fadeOutDuration)}const i=e-this.#U,s=t-this.#K,r=Math.sqrt(i*i+s*s);if(r>this.radius)return 0;const o=xe(1,0,r/this.radius);return this.layer.getValue(e,t)*n*o}}(C_,{enableMasking:S_.enableMasking,radius:S_.radius,fadeOutDuration:S_.fadeOutDuration,autoFadeDuration:S_.autoFadeDuration});{let e=!1;p_.addEventListener("mousedown",(t=>{if(!L_.enabled||!L_.enableMasking)return;e=!0;const n=p_.getBoundingClientRect(),i=(t.clientX-n.left)/n.width*m_,s=(t.clientY-n.top)/n.height*v_;L_.activate(i,s,f_.t)})),p_.addEventListener("mousemove",(t=>{if(!L_.enabled||!L_.enableMasking)return;if(!e)return;const n=p_.getBoundingClientRect(),i=(t.clientX-n.left)/n.width*m_,s=(t.clientY-n.top)/n.height*v_;L_.update(i,s,f_.t)})),p_.addEventListener("mouseup",(t=>{L_.enabled&&L_.enableMasking&&e&&(e=!1,L_.deactivate(f_.t))}))}const M_={additive:function(e,t,n){let i=0,s=!1;for(const r of e)r.enabled&&(i+=r.getValue(t,n),s=!0);return s?i:0},subtract:function(e,t,n){let i=null;for(const s of e)if(s.enabled){const e=s.getValue(t,n);null===i?i=e:i-=e}return null!==i?i:0},multiply:ye,screen:function(e,t,n){let i=1,s=!1;for(const r of e)r.enabled&&(i*=1-r.getValue(t,n),s=!0);return s?1-i:0},overlay:function(e,t,n){let i=null;for(const s of e)if(s.enabled){const e=s.getValue(t,n);i=null===i?e:i<.5?2*i*e:1-2*(1-i)*(1-e)}return null!==i?i:0},max:function(e,t,n){let i=!1,s=0;for(const r of e)if(r.enabled){const e=r.getValue(t,n);(!i||e>s)&&(s=e,i=!0)}return i?s:0},min:function(e,t,n){let i=!1,s=0;for(const r of e)if(r.enabled){const e=r.getValue(t,n);(!i||e<s)&&(s=e,i=!0)}return i?s:0},average:function(e,t,n){let i=0,s=0;for(const r of e)r.enabled&&(i+=r.getValue(t,n),s++);return s>0?i/s:0}},A_=new class{constructor(e=[],t){this.layers=e,this.blendingFunc=t||ye,this.time=0}getValue(e,t){return this.blendingFunc(this.layers,e,t)}setTime(e){this.time=e;for(const t of this.layers)t.enabled&&t.setTime(e)}advanceTime(e){this.time+=e;for(const t of this.layers)t.enabled&&t.advanceTime(e)}}([b_,L_],M_[l(Pe).blendingMode]);function D_(){const e=l(je),t=l(Te),{colorMode:n,showScaleVisualization:i}=l(Ue),s=d_.createImageData(m_,v_);let r=0;for(let e=0;e<v_;e++)for(let t=0;t<m_;t++){const i=A_.getValue(t,e);let o,a,l;switch(n){case Re.HEIGHT_BANDS:{const e=12;o=a=l=Math.floor(i*e)%2==0?0:255;break}case Re.GEOGRAPHICAL:i>=.5?(o=0,a=Math.floor(255*i),l=0):(o=0,a=0,l=Math.floor(255*i));break;case Re.GRAYSCALE:default:o=a=l=Math.floor(255*i);break}s.data[r++]=o,s.data[r++]=a,s.data[r++]=l,s.data[r++]=255}if(d_.putImageData(s,0,0),i){!function(e,t,n,i,s="rgba(255, 255, 255, 0.2)"){const r=1/i;e.strokeStyle=s,e.lineWidth=1,e.beginPath();for(let i=0;i<t;i+=r)e.moveTo(i,0),e.lineTo(i,n);for(let i=0;i<n;i+=r)e.moveTo(0,i),e.lineTo(t,i);e.stroke()}(d_,m_,v_,e);const n=1/(e*t),i=f_.t%n/n;!function(e,t,n,i,s,r="rgba(255, 0, 0, 0.5)"){e.beginPath(),e.moveTo(t,n),e.arc(t,n,i,-Math.PI/2,-Math.PI/2+2*Math.PI*s),e.closePath(),e.fillStyle=r,e.fill()}(d_,m_-50,50,20,i)}h_.draw()}let j_=performance.now();!function e(t=performance.now()){const n=(t-j_)/1e3;j_=t,function(e,t){A_.blendingFunc=M_[l(Pe).blendingMode],__(),$_();const n=l(Ee);C_.noise=x_,C_.enabled=n.enabled,C_.gain=n.gain,C_.frequency=l(je),C_.noiseSpeed=l(Te),C_.enabled&&C_.setTime(f_.t);const i=l($e);L_.enableMasking=i.enableMasking,L_.radius=i.radius,L_.fadeOutDuration=i.fadeOutDuration,L_.autoFadeDuration=i.autoFadeDuration;const{animating:s,speed:r,useAdvanceTime:o}=l(Ie),a=l(je),c=l(Te);if(s){const e=f_.t+t*r;f_.t=e,o?A_.advanceTime(t*r*c*a):A_.setTime(e*c*a)}h_.record(e)}(t,n),D_(),requestAnimationFrame(e)}()}();
//# sourceMappingURL=bundle.js.map
