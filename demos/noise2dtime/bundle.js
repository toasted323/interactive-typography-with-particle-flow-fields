var Noise2DTime=function(e){"use strict";function t(){}function n(e,t){for(const n in t)e[n]=t[n];return e}function i(e){return e()}function s(){return Object.create(null)}function r(e){e.forEach(i)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,...n){if(null==e){for(const e of n)e(void 0);return t}const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function c(e){let t;return l(e,(e=>t=e))(),t}function h(e,t,n){e.$$.on_destroy.push(l(t,n))}function p(e,t,n,i){if(e){const s=u(e,t,n,i);return e[0](s)}}function u(e,t,i,s){return e[1]&&s?n(i.ctx.slice(),e[1](s(t))):i.ctx}function d(e,t,n,i){if(e[2]&&i){const s=e[2](i(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|s[i];return e}return t.dirty|s}return t.dirty}function m(e,t,n,i,s,r){if(s){const o=u(t,n,i,r);e.p(o,s)}}function v(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function f(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function g(e,t){const n={};t=new Set(t);for(const i in e)t.has(i)||"$"===i[0]||(n[i]=e[i]);return n}function b(e,t,n){return e.set(n),t}const w="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function _(e,t,n){e.insertBefore(t,n||null)}function y(e){e.parentNode&&e.parentNode.removeChild(e)}function x(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function P(){return C(" ")}function E(){return C("")}function $(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function k(e,t,n,i){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}let V,L;function M(){if(void 0===V){V=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){V=!0}}return V}function S(e,t,n){e.classList.toggle(t,!!n)}function A(e){L=e}function D(){if(!L)throw new Error("Function called outside component initialization");return L}function j(e){D().$$.on_mount.push(e)}function T(e){D().$$.on_destroy.push(e)}function N(){const e=D();return(t,n,{cancelable:i=!1}={})=>{const s=e.$$.callbacks[t];if(s){const r=function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:i})}(t,n,{cancelable:i});return s.slice().forEach((t=>{t.call(e,r)})),!r.defaultPrevented}return!0}}function B(e,t){return D().$$.context.set(e,t),t}function O(e){return D().$$.context.get(e)}function z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const F=[],I=[];let R=[];const q=[],U=Promise.resolve();let K=!1;function H(){K||(K=!0,U.then(Z))}function G(e){R.push(e)}function Y(e){q.push(e)}const X=new Set;let W=0;function Z(){if(0!==W)return;const e=L;do{try{for(;W<F.length;){const e=F[W];W++,A(e),Q(e.$$)}}catch(e){throw F.length=0,W=0,e}for(A(null),F.length=0,W=0;I.length;)I.pop()();for(let e=0;e<R.length;e+=1){const t=R[e];X.has(t)||(X.add(t),t())}R.length=0}while(F.length);for(;q.length;)q.pop()();K=!1,X.clear(),A(e)}function Q(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(G)}}const J=new Set;let ee;function te(){ee={r:0,c:[],p:ee}}function ne(){ee.r||r(ee.c),ee=ee.p}function ie(e,t){e&&e.i&&(J.delete(e),e.i(t))}function se(e,t,n,i){if(e&&e.o){if(J.has(e))return;J.add(e),ee.c.push((()=>{J.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}function re(e,t){const n={},i={},s={$$scope:1};let r=e.length;for(;r--;){const o=e[r],a=t[r];if(a){for(const e in o)e in a||(i[e]=1);for(const e in a)s[e]||(n[e]=a[e],s[e]=1);e[r]=a}else for(const e in o)s[e]=1}for(const e in i)e in n||(n[e]=void 0);return n}function oe(e){return"object"==typeof e&&null!==e?e:{}}function ae(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function le(e){e&&e.c()}function ce(e,t,n){const{fragment:s,after_update:a}=e.$$;s&&s.m(t,n),G((()=>{const t=e.$$.on_mount.map(i).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),a.forEach(G)}function he(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];R.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),R=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function pe(e,n,i,o,a,l,c=null,h=[-1]){const p=L;A(e);const u=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:a,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(p?p.$$.context:[])),callbacks:s(),dirty:h,skip_bound:!1,root:n.target||p.$$.root};c&&c(u.root);let d=!1;if(u.ctx=i?i(e,n.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return u.ctx&&a(u.ctx[t],u.ctx[t]=s)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](s),d&&function(e,t){-1===e.$$.dirty[0]&&(F.push(e),H(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],u.update(),d=!0,r(u.before_update),u.fragment=!!o&&o(u.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);u.fragment&&u.fragment.l(e),e.forEach(y)}else u.fragment&&u.fragment.c();n.intro&&ie(e.$$.fragment),ce(e,n.target,n.anchor),Z()}A(p)}class ue{$$=void 0;$$set=void 0;$destroy(){he(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const de=[];function me(e,n=t){let i;const s=new Set;function r(t){if(a(e,t)&&(e=t,i)){const t=!de.length;for(const t of s)t[1](),de.push(t,e);if(t){for(let e=0;e<de.length;e+=2)de[e][0](de[e+1]);de.length=0}}}function o(t){r(t(e))}return{set:r,update:o,subscribe:function(a,l=t){const c=[a,l];return s.add(c),1===s.size&&(i=n(r,o)||t),a(e),()=>{s.delete(c),0===s.size&&i&&(i(),i=null)}}}}class ve{constructor(e,t,n){this.x=e,this.y=t,this.z=n}dot3(e,t,n){return this.x*e+this.y*t+this.z*n}}const fe=[new ve(1,1,0),new ve(-1,1,0),new ve(1,-1,0),new ve(-1,-1,0),new ve(1,0,1),new ve(-1,0,1),new ve(1,0,-1),new ve(-1,0,-1),new ve(0,1,1),new ve(0,-1,1),new ve(0,1,-1),new ve(0,-1,-1)],ge=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class be{#e=new Array(512);#t=new Array(512);#n=0;constructor(e={}){const{seed:t}=e;this.#i(t)}get time(){return this.#n}setTime(e){this.#n=e}advanceTime(e){this.#n+=e}getValue(e,t){return this.#s(e,t,this.#n)}#i(e){let t=this.#e,n=this.#t,i=ge.slice();if("number"!=typeof e)for(let e=0;e<512;e++)t[e]=i[255&e],n[e]=fe[t[e]%12];else{let s=(e=>()=>(e=1664525*e+1013904223&4294967295)>>>0)(e);for(let e=255;e>0;e--){let t=s()%(e+1);[i[e],i[t]]=[i[t],i[e]]}for(let e=0;e<512;e++)t[e]=i[255&e],n[e]=fe[t[e]%12]}}static#r(e){return e*e*e*(e*(6*e-15)+10)}static#o(e,t,n){return e+n*(t-e)}#s(e,t,n){let i=Math.floor(e),s=Math.floor(t),r=Math.floor(n);e-=i,t-=s,n-=r,i&=255,s&=255,r&=255;const o=this.#t,a=this.#e,l=o[i+a[s+a[r]]].dot3(e,t,n),c=o[i+a[s+a[r+1]]].dot3(e,t,n-1),h=o[i+a[s+1+a[r]]].dot3(e,t-1,n),p=o[i+a[s+1+a[r+1]]].dot3(e,t-1,n-1),u=o[i+1+a[s+a[r]]].dot3(e-1,t,n),d=o[i+1+a[s+a[r+1]]].dot3(e-1,t,n-1),m=o[i+1+a[s+1+a[r]]].dot3(e-1,t-1,n),v=o[i+1+a[s+1+a[r+1]]].dot3(e-1,t-1,n-1),f=be.#r(e),g=be.#r(t),b=be.#r(n);return be.#o(be.#o(be.#o(l,u,f),be.#o(c,d,f),b),be.#o(be.#o(h,m,f),be.#o(p,v,f),b),g)}}class we{static#o(e,t,n){return(1-n)*e+n*t}static#a(e){return e<0?0:e>1?1:e*e*e*(10+e*(6*e-15))}static#l(e){let t=2654435769*(12345391^e);return t^=t<<6^t>>>26,t=2654435769*t>>>0,t+=t<<5^t>>>12,t>>>0}static#c(e,t,n){return t+(n-t)*(we.#l(e)/4294967295)}#h;#p;#e;#u;#d;#m;#v;#f;#g;constructor(e={}){let{seed:t=171717,spinVariation:n=.2,N:i=128}=e;this.#h=i,this.#p=new Array(this.#h),this.#e=new Array(this.#h),this.#u=new Array(this.#h),this.#d=new Array(this.#h),this.#m=new Array(this.#h),this.#v=new Array(this.#h);for(let e=0;e<this.#h;++e)this.#m[e]=1,this.#v[e]=0;this.#f=0,this.#g=0;for(let e=0;e<this.#h;++e){const t=e/this.#h*2*Math.PI,n={x:Math.cos(t),y:Math.sin(t)};this.#p[e]={x:n.x,y:n.y},this.#e[e]=e}this.#b(t),t+=this.#h;for(let e=0;e<this.#h;++e){this.#u[e]={x:this.#p[e].x,y:this.#p[e].y};const i=we.#c(t++,1-.5*n,1+.5*n);this.#d[e]=2*Math.PI*i}}#b(e){for(let t=1;t<this.#h;++t){const n=we.#l(e++)%(t+1),i=this.#e[n];this.#e[n]=this.#e[t],this.#e[t]=i}}#w(e,t){const n=this.#h,i=(e%n+n)%n,s=(t%n+n)%n;return this.#e[(this.#e[i]+s)%n]}get time(){return this.#f}setTime(e){if(e!==this.#f){this.#f=e;for(let t=0;t<this.#h;++t){const n=this.#d[t]*e,i=Math.cos(n),s=Math.sin(n),r=this.#u[t];this.#p[t].x=i*r.x+s*r.y,this.#p[t].y=-s*r.x+i*r.y}}}advanceTime(e){this.#f+=e;for(let t=0;t<this.#h;++t){e!==this.#g&&(this.#m[t]=Math.cos(this.#d[t]*e),this.#v[t]=Math.sin(this.#d[t]*e));const n=this.#p[t].x,i=this.#p[t].y;this.#p[t].x=n*this.#m[t]+i*this.#v[t],this.#p[t].y=-n*this.#v[t]+i*this.#m[t]}this.#g=e}getValue(e,t){const n=Math.floor(e),i=Math.floor(t),s=n,r=i,o=this.#p[this.#w(s,r)],a=this.#p[this.#w(s+1,r)],l=this.#p[this.#w(s,r+1)],c=this.#p[this.#w(s+1,r+1)],h=e-n,p=t-i,u=we.#a(h),d=we.#a(p),m=h*o.x+p*o.y,v=(h-1)*a.x+p*a.y,f=h*l.x+(p-1)*l.y,g=(h-1)*c.x+(p-1)*c.y,b=we.#o(m,v,u),w=we.#o(f,g,u);return we.#o(b,w,d)/.7071}}const _e=function(){const e={seed:0},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSeed:e=>i((t=>({...t,seed:e}))),reset:()=>n({...e})}}();const ye=function(){const e={seed:0,spinVariation:.2,N:128},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSeed:e=>i((t=>({...t,seed:e}))),setSpinVariation:e=>i((t=>({...t,spinVariation:e}))),setN:e=>i((t=>({...t,N:e}))),reset:()=>n({...e})}}();const xe=function(){const e={baseType:"PerlinNoise2DTime",perlinBaseParams:{seed:0},flowBaseParams:{seed:0,spinVariation:.2,N:128},octaves:4,persistence:.5,lacunarity:2},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setBaseType:e=>i((t=>({...t,baseType:e}))),setPerlinBaseParams:e=>i((t=>({...t,perlinBaseParams:e}))),setFlowBaseParams:e=>i((t=>({...t,flowBaseParams:e}))),setOctaves:e=>i((t=>({...t,octaves:e}))),setPersistence:e=>i((t=>({...t,persistence:e}))),setLacunarity:e=>i((t=>({...t,lacunarity:e}))),reset:()=>n({...e})}}();const Ce=function(){const e={baseType:"PerlinNoise2DTime",perlinBaseParams:{seed:0},flowBaseParams:{seed:0,spinVariation:.2,N:128},octaves:4,persistence:.5,lacunarity:2},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setBaseType:e=>i((t=>({...t,baseType:e}))),setPerlinBaseParams:e=>i((t=>({...t,perlinBaseParams:e}))),setFlowBaseParams:e=>i((t=>({...t,flowBaseParams:e}))),setOctaves:e=>i((t=>({...t,octaves:e}))),setPersistence:e=>i((t=>({...t,persistence:e}))),setLacunarity:e=>i((t=>({...t,lacunarity:e}))),reset:()=>n({...e})}}(),Pe={PerlinNoise2DTime:_e,FlowNoise2DTime:ye,FBMNoise2DTime:xe,TurbulenceNoise2DTime:Ce},Ee=[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"},{text:"FBMNoise2DTime",value:"FBMNoise2DTime"},{text:"TurbulenceNoise2DTime",value:"TurbulenceNoise2DTime"}];const $e=function(){const e="PerlinNoise2DTime",{subscribe:t,set:n}=me(e);return{subscribe:t,set:n,reset:()=>n(e)}}();const ke=function(){const{subscribe:e,set:t}=me(.05);return{subscribe:e,set:t,reset:()=>t(.05)}}();const Ve=function(){const{subscribe:e,set:t}=me(20);return{subscribe:e,set:t,reset:()=>t(20)}}();const Le=function(){const e={PerlinNoise2DTime:!1,FlowNoise2DTime:!1,FBMNoise2DTime:!1,TurbulenceNoise2DTime:!1,noiseType:!1,frequency:!1,noiseSpeed:!1},{subscribe:t,set:n,update:i}=me({...e});return _e.subscribe((()=>i((e=>({...e,PerlinNoise2DTime:!0}))))),ye.subscribe((()=>i((e=>({...e,FlowNoise2DTime:!0}))))),xe.subscribe((()=>i((e=>({...e,FBMNoise2DTime:!0}))))),Ce.subscribe((()=>i((e=>({...e,TurbulenceNoise2DTime:!0}))))),$e.subscribe((()=>i((e=>({...e,noiseType:!0}))))),ke.subscribe((()=>i((e=>({...e,frequency:!0}))))),Ve.subscribe((()=>i((e=>({...e,noiseSpeed:!0}))))),{subscribe:t,clear:function(e){i((t=>({...t,[e]:!1})))},clearAll:function(){n({...e})}}}();const Me=function(){const e={animating:!0,speed:1,useAdvanceTime:!1},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setSpeed(e){i((t=>({...t,speed:e})))},setAnimating(e){i((t=>({...t,animating:e})))},setUseAdvanceTime(e){i((t=>({...t,useAdvanceTime:e})))},reset(){n({...e})}}}(),Se=Object.freeze({GRAYSCALE:"grayscale",HEIGHT_BANDS:"heightbands",GEOGRAPHICAL:"geographical"}),Ae=[{text:"Grayscale",value:Se.GRAYSCALE},{text:"Height Bands",value:Se.HEIGHT_BANDS},{text:"Geographical",value:Se.GEOGRAPHICAL}];const De=function(){const e={colorMode:"grayscale",showScaleVisualization:!0},{subscribe:t,set:n,update:i}=me({...e});return{subscribe:t,set:n,update:i,setColorMode:e=>i((t=>({...t,colorMode:e}))),setShowScaleVisualization:e=>i((t=>({...t,showScaleVisualization:e}))),reset:()=>n({...e})}}();function je(e){return null==e}function Te(e){return null!==e&&"object"==typeof e}function Ne(e){return null!==e&&"object"==typeof e}function Be(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Oe(e,t){return Array.from(new Set([...Object.keys(e),...Object.keys(t)])).reduce(((n,i)=>{const s=e[i],r=t[i];return Ne(s)&&Ne(r)?Object.assign(Object.assign({},n),{[i]:Oe(s,r)}):Object.assign(Object.assign({},n),{[i]:i in t?r:s})}),{})}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const ze={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:e=>`Not compatible with  plugin '${e.id}'`,propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Fe{static alreadyDisposed(){return new Fe({type:"alreadydisposed"})}static notBindable(){return new Fe({type:"notbindable"})}static notCompatible(e,t){return new Fe({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Fe({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Fe({type:"shouldneverhappen"})}constructor(e){var t;this.message=null!==(t=ze[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Ie{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return null!==e&&("object"==typeof e||"function"==typeof e)}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const n=this.read();if(!Ie.isBindable(n))throw Fe.notBindable();if(!(e in n))throw Fe.propertyNotFound(e);n[e]=t}}class Re{constructor(){this.observers_={}}on(e,t,n){var i;let s=this.observers_[e];return s||(s=this.observers_[e]=[]),s.push({handler:t,key:null!==(i=null==n?void 0:n.key)&&void 0!==i?i:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter((e=>e.key!==t))),this}emit(e,t){const n=this.observers_[e];n&&n.forEach((e=>{e.handler(t)}))}}class qe{constructor(e,t){var n;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(n=null==t?void 0:t.equals)&&void 0!==n?n:(e,t)=>e===t,this.emitter=new Re,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;(!this.equals_(s,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class Ue{constructor(e){this.emitter=new Re,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.value_;(i!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}class Ke{constructor(e){this.emitter=new Re,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function He(e,t){const n=null==t?void 0:t.constraint,i=null==t?void 0:t.equals;return n||i?new qe(e,t):new Ue(e)}class Ge{constructor(e){this.emitter=new Re,this.valMap_=e;for(const e in this.valMap_){this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}}static createCore(e){return Object.keys(e).reduce(((t,n)=>Object.assign(t,{[n]:He(e[n])})),{})}static fromObject(e){const t=this.createCore(e);return new Ge(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class Ye{constructor(e){this.values=Ge.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class Xe{constructor(e){this.values=Ge.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let i=e;return je(n)||(i=Math.max(i,n)),je(t)||(i=Math.min(i,t)),i}}class We{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}class Ze{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const Qe={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class Je{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=Qe[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const et={"+":e=>e,"-":e=>-e,"~":e=>~e};class tt{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=et[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function nt(e){return(t,n)=>{for(let i=0;i<e.length;i++){const s=e[i](t,n);if(""!==s)return s}return""}}function it(e,t){var n;const i=e.substr(t).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function st(e,t){var n;const i=e.substr(t).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function rt(e,t){const n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";const i=function(e,t){const n=st(e,t);if(""!==n)return n;const i=e.substr(t,1);if("-"!==i&&"+"!==i)return"";const s=st(e,t+=1);return""===s?"":i+s}(e,t);return""===i?"":n+i}function ot(e,t){const n=e.substr(t,1);if("0"===n)return n;const i=function(e,t){const n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=i.length,""===i?"":i+st(e,t)}const at=nt([function(e,t){const n=ot(e,t);if(t+=n.length,""===n)return"";const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const s=st(e,t);return n+i+s+rt(e,t+=s.length)},function(e,t){const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const i=st(e,t);return t+=i.length,""===i?"":n+i+rt(e,t)},function(e,t){const n=ot(e,t);return t+=n.length,""===n?"":n+rt(e,t)}]);const lt=nt([function(e,t){const n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i}]),ct=nt([lt,at]);function ht(e,t){var n;return null!==(n=function(e,t){const n=ct(e,t);return t+=n.length,""===n?null:{evaluable:new Ze(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){const n=e.substr(t,1);if(t+=n.length,"("!==n)return null;const i=dt(e,t);if(!i)return null;t=i.cursor,t+=it(e,t).length;const s=e.substr(t,1);return t+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:t}}(e,t)}function pt(e,t,n){n+=it(t,n).length;const i=e.filter((e=>t.startsWith(e,n)))[0];return i?(n+=i.length,{cursor:n+=it(t,n).length,operator:i}):null}const ut=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(n,i)=>{const s=e(n,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const s=pt(t,n,i);if(!s)break;i=s.cursor;const o=e(n,i);if(!o)return null;i=o.cursor,r=new Je(s.operator,r,o.evaluable)}return r?{cursor:i,evaluable:r}:null}}(e,t)),(function e(t,n){const i=ht(t,n);if(i)return i;const s=t.substr(n,1);if(n+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=e(t,n);return r?{cursor:n=r.cursor,evaluable:new tt(s,r.evaluable)}:null}));function dt(e,t){return t+=it(e,t).length,ut(e,t)}function mt(e){var t;const n=function(e){const t=dt(e,0);return t?t.cursor+it(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function vt(e){if("number"==typeof e)return e;if("string"==typeof e){const t=mt(e);if(!je(t))return t}return 0}function ft(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}function gt(e,t,n,i,s){return i+(e-t)/(n-t)*(s-i)}function bt(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function wt(e,t,n){return Math.min(Math.max(e,t),n)}function _t(e,t){return(e%t+t)%t}function yt(e,t){return je(e.step)?Math.max(bt(t),2):bt(e.step)}function xt(e){var t;return null!==(t=e.step)&&void 0!==t?t:1}function Ct(e,t){var n;const i=Math.abs(null!==(n=e.step)&&void 0!==n?n:t);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function Pt(e,t){return je(e.step)?null:new We(e.step,t)}function Et(e){return je(e.max)||je(e.min)?je(e.max)&&je(e.min)?null:new Xe({max:e.max,min:e.min}):new Ye({max:e.max,min:e.min})}function $t(e,t){var n,i,s;return{formatter:null!==(n=e.format)&&void 0!==n?n:ft(yt(e,t)),keyScale:null!==(i=e.keyScale)&&void 0!==i?i:xt(e),pointerScale:null!==(s=e.pointerScale)&&void 0!==s?s:Ct(e,t)}}function kt(e){return{format:e.optional.function,keyScale:e.optional.number,max:e.optional.number,min:e.optional.number,pointerScale:e.optional.number,step:e.optional.number}}function Vt(e){return{constraint:e.constraint,textProps:Ge.fromObject($t(e.params,e.initialValue))}}class Lt{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class Mt{constructor(e){this.target=e}}class St extends Mt{constructor(e,t,n){super(e),this.value=t,this.last=null==n||n}}class At extends Mt{constructor(e,t){super(e),this.expanded=t}}class Dt extends Mt{constructor(e,t){super(e),this.index=t}}class jt extends Mt{constructor(e,t){super(e),this.native=t}}class Tt extends Lt{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Re,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new St(this,t.binding.target.read(),e.options.last))}}function Nt(e){return t=>n=>{if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};const i=e(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Bt(e){return{custom:t=>Nt(t)(e),boolean:Nt((e=>"boolean"==typeof e?e:void 0))(e),number:Nt((e=>"number"==typeof e?e:void 0))(e),string:Nt((e=>"string"==typeof e?e:void 0))(e),function:Nt((e=>"function"==typeof e?e:void 0))(e),constant:t=>Nt((e=>e===t?t:void 0))(e),raw:Nt((e=>e))(e),object:t=>Nt((e=>{var n;if(null!==(n=e)&&"object"==typeof n)return function(e,t){return Object.keys(t).reduce(((n,i)=>{if(void 0===n)return;const s=(0,t[i])(e[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}(e,t)}))(e),array:t=>Nt((e=>{var n;if(Array.isArray(e))return n=t,e.reduce(((e,t)=>{if(void 0===e)return;const i=n(t);return i.succeeded&&void 0!==i.value?[...e,i.value]:void 0}),[])}))(e)}}const Ot={optional:Bt(!0),required:Bt(!1)};function zt(e,t){const n=t(Ot),i=Ot.required.object(n)(e);return i.succeeded?i.value:void 0}function Ft(e,t,n,i){if(t&&!t(e))return!1;const s=zt(e,n);return!!s&&i(s)}function It(e,t){var n;return Oe(null!==(n=null==e?void 0:e())&&void 0!==n?n:{},t)}function Rt(e){return"value"in e}function qt(e){if(!Te(e)||!("binding"in e))return!1;const t=e.binding;return!!Te(n=t)&&"target"in n;var n}const Ut="http://www.w3.org/2000/svg";function Kt(e){e.offsetHeight}function Ht(e){return void 0!==e.ontouchstart}function Gt(){return globalThis.document}const Yt={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Xt(e,t){const n=e.createElementNS(Ut,"svg");return n.innerHTML=Yt[t],n}function Wt(e,t,n){e.insertBefore(t,e.children[n])}function Zt(e){e.parentElement&&e.parentElement.removeChild(e)}function Qt(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function Jt(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}function en(e,t){e.emitter.on("change",(e=>{t(e.rawValue)})),t(e.rawValue)}function tn(e,t,n){en(e.value(t),n)}const nn="tp";function sn(e){return(t,n)=>[nn,"-",e,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}const rn=sn("lbl");class on{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(rn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(rn("l")),tn(t.props,"label",(t=>{je(t)?this.element.classList.add(rn(void 0,"nol")):(this.element.classList.remove(rn(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(n),n.appendChild(function(e,t){const n=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,i)=>{i>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(e,t)))})),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("div");i.classList.add(rn("v")),this.element.appendChild(i),this.valueElement=i}}class an{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new on(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Ft(e,null,(e=>({label:e.optional.string})),(e=>(this.props.set("label",e.label),!0)))}exportProps(){return It(null,{label:this.props.get("label")})}}const ln=sn(""),cn={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class hn{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(ln(void 0,cn[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(ln(void 0,cn[e]))}))})),this.viewProps.handleDispose((()=>{Zt(t)}))}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Ft(e,null,(e=>({disabled:e.required.boolean,hidden:e.required.boolean})),(e=>(this.viewProps.importState(e),!0)))}exportState(){return It(null,Object.assign({},this.viewProps.exportState()))}}class pn extends hn{constructor(e,t){if(t.value!==t.valueController.value)throw Fe.shouldNeverHappen();const n=t.valueController.viewProps,i=new an(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new on(e,{props:t.props,viewProps:n}),viewProps:n})),this.labelController=i,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return Ft(e,(t=>{var n,i,s;return super.importState(t)&&this.labelController.importProps(t)&&(null===(s=null===(i=(n=this.valueController).importProps)||void 0===i?void 0:i.call(n,e))||void 0===s||s)}),(e=>({value:e.optional.raw})),(e=>(e.value&&(this.value.rawValue=e.value),!0)))}exportState(){var e,t,n;return It((()=>super.exportState()),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(n=null===(t=(e=this.valueController).exportProps)||void 0===t?void 0:t.call(e))&&void 0!==n?n:{}))}}function un(e,t){for(;e.length<t;)e.push(void 0)}function dn(e){const t=[];return un(t,e),t}function mn(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}class vn extends Lt{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return null!==(e=this.controller.buttonController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller.buttonController.emitter.on(e,(e=>{n(new jt(this,e.nativeEvent))})),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function fn(e,t){return n=>{!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function gn(e,t){en(e,(e=>{t.textContent=null!=e?e:""}))}const bn=sn("btn");class wn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(bn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(bn("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(bn("t")),gn(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class _n{constructor(e,t){this.emitter=new Re,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new wn(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Ft(e,null,(e=>({title:e.optional.string})),(e=>(this.props.set("title",e.title),!0)))}exportProps(){return It(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class yn extends hn{constructor(e,t){const n=new _n(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new an(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:t.viewProps}),this.buttonController=n,this.labelController=i}importState(e){return Ft(e,(e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e)),(()=>({})),(()=>!0))}exportState(){return It((()=>super.exportState()),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}const xn=new class{constructor(e){const[t,n]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}("2.0.5");function Cn(e){return Object.assign({core:xn},e)}Cn({id:"button",type:"blade",accept(e){const t=zt(e,(e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new yn(e.document,{blade:e.blade,buttonProps:Ge.fromObject({title:e.params.title}),labelProps:Ge.fromObject({label:e.params.label}),viewProps:e.viewProps}),api:e=>e.controller instanceof yn?new vn(e.controller):null});class Pn{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Re,this.pool_=t;this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map((e=>this.pool_.createApi(e)))}addBinding(e,t,n){const i=null!=n?n:{},s=this.controller_.element.ownerDocument,r=this.pool_.createBinding(s,function(e,t){if(!Ie.isBindable(e))throw Fe.notBindable();return new Ie(e,t)}(e,t),i),o=this.pool_.createBindingApi(r);return this.add(o,i.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){const n=e.controller;return this.controller_.rack.add(n,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,n=this.pool_.createBlade(t,e),i=this.pool_.createApi(n);return this.add(i,e.index)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach((e=>{var t;Te(t=e)&&"refresh"in t&&"function"==typeof t.refresh&&e.refresh()}))}onRackValueChange_(e){const t=e.bladeController,n=this.pool_.createApi(t),i=qt(t.value)?t.value.binding:null;this.emitter_.emit("change",new St(n,i?i.target.read():t.value.rawValue,e.options.last))}}class En extends Lt{constructor(e,t){super(e),this.rackApi_=new Pn(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class $n extends hn{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Ft(e,(e=>super.importState(e)),(e=>({children:e.required.array(e.required.raw)})),(e=>this.rackController.rack.children.every(((t,n)=>t.importState(e.children[n])))))}exportState(){return It((()=>super.exportState()),{children:this.rackController.rack.children.map((e=>e.exportState()))})}}function kn(e){return"rackController"in e}class Vn{constructor(e){this.emitter=new Re,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Fe.shouldNeverHappen();const n=void 0!==t?t:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.allItems().forEach((e=>{this.cache_.delete(e)})),n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function Ln(e){return kn(e)?e.rackController.rack.bcSet_:null}class Mn{constructor(e){var t,n;this.emitter=new Re,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(t=e.blade)&&void 0!==t?t:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new Vn(Ln),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),Rt(n))n.value.emitter.on("change",this.onChildValueChange_);else if(kn(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.on("layout",this.onRackLayout_),t.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const n=e.item;if(Rt(n))n.value.emitter.off("change",this.onChildValueChange_);else if(kn(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.off("layout",this.onRackLayout_),t.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],n=e[e.length-1];this.bcSet_.items.forEach((e=>{const i=[];e===t&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),e===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),e.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildValueChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(Rt(i)&&i.value===t)return i}return null}(this.find(Rt),e.sender);if(!t)throw Fe.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Sn{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new Mn({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--){this.rack.children[e].viewProps.set("disposed",!0)}}))}onRackAdd_(e){e.root&&Wt(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Zt(e.bladeController.view.element)}}function An(){return new Ge({positions:He([],{equals:Be})})}class Dn extends Ge{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=Ge.createCore(t);return new Dn(n)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!je(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};tn(this,"expanded",n),tn(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function jn(e,t){t.style.height=e.styleHeight}function Tn(e,t){e.value("expanded").emitter.on("beforechange",(()=>{if(e.set("completed",!1),je(e.get("expandedHeight"))){const n=function(e,t){let n=0;return function(e,t){const n=e.style.transition;e.style.transition="none",t(),e.style.transition=n}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),Kt(t),n=t.clientHeight,e.set("temporaryExpanded",null),Kt(t)})),n}(e,t);n>0&&e.set("expandedHeight",n)}e.set("shouldFixHeight",!0),Kt(t)})),e.emitter.on("change",(()=>{jn(e,t)})),jn(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&e.cleanUpTransition()}))}class Nn extends En{constructor(e,t){super(e,t),this.emitter_=new Re,this.controller.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",new At(this,e.sender.rawValue))})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)}))}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const Bn=sn("cnt");class On{constructor(e,t){var n;this.className_=sn(null!==(n=t.viewName)&&void 0!==n?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Bn()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),tn(this.foldable_,"completed",fn(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),tn(t.props,"title",(e=>{je(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(this.className_("t")),gn(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class zn extends $n{constructor(e,t){var n;const i=Dn.create(null===(n=t.expanded)||void 0===n||n),s=new On(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Sn({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,Tn(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Ft(e,(e=>super.importState(e)),(e=>({expanded:e.required.boolean,title:e.optional.string})),(e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0)))}exportState(){return It((()=>super.exportState()),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}Cn({id:"folder",type:"blade",accept(e){const t=zt(e,(e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean})));return t?{params:t}:null},controller:e=>new zn(e.document,{blade:e.blade,expanded:e.params.expanded,props:Ge.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof zn?new Nn(e.controller,e.pool):null});const Fn=sn("");function In(e,t){return fn(e,Fn(void 0,t))}class Rn extends Ge{constructor(e){var t,n;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=(n=He(this.getGlobalDisabled_()),[new Ke(n),(e,t)=>{n.setRawValue(e,t)}]),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,i;const s=null!=e?e:{};return new Rn(Ge.createCore({disabled:null!==(t=s.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){en(this.globalDisabled_,In(e,"disabled")),tn(this,"hidden",In(e,"hidden"))}bindDisabled(e){en(this.globalDisabled_,(t=>{e.disabled=t}))}bindTabIndex(e){en(this.globalDisabled_,(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const qn=sn("tbp");class Un{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(qn("c")),this.element.appendChild(n),this.containerElement=n}}const Kn=sn("tbi");class Hn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Kn()),t.viewProps.bindClassModifiers(this.element),tn(t.props,"selected",(e=>{e?this.element.classList.add(Kn(void 0,"sel")):this.element.classList.remove(Kn(void 0,"sel"))}));const n=e.createElement("button");n.classList.add(Kn("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(Kn("t")),gn(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class Gn{constructor(e,t){this.emitter=new Re,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Hn(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Yn extends $n{constructor(e,t){const n=new Un(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Sn({blade:t.blade,element:n.containerElement,viewProps:t.viewProps}),view:n})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Gn(e,{props:t.itemProps,viewProps:Rn.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,tn(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}importState(e){return Ft(e,(e=>super.importState(e)),(e=>({selected:e.required.boolean,title:e.required.string})),(e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0)))}exportState(){return It((()=>super.exportState()),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class Xn extends En{constructor(e,t){super(e,t),this.emitter_=new Re,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)})),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,n=new Yn(t,{blade:An(),itemProps:Ge.fromObject({selected:!1,title:e.title}),props:Ge.fromObject({selected:!1}),viewProps:Rn.create()}),i=this.pool_.createApi(n);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Dt(this,e.rawValue))}}class Wn extends En{get title(){var e;return null!==(e=this.controller.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addBlade(e){return this.rackApi_.addBlade(e)}}class Zn{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=He(!0),this.selectedIndex=He(-1),this.items_=[]}add(e,t){const n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const e=this.items_.findIndex((e=>e.rawValue));e<0?(this.items_.forEach(((e,t)=>{e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex((t=>t===e.sender));this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const Qn=sn("tab");class Jn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Qn(),Bn()),t.viewProps.bindClassModifiers(this.element),en(t.empty,fn(this.element,Qn(void 0,"nop")));const n=e.createElement("div");n.classList.add(Qn("t")),this.element.appendChild(n),this.itemsElement=n;const i=e.createElement("div");i.classList.add(Qn("i")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Qn("c")),this.element.appendChild(s),this.contentsElement=s}}class ei extends $n{constructor(e,t){const n=new Zn,i=new Jn(e,{empty:n.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Sn({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=n}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;Wt(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Zt(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}Cn({id:"tab",type:"blade",accept(e){const t=zt(e,(e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")})));return t&&0!==t.pages.length?{params:t}:null},controller(e){const t=new ei(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((n=>{const i=new Yn(e.document,{blade:An(),itemProps:Ge.fromObject({selected:!1,title:n.title}),props:Ge.fromObject({selected:!1}),viewProps:Rn.create()});t.add(i)})),t},api:e=>e.controller instanceof ei?new Xn(e.controller,e.pool):e.controller instanceof Yn?new Wn(e.controller,e.pool):null});class ti extends Tt{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class ni{constructor(){this.disabled=!1,this.emitter=new Re}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ii{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Re,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class si{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function ri(e,t){if(e instanceof t)return e;if(e instanceof si){const n=e.constraints.reduce(((e,n)=>e||(n instanceof t?n:null)),null);if(n)return n}return null}class oi{constructor(e){this.values=Ge.fromObject({options:e})}constrain(e){const t=this.values.get("options");if(0===t.length)return e;return t.filter((t=>t.value===e)).length>0?e:t[0].value}}function ai(e){var t;const n=Ot;return Array.isArray(e)?null===(t=zt({items:e},(e=>({items:e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))}))))||void 0===t?void 0:t.items:"object"==typeof e?n.required.raw(e).value:void 0}function li(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((n=>{t.push({text:n,value:e[n]})})),t}function ci(e){return je(e)?null:new oi(li(e))}const hi=sn("lst");class pi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(hi()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(hi("s")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=e.createElement("div");i.classList.add(hi("m")),i.appendChild(Xt(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,tn(this.props_,"options",(t=>{Qt(this.selectElement),t.forEach((t=>{const n=e.createElement("option");n.textContent=t.text,this.selectElement.appendChild(n)})),this.update_()}))}update_(){const e=this.props_.get("options").map((e=>e.value));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class ui{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new pi(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Ft(e,null,(e=>({options:e.required.custom(ai)})),(e=>(this.props.set("options",li(e.options)),!0)))}exportProps(){return It(null,{options:this.props.get("options")})}}const di=sn("pop");class mi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(di()),t.viewProps.bindClassModifiers(this.element),en(t.shows,fn(this.element,di(void 0,"v")))}}class vi{constructor(e,t){this.shows=He(!1),this.viewProps=t.viewProps,this.view=new mi(e,{shows:this.shows,viewProps:this.viewProps})}}const fi=sn("txt");class gi{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(fi()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(fi("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class bi{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new gi(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);je(n)||(this.value.rawValue=n),this.view.refresh()}}function wi(e){return"false"!==e&&!!e}function _i(e){return function(e){return String(e)}(e)}const yi=ft(0);function xi(e){return yi(e)+"%"}function Ci(e){return String(e)}function Pi(e){return e}function Ei({primary:e,secondary:t,forward:n,backward:i}){let s=!1;function r(e){s||(s=!0,e(),s=!1)}e.emitter.on("change",(i=>{r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),i.options)}))})),t.emitter.on("change",(s=>{r((()=>{e.setRawValue(i(e.rawValue,t.rawValue),s.options)})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),s.options)}))})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),{forceEmit:!1,last:!0})}))}function $i(e,t){const n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function ki(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function Vi(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function Li(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Mi(e,t){var n,i;const s=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+r.left),y:e.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+r.top)}}class Si{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Re,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Mi(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Mi(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Mi(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const Ai=sn("txt");class Di{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Ai(),Ai(void 0,"num")),t.arrayPosition&&this.element.classList.add(Ai(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Ai("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ai()),this.inputElement.classList.add(Ai("i"));const i=e.createElement("div");i.classList.add(Ai("k")),this.element.appendChild(i),this.knobElement=i;const s=e.createElementNS(Ut,"svg");s.classList.add(Ai("g")),this.knobElement.appendChild(s);const r=e.createElementNS(Ut,"path");r.classList.add(Ai("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=e.createElementNS(Ut,"path");o.classList.add(Ai("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(sn("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(Ai(void 0,"drg"));this.element.classList.add(Ai(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),n=t+(t>0?-1:t<0?1:0),i=wt(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class ji{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=null!==(n=t.sliderProps)&&void 0!==n?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=He(null),this.view=new Di(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Si(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const i=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("min"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("max");let r=e;return void 0!==i&&(r=Math.max(r,i)),void 0!==s&&(r=Math.min(r,s)),r}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);je(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(e){const t=$i(this.props.get("keyScale"),ki(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==$i(this.props.get("keyScale"),ki(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Ti=sn("sld");class Ni{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Ti()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ti("t")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(Ti("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=wt(gt(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Bi{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Ni(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(gt(wt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=$i(this.props.get("keyScale"),Vi(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==$i(this.props.get("keyScale"),Vi(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Oi=sn("sldtxt");class zi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Oi());const n=e.createElement("div");n.classList.add(Oi("s")),this.sliderView_=t.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Oi("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class Fi{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Bi(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new ji(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new zi(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Ft(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>{const t=this.sliderC_.props;return t.set("max",e.max),t.set("min",e.min),!0}))}exportProps(){const e=this.sliderC_.props;return It(null,{max:e.get("max"),min:e.get("min")})}}const Ii={containerUnitSize:"cnt-usz"};function Ri(e){return`--${Ii[e]}`}class qi{constructor(e,t){const n=sn(t.viewName);this.element=e.createElement("div"),this.element.classList.add(n()),t.viewProps.bindClassModifiers(this.element)}}function Ui(e){return kt(e)}function Ki(e){if(Ne(e))return zt(e,Ui)}function Hi(e,t){if(!e)return;const n=[],i=Pt(e,t);i&&n.push(i);const s=Et(e);return s&&n.push(s),new si(n)}function Gi(e){if("inline"===e||"popup"===e)return e}function Yi(e,t){e.write(t)}const Xi=sn("ckb");class Wi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Xi()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(Xi("l")),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("input");i.classList.add(Xi("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(Xi("w")),this.labelElement.appendChild(s);const r=Xt(e,"check");s.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Zi{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Wi(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}Cn({id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=zt(t,(e=>({options:e.optional.custom(ai),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>wi,constraint:e=>function(e){const t=[],n=ci(e.options);return n&&t.push(n),new si(t)}(e.params),writer:e=>Yi},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&ri(i,oi);return s?new ui(t,{props:new Ge({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new Zi(t,{value:n,viewProps:e.viewProps})},api:e=>"boolean"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof ui?new ti(e.controller):null});const Qi=sn("col");class Ji{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Qi()),t.foldable.bindExpandedClass(this.element,Qi(void 0,"expanded")),tn(t.foldable,"completed",fn(this.element,Qi(void 0,"cpl")));const n=e.createElement("div");n.classList.add(Qi("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Qi("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add(Qi("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(Qi("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function es(e,t,n){const i=_t(e,360),s=wt(t/100,0,1),r=wt(n/100,0,1),o=r*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}function ts(e){return[e[0],e[1],e[2]]}function ns(e,t){return[e[0],e[1],e[2],t]}const is={hsl:{hsl:(e,t,n)=>[e,t,n],hsv:function(e,t,n){const i=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==i?t*(100-Math.abs(2*n-100))/i:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){const i=(e%360+360)%360,s=wt(t/100,0,1),r=wt(n/100,0,1),o=(1-Math.abs(2*r-1))*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o/2;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}},hsv:{hsl:function(e,t,n){const i=100-Math.abs(n*(200-t)/100-100);return[e,0!==i?t*n/i:0,n*(200-t)/200]},hsv:(e,t,n)=>[e,t,n],rgb:es},rgb:{hsl:function(e,t,n){const i=wt(e/255,0,1),s=wt(t/255,0,1),r=wt(n/255,0,1),o=Math.max(i,s,r),a=Math.min(i,s,r),l=o-a;let c=0,h=0;const p=(a+o)/2;return 0!==l&&(h=l/(1-Math.abs(o+a-1)),c=i===o?(s-r)/l:s===o?2+(r-i)/l:4+(i-s)/l,c=c/6+(c<0?1:0)),[360*c,100*h,100*p]},hsv:function(e,t,n){const i=wt(e/255,0,1),s=wt(t/255,0,1),r=wt(n/255,0,1),o=Math.max(i,s,r),a=o-Math.min(i,s,r);let l;return l=0===a?0:o===i?((s-r)/a%6+6)%6*60:o===s?60*((r-i)/a+2):60*((i-s)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,n)=>[e,t,n]}};function ss(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function rs(e,t,n){var i;const s=ss(t,n);return["rgb"===t?wt(e[0],0,s[0]):(r=e[0],o=s[0],r===o?o:_t(r,o)),wt(e[1],0,s[1]),wt(e[2],0,s[2]),wt(null!==(i=e[3])&&void 0!==i?i:1,0,1)];var r,o}function os(e,t,n,i){const s=ss(t,n),r=ss(t,i);return e.map(((e,t)=>e/s[t]*r[t]))}function as(e,t,n){const i=os(e,t.mode,t.type,"int");return os(is[t.mode][n.mode](...i),n.mode,"int",n.type)}class ls{static black(){return new ls([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=rs(e,t,this.type)}getComponents(e){return ns(as(ts(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const cs=sn("colp");class hs{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(cs()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(cs("hsv"));const i=e.createElement("div");i.classList.add(cs("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(cs("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);const r=e.createElement("div");if(r.classList.add(cs("rgb")),this.textsView_=t.textsView,r.appendChild(this.textsView_.element),this.element.appendChild(r),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const n=e.createElement("div");n.classList.add(cs("a"));const i=e.createElement("div");i.classList.add(cs("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(cs("at")),s.appendChild(this.alphaViews_.text.element),n.appendChild(s),this.element.appendChild(n)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function ps(e){return"int"===e?"int":"float"===e?"float":void 0}function us(e){return zt(e,(e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(ps)}),expanded:e.optional.boolean,picker:e.optional.custom(Gi),readonly:e.optional.constant(!1)})))}function ds(e){return e?.1:1}function ms(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}class vs{constructor(e,t){this.type="float",this.mode=t,this.comps_=rs(e,t,this.type)}getComponents(e){return ns(as(ts(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const fs={int:(e,t)=>new ls(e,t),float:(e,t)=>new vs(e,t)};function gs(e,t,n){return fs[n](e,t)}function bs(e,t){if(e.type===t)return e;if(function(e){return"int"===e.type}(e)&&"float"===t)return function(e){const t=e.getComponents(),n=ss(e.mode,"int");return new vs([gt(t[0],0,n[0],0,1),gt(t[1],0,n[1],0,1),gt(t[2],0,n[2],0,1),t[3]],e.mode)}(e);if(function(e){return"float"===e.type}(e)&&"int"===t)return function(e){const t=e.getComponents(),n=ss(e.mode,"int");return new ls([Math.round(gt(t[0],0,1,0,n[0])),Math.round(gt(t[1],0,1,0,n[1])),Math.round(gt(t[2],0,1,0,n[2])),t[3]],e.mode)}(e);throw Fe.shouldNeverHappen()}function ws(e,t){const n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}const _s={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function ys(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const n=parseFloat(t[1]),i=t[2];return _s[i](n)}function xs(e){const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[ws(t[1],255),ws(t[2],255),ws(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Cs(e){const t=xs(e);return t?new ls(t,"rgb"):null}function Ps(e){const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[ws(t[1],255),ws(t[2],255),ws(t[3],255),ws(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Es(e){const t=Ps(e);return t?new ls(t,"rgb"):null}function $s(e){const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[ys(t[1]),ws(t[2],100),ws(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function ks(e){const t=$s(e);return t?new ls(t,"hsl"):null}function Vs(e){const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[ys(t[1]),ws(t[2],100),ws(t[3],100),ws(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Ls(e){const t=Vs(e);return t?new ls(t,"hsl"):null}function Ms(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Ss(e){const t=Ms(e);return t?new ls(t,"rgb"):null}function As(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),gt(parseInt(t[4]+t[4],16),0,255,0,1)];const n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),gt(parseInt(n[4],16),0,255,0,1)]:null}function Ds(e){const t=As(e);return t?new ls(t,"rgb"):null}function js(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Ts(e){return t=>{const n=js(t);return n?gs(n,"rgb",e):null}}function Ns(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Bs(e){return t=>{const n=Ns(t);return n?gs(n,"rgb",e):null}}const Os=[{parser:Ms,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:As,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:xs,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Ps,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:$s,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Vs,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:js,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Ns,result:{alpha:!0,mode:"rgb",notation:"object"}}];function zs(e,t="int"){const n=function(e){return Os.reduce(((t,{parser:n,result:i})=>t||(n(e)?i:null)),null)}(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}function Fs(e){const t=[Ss,Ds,Cs,Es,ks,Ls];"int"===e&&t.push(Ts("int"),Bs("int")),"float"===e&&t.push(Ts("float"),Bs("float"));const n=function(e){return t=>e.reduce(((e,n)=>null!==e?e:n(t)),null)}(t);return t=>{const i=n(t);return i?bs(i,e):null}}function Is(e){const t=Fs("int");if("string"!=typeof e)return ls.black();const n=t(e);return null!=n?n:ls.black()}function Rs(e){const t=wt(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function qs(e,t="#"){return`${t}${ts(e.getComponents("rgb")).map(Rs).join("")}`}function Us(e,t="#"){const n=e.getComponents("rgb");return`${t}${[n[0],n[1],n[2],255*n[3]].map(Rs).join("")}`}function Ks(e){const t=ft(0);return`rgb(${ts(bs(e,"int").getComponents("rgb")).map((e=>t(e))).join(", ")})`}function Hs(e){const t=ft(2),n=ft(0),i=bs(e,"int").getComponents("rgb").map(((e,i)=>(3===i?t:n)(e)));return`rgba(${i.join(", ")})`}function Gs(e,t){const n=ft("float"===t?2:0),i=["r","g","b"],s=ts(bs(e,t).getComponents("rgb")).map(((e,t)=>`${i[t]}: ${n(e)}`));return`{${s.join(", ")}}`}function Ys(e){return t=>Gs(t,e)}function Xs(e,t){const n=ft(2),i=ft("float"===t?2:0),s=["r","g","b","a"],r=bs(e,t).getComponents("rgb").map(((e,t)=>`${s[t]}: ${(3===t?n:i)(e)}`));return`{${r.join(", ")}}`}function Ws(e){return t=>Xs(t,e)}const Zs=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:qs},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Us},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:Ks},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Hs},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[ft(0),xi,xi],n=ts(bs(e,"int").getComponents("hsl")).map(((e,n)=>t[n](e)));return`hsl(${n.join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[ft(0),xi,xi,ft(2)],n=bs(e,"int").getComponents("hsl").map(((e,n)=>t[n](e)));return`hsla(${n.join(", ")})`}},...["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:Ys(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:Ws(t)}]),[])];function Qs(e){return Zs.reduce(((t,n)=>{return t||(i=n.format,s=e,i.alpha===s.alpha&&i.mode===s.mode&&i.notation===s.notation&&i.type===s.type?n.stringifier:null);var i,s}),null)}const Js=sn("apl");class er{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Js()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(Js("b")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Js("c")),n.appendChild(i),this.colorElem_=i;const s=e.createElement("div");s.classList.add(Js("m")),this.element.appendChild(s),this.markerElem_=s;const r=e.createElement("div");r.classList.add(Js("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),n=new ls([t[0],t[1],t[2],0],"rgb"),i=new ls([t[0],t[1],t[2],255],"rgb"),s=["to right",Hs(n),Hs(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=Hs(e);const r=gt(t[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class tr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new er(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=e.point.x/e.bounds.width,i=this.value.rawValue,[s,r,o]=i.getComponents("hsv");this.value.setRawValue(new ls([s,r,o,n],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=$i(ds(!0),Vi(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new ls([i,s,r,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==$i(ds(!0),Vi(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const nr=sn("coltxt");class ir{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nr()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(nr("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce(((t,n)=>{const i=e.createElement("option");return i.textContent=n.text,i.value=n.value,t.appendChild(i),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(nr("ms")),n.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(nr("mm")),i.appendChild(Xt(e,"dropdown")),n.appendChild(i),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(nr("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),en(t.mode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){Qt(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach((t=>{const n=e.createElement("div");n.classList.add(nr("c")),n.appendChild(t.element),this.inputsElem_.appendChild(n)}))}}function sr(e,t,n){const i=ss(e,t)[n];return new Ye({min:0,max:i})}function rr(e,t){const n={colorMode:t.colorMode,colorType:t.colorType,parser:mt,viewProps:t.viewProps};return[0,1,2].map((i=>{const s=function(e,t,n){return new ji(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",parser:t.parser,props:Ge.fromObject({formatter:(i=t.colorType,ft("float"===i?2:0)),keyScale:ds(!1),pointerScale:"float"===t.colorType?.01:1}),value:He(0,{constraint:sr(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var i}(e,n,i);return Ei({primary:t.value,secondary:s.value,forward:e=>bs(e,t.colorType).getComponents(t.colorMode)[i],backward(e,n){const s=t.colorMode,r=bs(e,t.colorType).getComponents(s);r[i]=n;return bs(gs(ns(ts(r),r[3]),s,t.colorType),"int")}}),s}))}class or{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=He(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new ir(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return function(e){return"hex"!==e}(t)?rr(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(e,t){const n=new bi(e,{parser:Fs("int"),props:Ge.fromObject({formatter:qs}),value:He(ls.black()),viewProps:t.viewProps});return Ei({primary:t.value,secondary:n.value,forward:e=>new ls(ts(e.getComponents()),e.mode),backward:(e,t)=>new ls(ns(ts(t.getComponents(e.mode)),e.getComponents()[3]),e.mode)}),[n]}(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((e=>e.view))}}const ar=sn("hpl");class lr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ar()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(ar("c")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(ar("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=Ks(new ls([t,100,100],"hsv"));const n=gt(t,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class cr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new lr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=gt(wt(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new ls([n,s,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=$i(ds(!1),Vi(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new ls([i+t,s,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==$i(ds(!1),Vi(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const hr=sn("svp");class pr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(hr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=64,n.width=64,n.classList.add(hr("c")),this.element.appendChild(n),this.canvasElement=n;const i=e.createElement("div");i.classList.add(hr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,s=e.getImageData(0,0,n,i),r=s.data;for(let e=0;e<i;e++)for(let s=0;s<n;s++){const o=gt(s,0,n,0,100),a=gt(e,0,i,100,0),l=es(t[0],o,a),c=4*(e*n+s);r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=255}e.putImageData(s,0,0);const o=gt(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=gt(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class ur{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new pr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=gt(e.point.x,0,e.bounds.width,0,100),i=gt(e.point.y,0,e.bounds.height,100,0),[s,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ls([s,n,i,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Li(e.key)&&e.preventDefault();const[t,n,i,s]=this.value.rawValue.getComponents("hsv"),r=ds(!1),o=$i(r,Vi(e)),a=$i(r,ki(e));0===o&&0===a||this.value.setRawValue(new ls([t,n+o,i+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=ds(!1),n=$i(t,Vi(e)),i=$i(t,ki(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class dr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new cr(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new ur(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new tr(e,{value:this.value,viewProps:this.viewProps}),text:new ji(e,{parser:mt,props:Ge.fromObject({pointerScale:.01,keyScale:.1,formatter:ft(2)}),value:He(0,{constraint:new Ye({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ei({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.getComponents()[3],backward:(e,t)=>{const n=e.getComponents();return n[3]=t,new ls(n,e.mode)}}),this.textsC_=new or(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new hs(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const mr=sn("colsw");class vr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(mr()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(mr("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=e.createElement("button");i.classList.add(mr("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Us(e)}onValueChange_(){this.update_()}}class fr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new vr(e,{value:this.value,viewProps:this.viewProps})}}class gr{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Dn.create(t.expanded),this.swatchC_=new fr(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new bi(e,{parser:t.parser,props:Ge.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Ji(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new vi(e,{viewProps:this.viewProps}):null;const i=new dr(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Ei({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Tn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=Jt(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!Ht(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function br(e){return ts(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function wr(e){return e.getComponents("rgb").reduce(((e,t,n)=>e<<8|255&Math.floor(3===n?255*t:t)),0)>>>0}function _r(e){return"number"!=typeof e?ls.black():new ls([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function yr(e){return"number"!=typeof e?ls.black():new ls([(t=e)>>24&255,t>>16&255,t>>8&255,gt(255&t,0,255,0,1)],"rgb");var t}function xr(e,t){return"object"==typeof e&&!je(e)&&(t in e&&"number"==typeof e[t])}function Cr(e){return xr(e,"r")&&xr(e,"g")&&xr(e,"b")}function Pr(e){return Cr(e)&&xr(e,"a")}function Er(e){return Cr(e)}function $r(e,t){if(e.mode!==t.mode)return!1;if(e.type!==t.type)return!1;const n=e.getComponents(),i=t.getComponents();for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}function kr(e){return"a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b]}function Vr(e,t){return(n,i)=>{e?function(e,t,n){const i=bs(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}(n,i,t):function(e,t,n){const i=bs(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}(n,i,t)}}function Lr(e){var t;return!!(null===(t=null==e?void 0:e.color)||void 0===t?void 0:t.alpha)}function Mr(e){return t=>{const n=function(e,t){if(!Er(e))return bs(ls.black(),t);if("int"===t){const t=kr(e);return new ls(t,"rgb")}if("float"===t){const t=kr(e);return new vs(t,"rgb")}return bs(ls.black(),"int")}(t,e);return bs(n,"int")}}function Sr(e,t){return n=>e?Xs(n,t):Gs(n,t)}Cn({id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!function(e){return"color"in e||"color"===e.view}(t))return null;const n=us(t);return n?{initialValue:e,params:Object.assign(Object.assign({},n),{supportsAlpha:Lr(t)})}:null},binding:{reader:e=>e.params.supportsAlpha?yr:_r,equals:$r,writer:e=>function(e){const t=e?wr:br;return(e,n)=>{Yi(e,t(n))}}(e.params.supportsAlpha)},controller:e=>{var t,n,i;return new gr(e.document,{colorType:"int",expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:(i=e.params.supportsAlpha,i?e=>Us(e,"0x"):e=>qs(e,"0x")),parser:Fs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.supportsAlpha,value:e.value,viewProps:e.viewProps})}}),Cn({id:"input-color-object",type:"input",accept:(e,t)=>{var n;if(!Er(e))return null;const i=us(t);return i?{initialValue:e,params:Object.assign(Object.assign({},i),{colorType:null!==(n=ms(t))&&void 0!==n?n:"int"})}:null},binding:{reader:e=>Mr(e.params.colorType),equals:$r,writer:e=>Vr(Pr(e.initialValue),e.params.colorType)},controller:e=>{var t,n;const i=Pr(e.initialValue);return new gr(e.document,{colorType:e.params.colorType,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:Sr(i,e.params.colorType),parser:Fs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:i,value:e.value,viewProps:e.viewProps})}}),Cn({id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("text"===t.view)return null;const n=zs(e,ms(t));if(!n)return null;const i=Qs(n);if(!i)return null;const s=us(t);return s?{initialValue:e,params:Object.assign(Object.assign({},s),{format:n,stringifier:i})}:null},binding:{reader:()=>Is,equals:$r,writer:e=>{const t=function(e){const t=Qs(e);return t?(e,n)=>{Yi(e,t(n))}:null}(e.params.format);if(!t)throw Fe.notBindable();return t}},controller:e=>{var t,n;return new gr(e.document,{colorType:e.params.format.type,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:e.params.stringifier,parser:Fs("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.format.alpha,value:e.value,viewProps:e.viewProps})}});class Ar{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var n,i;return null!==(i=null===(n=this.components[t])||void 0===n?void 0:n.constrain(e))&&void 0!==i?i:e}));return this.asm_.fromComponents(t)}}const Dr=sn("pndtxt");class jr{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Dr()),this.textViews.forEach((t=>{const n=e.createElement("div");n.classList.add(Dr("a")),n.appendChild(t.element),this.element.appendChild(n)}))}}class Tr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((n,i)=>function(e,t,n){return new ji(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[n].textProps,value:He(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(e,t,i))),this.acs_.forEach(((e,n)=>{Ei({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e)[n],backward:(e,i)=>{const s=t.assembly.toComponents(e);return s[n]=i,t.assembly.fromComponents(s)}})})),this.view=new jr(e,{textViews:this.acs_.map((e=>e.view))})}get textControllers(){return this.acs_}}class Nr extends Tt{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}Cn({id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=zt(t,(e=>Object.assign(Object.assign({},kt(e)),{options:e.optional.custom(ai),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>vt,constraint:e=>function(e,t){const n=[],i=Pt(e,t);i&&n.push(i);const s=Et(e);s&&n.push(s);const r=ci(e.options);return r&&n.push(r),new si(n)}(e.params,e.initialValue),writer:e=>Yi},controller:e=>{const t=e.value,n=e.constraint,i=n&&ri(n,oi);if(i)return new ui(e.document,{props:new Ge({options:i.values.value("options")}),value:t,viewProps:e.viewProps});const s=$t(e.params,t.rawValue),r=n&&ri(n,Ye);return r?new Fi(e.document,Object.assign(Object.assign({},(o=Object.assign(Object.assign({},s),{keyScale:He(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}),{sliderProps:new Ge({keyScale:o.keyScale,max:o.max,min:o.min}),textProps:new Ge({formatter:He(o.formatter),keyScale:o.keyScale,pointerScale:He(o.pointerScale)})})),{parser:mt,value:t,viewProps:e.viewProps})):new ji(e.document,{parser:mt,props:Ge.fromObject(s),value:t,viewProps:e.viewProps});var o},api:e=>"number"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof Fi?new Nr(e.controller):e.controller.valueController instanceof ui?new ti(e.controller):null});class Br{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(je(e))return!1;const t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const Or={toComponents:e=>e.getComponents(),fromComponents:e=>new Br(...e)},zr=sn("p2d");class Fr{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(zr()),t.viewProps.bindClassModifiers(this.element),en(t.expanded,fn(this.element,zr(void 0,"expanded")));const n=e.createElement("div");n.classList.add(zr("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(zr("b")),i.appendChild(Xt(e,"p2dpad")),t.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const s=e.createElement("div");if(s.classList.add(zr("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(zr("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const Ir=sn("p2dp");class Rr{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Ir()),"popup"===t.layout&&this.element.classList.add(Ir(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ir("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(Ut,"svg");i.classList.add(Ir("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=e.createElementNS(Ut,"line");s.classList.add(Ir("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const r=e.createElementNS(Ut,"line");r.classList.add(Ir("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=e.createElementNS(Ut,"line");o.classList.add(Ir("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(Ir("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),n=this.props_.get("max"),i=gt(e,-n,+n,0,100),s=gt(t,-n,+n,0,100),r=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function qr(e,t,n){return[$i(t[0],Vi(e)),$i(t[1],ki(e))*(n?1:-1)]}class Ur{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Rr(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Si(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=this.props.get("max"),i=gt(e.point.x,0,e.bounds.width,-n,+n),s=gt(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new Br(i,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Li(e.key)&&e.preventDefault();const[t,n]=qr(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(new Br(this.value.rawValue.x+t,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,n]=qr(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Kr{constructor(e,t){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Dn.create(t.expanded),this.popC_="popup"===t.pickerLayout?new vi(e,{viewProps:this.viewProps}):null;const s=new Ur(e,{layout:t.pickerLayout,props:new Ge({invertsY:He(t.invertsY),max:He(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new Tr(e,{assembly:Or,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Fr(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ei({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Tn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=Jt(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!Ht(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function Hr(e){return Br.isObject(e)?new Br(e.x,e.y):new Br}function Gr(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function Yr(e,t){var n,i;if(!je(e.min)||!je(e.max))return Math.max(Math.abs(null!==(n=e.min)&&void 0!==n?n:0),Math.abs(null!==(i=e.max)&&void 0!==i?i:0));const s=xt(e);return Math.max(10*Math.abs(s),10*Math.abs(t))}function Xr(e,t){var n,i;const s=Yr(Oe(e,null!==(n=e.x)&&void 0!==n?n:{}),t.x),r=Yr(Oe(e,null!==(i=e.y)&&void 0!==i?i:{}),t.y);return Math.max(s,r)}function Wr(e){if(!("y"in e))return!1;const t=e.y;return!!t&&("inverted"in t&&!!t.inverted)}Cn({id:"input-point2d",type:"input",accept:(e,t)=>{if(!Br.isObject(e))return null;const n=zt(t,(e=>Object.assign(Object.assign({},Ui(e)),{expanded:e.optional.boolean,picker:e.optional.custom(Gi),readonly:e.optional.constant(!1),x:e.optional.custom(Ki),y:e.optional.object(Object.assign(Object.assign({},Ui(e)),{inverted:e.optional.boolean}))})));return n?{initialValue:e,params:n}:null},binding:{reader:()=>Hr,constraint:e=>{return t=e.params,n=e.initialValue,new Ar({assembly:Or,components:[Hi(Object.assign(Object.assign({},t),t.x),n.x),Hi(Object.assign(Object.assign({},t),t.y),n.y)]});var t,n},equals:Br.equals,writer:()=>Gr},controller:e=>{var t,n;const i=e.document,s=e.value,r=e.constraint,o=[e.params.x,e.params.y];return new Kr(i,{axes:s.rawValue.getComponents().map(((t,n)=>{var i;return Vt({constraint:r.components[n],initialValue:t,params:Oe(e.params,null!==(i=o[n])&&void 0!==i?i:{})})})),expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,invertsY:Wr(e.params),max:Xr(e.params,s.rawValue),parser:mt,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:s,viewProps:e.viewProps})}});class Zr{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(je(e))return!1;const t=e.x,n=e.y,i=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Qr={toComponents:e=>e.getComponents(),fromComponents:e=>new Zr(...e)};function Jr(e){return Zr.isObject(e)?new Zr(e.x,e.y,e.z):new Zr}function eo(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}Cn({id:"input-point3d",type:"input",accept:(e,t)=>{if(!Zr.isObject(e))return null;const n=zt(t,(e=>Object.assign(Object.assign({},Ui(e)),{readonly:e.optional.constant(!1),x:e.optional.custom(Ki),y:e.optional.custom(Ki),z:e.optional.custom(Ki)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Jr,constraint:e=>{return t=e.params,n=e.initialValue,new Ar({assembly:Qr,components:[Hi(Object.assign(Object.assign({},t),t.x),n.x),Hi(Object.assign(Object.assign({},t),t.y),n.y),Hi(Object.assign(Object.assign({},t),t.z),n.z)]});var t,n},equals:Zr.equals,writer:e=>eo},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z];return new Tr(e.document,{assembly:Qr,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Vt({constraint:n.components[s],initialValue:t,params:Oe(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:mt,value:t,viewProps:e.viewProps})}});class to{constructor(e=0,t=0,n=0,i=0){this.x=e,this.y=t,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(je(e))return!1;const t=e.x,n=e.y,i=e.z,s=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i&&"number"==typeof s}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const no={toComponents:e=>e.getComponents(),fromComponents:e=>new to(...e)};function io(e){return to.isObject(e)?new to(e.x,e.y,e.z,e.w):new to}function so(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}Cn({id:"input-point4d",type:"input",accept:(e,t)=>{if(!to.isObject(e))return null;const n=zt(t,(e=>Object.assign(Object.assign({},Ui(e)),{readonly:e.optional.constant(!1),w:e.optional.custom(Ki),x:e.optional.custom(Ki),y:e.optional.custom(Ki),z:e.optional.custom(Ki)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>io,constraint:e=>{return t=e.params,n=e.initialValue,new Ar({assembly:no,components:[Hi(Object.assign(Object.assign({},t),t.x),n.x),Hi(Object.assign(Object.assign({},t),t.y),n.y),Hi(Object.assign(Object.assign({},t),t.z),n.z),Hi(Object.assign(Object.assign({},t),t.w),n.w)]});var t,n},equals:to.equals,writer:e=>so},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z,e.params.w];return new Tr(e.document,{assembly:no,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Vt({constraint:n.components[s],initialValue:t,params:Oe(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:mt,value:t,viewProps:e.viewProps})}}),Cn({id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const n=zt(t,(e=>({readonly:e.optional.constant(!1),options:e.optional.custom(ai)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Ci,constraint:e=>function(e){const t=[],n=ci(e.options);return n&&t.push(n),new si(t)}(e.params),writer:e=>Yi},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&ri(i,oi);return s?new ui(t,{props:new Ge({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new bi(t,{parser:e=>e,props:Ge.fromObject({formatter:Pi}),value:n,viewProps:e.viewProps})},api:e=>"string"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof ui?new ti(e.controller):null});const ro={defaultInterval:200,defaultRows:3},oo=sn("mll");class ao{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(oo()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(oo("i")),n.style.height=`calc(var(${Ri("containerUnitSize")}) * ${t.rows})`,n.readOnly=!0,t.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach((e=>{void 0!==e&&n.push(this.formatter_(e))})),e.textContent=n.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class lo{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new ao(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const co=sn("sgl");class ho{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(co()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(co("i")),n.readOnly=!0,n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class po{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new ho(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}Cn({id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=zt(t,(e=>({readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>wi},controller:e=>{var t;return 1===e.value.rawValue.length?new po(e.document,{formatter:_i,value:e.value,viewProps:e.viewProps}):new lo(e.document,{formatter:_i,rows:null!==(t=e.params.rows)&&void 0!==t?t:ro.defaultRows,value:e.value,viewProps:e.viewProps})}});class uo extends Tt{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const mo=sn("grl");class vo{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(mo()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(Ut,"svg");n.classList.add(mo("g")),n.style.height=`calc(var(${Ri("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(Ut,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=e.createElement("div");s.classList.add(mo("t"),sn("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,n=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach(((o,a)=>{if(void 0===o)return;const l=gt(a,0,n,0,e),c=gt(o,i,s,t,0);r.push([l,c].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(mo("t","a"));const l=gt(this.cursor_.rawValue,0,n,0,e),c=gt(a,i,s,t,0);o.style.left=`${l}px`,o.style.top=`${c}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(mo("t","a"))||(o.classList.add(mo("t","a"),mo("t","in")),Kt(o),o.classList.remove(mo("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class fo{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=He(-1),this.view=new vo(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),Ht(e)){const e=new Si(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}importProps(e){return Ft(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0)))}exportProps(){return It(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(gt(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.rawValue=Math.floor(gt(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function go(e){return je(e.format)?ft(2):e.format}function bo(e){return"graph"===e.view}Cn({id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const n=zt(t,(e=>({format:e.optional.function,max:e.optional.number,min:e.optional.number,readonly:e.required.constant(!0),rows:e.optional.number,view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>bo(e)?64:1,reader:e=>vt},controller:e=>bo(e.params)?function(e){var t,n,i;return new fo(e.document,{formatter:go(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:ro.defaultRows,props:Ge.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:100,min:null!==(i=e.params.min)&&void 0!==i?i:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new po(e.document,{formatter:go(e.params),value:e.value,viewProps:e.viewProps}):new lo(e.document,{formatter:go(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:ro.defaultRows,value:e.value,viewProps:e.viewProps})}(e),api:e=>e.controller.valueController instanceof fo?new uo(e.controller):null}),Cn({id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const n=zt(t,(e=>({multiline:e.optional.boolean,readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Ci},controller:e=>{var t;const n=e.value;return n.rawValue.length>1||e.params.multiline?new lo(e.document,{formatter:Pi,rows:null!==(t=e.params.rows)&&void 0!==t?t:ro.defaultRows,value:n,viewProps:e.viewProps}):new po(e.document,{formatter:Pi,value:n,viewProps:e.viewProps})}});const wo={baseBackgroundColor:"hsl(230, 7%, 17%)",baseBorderRadius:"6px",baseFontFamily:"Roboto Mono, Source Code Pro, Menlo, Courier, monospace",baseShadowColor:"rgba(0, 0, 0, 0.2)",bladeBorderRadius:"2px",bladeHorizontalPadding:"4px",bladeValueWidth:"160px",buttonBackgroundColor:"hsl(230, 7%, 70%)",buttonBackgroundColorActive:"#d6d7db",buttonBackgroundColorFocus:"#c8cad0",buttonBackgroundColorHover:"#bbbcc4",buttonForegroundColor:"hsl(230, 7%, 17%)",containerBackgroundColor:"rgba(187, 188, 196, 0.1)",containerBackgroundColorActive:"rgba(187, 188, 196, 0.25)",containerBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",containerBackgroundColorHover:"rgba(187, 188, 196, 0.15)",containerForegroundColor:"hsl(230, 7%, 75%)",containerHorizontalPadding:"4px",containerUnitSize:"20px",containerUnitSpacing:"4px",containerVerticalPadding:"4px",grooveForegroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColorActive:"rgba(187, 188, 196, 0.25)",inputBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",inputBackgroundColorHover:"rgba(187, 188, 196, 0.15)",inputForegroundColor:"hsl(230, 7%, 75%)",labelForegroundColor:"rgba(187, 188, 196, 0.7)",monitorBackgroundColor:"rgba(0, 0, 0, 0.2)",monitorForegroundColor:"rgba(187, 188, 196, 0.7)",pluginImageDraggingColor:"hsla(230, 100%, 66%, 1)"};Object.keys(wo).reduce(((e,t)=>(e[t]=t,e)),{});const _o=new Map([["baseBackgroundColor","--tp-base-background-color"],["baseBorderRadius","--tp-base-border-radius"],["baseFontFamily","--tp-base-font-family"],["baseShadowColor","--tp-base-shadow-color"],["bladeBorderRadius","--tp-blade-border-radius"],["bladeHorizontalPadding","--tp-blade-horizontal-padding"],["bladeValueWidth","--tp-blade-value-width"],["buttonBackgroundColor","--tp-button-background-color"],["buttonBackgroundColorActive","--tp-button-background-color-active"],["buttonBackgroundColorFocus","--tp-button-background-color-focus"],["buttonBackgroundColorHover","--tp-button-background-color-hover"],["buttonForegroundColor","--tp-button-foreground-color"],["containerBackgroundColor","--tp-container-background-color"],["containerBackgroundColorActive","--tp-container-background-color-active"],["containerBackgroundColorFocus","--tp-container-background-color-focus"],["containerBackgroundColorHover","--tp-container-background-color-hover"],["containerForegroundColor","--tp-container-foreground-color"],["containerHorizontalPadding","--tp-container-horizontal-padding"],["containerUnitSize","--tp-container-unit-size"],["containerUnitSpacing","--tp-container-unit-spacing"],["containerVerticalPadding","--tp-container-vertical-padding"],["grooveForegroundColor","--tp-groove-foreground-color"],["inputBackgroundColor","--tp-input-background-color"],["inputBackgroundColorActive","--tp-input-background-color-active"],["inputBackgroundColorFocus","--tp-input-background-color-focus"],["inputBackgroundColorHover","--tp-input-background-color-hover"],["inputForegroundColor","--tp-input-foreground-color"],["labelForegroundColor","--tp-label-foreground-color"],["monitorBackgroundColor","--tp-monitor-background-color"],["monitorForegroundColor","--tp-monitor-foreground-color"],["pluginImageDraggingColor","--tp-plugin-image-dragging-color"]]);function yo(e){if(void 0!==e)return"string"==typeof e?e:Pr(e)?`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`:Cr(e)?`rgb(${e.r}, ${e.g}, ${e.b})`:void 0}function xo(e){if(e.startsWith("--tp-"))return e;const t=_o.get(e);if(t)return t;throw new Error(`Unknown Tweakpane CSS theme map variable key: "${e}"`)}function Co(e,t){return yo(void 0===e?.[t]?wo[t]:e[t])}function Po(e){let t,n=`${e[0]}px`;return{c(){t=x("div"),k(t,"background",null),k(t,"height",n)},m(e,n){_(e,t,n)},p(e,i){1&i&&n!==(n=`${e[0]}px`)&&k(t,"height",n)},d(e){e&&y(t)}}}function Eo(e){let n,i=e[0]>0&&Po(e);return{c(){i&&i.c(),n=E()},m(e,t){i&&i.m(e,t),_(e,n,t)},p(e,[t]){e[0]>0?i?i.p(e,t):(i=Po(e),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},i:t,o:t,d(e){e&&y(n),i&&i.d(e)}}}function $o(e){return Number.parseFloat(e.replace("px",""))}function ko(e,t,n){let i,{theme:s}=t,{keysAdd:r=[]}=t,{keysSubtract:o=[]}=t,{extra:a}=t;return e.$$set=e=>{"theme"in e&&n(1,s=e.theme),"keysAdd"in e&&n(2,r=e.keysAdd),"keysSubtract"in e&&n(3,o=e.keysSubtract),"extra"in e&&n(4,a=e.extra)},e.$$.update=()=>{28&e.$$.dirty&&n(0,i=function(e,t,n=0){return e.reduce(((e,t)=>e+$o(Co(s,t))),0)-t.reduce(((e,t)=>e+$o(Co(s,t))),0)+n}(r,o,a))},[i,s,r,o,a]}class Vo extends ue{constructor(e){super(),pe(this,e,ko,Eo,a,{theme:1,keysAdd:2,keysSubtract:3,extra:4})}}function Lo(e){return"Pane"===e.constructor.name}function Mo(e,t,n){return Math.min(Math.max(e,t),n)}function So(e){let t=0,n=e;for(;null!==(n=n.previousElementSibling);)n.classList.contains("skip-element-index")||t++;return t}function Ao(e,...t){for(const n of t)n in e&&delete e[n];return e}function Do(e){e.isTrusted&&e.stopPropagation()}function jo(e,t,n,i){if(t){const s=t.querySelector(`.${n}`);if(s){const n=i?t.querySelector(`.${i}`):void 0;e?(s.removeEventListener("click",Do,{capture:!0}),s.style.cursor="pointer",n&&(n.style.display="block")):(s.addEventListener("click",Do,{capture:!0}),s.style.cursor="default",n&&(n.style.display="none"))}}else console.warn(`Title bar element not found with class "${n}"`)}function To(e){return Boolean(e.controller.valueController?.foldable_?.valMap_?.expanded?.value_)}function No(e){return null==e}function Bo(e){return null!==e&&"object"==typeof e}function Oo(e){return null!==e&&"object"==typeof e}function zo(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Fo(e,t){return Array.from(new Set([...Object.keys(e),...Object.keys(t)])).reduce(((n,i)=>{const s=e[i],r=t[i];return Oo(s)&&Oo(r)?Object.assign(Object.assign({},n),{[i]:Fo(s,r)}):Object.assign(Object.assign({},n),{[i]:i in t?r:s})}),{})}function Io(e){return!!Bo(e)&&"target"in e}const Ro={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:e=>`Not compatible with  plugin '${e.id}'`,propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class qo{static alreadyDisposed(){return new qo({type:"alreadydisposed"})}static notBindable(){return new qo({type:"notbindable"})}static notCompatible(e,t){return new qo({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new qo({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new qo({type:"shouldneverhappen"})}constructor(e){var t;this.message=null!==(t=Ro[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Uo{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return null!==e&&("object"==typeof e||"function"==typeof e)}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const n=this.read();if(!Uo.isBindable(n))throw qo.notBindable();if(!(e in n))throw qo.propertyNotFound(e);n[e]=t}}class Ko{constructor(){this.observers_={}}on(e,t,n){var i;let s=this.observers_[e];return s||(s=this.observers_[e]=[]),s.push({handler:t,key:null!==(i=null==n?void 0:n.key)&&void 0!==i?i:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter((e=>e.key!==t))),this}emit(e,t){const n=this.observers_[e];n&&n.forEach((e=>{e.handler(t)}))}}class Ho{constructor(e,t){var n;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(n=null==t?void 0:t.equals)&&void 0!==n?n:(e,t)=>e===t,this.emitter=new Ko,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;(!this.equals_(s,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:i,sender:this}))}}class Go{constructor(e){this.emitter=new Ko,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},i=this.value_;(i!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:this.value_,sender:this}))}}class Yo{constructor(e){this.emitter=new Ko,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Xo(e,t){const n=null==t?void 0:t.constraint,i=null==t?void 0:t.equals;return n||i?new Ho(e,t):new Go(e)}class Wo{constructor(e){this.emitter=new Ko,this.valMap_=e;for(const e in this.valMap_){this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}}static createCore(e){return Object.keys(e).reduce(((t,n)=>Object.assign(t,{[n]:Xo(e[n])})),{})}static fromObject(e){const t=this.createCore(e);return new Wo(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class Zo{constructor(e){this.values=Wo.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class Qo{constructor(e){this.values=Wo.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let i=e;return No(n)||(i=Math.max(i,n)),No(t)||(i=Math.min(i,t)),i}}class Jo{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}class ea{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const ta={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class na{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=ta[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ia={"+":e=>e,"-":e=>-e,"~":e=>~e};class sa{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=ia[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ra(e){return(t,n)=>{for(let i=0;i<e.length;i++){const s=e[i](t,n);if(""!==s)return s}return""}}function oa(e,t){var n;const i=e.substr(t).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function aa(e,t){var n;const i=e.substr(t).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function la(e,t){const n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";const i=function(e,t){const n=aa(e,t);if(""!==n)return n;const i=e.substr(t,1);if("-"!==i&&"+"!==i)return"";const s=aa(e,t+=1);return""===s?"":i+s}(e,t);return""===i?"":n+i}function ca(e,t){const n=e.substr(t,1);if("0"===n)return n;const i=function(e,t){const n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=i.length,""===i?"":i+aa(e,t)}const ha=ra([function(e,t){const n=ca(e,t);if(t+=n.length,""===n)return"";const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const s=aa(e,t);return n+i+s+la(e,t+=s.length)},function(e,t){const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const i=aa(e,t);return t+=i.length,""===i?"":n+i+la(e,t)},function(e,t){const n=ca(e,t);return t+=n.length,""===n?"":n+la(e,t)}]);const pa=ra([function(e,t){const n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";const i=function(e,t){var n;const i=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}(e,t);return""===i?"":n+i}]),ua=ra([pa,ha]);function da(e,t){var n;return null!==(n=function(e,t){const n=ua(e,t);return t+=n.length,""===n?null:{evaluable:new ea(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){const n=e.substr(t,1);if(t+=n.length,"("!==n)return null;const i=fa(e,t);if(!i)return null;t=i.cursor,t+=oa(e,t).length;const s=e.substr(t,1);return t+=s.length,")"!==s?null:{evaluable:i.evaluable,cursor:t}}(e,t)}function ma(e,t,n){n+=oa(t,n).length;const i=e.filter((e=>t.startsWith(e,n)))[0];return i?(n+=i.length,{cursor:n+=oa(t,n).length,operator:i}):null}const va=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(n,i)=>{const s=e(n,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const s=ma(t,n,i);if(!s)break;i=s.cursor;const o=e(n,i);if(!o)return null;i=o.cursor,r=new na(s.operator,r,o.evaluable)}return r?{cursor:i,evaluable:r}:null}}(e,t)),(function e(t,n){const i=da(t,n);if(i)return i;const s=t.substr(n,1);if(n+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=e(t,n);return r?{cursor:n=r.cursor,evaluable:new sa(s,r.evaluable)}:null}));function fa(e,t){return t+=oa(e,t).length,va(e,t)}function ga(e){var t;const n=function(e){const t=fa(e,0);return t?t.cursor+oa(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function ba(e){if("number"==typeof e)return e;if("string"==typeof e){const t=ga(e);if(!No(t))return t}return 0}function wa(e){return String(e)}function _a(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}function ya(e,t,n,i,s){return i+(e-t)/(n-t)*(s-i)}function xa(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ca(e,t,n){return Math.min(Math.max(e,t),n)}function Pa(e,t){return(e%t+t)%t}function Ea(e,t){return No(e.step)?Math.max(xa(t),2):xa(e.step)}function $a(e){var t;return null!==(t=e.step)&&void 0!==t?t:1}function ka(e,t){var n;const i=Math.abs(null!==(n=e.step)&&void 0!==n?n:t);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function Va(e,t){return No(e.step)?null:new Jo(e.step,t)}function La(e){return No(e.max)||No(e.min)?No(e.max)&&No(e.min)?null:new Qo({max:e.max,min:e.min}):new Zo({max:e.max,min:e.min})}function Ma(e,t){var n,i,s;return{formatter:null!==(n=e.format)&&void 0!==n?n:_a(Ea(e,t)),keyScale:null!==(i=e.keyScale)&&void 0!==i?i:$a(e),pointerScale:null!==(s=e.pointerScale)&&void 0!==s?s:ka(e,t)}}function Sa(e){return{format:e.optional.function,keyScale:e.optional.number,max:e.optional.number,min:e.optional.number,pointerScale:e.optional.number,step:e.optional.number}}function Aa(e){return{constraint:e.constraint,textProps:Wo.fromObject(Ma(e.params,e.initialValue))}}class Da{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class ja{constructor(e){this.target=e}}class Ta extends ja{constructor(e,t,n){super(e),this.value=t,this.last=null==n||n}}class Na extends ja{constructor(e,t){super(e),this.expanded=t}}class Ba extends ja{constructor(e,t){super(e),this.index=t}}class Oa extends ja{constructor(e,t){super(e),this.native=t}}class za extends Da{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Ko,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Ta(this,t.binding.target.read(),e.options.last))}}class Fa{constructor(e,t){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t,this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new Ko}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Ia(e){return t=>n=>{if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};const i=e(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Ra(e){return{custom:t=>Ia(t)(e),boolean:Ia((e=>"boolean"==typeof e?e:void 0))(e),number:Ia((e=>"number"==typeof e?e:void 0))(e),string:Ia((e=>"string"==typeof e?e:void 0))(e),function:Ia((e=>"function"==typeof e?e:void 0))(e),constant:t=>Ia((e=>e===t?t:void 0))(e),raw:Ia((e=>e))(e),object:t=>Ia((e=>{var n;if(null!==(n=e)&&"object"==typeof n)return function(e,t){return Object.keys(t).reduce(((n,i)=>{if(void 0===n)return;const s=(0,t[i])(e[i]);return s.succeeded?Object.assign(Object.assign({},n),{[i]:s.value}):void 0}),{})}(e,t)}))(e),array:t=>Ia((e=>{var n;if(Array.isArray(e))return n=t,e.reduce(((e,t)=>{if(void 0===e)return;const i=n(t);return i.succeeded&&void 0!==i.value?[...e,i.value]:void 0}),[])}))(e)}}const qa={optional:Ra(!0),required:Ra(!1)};function Ua(e,t){const n=t(qa),i=qa.required.object(n)(e);return i.succeeded?i.value:void 0}function Ka(e,t,n,i){if(t&&!t(e))return!1;const s=Ua(e,n);return!!s&&i(s)}function Ha(e,t){var n;return Fo(null!==(n=null==e?void 0:e())&&void 0!==n?n:{},t)}function Ga(e){return"value"in e}function Ya(e){if(!Bo(e)||!("binding"in e))return!1;return Io(e.binding)}const Xa="http://www.w3.org/2000/svg";function Wa(e){e.offsetHeight}function Za(e){return void 0!==e.ontouchstart}function Qa(){return globalThis.document}const Ja={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function el(e,t){const n=e.createElementNS(Xa,"svg");return n.innerHTML=Ja[t],n}function tl(e,t,n){e.insertBefore(t,e.children[n])}function nl(e){e.parentElement&&e.parentElement.removeChild(e)}function il(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function sl(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}function rl(e,t){e.emitter.on("change",(e=>{t(e.rawValue)})),t(e.rawValue)}function ol(e,t,n){rl(e.value(t),n)}const al="tp";function ll(e){return(t,n)=>[al,"-",e,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}const cl=ll("lbl");class hl{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cl()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(cl("l")),ol(t.props,"label",(t=>{No(t)?this.element.classList.add(cl(void 0,"nol")):(this.element.classList.remove(cl(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(n),n.appendChild(function(e,t){const n=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,i)=>{i>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(e,t)))})),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("div");i.classList.add(cl("v")),this.element.appendChild(i),this.valueElement=i}}class pl{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new hl(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Ka(e,null,(e=>({label:e.optional.string})),(e=>(this.props.set("label",e.label),!0)))}exportProps(){return Ha(null,{label:this.props.get("label")})}}const ul=ll(""),dl={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class ml{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(ul(void 0,dl[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(ul(void 0,dl[e]))}))})),this.viewProps.handleDispose((()=>{nl(t)}))}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Ka(e,null,(e=>({disabled:e.required.boolean,hidden:e.required.boolean})),(e=>(this.viewProps.importState(e),!0)))}exportState(){return Ha(null,Object.assign({},this.viewProps.exportState()))}}class vl extends ml{constructor(e,t){if(t.value!==t.valueController.value)throw qo.shouldNeverHappen();const n=t.valueController.viewProps,i=new pl(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new hl(e,{props:t.props,viewProps:n}),viewProps:n})),this.labelController=i,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return Ka(e,(t=>{var n,i,s;return super.importState(t)&&this.labelController.importProps(t)&&(null===(s=null===(i=(n=this.valueController).importProps)||void 0===i?void 0:i.call(n,e))||void 0===s||s)}),(e=>({value:e.optional.raw})),(e=>(e.value&&(this.value.rawValue=e.value),!0)))}exportState(){var e,t,n;return Ha((()=>super.exportState()),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),null!==(n=null===(t=(e=this.valueController).exportProps)||void 0===t?void 0:t.call(e))&&void 0!==n?n:{}))}}function fl(e){const t=Object.assign({},e);return delete t.value,t}class gl extends vl{constructor(e,t){super(e,t),this.tag=t.tag}importState(e){return Ka(e,(t=>super.importState(fl(e))),(e=>({tag:e.optional.string})),(e=>(this.tag=e.tag,!0)))}exportState(){return Ha((()=>fl(super.exportState())),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}class bl extends gl{importState(e){return Ka(e,(e=>super.importState(e)),(e=>({binding:e.required.object({value:e.required.raw})})),(e=>(this.value.binding.inject(e.binding.value),this.value.fetch(),!0)))}}function wl(e){return Ga(e)&&function(e){if(!("binding"in e))return!1;const t=e.binding;return Io(t)&&"read"in t&&"write"in t}(e.value)}function _l(e,t){for(;e.length<t;)e.push(void 0)}function yl(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}class xl{constructor(e){this.emitter=new Ko,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e.binding,this.value_=Xo(function(e){const t=[];return _l(t,e),t}(e.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=function(e,t){const n=[...yl(e),t];return n.length>e.length?n.splice(0,n.length-e.length):_l(n,e.length),n}(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}class Cl extends gl{exportState(){return Ha((()=>super.exportState()),{binding:{readonly:!0}})}}function Pl(e){return Ga(e)&&function(e){if(!("binding"in e))return!1;const t=e.binding;return Io(t)&&"read"in t&&!("write"in t)}(e.value)}class El extends Da{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return null!==(e=this.controller.buttonController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller.buttonController.emitter.on(e,(e=>{n(new Oa(this,e.nativeEvent))})),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function $l(e,t){return n=>{!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function kl(e,t){rl(e,(e=>{t.textContent=null!=e?e:""}))}const Vl=ll("btn");class Ll{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Vl()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(Vl("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(Vl("t")),kl(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class Ml{constructor(e,t){this.emitter=new Ko,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Ll(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Ka(e,null,(e=>({title:e.optional.string})),(e=>(this.props.set("title",e.title),!0)))}exportProps(){return Ha(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class Sl extends ml{constructor(e,t){const n=new Ml(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new pl(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:t.viewProps}),this.buttonController=n,this.labelController=i}importState(e){return Ka(e,(e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e)),(()=>({})),(()=>!0))}exportState(){return Ha((()=>super.exportState()),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Al{constructor(e){const[t,n]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}const Dl=new Al("2.0.5");function jl(e){return Object.assign({core:Dl},e)}const Tl=jl({id:"button",type:"blade",accept(e){const t=Ua(e,(e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new Sl(e.document,{blade:e.blade,buttonProps:Wo.fromObject({title:e.params.title}),labelProps:Wo.fromObject({label:e.params.label}),viewProps:e.viewProps}),api:e=>e.controller instanceof Sl?new El(e.controller):null});class Nl{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Ko,this.pool_=t;this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map((e=>this.pool_.createApi(e)))}addBinding(e,t,n){const i=null!=n?n:{},s=this.controller_.element.ownerDocument,r=this.pool_.createBinding(s,function(e,t){if(!Uo.isBindable(e))throw qo.notBindable();return new Uo(e,t)}(e,t),i),o=this.pool_.createBindingApi(r);return this.add(o,i.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){const n=e.controller;return this.controller_.rack.add(n,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,n=this.pool_.createBlade(t,e),i=this.pool_.createApi(n);return this.add(i,e.index)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach((e=>{var t;Bo(t=e)&&"refresh"in t&&"function"==typeof t.refresh&&e.refresh()}))}onRackValueChange_(e){const t=e.bladeController,n=this.pool_.createApi(t),i=Ya(t.value)?t.value.binding:null;this.emitter_.emit("change",new Ta(n,i?i.target.read():t.value.rawValue,e.options.last))}}class Bl extends Da{constructor(e,t){super(e),this.rackApi_=new Nl(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class Ol extends ml{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Ka(e,(e=>super.importState(e)),(e=>({children:e.required.array(e.required.raw)})),(e=>this.rackController.rack.children.every(((t,n)=>t.importState(e.children[n])))))}exportState(){return Ha((()=>super.exportState()),{children:this.rackController.rack.children.map((e=>e.exportState()))})}}function zl(e){return"rackController"in e}class Fl{constructor(e){this.emitter=new Ko,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw qo.shouldNeverHappen();const n=void 0!==t?t:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.allItems().forEach((e=>{this.cache_.delete(e)})),n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function Il(e){return zl(e)?e.rackController.rack.bcSet_:null}class Rl{constructor(e){var t,n;this.emitter=new Ko,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=null!==(t=e.blade)&&void 0!==t?t:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new Fl(Il),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),Ga(n))n.value.emitter.on("change",this.onChildValueChange_);else if(zl(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.on("layout",this.onRackLayout_),t.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const n=e.item;if(Ga(n))n.value.emitter.off("change",this.onChildValueChange_);else if(zl(n)){const e=n.rackController.rack;if(e){const t=e.emitter;t.off("layout",this.onRackLayout_),t.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],n=e[e.length-1];this.bcSet_.items.forEach((e=>{const i=[];e===t&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),e===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),e.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildValueChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(Ga(i)&&i.value===t)return i}return null}(this.find(Ga),e.sender);if(!t)throw qo.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class ql{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new Rl({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--){this.rack.children[e].viewProps.set("disposed",!0)}}))}onRackAdd_(e){e.root&&tl(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&nl(e.bladeController.view.element)}}function Ul(){return new Wo({positions:Xo([],{equals:zo})})}class Kl extends Wo{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=Wo.createCore(t);return new Kl(n)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!No(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};ol(this,"expanded",n),ol(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Hl(e,t){t.style.height=e.styleHeight}function Gl(e,t){e.value("expanded").emitter.on("beforechange",(()=>{if(e.set("completed",!1),No(e.get("expandedHeight"))){const n=function(e,t){let n=0;return function(e,t){const n=e.style.transition;e.style.transition="none",t(),e.style.transition=n}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),Wa(t),n=t.clientHeight,e.set("temporaryExpanded",null),Wa(t)})),n}(e,t);n>0&&e.set("expandedHeight",n)}e.set("shouldFixHeight",!0),Wa(t)})),e.emitter.on("change",(()=>{Hl(e,t)})),Hl(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&e.cleanUpTransition()}))}class Yl extends Bl{constructor(e,t){super(e,t),this.emitter_=new Ko,this.controller.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",new Na(this,e.sender.rawValue))})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)}))}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const Xl=ll("cnt");class Wl{constructor(e,t){var n;this.className_=ll(null!==(n=t.viewName)&&void 0!==n?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Xl()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),ol(this.foldable_,"completed",$l(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),ol(t.props,"title",(e=>{No(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(this.className_("t")),kl(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class Zl extends Ol{constructor(e,t){var n;const i=Kl.create(null===(n=t.expanded)||void 0===n||n),s=new Wl(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new ql({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,Gl(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Ka(e,(e=>super.importState(e)),(e=>({expanded:e.required.boolean,title:e.optional.string})),(e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0)))}exportState(){return Ha((()=>super.exportState()),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Ql=jl({id:"folder",type:"blade",accept(e){const t=Ua(e,(e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean})));return t?{params:t}:null},controller:e=>new Zl(e.document,{blade:e.blade,expanded:e.params.expanded,props:Wo.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof Zl?new Yl(e.controller,e.pool):null}),Jl=ll("");function ec(e,t){return $l(e,Jl(void 0,t))}class tc extends Wo{constructor(e){var t,n;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=(n=Xo(this.getGlobalDisabled_()),[new Yo(n),(e,t)=>{n.setRawValue(e,t)}]),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,i;const s=null!=e?e:{};return new tc(Wo.createCore({disabled:null!==(t=s.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(n=s.hidden)&&void 0!==n&&n,parent:null!==(i=s.parent)&&void 0!==i?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){rl(this.globalDisabled_,ec(e,"disabled")),ol(this,"hidden",ec(e,"hidden"))}bindDisabled(e){rl(this.globalDisabled_,(t=>{e.disabled=t}))}bindTabIndex(e){rl(this.globalDisabled_,(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const nc=ll("tbp");class ic{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nc()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(nc("c")),this.element.appendChild(n),this.containerElement=n}}const sc=ll("tbi");class rc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(sc()),t.viewProps.bindClassModifiers(this.element),ol(t.props,"selected",(e=>{e?this.element.classList.add(sc(void 0,"sel")):this.element.classList.remove(sc(void 0,"sel"))}));const n=e.createElement("button");n.classList.add(sc("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElement("div");i.classList.add(sc("t")),kl(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class oc{constructor(e,t){this.emitter=new Ko,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new rc(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ac extends Ol{constructor(e,t){const n=new ic(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new ql({blade:t.blade,element:n.containerElement,viewProps:t.viewProps}),view:n})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new oc(e,{props:t.itemProps,viewProps:tc.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,ol(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}importState(e){return Ka(e,(e=>super.importState(e)),(e=>({selected:e.required.boolean,title:e.required.string})),(e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0)))}exportState(){return Ha((()=>super.exportState()),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class lc extends Bl{constructor(e,t){super(e,t),this.emitter_=new Ko,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",e)})),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,n=new ac(t,{blade:Ul(),itemProps:Wo.fromObject({selected:!1,title:e.title}),props:Wo.fromObject({selected:!1}),viewProps:tc.create()}),i=this.pool_.createApi(n);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Ba(this,e.rawValue))}}class cc extends Bl{get title(){var e;return null!==(e=this.controller.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,n){return this.rackApi_.addBinding(e,t,n)}addBlade(e){return this.rackApi_.addBlade(e)}}class hc{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Xo(!0),this.selectedIndex=Xo(-1),this.items_=[]}add(e,t){const n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const e=this.items_.findIndex((e=>e.rawValue));e<0?(this.items_.forEach(((e,t)=>{e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex((t=>t===e.sender));this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const pc=ll("tab");class uc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(pc(),Xl()),t.viewProps.bindClassModifiers(this.element),rl(t.empty,$l(this.element,pc(void 0,"nop")));const n=e.createElement("div");n.classList.add(pc("t")),this.element.appendChild(n),this.itemsElement=n;const i=e.createElement("div");i.classList.add(pc("i")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(pc("c")),this.element.appendChild(s),this.contentsElement=s}}class dc extends Ol{constructor(e,t){const n=new hc,i=new uc(e,{empty:n.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new ql({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=n}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;tl(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;nl(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}const mc=jl({id:"tab",type:"blade",accept(e){const t=Ua(e,(e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")})));return t&&0!==t.pages.length?{params:t}:null},controller(e){const t=new dc(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((n=>{const i=new ac(e.document,{blade:Ul(),itemProps:Wo.fromObject({selected:!1,title:n.title}),props:Wo.fromObject({selected:!1}),viewProps:tc.create()});t.add(i)})),t},api:e=>e.controller instanceof dc?new lc(e.controller,e.pool):e.controller instanceof ac?new cc(e.controller,e.pool):null});class vc extends za{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class fc{constructor(){this.disabled=!1,this.emitter=new Ko}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class gc{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Ko,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class bc{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function wc(e,t){if(e instanceof t)return e;if(e instanceof bc){const n=e.constraints.reduce(((e,n)=>e||(n instanceof t?n:null)),null);if(n)return n}return null}class _c{constructor(e){this.values=Wo.fromObject({options:e})}constrain(e){const t=this.values.get("options");if(0===t.length)return e;return t.filter((t=>t.value===e)).length>0?e:t[0].value}}function yc(e){var t;const n=qa;return Array.isArray(e)?null===(t=Ua({items:e},(e=>({items:e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))}))))||void 0===t?void 0:t.items:"object"==typeof e?n.required.raw(e).value:void 0}function xc(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((n=>{t.push({text:n,value:e[n]})})),t}function Cc(e){return No(e)?null:new _c(xc(e))}const Pc=ll("lst");class Ec{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Pc()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(Pc("s")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=e.createElement("div");i.classList.add(Pc("m")),i.appendChild(el(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,ol(this.props_,"options",(t=>{il(this.selectElement),t.forEach((t=>{const n=e.createElement("option");n.textContent=t.text,this.selectElement.appendChild(n)})),this.update_()}))}update_(){const e=this.props_.get("options").map((e=>e.value));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class $c{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Ec(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Ka(e,null,(e=>({options:e.required.custom(yc)})),(e=>(this.props.set("options",xc(e.options)),!0)))}exportProps(){return Ha(null,{options:this.props.get("options")})}}const kc=ll("pop");class Vc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(kc()),t.viewProps.bindClassModifiers(this.element),rl(t.shows,$l(this.element,kc(void 0,"v")))}}class Lc{constructor(e,t){this.shows=Xo(!1),this.viewProps=t.viewProps,this.view=new Vc(e,{shows:this.shows,viewProps:this.viewProps})}}const Mc=ll("txt");class Sc{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Mc()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(Mc("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Ac{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Sc(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);No(n)||(this.value.rawValue=n),this.view.refresh()}}function Dc(e){return"false"!==e&&!!e}function jc(e){return function(e){return String(e)}(e)}const Tc=_a(0);function Nc(e){return Tc(e)+"%"}function Bc(e){return String(e)}function Oc(e){return e}function zc({primary:e,secondary:t,forward:n,backward:i}){let s=!1;function r(e){s||(s=!0,e(),s=!1)}e.emitter.on("change",(i=>{r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),i.options)}))})),t.emitter.on("change",(s=>{r((()=>{e.setRawValue(i(e.rawValue,t.rawValue),s.options)})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),s.options)}))})),r((()=>{t.setRawValue(n(e.rawValue,t.rawValue),{forceEmit:!1,last:!0})}))}function Fc(e,t){const n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function Ic(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function Rc(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function qc(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Uc(e,t){var n,i;const s=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=s&&s.scrollX)&&void 0!==n?n:0)+r.left),y:e.pageY-((null!==(i=s&&s.scrollY)&&void 0!==i?i:0)+r.top)}}class Kc{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Ko,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Uc(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Uc(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Uc(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const Hc=ll("txt");class Gc{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Hc(),Hc(void 0,"num")),t.arrayPosition&&this.element.classList.add(Hc(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Hc("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Hc()),this.inputElement.classList.add(Hc("i"));const i=e.createElement("div");i.classList.add(Hc("k")),this.element.appendChild(i),this.knobElement=i;const s=e.createElementNS(Xa,"svg");s.classList.add(Hc("g")),this.knobElement.appendChild(s);const r=e.createElementNS(Xa,"path");r.classList.add(Hc("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=e.createElementNS(Xa,"path");o.classList.add(Hc("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(ll("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(Hc(void 0,"drg"));this.element.classList.add(Hc(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),n=t+(t>0?-1:t<0?1:0),i=Ca(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Yc{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=null!==(n=t.sliderProps)&&void 0!==n?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=Xo(null),this.view=new Gc(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Kc(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const i=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("min"),s=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("max");let r=e;return void 0!==i&&(r=Math.max(r,i)),void 0!==s&&(r=Math.min(r,s)),r}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);No(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(e){const t=Fc(this.props.get("keyScale"),Ic(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Fc(this.props.get("keyScale"),Ic(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Xc=ll("sld");class Wc{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Xc()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Xc("t")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(Xc("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Ca(ya(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Zc{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Wc(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kc(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(ya(Ca(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Fc(this.props.get("keyScale"),Rc(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Fc(this.props.get("keyScale"),Rc(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Qc=ll("sldtxt");class Jc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Qc());const n=e.createElement("div");n.classList.add(Qc("s")),this.sliderView_=t.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Qc("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class eh{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Zc(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Yc(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Jc(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Ka(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>{const t=this.sliderC_.props;return t.set("max",e.max),t.set("min",e.min),!0}))}exportProps(){const e=this.sliderC_.props;return Ha(null,{max:e.get("max"),min:e.get("min")})}}function th(e){return{sliderProps:new Wo({keyScale:e.keyScale,max:e.max,min:e.min}),textProps:new Wo({formatter:Xo(e.formatter),keyScale:e.keyScale,pointerScale:Xo(e.pointerScale)})}}const nh={containerUnitSize:"cnt-usz"};function ih(e){return`--${nh[e]}`}function sh(e){return Sa(e)}function rh(e){if(Oo(e))return Ua(e,sh)}function oh(e,t){if(!e)return;const n=[],i=Va(e,t);i&&n.push(i);const s=La(e);return s&&n.push(s),new bc(n)}function ah(e){if("inline"===e||"popup"===e)return e}function lh(e,t){e.write(t)}const ch=ll("ckb");class hh{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ch()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(ch("l")),this.element.appendChild(n),this.labelElement=n;const i=e.createElement("input");i.classList.add(ch("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(ch("w")),this.labelElement.appendChild(s);const r=el(e,"check");s.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ph{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new hh(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}const uh=jl({id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=Ua(t,(e=>({options:e.optional.custom(yc),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Dc,constraint:e=>function(e){const t=[],n=Cc(e.options);return n&&t.push(n),new bc(t)}(e.params),writer:e=>lh},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&wc(i,_c);return s?new $c(t,{props:new Wo({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new ph(t,{value:n,viewProps:e.viewProps})},api:e=>"boolean"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof $c?new vc(e.controller):null}),dh=ll("col");class mh{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(dh()),t.foldable.bindExpandedClass(this.element,dh(void 0,"expanded")),ol(t.foldable,"completed",$l(this.element,dh(void 0,"cpl")));const n=e.createElement("div");n.classList.add(dh("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(dh("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add(dh("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(dh("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function vh(e,t,n){const i=Pa(e,360),s=Ca(t/100,0,1),r=Ca(n/100,0,1),o=r*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}function fh(e){return[e[0],e[1],e[2]]}function gh(e,t){return[e[0],e[1],e[2],t]}const bh={hsl:{hsl:(e,t,n)=>[e,t,n],hsv:function(e,t,n){const i=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==i?t*(100-Math.abs(2*n-100))/i:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){const i=(e%360+360)%360,s=Ca(t/100,0,1),r=Ca(n/100,0,1),o=(1-Math.abs(2*r-1))*s,a=o*(1-Math.abs(i/60%2-1)),l=r-o/2;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}},hsv:{hsl:function(e,t,n){const i=100-Math.abs(n*(200-t)/100-100);return[e,0!==i?t*n/i:0,n*(200-t)/200]},hsv:(e,t,n)=>[e,t,n],rgb:vh},rgb:{hsl:function(e,t,n){const i=Ca(e/255,0,1),s=Ca(t/255,0,1),r=Ca(n/255,0,1),o=Math.max(i,s,r),a=Math.min(i,s,r),l=o-a;let c=0,h=0;const p=(a+o)/2;return 0!==l&&(h=l/(1-Math.abs(o+a-1)),c=i===o?(s-r)/l:s===o?2+(r-i)/l:4+(i-s)/l,c=c/6+(c<0?1:0)),[360*c,100*h,100*p]},hsv:function(e,t,n){const i=Ca(e/255,0,1),s=Ca(t/255,0,1),r=Ca(n/255,0,1),o=Math.max(i,s,r),a=o-Math.min(i,s,r);let l;return l=0===a?0:o===i?((s-r)/a%6+6)%6*60:o===s?60*((r-i)/a+2):60*((i-s)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,n)=>[e,t,n]}};function wh(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function _h(e,t,n){var i;const s=wh(t,n);return["rgb"===t?Ca(e[0],0,s[0]):(r=e[0],o=s[0],r===o?o:Pa(r,o)),Ca(e[1],0,s[1]),Ca(e[2],0,s[2]),Ca(null!==(i=e[3])&&void 0!==i?i:1,0,1)];var r,o}function yh(e,t,n,i){const s=wh(t,n),r=wh(t,i);return e.map(((e,t)=>e/s[t]*r[t]))}function xh(e,t,n){const i=yh(e,t.mode,t.type,"int");return yh(bh[t.mode][n.mode](...i),n.mode,"int",n.type)}class Ch{static black(){return new Ch([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=_h(e,t,this.type)}getComponents(e){return gh(xh(fh(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Ph=ll("colp");class Eh{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Ph()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ph("hsv"));const i=e.createElement("div");i.classList.add(Ph("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(Ph("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);const r=e.createElement("div");if(r.classList.add(Ph("rgb")),this.textsView_=t.textsView,r.appendChild(this.textsView_.element),this.element.appendChild(r),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const n=e.createElement("div");n.classList.add(Ph("a"));const i=e.createElement("div");i.classList.add(Ph("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const s=e.createElement("div");s.classList.add(Ph("at")),s.appendChild(this.alphaViews_.text.element),n.appendChild(s),this.element.appendChild(n)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function $h(e){return"int"===e?"int":"float"===e?"float":void 0}function kh(e){return Ua(e,(e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom($h)}),expanded:e.optional.boolean,picker:e.optional.custom(ah),readonly:e.optional.constant(!1)})))}function Vh(e){return e?.1:1}function Lh(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}class Mh{constructor(e,t){this.type="float",this.mode=t,this.comps_=_h(e,t,this.type)}getComponents(e){return gh(xh(fh(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Sh={int:(e,t)=>new Ch(e,t),float:(e,t)=>new Mh(e,t)};function Ah(e,t,n){return Sh[n](e,t)}function Dh(e,t){if(e.type===t)return e;if(function(e){return"int"===e.type}(e)&&"float"===t)return function(e){const t=e.getComponents(),n=wh(e.mode,"int");return new Mh([ya(t[0],0,n[0],0,1),ya(t[1],0,n[1],0,1),ya(t[2],0,n[2],0,1),t[3]],e.mode)}(e);if(function(e){return"float"===e.type}(e)&&"int"===t)return function(e){const t=e.getComponents(),n=wh(e.mode,"int");return new Ch([Math.round(ya(t[0],0,1,0,n[0])),Math.round(ya(t[1],0,1,0,n[1])),Math.round(ya(t[2],0,1,0,n[2])),t[3]],e.mode)}(e);throw qo.shouldNeverHappen()}function jh(e,t){const n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}const Th={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function Nh(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const n=parseFloat(t[1]),i=t[2];return Th[i](n)}function Bh(e){const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[jh(t[1],255),jh(t[2],255),jh(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Oh(e){const t=Bh(e);return t?new Ch(t,"rgb"):null}function zh(e){const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[jh(t[1],255),jh(t[2],255),jh(t[3],255),jh(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Fh(e){const t=zh(e);return t?new Ch(t,"rgb"):null}function Ih(e){const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Nh(t[1]),jh(t[2],100),jh(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Rh(e){const t=Ih(e);return t?new Ch(t,"hsl"):null}function qh(e){const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Nh(t[1]),jh(t[2],100),jh(t[3],100),jh(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Uh(e){const t=qh(e);return t?new Ch(t,"hsl"):null}function Kh(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Hh(e){const t=Kh(e);return t?new Ch(t,"rgb"):null}function Gh(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),ya(parseInt(t[4]+t[4],16),0,255,0,1)];const n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),ya(parseInt(n[4],16),0,255,0,1)]:null}function Yh(e){const t=Gh(e);return t?new Ch(t,"rgb"):null}function Xh(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Wh(e){return t=>{const n=Xh(t);return n?Ah(n,"rgb",e):null}}function Zh(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Qh(e){return t=>{const n=Zh(t);return n?Ah(n,"rgb",e):null}}const Jh=[{parser:Kh,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Gh,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Bh,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:zh,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Ih,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:qh,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Xh,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Zh,result:{alpha:!0,mode:"rgb",notation:"object"}}];function ep(e,t="int"){const n=function(e){return Jh.reduce(((t,{parser:n,result:i})=>t||(n(e)?i:null)),null)}(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}function tp(e){const t=[Hh,Yh,Oh,Fh,Rh,Uh];"int"===e&&t.push(Wh("int"),Qh("int")),"float"===e&&t.push(Wh("float"),Qh("float"));const n=function(e){return t=>e.reduce(((e,n)=>null!==e?e:n(t)),null)}(t);return t=>{const i=n(t);return i?Dh(i,e):null}}function np(e){const t=tp("int");if("string"!=typeof e)return Ch.black();const n=t(e);return null!=n?n:Ch.black()}function ip(e){const t=Ca(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function sp(e,t="#"){return`${t}${fh(e.getComponents("rgb")).map(ip).join("")}`}function rp(e,t="#"){const n=e.getComponents("rgb");return`${t}${[n[0],n[1],n[2],255*n[3]].map(ip).join("")}`}function op(e){const t=_a(0);return`rgb(${fh(Dh(e,"int").getComponents("rgb")).map((e=>t(e))).join(", ")})`}function ap(e){const t=_a(2),n=_a(0),i=Dh(e,"int").getComponents("rgb").map(((e,i)=>(3===i?t:n)(e)));return`rgba(${i.join(", ")})`}function lp(e,t){const n=_a("float"===t?2:0),i=["r","g","b"],s=fh(Dh(e,t).getComponents("rgb")).map(((e,t)=>`${i[t]}: ${n(e)}`));return`{${s.join(", ")}}`}function cp(e){return t=>lp(t,e)}function hp(e,t){const n=_a(2),i=_a("float"===t?2:0),s=["r","g","b","a"],r=Dh(e,t).getComponents("rgb").map(((e,t)=>`${s[t]}: ${(3===t?n:i)(e)}`));return`{${r.join(", ")}}`}function pp(e){return t=>hp(t,e)}const up=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:sp},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:rp},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:op},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:ap},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[_a(0),Nc,Nc],n=fh(Dh(e,"int").getComponents("hsl")).map(((e,n)=>t[n](e)));return`hsl(${n.join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[_a(0),Nc,Nc,_a(2)],n=Dh(e,"int").getComponents("hsl").map(((e,n)=>t[n](e)));return`hsla(${n.join(", ")})`}},...["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:cp(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:pp(t)}]),[])];function dp(e){return up.reduce(((t,n)=>{return t||(i=n.format,s=e,i.alpha===s.alpha&&i.mode===s.mode&&i.notation===s.notation&&i.type===s.type?n.stringifier:null);var i,s}),null)}const mp=ll("apl");class vp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(mp()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(mp("b")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(mp("c")),n.appendChild(i),this.colorElem_=i;const s=e.createElement("div");s.classList.add(mp("m")),this.element.appendChild(s),this.markerElem_=s;const r=e.createElement("div");r.classList.add(mp("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),n=new Ch([t[0],t[1],t[2],0],"rgb"),i=new Ch([t[0],t[1],t[2],255],"rgb"),s=["to right",ap(n),ap(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=ap(e);const r=ya(t[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class fp{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new vp(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kc(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=e.point.x/e.bounds.width,i=this.value.rawValue,[s,r,o]=i.getComponents("hsv");this.value.setRawValue(new Ch([s,r,o,n],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Fc(Vh(!0),Rc(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new Ch([i,s,r,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Fc(Vh(!0),Rc(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const gp=ll("coltxt");class bp{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(gp()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(gp("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}].reduce(((t,n)=>{const i=e.createElement("option");return i.textContent=n.text,i.value=n.value,t.appendChild(i),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(gp("ms")),n.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(gp("mm")),i.appendChild(el(e,"dropdown")),n.appendChild(i),this.element.appendChild(n);const s=e.createElement("div");s.classList.add(gp("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),rl(t.mode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){il(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach((t=>{const n=e.createElement("div");n.classList.add(gp("c")),n.appendChild(t.element),this.inputsElem_.appendChild(n)}))}}function wp(e,t,n){const i=wh(e,t)[n];return new Zo({min:0,max:i})}function _p(e,t){const n={colorMode:t.colorMode,colorType:t.colorType,parser:ga,viewProps:t.viewProps};return[0,1,2].map((i=>{const s=function(e,t,n){return new Yc(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",parser:t.parser,props:Wo.fromObject({formatter:(i=t.colorType,_a("float"===i?2:0)),keyScale:Vh(!1),pointerScale:"float"===t.colorType?.01:1}),value:Xo(0,{constraint:wp(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var i}(e,n,i);return zc({primary:t.value,secondary:s.value,forward:e=>Dh(e,t.colorType).getComponents(t.colorMode)[i],backward(e,n){const s=t.colorMode,r=Dh(e,t.colorType).getComponents(s);r[i]=n;return Dh(Ah(gh(fh(r),r[3]),s,t.colorType),"int")}}),s}))}class yp{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=Xo(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new bp(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return function(e){return"hex"!==e}(t)?_p(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):function(e,t){const n=new Ac(e,{parser:tp("int"),props:Wo.fromObject({formatter:sp}),value:Xo(Ch.black()),viewProps:t.viewProps});return zc({primary:t.value,secondary:n.value,forward:e=>new Ch(fh(e.getComponents()),e.mode),backward:(e,t)=>new Ch(gh(fh(t.getComponents(e.mode)),e.getComponents()[3]),e.mode)}),[n]}(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((e=>e.view))}}const xp=ll("hpl");class Cp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(xp()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(xp("c")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(xp("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=op(new Ch([t,100,100],"hsv"));const n=ya(t,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class Pp{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Cp(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kc(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=ya(Ca(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new Ch([n,s,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Fc(Vh(!1),Rc(e));if(0===t)return;const n=this.value.rawValue,[i,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new Ch([i+t,s,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Fc(Vh(!1),Rc(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ep=ll("svp");class $p{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ep()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=64,n.width=64,n.classList.add(Ep("c")),this.element.appendChild(n),this.canvasElement=n;const i=e.createElement("div");i.classList.add(Ep("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,s=e.getImageData(0,0,n,i),r=s.data;for(let e=0;e<i;e++)for(let s=0;s<n;s++){const o=ya(s,0,n,0,100),a=ya(e,0,i,100,0),l=vh(t[0],o,a),c=4*(e*n+s);r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=255}e.putImageData(s,0,0);const o=ya(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=ya(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class kp{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new $p(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kc(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=ya(e.point.x,0,e.bounds.width,0,100),i=ya(e.point.y,0,e.bounds.height,100,0),[s,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Ch([s,n,i,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){qc(e.key)&&e.preventDefault();const[t,n,i,s]=this.value.rawValue.getComponents("hsv"),r=Vh(!1),o=Fc(r,Rc(e)),a=Fc(r,Ic(e));0===o&&0===a||this.value.setRawValue(new Ch([t,n+o,i+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Vh(!1),n=Fc(t,Rc(e)),i=Fc(t,Ic(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Vp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Pp(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new kp(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new fp(e,{value:this.value,viewProps:this.viewProps}),text:new Yc(e,{parser:ga,props:Wo.fromObject({pointerScale:.01,keyScale:.1,formatter:_a(2)}),value:Xo(0,{constraint:new Zo({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&zc({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.getComponents()[3],backward:(e,t)=>{const n=e.getComponents();return n[3]=t,new Ch(n,e.mode)}}),this.textsC_=new yp(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Eh(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Lp=ll("colsw");class Mp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Lp()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Lp("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=e.createElement("button");i.classList.add(Lp("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=rp(e)}onValueChange_(){this.update_()}}class Sp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Mp(e,{value:this.value,viewProps:this.viewProps})}}class Ap{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Kl.create(t.expanded),this.swatchC_=new Sp(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Ac(e,{parser:t.parser,props:Wo.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new mh(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Lc(e,{viewProps:this.viewProps}):null;const i=new Vp(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),zc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Gl(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=sl(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!Za(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Dp(e){return fh(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function jp(e){return e.getComponents("rgb").reduce(((e,t,n)=>e<<8|255&Math.floor(3===n?255*t:t)),0)>>>0}function Tp(e){return"number"!=typeof e?Ch.black():new Ch([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function Np(e){return"number"!=typeof e?Ch.black():new Ch([(t=e)>>24&255,t>>16&255,t>>8&255,ya(255&t,0,255,0,1)],"rgb");var t}function Bp(e,t){return"object"==typeof e&&!No(e)&&(t in e&&"number"==typeof e[t])}function Op(e){return Bp(e,"r")&&Bp(e,"g")&&Bp(e,"b")}function zp(e){return Op(e)&&Bp(e,"a")}function Fp(e){return Op(e)}function Ip(e,t){if(e.mode!==t.mode)return!1;if(e.type!==t.type)return!1;const n=e.getComponents(),i=t.getComponents();for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}function Rp(e){return"a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b]}function qp(e,t){return(n,i)=>{e?function(e,t,n){const i=Dh(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}(n,i,t):function(e,t,n){const i=Dh(t,n).toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}(n,i,t)}}function Up(e){var t;return!!(null===(t=null==e?void 0:e.color)||void 0===t?void 0:t.alpha)}const Kp=jl({id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!function(e){return"color"in e||"color"===e.view}(t))return null;const n=kh(t);return n?{initialValue:e,params:Object.assign(Object.assign({},n),{supportsAlpha:Up(t)})}:null},binding:{reader:e=>e.params.supportsAlpha?Np:Tp,equals:Ip,writer:e=>function(e){const t=e?jp:Dp;return(e,n)=>{lh(e,t(n))}}(e.params.supportsAlpha)},controller:e=>{var t,n,i;return new Ap(e.document,{colorType:"int",expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:(i=e.params.supportsAlpha,i?e=>rp(e,"0x"):e=>sp(e,"0x")),parser:tp("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.supportsAlpha,value:e.value,viewProps:e.viewProps})}});function Hp(e){return t=>{const n=function(e,t){if(!Fp(e))return Dh(Ch.black(),t);if("int"===t){const t=Rp(e);return new Ch(t,"rgb")}if("float"===t){const t=Rp(e);return new Mh(t,"rgb")}return Dh(Ch.black(),"int")}(t,e);return Dh(n,"int")}}function Gp(e,t){return n=>e?hp(n,t):lp(n,t)}const Yp=jl({id:"input-color-object",type:"input",accept:(e,t)=>{var n;if(!Fp(e))return null;const i=kh(t);return i?{initialValue:e,params:Object.assign(Object.assign({},i),{colorType:null!==(n=Lh(t))&&void 0!==n?n:"int"})}:null},binding:{reader:e=>Hp(e.params.colorType),equals:Ip,writer:e=>qp(zp(e.initialValue),e.params.colorType)},controller:e=>{var t,n;const i=zp(e.initialValue);return new Ap(e.document,{colorType:e.params.colorType,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:Gp(i,e.params.colorType),parser:tp("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:i,value:e.value,viewProps:e.viewProps})}}),Xp=jl({id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("text"===t.view)return null;const n=ep(e,Lh(t));if(!n)return null;const i=dp(n);if(!i)return null;const s=kh(t);return s?{initialValue:e,params:Object.assign(Object.assign({},s),{format:n,stringifier:i})}:null},binding:{reader:()=>np,equals:Ip,writer:e=>{const t=function(e){const t=dp(e);return t?(e,n)=>{lh(e,t(n))}:null}(e.params.format);if(!t)throw qo.notBindable();return t}},controller:e=>{var t,n;return new Ap(e.document,{colorType:e.params.format.type,expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,formatter:e.params.stringifier,parser:tp("int"),pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",supportsAlpha:e.params.format.alpha,value:e.value,viewProps:e.viewProps})}});class Wp{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var n,i;return null!==(i=null===(n=this.components[t])||void 0===n?void 0:n.constrain(e))&&void 0!==i?i:e}));return this.asm_.fromComponents(t)}}const Zp=ll("pndtxt");class Qp{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Zp()),this.textViews.forEach((t=>{const n=e.createElement("div");n.classList.add(Zp("a")),n.appendChild(t.element),this.element.appendChild(n)}))}}class Jp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((n,i)=>function(e,t,n){return new Yc(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[n].textProps,value:Xo(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(e,t,i))),this.acs_.forEach(((e,n)=>{zc({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e)[n],backward:(e,i)=>{const s=t.assembly.toComponents(e);return s[n]=i,t.assembly.fromComponents(s)}})})),this.view=new Qp(e,{textViews:this.acs_.map((e=>e.view))})}get textControllers(){return this.acs_}}class eu extends za{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}const tu=jl({id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=Ua(t,(e=>Object.assign(Object.assign({},Sa(e)),{options:e.optional.custom(yc),readonly:e.optional.constant(!1)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>ba,constraint:e=>function(e,t){const n=[],i=Va(e,t);i&&n.push(i);const s=La(e);s&&n.push(s);const r=Cc(e.options);return r&&n.push(r),new bc(n)}(e.params,e.initialValue),writer:e=>lh},controller:e=>{const t=e.value,n=e.constraint,i=n&&wc(n,_c);if(i)return new $c(e.document,{props:new Wo({options:i.values.value("options")}),value:t,viewProps:e.viewProps});const s=Ma(e.params,t.rawValue),r=n&&wc(n,Zo);return r?new eh(e.document,Object.assign(Object.assign({},th(Object.assign(Object.assign({},s),{keyScale:Xo(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:ga,value:t,viewProps:e.viewProps})):new Yc(e.document,{parser:ga,props:Wo.fromObject(s),value:t,viewProps:e.viewProps})},api:e=>"number"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof eh?new eu(e.controller):e.controller.valueController instanceof $c?new vc(e.controller):null});class nu{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(No(e))return!1;const t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const iu={toComponents:e=>e.getComponents(),fromComponents:e=>new nu(...e)},su=ll("p2d");class ru{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(su()),t.viewProps.bindClassModifiers(this.element),rl(t.expanded,$l(this.element,su(void 0,"expanded")));const n=e.createElement("div");n.classList.add(su("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(su("b")),i.appendChild(el(e,"p2dpad")),t.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const s=e.createElement("div");if(s.classList.add(su("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(su("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const ou=ll("p2dp");class au{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(ou()),"popup"===t.layout&&this.element.classList.add(ou(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(ou("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(Xa,"svg");i.classList.add(ou("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=e.createElementNS(Xa,"line");s.classList.add(ou("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const r=e.createElementNS(Xa,"line");r.classList.add(ou("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=e.createElementNS(Xa,"line");o.classList.add(ou("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(ou("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),n=this.props_.get("max"),i=ya(e,-n,+n,0,100),s=ya(t,-n,+n,0,100),r=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function lu(e,t,n){return[Fc(t[0],Rc(e)),Fc(t[1],Ic(e))*(n?1:-1)]}class cu{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new au(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kc(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=this.props.get("max"),i=ya(e.point.x,0,e.bounds.width,-n,+n),s=ya(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new nu(i,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){qc(e.key)&&e.preventDefault();const[t,n]=lu(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(new nu(this.value.rawValue.x+t,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,n]=lu(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));0===t&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class hu{constructor(e,t){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Kl.create(t.expanded),this.popC_="popup"===t.pickerLayout?new Lc(e,{viewProps:this.viewProps}):null;const s=new cu(e,{layout:t.pickerLayout,props:new Wo({invertsY:Xo(t.invertsY),max:Xo(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new Jp(e,{assembly:iu,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new ru(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),zc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Gl(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=sl(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!Za(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function pu(e){return nu.isObject(e)?new nu(e.x,e.y):new nu}function uu(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function du(e,t){var n,i;if(!No(e.min)||!No(e.max))return Math.max(Math.abs(null!==(n=e.min)&&void 0!==n?n:0),Math.abs(null!==(i=e.max)&&void 0!==i?i:0));const s=$a(e);return Math.max(10*Math.abs(s),10*Math.abs(t))}function mu(e,t){var n,i;const s=du(Fo(e,null!==(n=e.x)&&void 0!==n?n:{}),t.x),r=du(Fo(e,null!==(i=e.y)&&void 0!==i?i:{}),t.y);return Math.max(s,r)}function vu(e){if(!("y"in e))return!1;const t=e.y;return!!t&&("inverted"in t&&!!t.inverted)}const fu=jl({id:"input-point2d",type:"input",accept:(e,t)=>{if(!nu.isObject(e))return null;const n=Ua(t,(e=>Object.assign(Object.assign({},sh(e)),{expanded:e.optional.boolean,picker:e.optional.custom(ah),readonly:e.optional.constant(!1),x:e.optional.custom(rh),y:e.optional.object(Object.assign(Object.assign({},sh(e)),{inverted:e.optional.boolean}))})));return n?{initialValue:e,params:n}:null},binding:{reader:()=>pu,constraint:e=>{return t=e.params,n=e.initialValue,new Wp({assembly:iu,components:[oh(Object.assign(Object.assign({},t),t.x),n.x),oh(Object.assign(Object.assign({},t),t.y),n.y)]});var t,n},equals:nu.equals,writer:()=>uu},controller:e=>{var t,n;const i=e.document,s=e.value,r=e.constraint,o=[e.params.x,e.params.y];return new hu(i,{axes:s.rawValue.getComponents().map(((t,n)=>{var i;return Aa({constraint:r.components[n],initialValue:t,params:Fo(e.params,null!==(i=o[n])&&void 0!==i?i:{})})})),expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,invertsY:vu(e.params),max:mu(e.params,s.rawValue),parser:ga,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:s,viewProps:e.viewProps})}});class gu{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(No(e))return!1;const t=e.x,n=e.y,i=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const bu={toComponents:e=>e.getComponents(),fromComponents:e=>new gu(...e)};function wu(e){return gu.isObject(e)?new gu(e.x,e.y,e.z):new gu}function _u(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}const yu=jl({id:"input-point3d",type:"input",accept:(e,t)=>{if(!gu.isObject(e))return null;const n=Ua(t,(e=>Object.assign(Object.assign({},sh(e)),{readonly:e.optional.constant(!1),x:e.optional.custom(rh),y:e.optional.custom(rh),z:e.optional.custom(rh)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>wu,constraint:e=>{return t=e.params,n=e.initialValue,new Wp({assembly:bu,components:[oh(Object.assign(Object.assign({},t),t.x),n.x),oh(Object.assign(Object.assign({},t),t.y),n.y),oh(Object.assign(Object.assign({},t),t.z),n.z)]});var t,n},equals:gu.equals,writer:e=>_u},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z];return new Jp(e.document,{assembly:bu,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Aa({constraint:n.components[s],initialValue:t,params:Fo(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:ga,value:t,viewProps:e.viewProps})}});class xu{constructor(e=0,t=0,n=0,i=0){this.x=e,this.y=t,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(No(e))return!1;const t=e.x,n=e.y,i=e.z,s=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof i&&"number"==typeof s}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Cu={toComponents:e=>e.getComponents(),fromComponents:e=>new xu(...e)};function Pu(e){return xu.isObject(e)?new xu(e.x,e.y,e.z,e.w):new xu}function Eu(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}const $u=jl({id:"input-point4d",type:"input",accept:(e,t)=>{if(!xu.isObject(e))return null;const n=Ua(t,(e=>Object.assign(Object.assign({},sh(e)),{readonly:e.optional.constant(!1),w:e.optional.custom(rh),x:e.optional.custom(rh),y:e.optional.custom(rh),z:e.optional.custom(rh)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Pu,constraint:e=>{return t=e.params,n=e.initialValue,new Wp({assembly:Cu,components:[oh(Object.assign(Object.assign({},t),t.x),n.x),oh(Object.assign(Object.assign({},t),t.y),n.y),oh(Object.assign(Object.assign({},t),t.z),n.z),oh(Object.assign(Object.assign({},t),t.w),n.w)]});var t,n},equals:xu.equals,writer:e=>Eu},controller:e=>{const t=e.value,n=e.constraint,i=[e.params.x,e.params.y,e.params.z,e.params.w];return new Jp(e.document,{assembly:Cu,axes:t.rawValue.getComponents().map(((t,s)=>{var r;return Aa({constraint:n.components[s],initialValue:t,params:Fo(e.params,null!==(r=i[s])&&void 0!==r?r:{})})})),parser:ga,value:t,viewProps:e.viewProps})}});const ku=jl({id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const n=Ua(t,(e=>({readonly:e.optional.constant(!1),options:e.optional.custom(yc)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Bc,constraint:e=>function(e){const t=[],n=Cc(e.options);return n&&t.push(n),new bc(t)}(e.params),writer:e=>lh},controller:e=>{const t=e.document,n=e.value,i=e.constraint,s=i&&wc(i,_c);return s?new $c(t,{props:new Wo({options:s.values.value("options")}),value:n,viewProps:e.viewProps}):new Ac(t,{parser:e=>e,props:Wo.fromObject({formatter:Oc}),value:n,viewProps:e.viewProps})},api:e=>"string"!=typeof e.controller.value.rawValue?null:e.controller.valueController instanceof $c?new vc(e.controller):null}),Vu={defaultInterval:200,defaultRows:3},Lu=ll("mll");class Mu{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Lu()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(Lu("i")),n.style.height=`calc(var(${ih("containerUnitSize")}) * ${t.rows})`,n.readOnly=!0,t.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach((e=>{void 0!==e&&n.push(this.formatter_(e))})),e.textContent=n.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class Su{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Mu(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const Au=ll("sgl");class Du{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Au()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Au("i")),n.readOnly=!0,n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class ju{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Du(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const Tu=jl({id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=Ua(t,(e=>({readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Dc},controller:e=>{var t;return 1===e.value.rawValue.length?new ju(e.document,{formatter:jc,value:e.value,viewProps:e.viewProps}):new Su(e.document,{formatter:jc,rows:null!==(t=e.params.rows)&&void 0!==t?t:Vu.defaultRows,value:e.value,viewProps:e.viewProps})}});class Nu extends za{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const Bu=ll("grl");class Ou{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Bu()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(Xa,"svg");n.classList.add(Bu("g")),n.style.height=`calc(var(${ih("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(Xa,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=e.createElement("div");s.classList.add(Bu("t"),ll("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,n=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach(((o,a)=>{if(void 0===o)return;const l=ya(a,0,n,0,e),c=ya(o,i,s,t,0);r.push([l,c].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(Bu("t","a"));const l=ya(this.cursor_.rawValue,0,n,0,e),c=ya(a,i,s,t,0);o.style.left=`${l}px`,o.style.top=`${c}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(Bu("t","a"))||(o.classList.add(Bu("t","a"),Bu("t","in")),Wa(o),o.classList.remove(Bu("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class zu{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=Xo(-1),this.view=new Ou(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),Za(e)){const e=new Kc(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}importProps(e){return Ka(e,null,(e=>({max:e.required.number,min:e.required.number})),(e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0)))}exportProps(){return Ha(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(ya(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.rawValue=Math.floor(ya(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Fu(e){return No(e.format)?_a(2):e.format}function Iu(e){return"graph"===e.view}const Ru=jl({id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const n=Ua(t,(e=>({format:e.optional.function,max:e.optional.number,min:e.optional.number,readonly:e.required.constant(!0),rows:e.optional.number,view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>Iu(e)?64:1,reader:e=>ba},controller:e=>Iu(e.params)?function(e){var t,n,i;return new zu(e.document,{formatter:Fu(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Vu.defaultRows,props:Wo.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:100,min:null!==(i=e.params.min)&&void 0!==i?i:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new ju(e.document,{formatter:Fu(e.params),value:e.value,viewProps:e.viewProps}):new Su(e.document,{formatter:Fu(e.params),rows:null!==(t=e.params.rows)&&void 0!==t?t:Vu.defaultRows,value:e.value,viewProps:e.viewProps})}(e),api:e=>e.controller.valueController instanceof zu?new Nu(e.controller):null}),qu=jl({id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const n=Ua(t,(e=>({multiline:e.optional.boolean,readonly:e.required.constant(!0),rows:e.optional.number})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>Bc},controller:e=>{var t;const n=e.value;return n.rawValue.length>1||e.params.multiline?new Su(e.document,{formatter:Oc,rows:null!==(t=e.params.rows)&&void 0!==t?t:Vu.defaultRows,value:n,viewProps:e.viewProps}):new ju(e.document,{formatter:Oc,value:n,viewProps:e.viewProps})}});class Uu{constructor(e){this.target=e.target,this.reader_=e.reader,this.writer_=e.writer}read(){return this.reader_(this.target.read())}write(e){this.writer_(this.target,e)}inject(e){this.write(this.reader_(e))}}class Ku{constructor(e){this.target=e.target,this.reader_=e.reader}read(){return this.reader_(this.target.read())}}function Hu(e,t){return 0===t?new fc:new gc(e,null!=t?t:Vu.defaultInterval)}class Gu{constructor(e){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=e}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e,t){if(!(n=t.core)||n.major!==Dl.major)throw qo.notCompatible(e,t.id);var n;"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput_(e,t,n){return this.pluginsMap_.inputs.reduce(((i,s)=>null!=i?i:function(e,t){var n;const i=e.accept(t.target.read(),t.params);if(No(i))return null;const s={target:t.target,initialValue:i.initialValue,params:i.params},r=Ua(t.params,(e=>({disabled:e.optional.boolean,hidden:e.optional.boolean,label:e.optional.string,tag:e.optional.string}))),o=e.binding.reader(s),a=e.binding.constraint?e.binding.constraint(s):void 0,l=new Uu({reader:o,target:t.target,writer:e.binding.writer(s)}),c=new Fa(Xo(o(i.initialValue),{constraint:a,equals:e.binding.equals}),l),h=e.controller({constraint:a,document:t.document,initialValue:i.initialValue,params:i.params,value:c,viewProps:tc.create({disabled:null==r?void 0:r.disabled,hidden:null==r?void 0:r.hidden})});return new bl(t.document,{blade:Ul(),props:Wo.fromObject({label:"label"in t.params?null!==(n=null==r?void 0:r.label)&&void 0!==n?n:null:t.target.key}),tag:null==r?void 0:r.tag,value:c,valueController:h})}(s,{document:e,target:t,params:n})),null)}createMonitor_(e,t,n){return this.pluginsMap_.monitors.reduce(((i,s)=>null!=i?i:function(e,t){var n,i,s;const r=e.accept(t.target.read(),t.params);if(No(r))return null;const o={target:t.target,initialValue:r.initialValue,params:r.params},a=Ua(t.params,(e=>({bufferSize:e.optional.number,disabled:e.optional.boolean,hidden:e.optional.boolean,interval:e.optional.number,label:e.optional.string}))),l=e.binding.reader(o),c=null!==(i=null!==(n=null==a?void 0:a.bufferSize)&&void 0!==n?n:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(r.params))&&void 0!==i?i:1,h=new xl({binding:new Ku({reader:l,target:t.target}),bufferSize:c,ticker:Hu(t.document,null==a?void 0:a.interval)}),p=e.controller({document:t.document,params:r.params,value:h,viewProps:tc.create({disabled:null==a?void 0:a.disabled,hidden:null==a?void 0:a.hidden})});return p.viewProps.bindDisabled(h.ticker),p.viewProps.handleDispose((()=>{h.ticker.dispose()})),new Cl(t.document,{blade:Ul(),props:Wo.fromObject({label:"label"in t.params?null!==(s=null==a?void 0:a.label)&&void 0!==s?s:null:t.target.key}),value:h,valueController:p})}(s,{document:e,params:n,target:t})),null)}createBinding(e,t,n){if(No(t.read()))throw new qo({context:{key:t.key},type:"nomatchingcontroller"});const i=this.createInput_(e,t,n);if(i)return i;const s=this.createMonitor_(e,t,n);if(s)return s;throw new qo({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const n=this.pluginsMap_.blades.reduce(((n,i)=>null!=n?n:function(e,t){const n=e.accept(t.params);if(!n)return null;const i=Ua(t.params,(e=>({disabled:e.optional.boolean,hidden:e.optional.boolean})));return e.controller({blade:Ul(),document:t.document,params:Object.assign(Object.assign({},n.params),{disabled:null==i?void 0:i.disabled,hidden:null==i?void 0:i.hidden}),viewProps:tc.create({disabled:null==i?void 0:i.disabled,hidden:null==i?void 0:i.hidden})})}(i,{document:e,params:t})),null);if(!n)throw new qo({type:"nomatchingview",context:{params:t}});return n}createInputBindingApi_(e){const t=this.pluginsMap_.inputs.reduce(((t,n)=>{var i,s;return t||(null!==(s=null===(i=n.api)||void 0===i?void 0:i.call(n,{controller:e}))&&void 0!==s?s:null)}),null);return this.apiCache_.add(e,null!=t?t:new za(e))}createMonitorBindingApi_(e){const t=this.pluginsMap_.monitors.reduce(((t,n)=>{var i,s;return t||(null!==(s=null===(i=n.api)||void 0===i?void 0:i.call(n,{controller:e}))&&void 0!==s?s:null)}),null);return this.apiCache_.add(e,null!=t?t:new za(e))}createBindingApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(wl(e))return this.createInputBindingApi_(e);if(Pl(e))return this.createMonitorBindingApi_(e);throw qo.shouldNeverHappen()}createApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(function(e){return Ga(e)&&Ya(e.value)}(e))return this.createBindingApi(e);const t=this.pluginsMap_.blades.reduce(((t,n)=>null!=t?t:n.api({controller:e,pool:this})),null);if(!t)throw qo.shouldNeverHappen();return this.apiCache_.add(e,t)}}const Yu=new class{constructor(){this.map_=new Map}get(e){var t;return null!==(t=this.map_.get(e))&&void 0!==t?t:null}has(e){return this.map_.has(e)}add(e,t){return this.map_.set(e,t),e.viewProps.handleDispose((()=>{this.map_.delete(e)})),t}};class Xu extends Da{constructor(e){super(e),this.emitter_=new Ko,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ta(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class Wu extends Da{}class Zu extends Da{constructor(e){super(e),this.emitter_=new Ko,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ta(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class Qu extends Da{constructor(e){super(e),this.emitter_=new Ko,this.controller.value.emitter.on("change",(e=>{this.emitter_.emit("change",new Ta(this,e.rawValue))}))}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(e){this.controller.valueController.props.set("formatter",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e)}),{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const Ju={id:"list",type:"blade",core:Dl,accept(e){const t=Ua(e,(e=>({options:e.required.custom(yc),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string})));return t?{params:t}:null},controller(e){const t=new _c(xc(e.params.options)),n=Xo(e.params.value,{constraint:t}),i=new $c(e.document,{props:new Wo({options:t.values.value("options")}),value:n,viewProps:e.viewProps});return new vl(e.document,{blade:e.blade,props:Wo.fromObject({label:e.params.label}),value:n,valueController:i})},api:e=>e.controller instanceof vl&&e.controller.valueController instanceof $c?new Xu(e.controller):null};class ed extends Yl{constructor(e,t){super(e,t)}get element(){return this.controller.view.element}}class td extends Zl{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const nd=ll("spr");class id{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nd()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("hr");n.classList.add(nd("r")),this.element.appendChild(n)}}class sd extends ml{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new id(e,{viewProps:t.viewProps})}))}}const rd={id:"separator",type:"blade",core:Dl,accept(e){const t=Ua(e,(e=>({view:e.required.constant("separator")})));return t?{params:t}:null},controller:e=>new sd(e.document,{blade:e.blade,viewProps:e.viewProps}),api:e=>e.controller instanceof sd?new Wu(e.controller):null},od={id:"slider",type:"blade",core:Dl,accept(e){const t=Ua(e,(e=>({max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number})));return t?{params:t}:null},controller(e){var t,n;const i=null!==(t=e.params.value)&&void 0!==t?t:0,s=new Zo({max:e.params.max,min:e.params.min}),r=Xo(i,{constraint:s}),o=new eh(e.document,Object.assign(Object.assign({},th({formatter:null!==(n=e.params.format)&&void 0!==n?n:wa,keyScale:Xo(1),max:s.values.value("max"),min:s.values.value("min"),pointerScale:ka(e.params,i)})),{parser:ga,value:r,viewProps:e.viewProps}));return new vl(e.document,{blade:e.blade,props:Wo.fromObject({label:e.params.label}),value:r,valueController:o})},api:e=>e.controller instanceof vl&&e.controller.valueController instanceof eh?new Zu(e.controller):null},ad={id:"text",type:"blade",core:Dl,accept(e){const t=Ua(e,(e=>({parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string})));return t?{params:t}:null},controller(e){var t;const n=Xo(e.params.value),i=new Ac(e.document,{parser:e.params.parse,props:Wo.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:e=>String(e)}),value:n,viewProps:e.viewProps});return new vl(e.document,{blade:e.blade,props:Wo.fromObject({label:e.params.label}),value:n,valueController:i})},api:e=>e.controller instanceof vl&&e.controller.valueController instanceof Ac?new Qu(e.controller):null};class ld extends ed{constructor(e){var t,n;const i=null!=e?e:{},s=null!==(t=i.document)&&void 0!==t?t:Qa(),r=function(){const e=new Gu(Yu);return[fu,yu,$u,ku,tu,Xp,Yp,Kp,uh,Tu,qu,Ru,Tl,Ql,mc].forEach((t=>{e.register("core",t)})),e}();super(new td(s,{expanded:i.expanded,blade:Ul(),props:Wo.fromObject({title:i.title}),viewProps:tc.create()}),r),this.pool_=r,this.containerElem_=null!==(n=i.container)&&void 0!==n?n:function(e){const t=e.createElement("div");return t.classList.add(ll("dfw")()),e.body&&e.body.appendChild(t),t}(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw qo.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw qo.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){e.css&&function(e,t,n){if(e.querySelector(`style[data-tp-style=${t}]`))return;const i=e.createElement("style");i.dataset.tpStyle=t,i.textContent=n,e.head.appendChild(i)}(this.document,`plugin-${e.id}`,e.css);("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((t=>{this.pool_.register(e.id,t)}))}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:"";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:"";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[Ju,rd,od,mc,ad]})}}function cd(e){let t,n;return t=new Vo({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function hd(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function pd(e){let t,n,i,s;const r=[md,dd],o=[];function a(e,t){return void 0===e[1]?0:1}t=a(e),n=o[t]=r[t](e);const l=e[10].default,c=p(l,e,e[9],null);return{c(){n.c(),i=P(),c&&c.c()},m(e,n){o[t].m(e,n),_(e,i,n),c&&c.m(e,n),s=!0},p(e,h){let p=t;t=a(e),t===p?o[t].p(e,h):(te(),se(o[p],1,1,(()=>{o[p]=null})),ne(),n=o[t],n?n.p(e,h):(n=o[t]=r[t](e),n.c()),ie(n,1),n.m(i.parentNode,i)),c&&c.p&&(!s||512&h)&&m(c,l,e,e[9],s?d(l,e[9],h,null):v(e[9]),null)},i(e){s||(ie(n),ie(c,e),s=!0)},o(e){se(n),se(c,e),s=!1},d(e){e&&y(i),o[t].d(e),c&&c.d(e)}}}function ud(e){let t;const n=e[10].default,i=p(n,e,e[9],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||512&s)&&m(i,n,e,e[9],t?d(n,e[9],s,null):v(e[9]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function dd(e){let t,n;return t=new Vo({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding","containerVerticalPadding","containerUnitSize"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function md(e){let t,n;return t=new Vo({props:{keysAdd:["containerVerticalPadding"],theme:e[2]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.theme=e[2]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function vd(e){let t,n,i,s;const r=[ud,pd,hd,cd],o=[];return t=0,n=o[t]=r[t](e),{c(){n.c(),i=E()},m(e,n){o[t].m(e,n),_(e,i,n),s=!0},p(e,[s]){let a=t;t=0,t===a?o[t].p(e,s):(te(),se(o[a],1,1,(()=>{o[a]=null})),ne(),n=o[t],n?n.p(e,s):(n=o[t]=r[t](e),n.c()),ie(n,1),n.m(i.parentNode,i))},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[t].d(e)}}}function fd(e,t,n){let i,s,{$$slots:r={},$$scope:o}=t,{title:a}=t,{userExpandable:l=!0}=t,{expanded:c=!0}=t,{theme:p}=t,{scale:u=1}=t,{userCreatedPane:d=!0}=t,{tpPane:m}=t;const v=me();h(e,v,(e=>n(11,i=e)));const f=O("parentStore");h(e,f,(e=>n(12,s=e)));let g=[];function w(e){(H(),U).then((()=>{void 0!==m?.expanded&&void 0!==e&&m.expanded!==e&&n(5,m.expanded=e,m)}))}return B("registerPlugin",(e=>{void 0===m?console.warn(`tpPane is undefined, failed to register plugin "${e.id}"`):g.includes(e.id)||(m?.registerPlugin(e),g.push(e.id))})),B("userCreatedPane",d),void 0!==s&&console.warn("<Panes> must not be nested"),b(v,i=new ld({expanded:c,title:a}),i),i.on("fold",(()=>{void 0!==i.expanded&&c!==i.expanded&&n(0,c=i.expanded)})),m=i,B("parentStore",v),T((()=>{i.dispose()})),e.$$set=e=>{"title"in e&&n(1,a=e.title),"userExpandable"in e&&n(6,l=e.userExpandable),"expanded"in e&&n(0,c=e.expanded),"theme"in e&&n(2,p=e.theme),"scale"in e&&n(7,u=e.scale),"userCreatedPane"in e&&n(8,d=e.userCreatedPane),"tpPane"in e&&n(5,m=e.tpPane),"$$scope"in e&&n(9,o=e.$$scope)},e.$$.update=()=>{34&e.$$.dirty&&m&&void 0!==a&&n(5,m.title=a.length>0?a:" ",m),32&e.$$.dirty&&m?.element&&m?.element.classList.add("svelte-tweakpane-ui"),160&e.$$.dirty&&m&&function(e){if(m)if(1===e)m.element.style.removeProperty("transform-origin"),m.element.style.removeProperty("transform"),m.element.style.removeProperty("width");else{const t=Math.max(0,e);n(5,m.element.style.transformOrigin="0 0",m),n(5,m.element.style.transform=`scale(${t})`,m),n(5,m.element.style.width=100/t+"%",m)}}(u),96&e.$$.dirty&&m&&jo(l,m.element,"tp-rotv_b","tp-rotv_m"),36&e.$$.dirty&&m&&function(e,t){const n=Gt().documentElement;if(void 0===t)for(const t of Object.keys(wo)){const n=xo(t);e.style.getPropertyValue(n).length>0&&e.style.removeProperty(n)}else for(const[i,s]of Object.entries(t)){const t=xo(i),r=yo(s),o=wo[i]||void 0,a=n.style.getPropertyValue(t)||void 0;void 0!==r&&(a&&r!==a||!a&&o&&r!==o)?e.style.setProperty(t,r):e.style.getPropertyValue(t).length>0&&e.style.removeProperty(t)}}(m.element,p),33&e.$$.dirty&&m&&w(c)},[c,a,p,v,f,m,l,u,d,o,r]}new Al("4.0.5");class gd extends ue{constructor(e){super(),pe(this,e,fd,vd,a,{title:1,userExpandable:6,expanded:0,theme:2,scale:7,userCreatedPane:8,tpPane:5})}}function bd(e){let t;const n=e[6].default,i=p(n,e,e[10],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||1024&s)&&m(i,n,e,e[10],t?d(n,e[10],s,null):v(e[10]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function wd(e){let t,i,s,r,o;const a=[{theme:e[3]},Ao(e[5],"position")];function l(t){e[7](t)}function c(t){e[8](t)}let h={$$slots:{default:[bd]},$$scope:{ctx:e}};for(let e=0;e<a.length;e+=1)h=n(h,a[e]);return void 0!==e[0]&&(h.expanded=e[0]),void 0!==e[1]&&(h.tpPane=e[1]),i=new gd({props:h}),I.push((()=>ae(i,"expanded",l))),I.push((()=>ae(i,"tpPane",c))),{c(){t=x("div"),le(i.$$.fragment),k(t,"width",void 0===e[2]?null:`${e[2]}px`)},m(n,s){_(n,t,s),ce(i,t,null),e[9](t),o=!0},p(e,[n]){const o=40&n?re(a,[8&n&&{theme:e[3]},32&n&&oe(Ao(e[5],"position"))]):{};1024&n&&(o.$$scope={dirty:n,ctx:e}),!s&&1&n&&(s=!0,o.expanded=e[0],Y((()=>s=!1))),!r&&2&n&&(r=!0,o.tpPane=e[1],Y((()=>r=!1))),i.$set(o),4&n&&k(t,"width",void 0===e[2]?null:`${e[2]}px`)},i(e){o||(ie(i.$$.fragment,e),o=!0)},o(e){se(i.$$.fragment,e),o=!1},d(n){n&&y(t),he(i),e[9](null)}}}function _d(e,t,i){const s=["expanded","width","tpPane","theme"];let r,o=g(t,s),{$$slots:a={},$$scope:l}=t,{expanded:c}=t,{width:h}=t,{tpPane:p}=t,{theme:u={baseBorderRadius:"0px",baseShadowColor:"hsla(0, 0%, 0%, 0)"}}=t;return j((()=>{if(p){const e=p.element.parentElement;r.append(p.element),e?.remove()}else console.warn("tpPane is undefined")})),e.$$set=e=>{t=n(n({},t),f(e)),i(5,o=g(t,s)),"expanded"in e&&i(0,c=e.expanded),"width"in e&&i(2,h=e.width),"tpPane"in e&&i(1,p=e.tpPane),"theme"in e&&i(3,u=e.theme),"$$scope"in e&&i(10,l=e.$$scope)},[c,p,h,u,r,o,a,function(e){c=e,i(0,c)},function(e){p=e,i(1,p)},function(e){I[e?"unshift":"push"]((()=>{r=e,i(4,r)}))},l]}class yd extends ue{constructor(e){super(),pe(this,e,_d,wd,a,{expanded:0,width:2,tpPane:1,theme:3})}}function xd(e){let t,n;return t=new yd({props:{theme:e[3],userCreatedPane:!1,$$slots:{default:[Pd]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};8&n&&(i.theme=e[3]),16391&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Cd(e){let t,n,i,s;const r=[$d,Ed],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function Pd(e){let t,n;return t=new Ld({props:{disabled:e[2],label:e[1],title:e[0]}}),t.$on("click",e[10]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.disabled=e[2]),2&n&&(i.label=e[1]),1&n&&(i.title=e[0]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Ed(e){let t,n;return t=new Vo({props:{keysAdd:["containerUnitSize","containerVerticalPadding"],theme:e[3]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};8&n&&(i.theme=e[3]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function $d(e){let n;return{c(){n=x("div"),k(n,"display","none")},m(t,i){_(t,n,i),e[9](n)},p:t,i:t,o:t,d(t){t&&y(n),e[9](null)}}}function kd(e){let t,n,i,s;const r=[Cd,xd],o=[];return t=function(e){return e[5]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=E()},m(e,n){o[t].m(e,n),_(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[t].d(e)}}}function Vd(e,t,n){let i,{title:s="Button"}=t,{label:r}=t,{disabled:o=!1}=t,{theme:a}=t;const l=O("parentStore");h(e,l,(e=>n(8,i=e)));const c=O("userCreatedPane"),p=N();let u,d,m;return j((()=>{n(7,m=u?So(u):0)})),T((()=>{d?.dispose()})),e.$$set=e=>{"title"in e&&n(0,s=e.title),"label"in e&&n(1,r=e.label),"disabled"in e&&n(2,o=e.disabled),"theme"in e&&n(3,a=e.theme)},e.$$.update=()=>{65&e.$$.dirty&&d&&n(6,d.title=s,d),66&e.$$.dirty&&d&&n(6,d.label=r,d),68&e.$$.dirty&&d&&n(6,d.disabled=o,d),448&e.$$.dirty&&void 0!==m&&i&&!d&&(d&&d.dispose(),n(6,d=i.addButton({disabled:o,index:m,label:r,title:s})),d.on("click",(()=>{p("click")}))),264&e.$$.dirty&&a&&i&&(c||!Lo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Button> components for a theme prop.)")},[s,r,o,a,u,l,d,m,i,function(e){I[e?"unshift":"push"]((()=>{u=e,n(4,u)}))},function(t){z.call(this,e,t)}]}class Ld extends ue{constructor(e){super(),pe(this,e,Vd,kd,a,{title:0,label:1,disabled:2,theme:3})}}function Md(e){let t,n;return t=new yd({props:{theme:e[4],userCreatedPane:!1,$$slots:{default:[Ad]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),262159&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Sd(e){let t,n,i,s;const r=[jd,Dd],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function Ad(e){let t,n,i,s,r,o;function a(t){e[11](t)}function l(t){e[12](t)}function c(t){e[13](t)}function h(t){e[14](t)}let p={};return void 0!==e[1]&&(p.disabled=e[1]),void 0!==e[0]&&(p.options=e[0]),void 0!==e[3]&&(p.plugin=e[3]),void 0!==e[2]&&(p.ref=e[2]),t=new Bd({props:p}),I.push((()=>ae(t,"disabled",a))),I.push((()=>ae(t,"options",l))),I.push((()=>ae(t,"plugin",c))),I.push((()=>ae(t,"ref",h))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),o=!0},p(e,o){const a={};!n&&2&o&&(n=!0,a.disabled=e[1],Y((()=>n=!1))),!i&&1&o&&(i=!0,a.options=e[0],Y((()=>i=!1))),!s&&8&o&&(s=!0,a.plugin=e[3],Y((()=>s=!1))),!r&&4&o&&(r=!0,a.ref=e[2],Y((()=>r=!1))),t.$set(a)},i(e){o||(ie(t.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),o=!1},d(e){he(t,e)}}}function Dd(e){let t,n;return t=new Vo({props:{keysAdd:["containerVerticalPadding"],theme:e[4]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function jd(e){let n;return{c(){n=x("div"),k(n,"display","none")},m(t,i){_(t,n,i),e[10](n)},p:t,i:t,o:t,d(t){t&&y(n),e[10](null)}}}function Td(e){let t,n,i,s;const r=[Sd,Md],o=[];return t=function(e){return e[6]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=E()},m(e,n){o[t].m(e,n),_(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[t].d(e)}}}function Nd(e,t,n){let i,{options:s}=t,{disabled:r=!1}=t,{theme:o}=t,{ref:a}=t,{plugin:l}=t;const c=O("registerPlugin"),p=O("parentStore");h(e,p,(e=>n(9,i=e)));const u=O("userCreatedPane");let d,m,v;return j((()=>{n(7,m=d?So(d):0)})),T((()=>{v?.dispose()})),e.$$set=e=>{"options"in e&&n(0,s=e.options),"disabled"in e&&n(1,r=e.disabled),"theme"in e&&n(4,o=e.theme),"ref"in e&&n(2,a=e.ref),"plugin"in e&&n(3,l=e.plugin)},e.$$.update=()=>{258&e.$$.dirty&&v&&n(8,v.disabled=r,v),e.$$.dirty,641&e.$$.dirty&&s&&i&&void 0!==m&&(v&&v.dispose(),void 0!==l&&c(l),n(8,v=i.addBlade({index:m,...s,disabled:r})),n(2,a=v)),528&e.$$.dirty&&o&&i&&(u||!Lo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Blade> components for a theme prop.)")},[s,r,a,l,o,d,p,m,v,i,function(e){I[e?"unshift":"push"]((()=>{d=e,n(5,d)}))},function(e){r=e,n(1,r)},function(e){s=e,n(0,s)},function(e){l=e,n(3,l)},function(e){a=e,n(2,a)}]}class Bd extends ue{constructor(e){super(),pe(this,e,Nd,Td,a,{options:0,disabled:1,theme:4,ref:2,plugin:3})}}class Od{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return null!==(e=this.controller_.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.emitter.on(e,(()=>{n(new Mt(this))})),this}}class zd extends Mt{constructor(e,t,n){super(e),this.cell=t,this.index=n}}class Fd extends Lt{constructor(e){super(e),this.cellToApiMap_=new Map,this.emitter_=new Re;const t=this.controller.valueController;t.cellControllers.forEach(((e,n)=>{const i=new Od(e);this.cellToApiMap_.set(e,i),e.emitter.on("click",(()=>{const e=n%t.size[0],s=Math.floor(n/t.size[0]);this.emitter_.emit("click",{event:new zd(this,i,[e,s])})}))}))}cell(e,t){const n=this.controller.valueController,i=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(i)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}class Id{constructor(e,t){this.size=t.size;const[n,i]=this.size,s=[];for(let r=0;r<i;r++)for(let i=0;i<n;i++){const n=new _n(e,{props:Ge.fromObject(Object.assign({},t.cellConfig(i,r))),viewProps:Rn.create()});s.push(n)}this.cellCs_=s,this.viewProps=Rn.create(),this.viewProps.handleDispose((()=>{this.cellCs_.forEach((e=>{e.viewProps.set("disposed",!0)}))})),this.view=new qi(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((e=>{this.view.element.appendChild(e.view.element)}))}get cellControllers(){return this.cellCs_}}class Rd extends hn{constructor(e,t){const n=t.valueController,i=new an(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}Cn({id:"buttongrid",type:"blade",accept(e){const t=zt(e,(e=>({cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string})));return t?{params:t}:null},controller:e=>new Rd(e.document,{blade:e.blade,labelProps:Ge.fromObject({label:e.params.label}),valueController:new Id(e.document,{cellConfig:e.params.cells,size:e.params.size})}),api:e=>e.controller instanceof Rd?new Fd(e.controller):null});class qd extends Lt{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get value(){return this.controller.valueController.value.rawValue}set value(e){this.controller.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.controller.valueController.value.emitter.on(e,(e=>{n(new St(this,e.rawValue,e.options.last))})),this}}function Ud(e,t,n){return e*(1-n)+t*n}function Kd(e,t){let n=.25,i=.5,s=-1;for(let r=0;r<20;r++){const[r,o]=e.curve(i);if(i+=n*(r<t?1:-1),s=o,n*=.5,Math.abs(t-r)<.001)break}return s}class Hd{constructor(e=0,t=0,n=1,i=1){this.cache_=[],this.comps_=[e,t,n,i]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(e){return!je(e)&&(!!Array.isArray(e)&&("number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]&&"number"==typeof e[3]))}static equals(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}curve(e){const t=Ud(0,this.x1,e),n=Ud(0,this.y1,e),i=Ud(this.x1,this.x2,e),s=Ud(this.y1,this.y2,e),r=Ud(this.x2,1,e),o=Ud(this.y2,1,e),a=Ud(t,i,e),l=Ud(n,s,e),c=Ud(i,r,e),h=Ud(s,o,e);return[Ud(a,c,e),Ud(l,h,e)]}y(e){if(0===this.cache_.length){const e=[];for(let t=0;t<100;t++)e.push(Kd(this,gt(t,0,99,0,1)));this.cache_=e}return this.cache_[Math.round(gt(wt(e,0,1),0,1,0,99))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Gd={toComponents:e=>e.toObject(),fromComponents:e=>new Hd(...e)};function Yd(e){const t=ft(2);return`cubic-bezier(${e.toObject().map((e=>t(e))).join(", ")})`}const Xd=[0,.5,.5,1];function Wd(e){const t=e.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!t)return new Hd(...Xd);const n=[t[1],t[2],t[3],t[4]].reduce(((e,t)=>{if(!e)return null;const n=Number(t);return isNaN(n)?null:[...e,n]}),[]);return new Hd(...null!=n?n:Xd)}const Zd=sn("cbz");class Qd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Zd()),t.viewProps.bindClassModifiers(this.element),t.foldable.bindExpandedClass(this.element,Zd(void 0,"expanded")),tn(t.foldable,"completed",fn(this.element,Zd(void 0,"cpl")));const n=e.createElement("div");n.classList.add(Zd("h")),this.element.appendChild(n);const i=e.createElement("button");i.classList.add(Zd("b")),t.viewProps.bindDisabled(i);const s=e.createElementNS(Ut,"svg");s.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',i.appendChild(s),n.appendChild(i),this.buttonElement=i;const r=e.createElement("div");if(r.classList.add(Zd("t")),n.appendChild(r),this.textElement=r,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(Zd("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const Jd=sn("cbzp");class em{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Jd()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Jd("g")),this.element.appendChild(n),this.graphElement=n;const i=e.createElement("div");i.classList.add(Jd("t")),this.element.appendChild(i),this.textElement=i}}function tm(e,t){const n=new MutationObserver((e=>{for(const i of e)"childList"===i.type&&i.addedNodes.forEach((e=>{e.contains(e)&&(t(),n.disconnect())}))})),i=e.ownerDocument;n.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}const nm=sn("cbzg");class im{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(nm("p")),this.element.appendChild(n),this.previewElement=n;const i=e.createElementNS(Ut,"svg");i.classList.add(nm("g")),this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(Ut,"path");s.classList.add(nm("u")),this.svgElem_.appendChild(s),this.guideElem_=s;const r=e.createElementNS(Ut,"polyline");r.classList.add(nm("l")),this.svgElem_.appendChild(r),this.lineElem_=r,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach((e=>{e.classList.add(nm("h")),this.element.appendChild(e)})),this.vectorElems_=[e.createElementNS(Ut,"line"),e.createElementNS(Ut,"line")],this.vectorElems_.forEach((e=>{e.classList.add(nm("v")),this.svgElem_.appendChild(e)})),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=t.selection,this.handleElems_.forEach(((e,t)=>{var n,i;en(this.sel_,(n=e=>e===t,i=fn(e,nm("h","sel")),e=>i(n(e))))})),tm(this.element,(()=>{this.refresh()}))}getVertMargin_(e){return.25*e}valueToPosition(e,t){const{clientWidth:n,clientHeight:i}=this.element,s=this.getVertMargin_(i);return{x:gt(e,0,1,0,n),y:gt(t,0,1,i-s,s)}}positionToValue(e,t){const n=this.element.getBoundingClientRect(),i=n.width,s=n.height,r=this.getVertMargin_(s);return{x:wt(gt(e,0,i,0,1),0,1),y:gt(t,s-r,r,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map((e=>{const t=this.valueToPosition(0,e),n=this.valueToPosition(1,e);return[`M ${t.x},${t.y}`,`L ${n.x},${n.y}`].join(" ")})).join(" "));const e=this.value_.rawValue,t=[];let n=0;for(;;){const i=this.valueToPosition(...e.curve(n));if(t.push([i.x,i.y].join(",")),n>=1)break;n=Math.min(n+.05,1)}this.lineElem_.setAttributeNS(null,"points",t.join(" "));const i=e.toObject();[0,1].forEach((e=>{const t=this.valueToPosition(e,e),n=this.valueToPosition(i[2*e],i[2*e+1]),s=this.vectorElems_[e];s.setAttributeNS(null,"x1",String(t.x)),s.setAttributeNS(null,"y1",String(t.y)),s.setAttributeNS(null,"x2",String(n.x)),s.setAttributeNS(null,"y2",String(n.y));const r=this.handleElems_[e];r.style.left=`${n.x}px`,r.style.top=`${n.y}px`}))}onValueChange_(){this.refresh()}}const sm=sn("cbzprv");class rm{constructor(e,t){this.stopped_=!0,this.startTime_=-1,this.requestId_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(sm()),t.viewProps.bindClassModifiers(this.element);const n=e.createElementNS(Ut,"svg");n.classList.add(sm("g")),this.element.appendChild(n),this.svgElem_=n;const i=e.createElementNS(Ut,"path");i.classList.add(sm("t")),this.svgElem_.appendChild(i),this.ticksElem_=i;const s=e.createElement("div");s.classList.add(sm("m")),this.element.appendChild(s),this.markerElem_=s,this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.viewProps.handleDispose(this.onDispose_),tm(this.element,(()=>{this.refresh()}))}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(sm("m","a")),this.startTime_=(new Date).getTime()+400,this.stopped_=!1,this.requestId_=requestAnimationFrame(this.onTimer_)}stop(){cancelAnimationFrame(this.requestId_),this.stopped_=!0,this.markerElem_.classList.remove(sm("m","a"))}onDispose_(){this.stop()}updateMarker_(e){const t=this.value_.rawValue.y(wt(e,0,1));this.markerElem_.style.left=100*t+"%"}refresh(){const{clientWidth:e,clientHeight:t}=this.svgElem_,n=[],i=this.value_.rawValue;for(let s=0;s<24;s++){const r=gt(s,0,23,0,1),o=gt(i.y(r),0,1,0,e);n.push(`M ${o},0 v${t}`)}this.ticksElem_.setAttributeNS(null,"d",n.join(" "))}onTimer_(){if(null===this.startTime_)return;const e=(new Date).getTime()-this.startTime_,t=e/1e3;this.updateMarker_(t),e>1400&&this.stop(),this.stopped_||(this.requestId_=requestAnimationFrame(this.onTimer_))}onValueChange_(){this.refresh(),this.play()}}function om(e,t,n,i){const s=n-e,r=i-t;return Math.sqrt(s*s+r*r)}class am{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.keyScale_=t.keyScale,this.value=t.value,this.sel_=He(0),this.viewProps=t.viewProps,this.view=new im(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new rm(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(e=>{e.stopImmediatePropagation(),e.preventDefault(),this.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);const n=new Si(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(e,t,n){const i=this.sel_.rawValue,s=this.value.rawValue.toObject(),r=this.view.positionToValue(e.x,e.y),o=t?function(e,t,n,i){const s=om(e,t,n,i),r=Math.atan2(i-t,n-e),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:e+Math.cos(o)*s,y:t+Math.sin(o)*s}}(i,i,r.x,r.y):r;s[2*i]=o.x,s[2*i+1]=o.y,this.value.setRawValue(new Hd(...s),n)}onPointerDown_(e){const t=e.data;if(!t.point)return;const n=this.value.rawValue,i=this.view.valueToPosition(n.x1,n.y1),s=om(t.point.x,t.point.y,i.x,i.y),r=this.view.valueToPosition(n.x2,n.y2),o=om(t.point.x,t.point.y,r.x,r.y);this.sel_.rawValue=s<=o?0:1,this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(e){Li(e.key)&&e.preventDefault();const t=this.sel_.rawValue,n=this.value.rawValue.toObject(),i=this.keyScale_.rawValue;n[2*t]+=$i(i,Vi(e)),n[2*t+1]+=$i(i,ki(e)),this.value.setRawValue(new Hd(...n),{forceEmit:!1,last:!1})}onKeyUp_(e){Li(e.key)&&e.preventDefault();const t=this.keyScale_.rawValue,n=$i(t,Vi(e)),i=$i(t,ki(e));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class lm{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new em(e,{viewProps:this.viewProps}),this.gc_=new am(e,{keyScale:t.axis.textProps.value("keyScale"),value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const n=Object.assign(Object.assign({},t.axis),{constraint:new Xe({max:1,min:0})}),i=Object.assign(Object.assign({},t.axis),{constraint:void 0});this.tc_=new Tr(e,{assembly:Gd,axes:[n,i,n,i],parser:mt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map((e=>e.inputElement))]}refresh(){this.gc_.refresh()}}class cm{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Dn.create(t.expanded),this.view=new Qd(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new bi(e,{parser:Wd,props:Ge.fromObject({formatter:Yd}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===t.pickerLayout?new vi(e,{viewProps:this.viewProps}):null;const n=new lm(e,{axis:t.axis,value:this.value,viewProps:this.viewProps});n.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),en(this.popC_.shows,(e=>{e&&n.refresh()})),Ei({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Tn(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=e.relatedTarget;t&&this.popC_.view.element.contains(t)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=Jt(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!Ht(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_&&"Escape"===e.key&&(this.popC_.shows.rawValue=!1)}}Cn({id:"cubicbezier",type:"blade",accept(e){const t=zt(e,(e=>({value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((e=>"inline"===e||"popup"===e?e:void 0))})));return t?{params:t}:null},controller(e){var t,n;const i=He(new Hd(...e.params.value),{constraint:new Ar({assembly:Gd,components:[0,1,2,3].map((e=>e%2==0?new Xe({min:0,max:1}):void 0))}),equals:Hd.equals}),s=new cm(e.document,{axis:{textProps:Ge.fromObject({keyScale:.1,pointerScale:.01,formatter:ft(2)})},expanded:null!==(t=e.params.expanded)&&void 0!==t&&t,pickerLayout:null!==(n=e.params.picker)&&void 0!==n?n:"popup",value:i,viewProps:e.viewProps});return new pn(e.document,{blade:e.blade,props:Ge.fromObject({label:e.params.label}),value:i,valueController:s})},api:e=>e.controller instanceof pn&&e.controller.valueController instanceof cm?new qd(e.controller):null});class hm extends Lt{get fps(){return this.controller.valueController.fps}get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}begin(){this.controller.valueController.begin()}end(){this.controller.valueController.end()}on(e,t){const n=t.bind(this);return this.controller.valueController.ticker.emitter.on(e,(()=>{n(new Mt(this))})),this}}class pm{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(e){this.start_=e.getTime()}calculateFps_(e){if(0===this.timestamps_.length)return null;const t=this.timestamps_[0];return 1e3*(this.frameCount_-t.frameCount)/(e-t.time)}compactTimestamps_(){if(this.timestamps_.length<=20)return;const e=this.timestamps_.length-20;this.timestamps_.splice(0,e);const t=this.timestamps_[0].frameCount;this.timestamps_.forEach((e=>{e.frameCount-=t})),this.frameCount_-=t}end(e){if(null===this.start_)return;const t=e.getTime();this.duration_=t-this.start_,this.start_=null,this.fps_=this.calculateFps_(t),this.timestamps_.push({frameCount:this.frameCount_,time:t}),++this.frameCount_,this.compactTimestamps_()}}const um=sn("fps");class dm{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(um()),t.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(um("g")),this.element.appendChild(this.graphElement);const n=e.createElement("div");n.classList.add(um("l")),this.element.appendChild(n);const i=e.createElement("span");i.classList.add(um("v")),i.textContent="--",n.appendChild(i),this.valueElement=i;const s=e.createElement("span");s.classList.add(um("u")),s.textContent="FPS",n.appendChild(s)}}class mm{constructor(e,t){this.stopwatch_=new pm,this.onTick_=this.onTick_.bind(this),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.props=t.props,this.value_=t.value,this.viewProps=t.viewProps,this.view=new dm(e,{viewProps:this.viewProps}),this.graphC_=new fo(e,{formatter:ft(0),props:this.props,rows:t.rows,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker.dispose()}))}get fps(){return this.stopwatch_.fps}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const e=this.fps;if(null!==e){const t=this.value_.rawValue;this.value_.rawValue=function(e,t){const n=[...mn(e),t];return n.length>e.length?n.splice(0,n.length-e.length):un(n,e.length),n}(t,e),this.view.valueElement.textContent=e.toFixed(0)}}}class vm extends hn{constructor(e,t){const n=t.valueController,i=new an(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}function fm(e,t){return 0===t?new ni:new ii(e,null!=t?t:ro.defaultInterval)}Cn({id:"fpsgraph",type:"blade",accept(e){const t=zt(e,(e=>({view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,rows:e.optional.number,max:e.optional.number,min:e.optional.number})));return t?{params:t}:null},controller(e){var t,n,i,s;const r=null!==(t=e.params.interval)&&void 0!==t?t:500;return new vm(e.document,{blade:e.blade,labelProps:Ge.fromObject({label:e.params.label}),valueController:new mm(e.document,{props:Ge.fromObject({max:null!==(n=e.params.max)&&void 0!==n?n:90,min:null!==(i=e.params.min)&&void 0!==i?i:0}),rows:null!==(s=e.params.rows)&&void 0!==s?s:2,ticker:fm(e.document,r),value:He(dn(80)),viewProps:e.viewProps})})},api:e=>e.controller instanceof vm?new hm(e.controller):null});class gm{constructor(e,t){this.min=e,this.max=t}static isObject(e){if("object"!=typeof e||null===e)return!1;const t=e.min,n=e.max;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.min===t.min&&e.max===t.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const bm={fromComponents:e=>new gm(e[0],e[1]),toComponents:e=>[e.min,e.max]};class wm{constructor(e){this.edge=e}constrain(e){var t,n,i,s,r,o,a,l;if(e.min<=e.max)return new gm(null!==(n=null===(t=this.edge)||void 0===t?void 0:t.constrain(e.min))&&void 0!==n?n:e.min,null!==(s=null===(i=this.edge)||void 0===i?void 0:i.constrain(e.max))&&void 0!==s?s:e.max);const c=(e.min+e.max)/2;return new gm(null!==(o=null===(r=this.edge)||void 0===r?void 0:r.constrain(c))&&void 0!==o?o:c,null!==(l=null===(a=this.edge)||void 0===a?void 0:a.constrain(c))&&void 0!==l?l:c)}}const _m=sn("rsltxt");class ym{constructor(e,t){this.sliderView_=t.sliderView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(_m());const n=e.createElement("div");n.classList.add(_m("s")),n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(_m("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const xm=sn("rsl");class Cm{constructor(e,t){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=t.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=e.createElement("div"),this.element.classList.add(xm()),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_);const n=e.createElement("div");n.classList.add(xm("t")),this.element.appendChild(n),this.trackElement=n;const i=e.createElement("div");i.classList.add(xm("b")),n.appendChild(i),this.barElement=i;const s=["min","max"].map((t=>{const i=e.createElement("div");return i.classList.add(xm("k"),xm("k",t)),n.appendChild(i),i}));this.knobElements=[s[0],s[1]],this.update_()}valueToX_(e){return 100*wt(gt(e,this.sliderProps_.get("min"),this.sliderProps_.get("max"),0,1),0,1)}update_(){const e=this.value_.rawValue;0===e.length?this.element.classList.add(xm(void 0,"zero")):this.element.classList.remove(xm(void 0,"zero"));const t=[this.valueToX_(e.min),this.valueToX_(e.max)];this.barElement.style.left=`${t[0]}%`,this.barElement.style.right=100-t[1]+"%",this.knobElements.forEach(((e,n)=>{e.style.left=`${t[n]}%`}))}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Pm{constructor(e,t){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=t.sliderProps,this.viewProps=t.viewProps,this.value=t.value,this.view=new Cm(e,{sliderProps:this.sliderProps,value:this.value,viewProps:t.viewProps});const n=new Si(this.view.trackElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}ofs_(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(e){if(!e.point)return null;return gt((e.point.x+this.ofs_())/e.bounds.width,0,1,this.sliderProps.get("min"),this.sliderProps.get("max"))}onPointerDown_(e){if(!e.data.point)return;const t=e.data.point.x/e.data.bounds.width,n=this.value.rawValue,i=this.sliderProps.get("min"),s=this.sliderProps.get("max"),r=gt(n.min,i,s,0,1),o=gt(n.max,i,s,0,1);Math.abs(o-t)<=.025?this.grabbing_="max":Math.abs(r-t)<=.025?this.grabbing_="min":t>=r&&t<=o?(this.grabbing_="length",this.grabOffset_=gt(t-r,0,1,0,s-i)):t<r?(this.grabbing_="min",this.onPointerMove_(e)):t>o&&(this.grabbing_="max",this.onPointerMove_(e))}applyPointToValue_(e,t){const n=this.valueFromData_(e);if(null===n)return;const i=this.sliderProps.get("min"),s=this.sliderProps.get("max");if("min"===this.grabbing_)this.value.setRawValue(new gm(n,this.value.rawValue.max),t);else if("max"===this.grabbing_)this.value.setRawValue(new gm(this.value.rawValue.min,n),t);else if("length"===this.grabbing_){const e=this.value.rawValue.length;let r=n-this.grabOffset_,o=r+e;r<i?(r=i,o=i+e):o>s&&(r=s-e,o=s),this.value.setRawValue(new gm(r,o),t)}}onPointerMove_(e){this.applyPointToValue_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.applyPointToValue_(e.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Em{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new Pm(e,t);const n={constraint:t.constraint,textProps:t.textProps};this.tc_=new Tr(e,{assembly:bm,axes:[n,n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new ym(e,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function $m(e){return gm.isObject(e)?new gm(e.min,e.max):new gm(0,0)}function km(e,t){e.writeProperty("max",t.max),e.writeProperty("min",t.min)}Cn({id:"input-interval",type:"input",accept:(e,t)=>{if(!gm.isObject(e))return null;const n=zt(t,(e=>Object.assign(Object.assign({},kt(e)),{readonly:e.optional.constant(!1)})));return n?{initialValue:new gm(e.min,e.max),params:n}:null},binding:{reader:e=>$m,constraint:e=>function(e){const t=[],n=Et(e);n&&t.push(n);const i=Pt(e);return i&&t.push(i),new wm(new si(t))}(e.params),equals:gm.equals,writer:e=>km},controller(e){const t=e.value,n=e.constraint;if(!(n instanceof wm))throw Fe.shouldNeverHappen();const i=(t.rawValue.min+t.rawValue.max)/2,s=Ge.fromObject($t(e.params,i)),r=n.edge&&ri(n.edge,Ye);if(r)return new Em(e.document,{constraint:n.edge,parser:mt,sliderProps:new Ge({keyScale:s.value("keyScale"),max:r.values.value("max"),min:r.values.value("min")}),textProps:s,value:t,viewProps:e.viewProps});const o={constraint:n.edge,textProps:s};return new Tr(e.document,{assembly:bm,axes:[o,o],parser:mt,value:t,viewProps:e.viewProps})}});class Vm{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return null!==(e=this.controller_.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.props.set("title",e)}}class Lm extends St{constructor(e,t,n,i,s){super(e,i,s),this.cell=t,this.index=n}}class Mm extends Lt{constructor(e){super(e),this.cellToApiMap_=new Map;this.controller.valueController.cellControllers.forEach((e=>{const t=new Vm(e);this.cellToApiMap_.set(e,t)}))}get value(){return this.controller.value}cell(e,t){const n=this.controller.valueController,i=n.cellControllers[t*n.size[0]+e];return this.cellToApiMap_.get(i)}on(e,t){const n=t.bind(this);this.controller.value.emitter.on(e,(e=>{const t=this.controller.valueController,i=t.findCellByValue(e.rawValue);if(!i)return;const s=this.cellToApiMap_.get(i);if(!s)return;const r=t.cellControllers.indexOf(i);n(new Lm(this,s,[r%t.size[0],Math.floor(r/t.size[0])],e.rawValue))}))}}const Sm=sn("rad");class Am{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Sm()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(Sm("l")),this.element.appendChild(n);const i=e.createElement("input");i.classList.add(Sm("i")),i.name=t.name,i.type="radio",t.viewProps.bindDisabled(i),n.appendChild(i),this.inputElement=i;const s=e.createElement("div");s.classList.add(Sm("b")),n.appendChild(s);const r=e.createElement("div");r.classList.add(Sm("t")),s.appendChild(r),tn(t.props,"title",(e=>{r.textContent=e}))}}class Dm{constructor(e,t){this.props=t.props,this.viewProps=t.viewProps,this.view=new Am(e,{name:t.name,props:this.props,viewProps:this.viewProps})}}class jm{constructor(e,t){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=t.size;const[n,i]=this.size;for(let s=0;s<i;s++)for(let i=0;i<n;i++){const n=new Dm(e,{name:t.groupName,props:Ge.fromObject(Object.assign({},t.cellConfig(i,s))),viewProps:Rn.create()});this.cellCs_.push(n),this.cellValues_.push(t.cellConfig(i,s).value)}this.value=t.value,en(this.value,(e=>{const t=this.findCellByValue(e);t&&(t.view.inputElement.checked=!0)})),this.viewProps=Rn.create(),this.view=new qi(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${n}, 1fr)`,this.cellCs_.forEach((e=>{e.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(e.view.element)}))}get cellControllers(){return this.cellCs_}findCellByValue(e){const t=this.cellValues_.findIndex((t=>t===e));return t<0?null:this.cellCs_[t]}onCellInputChange_(e){const t=e.currentTarget,n=this.cellCs_.findIndex((e=>e.view.inputElement===t));n<0||(this.value.rawValue=this.cellValues_[n])}}function Tm(e){return Cn({id:"input-radiogrid",type:"input",accept(t,n){if(!e.isType(t))return null;const i=zt(n,(e=>({cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),view:e.required.constant("radiogrid")})));return i?{initialValue:t,params:i}:null},binding:e.binding,controller:e=>new jm(e.document,{cellConfig:e.params.cells,groupName:e.params.groupName,size:e.params.size,value:e.value})})}Cn({id:"radiogrid",type:"blade",accept(e){const t=zt(e,(e=>({cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string})));return t?{params:t}:null},controller(e){const t=He(e.params.value);return new pn(e.document,{blade:e.blade,props:Ge.fromObject({label:e.params.label}),value:t,valueController:new jm(e.document,{groupName:e.params.groupName,cellConfig:e.params.cells,size:e.params.size,value:t})})},api:e=>e.controller instanceof pn&&e.controller.valueController instanceof jm?new Mm(e.controller):null}),Tm({isType:e=>"number"==typeof e,binding:{reader:e=>vt,writer:e=>Yi}}),Tm({isType:e=>"string"==typeof e,binding:{reader:e=>Ci,writer:e=>Yi}}),Tm({isType:e=>"boolean"==typeof e,binding:{reader:e=>wi,writer:e=>Yi}});var Nm=Function.prototype.toString,Bm=Object.create,Om=Object.prototype.toString,zm=function(){function e(){this._keys=[],this._values=[]}return e.prototype.has=function(e){return!!~this._keys.indexOf(e)},e.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},e.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},e}();var Fm="undefined"!=typeof WeakMap?function(){return new WeakMap}:function(){return new zm};function Im(e){if(!e)return Bm(null);var t=e.constructor;if(t===Object)return e===Object.prototype?{}:Bm(e);if(t&&~Nm.call(t).indexOf("[native code]"))try{return new t}catch(e){}return Bm(e)}var Rm="g"===/test/g.flags?function(e){return e.flags}:function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function qm(e){var t=Om.call(e);return t.substring(8,t.length-1)}var Um="undefined"!=typeof Symbol?function(e){return e[Symbol.toStringTag]||qm(e)}:qm,Km=Object.defineProperty,Hm=Object.getOwnPropertyDescriptor,Gm=Object.getOwnPropertyNames,Ym=Object.getOwnPropertySymbols,Xm=Object.prototype,Wm=Xm.hasOwnProperty,Zm=Xm.propertyIsEnumerable,Qm="function"==typeof Ym;var Jm=Qm?function(e){return Gm(e).concat(Ym(e))}:Gm;function ev(e,t,n){for(var i=Jm(e),s=0,r=i.length,o=void 0,a=void 0;s<r;++s)if("callee"!==(o=i[s])&&"caller"!==o)if(a=Hm(e,o)){a.get||a.set||(a.value=n.copier(a.value,n));try{Km(t,o,a)}catch(e){t[o]=a.value}}else t[o]=n.copier(e[o],n);return t}function tv(e,t){return e.slice(0)}function nv(e,t){var n=new t.Constructor;return t.cache.set(e,n),e.forEach((function(e,i){n.set(i,t.copier(e,t))})),n}var iv=Qm?function(e,t){var n=Im(t.prototype);for(var i in t.cache.set(e,n),e)Wm.call(e,i)&&(n[i]=t.copier(e[i],t));for(var s=Ym(e),r=0,o=s.length,a=void 0;r<o;++r)a=s[r],Zm.call(e,a)&&(n[a]=t.copier(e[a],t));return n}:function(e,t){var n=Im(t.prototype);for(var i in t.cache.set(e,n),e)Wm.call(e,i)&&(n[i]=t.copier(e[i],t));return n};function sv(e,t){return new t.Constructor(e.valueOf())}function rv(e,t){return e}function ov(e,t){var n=new t.Constructor;return t.cache.set(e,n),e.forEach((function(e){n.add(t.copier(e,t))})),n}var av=Array.isArray,lv=Object.assign,cv=Object.getPrototypeOf||function(e){return e.__proto__},hv={array:function(e,t){var n=new t.Constructor;t.cache.set(e,n);for(var i=0,s=e.length;i<s;++i)n[i]=t.copier(e[i],t);return n},arrayBuffer:tv,blob:function(e,t){return e.slice(0,e.size,e.type)},dataView:function(e,t){return new t.Constructor(tv(e.buffer))},date:function(e,t){return new t.Constructor(e.getTime())},error:rv,map:nv,object:iv,regExp:function(e,t){var n=new t.Constructor(e.source,Rm(e));return n.lastIndex=e.lastIndex,n},set:ov},pv=lv({},hv,{array:function(e,t){var n=new t.Constructor;return t.cache.set(e,n),ev(e,n,t)},map:function(e,t){return ev(e,nv(e,t),t)},object:function(e,t){var n=Im(t.prototype);return t.cache.set(e,n),ev(e,n,t)},set:function(e,t){return ev(e,ov(e,t),t)}});function uv(e){var t=function(e){return{Arguments:e.object,Array:e.array,ArrayBuffer:e.arrayBuffer,Blob:e.blob,Boolean:sv,DataView:e.dataView,Date:e.date,Error:e.error,Float32Array:e.arrayBuffer,Float64Array:e.arrayBuffer,Int8Array:e.arrayBuffer,Int16Array:e.arrayBuffer,Int32Array:e.arrayBuffer,Map:e.map,Number:sv,Object:e.object,Promise:rv,RegExp:e.regExp,Set:e.set,String:sv,WeakMap:rv,WeakSet:rv,Uint8Array:e.arrayBuffer,Uint8ClampedArray:e.arrayBuffer,Uint16Array:e.arrayBuffer,Uint32Array:e.arrayBuffer,Uint64Array:e.arrayBuffer}}(lv({},hv,e)),n=t.Array,i=t.Object;function s(e,s){if(s.prototype=s.Constructor=void 0,!e||"object"!=typeof e)return e;if(s.cache.has(e))return s.cache.get(e);if(s.prototype=cv(e),s.Constructor=s.prototype&&s.prototype.constructor,!s.Constructor||s.Constructor===Object)return i(e,s);if(av(e))return n(e,s);var r=t[Um(e)];return r?r(e,s):"function"==typeof e.then?e:i(e,s)}return function(e){return s(e,{Constructor:void 0,cache:Fm(),copier:s,prototype:void 0})}}uv(lv({},pv,{}));var dv=uv({}),mv=Object.getOwnPropertyNames,vv=Object.getOwnPropertySymbols,fv=Object.prototype.hasOwnProperty;function gv(e,t){return function(n,i,s){return e(n,i,s)&&t(n,i,s)}}function bv(e){return function(t,n,i){if(!t||!n||"object"!=typeof t||"object"!=typeof n)return e(t,n,i);var s=i.cache,r=s.get(t),o=s.get(n);if(r&&o)return r===n&&o===t;s.set(t,n),s.set(n,t);var a=e(t,n,i);return s.delete(t),s.delete(n),a}}function wv(e){return mv(e).concat(vv(e))}var _v=Object.hasOwn||function(e,t){return fv.call(e,t)};function yv(e,t){return e===t||!e&&!t&&e!=e&&t!=t}var xv=Object.getOwnPropertyDescriptor,Cv=Object.keys;function Pv(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function Ev(e,t){return yv(e.getTime(),t.getTime())}function $v(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function kv(e,t){return e===t}function Vv(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var s,r,o=new Array(i),a=e.entries(),l=0;(s=a.next())&&!s.done;){for(var c=t.entries(),h=!1,p=0;(r=c.next())&&!r.done;)if(o[p])p++;else{var u=s.value,d=r.value;if(n.equals(u[0],d[0],l,p,e,t,n)&&n.equals(u[1],d[1],u[0],d[0],e,t,n)){h=o[p]=!0;break}p++}if(!h)return!1;l++}return!0}var Lv=yv;function Mv(e,t,n){var i=Cv(e),s=i.length;if(Cv(t).length!==s)return!1;for(;s-- >0;)if(!Bv(e,t,n,i[s]))return!1;return!0}function Sv(e,t,n){var i,s,r,o=wv(e),a=o.length;if(wv(t).length!==a)return!1;for(;a-- >0;){if(!Bv(e,t,n,i=o[a]))return!1;if(s=xv(e,i),r=xv(t,i),(s||r)&&(!s||!r||s.configurable!==r.configurable||s.enumerable!==r.enumerable||s.writable!==r.writable))return!1}return!0}function Av(e,t){return yv(e.valueOf(),t.valueOf())}function Dv(e,t){return e.source===t.source&&e.flags===t.flags}function jv(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var s,r,o=new Array(i),a=e.values();(s=a.next())&&!s.done;){for(var l=t.values(),c=!1,h=0;(r=l.next())&&!r.done;){if(!o[h]&&n.equals(s.value,r.value,s.value,r.value,e,t,n)){c=o[h]=!0;break}h++}if(!c)return!1}return!0}function Tv(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Nv(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Bv(e,t,n,i){return!("_owner"!==i&&"__o"!==i&&"__v"!==i||!e.$$typeof&&!t.$$typeof)||_v(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var Ov=Array.isArray,zv="function"==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,Fv=Object.assign,Iv=Object.prototype.toString.call.bind(Object.prototype.toString);qv(),qv({strict:!0}),qv({circular:!0}),qv({circular:!0,strict:!0});var Rv=qv({createInternalComparator:function(){return yv}});function qv(e){void 0===e&&(e={});var t,n=e.circular,i=void 0!==n&&n,s=e.createInternalComparator,r=e.createState,o=e.strict,a=void 0!==o&&o,l=function(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,s={areArraysEqual:i?Sv:Pv,areDatesEqual:Ev,areErrorsEqual:$v,areFunctionsEqual:kv,areMapsEqual:i?gv(Vv,Sv):Vv,areNumbersEqual:Lv,areObjectsEqual:i?Sv:Mv,arePrimitiveWrappersEqual:Av,areRegExpsEqual:Dv,areSetsEqual:i?gv(jv,Sv):jv,areTypedArraysEqual:i?Sv:Tv,areUrlsEqual:Nv};if(n&&(s=Fv({},s,n(s))),t){var r=bv(s.areArraysEqual),o=bv(s.areMapsEqual),a=bv(s.areObjectsEqual),l=bv(s.areSetsEqual);s=Fv({},s,{areArraysEqual:r,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return s}(e),c=function(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,s=e.areFunctionsEqual,r=e.areMapsEqual,o=e.areNumbersEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,h=e.areSetsEqual,p=e.areTypedArraysEqual,u=e.areUrlsEqual;return function(e,d,m){if(e===d)return!0;if(null==e||null==d)return!1;var v=typeof e;if(v!==typeof d)return!1;if("object"!==v)return"number"===v?o(e,d,m):"function"===v&&s(e,d,m);var f=e.constructor;if(f!==d.constructor)return!1;if(f===Object)return a(e,d,m);if(Ov(e))return t(e,d,m);if(null!=zv&&zv(e))return p(e,d,m);if(f===Date)return n(e,d,m);if(f===RegExp)return c(e,d,m);if(f===Map)return r(e,d,m);if(f===Set)return h(e,d,m);var g=Iv(e);return"[object Date]"===g?n(e,d,m):"[object RegExp]"===g?c(e,d,m):"[object Map]"===g?r(e,d,m):"[object Set]"===g?h(e,d,m):"[object Object]"===g?"function"!=typeof e.then&&"function"!=typeof d.then&&a(e,d,m):"[object URL]"===g?u(e,d,m):"[object Error]"===g?i(e,d,m):"[object Arguments]"===g?a(e,d,m):("[object Boolean]"===g||"[object Number]"===g||"[object String]"===g)&&l(e,d,m)}}(l),h=s?s(c):(t=c,function(e,n,i,s,r,o,a){return t(e,n,a)});return function(e){var t=e.circular,n=e.comparator,i=e.createState,s=e.equals,r=e.strict;if(i)return function(e,o){var a=i(),l=a.cache,c=void 0===l?t?new WeakMap:void 0:l,h=a.meta;return n(e,o,{cache:c,equals:s,meta:h,strict:r})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:s,meta:void 0,strict:r})};var o={cache:void 0,equals:s,meta:void 0,strict:r};return function(e,t){return n(e,t,o)}}({circular:i,comparator:c,createState:r,equals:h,strict:a})}function Uv(e){let t,n;return t=new yd({props:{theme:e[7],userCreatedPane:!1,$$slots:{default:[Hv]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]&&(i.theme=e[7]),127&n[0]|2&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Kv(e){let t,n,i,s;const r=[Yv,Gv],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function Hv(e){let t,n,i,s,r,o,a,l,c;function h(t){e[14](t)}function p(t){e[15](t)}function u(t){e[16](t)}function d(t){e[17](t)}function m(t){e[18](t)}function v(t){e[19](t)}function f(t){e[20](t)}let g={};return void 0!==e[1]&&(g.disabled=e[1]),void 0!==e[5]&&(g.key=e[5]),void 0!==e[2]&&(g.label=e[2]),void 0!==e[0]&&(g.object=e[0]),void 0!==e[3]&&(g.options=e[3]),void 0!==e[6]&&(g.plugin=e[6]),void 0!==e[4]&&(g.ref=e[4]),t=new Zv({props:g}),I.push((()=>ae(t,"disabled",h))),I.push((()=>ae(t,"key",p))),I.push((()=>ae(t,"label",u))),I.push((()=>ae(t,"object",d))),I.push((()=>ae(t,"options",m))),I.push((()=>ae(t,"plugin",v))),I.push((()=>ae(t,"ref",f))),t.$on("change",e[21]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),c=!0},p(e,c){const h={};!n&&2&c[0]&&(n=!0,h.disabled=e[1],Y((()=>n=!1))),!i&&32&c[0]&&(i=!0,h.key=e[5],Y((()=>i=!1))),!s&&4&c[0]&&(s=!0,h.label=e[2],Y((()=>s=!1))),!r&&1&c[0]&&(r=!0,h.object=e[0],Y((()=>r=!1))),!o&&8&c[0]&&(o=!0,h.options=e[3],Y((()=>o=!1))),!a&&64&c[0]&&(a=!0,h.plugin=e[6],Y((()=>a=!1))),!l&&16&c[0]&&(l=!0,h.ref=e[4],Y((()=>l=!1))),t.$set(h)},i(e){c||(ie(t.$$.fragment,e),c=!0)},o(e){se(t.$$.fragment,e),c=!1},d(e){he(t,e)}}}function Gv(e){let t,n;return t=new Vo({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:e[7]}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};128&n[0]&&(i.theme=e[7]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Yv(e){let n;return{c(){n=x("div"),k(n,"display","none")},m(t,i){_(t,n,i),e[13](n)},p:t,i:t,o:t,d(t){t&&y(n),e[13](null)}}}function Xv(e){let t,n,i,s;const r=[Kv,Uv],o=[];return t=function(e){return e[9]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=E()},m(e,n){o[t].m(e,n),_(e,i,n),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[t].d(e)}}}function Wv(e,t,n){let i,{object:s}=t,{key:r}=t,{disabled:o=!1}=t,{label:a}=t,{options:l}=t,{theme:c}=t,{ref:p}=t,{plugin:u}=t;const d=O("registerPlugin"),m=O("parentStore");h(e,m,(e=>n(12,i=e)));const v=O("userCreatedPane");let f,g,b;function w(){f&&f.dispose(),void 0!==u&&d(u),n(10,f=i.addBinding(s,r,{index:b,label:a,...l,disabled:o})),n(4,p=f),f.on("change",E)}j((()=>{n(11,b=g?So(g):0)})),T((()=>{f?.dispose()}));const _=N();function y(e){if(e instanceof File)return new File([e],e.name,{lastModified:e.lastModified,type:e.type});if(e instanceof HTMLImageElement){const t=new Image;return t.src=e.src,t}return dv(e)}let x=s,C=y(s[r]),P=!1;function E(){P=!0,n(0,s[r]=y(s[r]),s)}return e.$$set=e=>{"object"in e&&n(0,s=e.object),"key"in e&&n(5,r=e.key),"disabled"in e&&n(1,o=e.disabled),"label"in e&&n(2,a=e.label),"options"in e&&n(3,l=e.options),"theme"in e&&n(7,c=e.theme),"ref"in e&&n(4,p=e.ref),"plugin"in e&&n(6,u=e.plugin)},e.$$.update=()=>{var t;1026&e.$$.dirty[0]&&void 0!==f&&n(10,f.disabled=o,f),1028&e.$$.dirty[0]&&void 0!==f&&n(10,f.label=a,f),e.$$.dirty[0],6152&e.$$.dirty[0]&&void 0!==i&&void 0!==b&&w(),4097&e.$$.dirty[0]&&void 0!==i&&(x!==(t=s)&&(P=!1),Rv(t[r],C)||(C=y(t[r]),_("change",{value:y(t[r]),origin:P?"internal":"external"}),!P&&f&&(f.off("change",E),f.refresh(),f.on("change",E))),P=!1,x!==t&&(x=t,w())),4224&e.$$.dirty[0]&&c&&void 0!==i&&(v||!Lo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Binding> components for a theme prop.)")},[s,o,a,l,p,r,u,c,g,m,f,b,i,function(e){I[e?"unshift":"push"]((()=>{g=e,n(8,g)}))},function(e){o=e,n(1,o)},function(e){r=e,n(5,r)},function(e){a=e,n(2,a)},function(e){s=e,n(0,s)},function(e){l=e,n(3,l)},function(e){u=e,n(6,u)},function(e){p=e,n(4,p)},function(t){z.call(this,e,t)}]}qv({strict:!0,createInternalComparator:function(){return yv}}),qv({circular:!0,createInternalComparator:function(){return yv}}),qv({circular:!0,createInternalComparator:function(){return yv},strict:!0});class Zv extends ue{constructor(e){super(),pe(this,e,Wv,Xv,a,{object:0,key:5,disabled:1,label:2,options:3,theme:7,ref:4,plugin:6},null,[-1,-1])}}function Qv(e){let t,i,s,r;const o=[{key:e[3]},{options:e[1]},e[4]];function a(t){e[6](t)}function l(t){e[7](t)}let c={};for(let e=0;e<o.length;e+=1)c=n(c,o[e]);return void 0!==e[2]&&(c.object=e[2]),void 0!==e[0]&&(c.ref=e[0]),t=new Zv({props:c}),I.push((()=>ae(t,"object",a))),I.push((()=>ae(t,"ref",l))),t.$on("change",e[8]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),r=!0},p(e,[n]){const r=26&n?re(o,[8&n&&{key:e[3]},2&n&&{options:e[1]},16&n&&oe(e[4])]):{};!i&&4&n&&(i=!0,r.object=e[2],Y((()=>i=!1))),!s&&1&n&&(s=!0,r.ref=e[0],Y((()=>s=!1))),t.$set(r)},i(e){r||(ie(t.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),r=!1},d(e){he(t,e)}}}function Jv(e,t,i){let s;const r=["value","ref","options"];let o=g(t,r),{value:a}=t,{ref:l}=t,{options:c}=t;const h=Symbol("key");return e.$$set=e=>{t=n(n({},t),f(e)),i(4,o=g(t,r)),"value"in e&&i(5,a=e.value),"ref"in e&&i(0,l=e.ref),"options"in e&&i(1,c=e.options)},e.$$.update=()=>{4&e.$$.dirty&&i(5,a=s[h]),32&e.$$.dirty&&(Rv(a,s[h])||i(2,s[h]=a,s))},i(2,s={[h]:a}),[l,c,s,h,o,a,function(e){s=e,i(2,s)},function(e){l=e,i(0,l)},function(t){z.call(this,e,t)}]}class ef extends ue{constructor(e){super(),pe(this,e,Jv,Qv,a,{value:5,ref:0,options:1})}}function tf(e){let t,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[5](t)}function l(t){e[6](t)}let c={};for(let e=0;e<o.length;e+=1)c=n(c,o[e]);return void 0!==e[1]&&(c.value=e[1]),void 0!==e[0]&&(c.ref=e[0]),t=new ef({props:c}),I.push((()=>ae(t,"value",a))),I.push((()=>ae(t,"ref",l))),t.$on("change",e[7]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),r=!0},p(e,[n]){const r=12&n?re(o,[4&n&&{options:e[2]},8&n&&oe(e[3])]):{};!i&&2&n&&(i=!0,r.value=e[1],Y((()=>i=!1))),!s&&1&n&&(s=!0,r.ref=e[0],Y((()=>s=!1))),t.$set(r)},i(e){r||(ie(t.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),r=!1},d(e){he(t,e)}}}function nf(e,t,i){const s=["options","ref","value"];let r,o=g(t,s),{options:a}=t,{ref:l}=t,{value:c}=t;return e.$$set=e=>{t=n(n({},t),f(e)),i(3,o=g(t,s)),"options"in e&&i(4,a=e.options),"ref"in e&&i(0,l=e.ref),"value"in e&&i(1,c=e.value)},e.$$.update=()=>{16&e.$$.dirty&&i(2,r={...a,readonly:!1})},[l,c,r,o,a,function(e){c=e,i(1,c)},function(e){l=e,i(0,l)},function(t){z.call(this,e,t)}]}class sf extends ue{constructor(e){super(),pe(this,e,nf,tf,a,{options:4,ref:0,value:1})}}function rf(e){let t,i,s;const r=[e[1]];function o(t){e[2](t)}let a={};for(let e=0;e<r.length;e+=1)a=n(a,r[e]);return void 0!==e[0]&&(a.value=e[0]),t=new sf({props:a}),I.push((()=>ae(t,"value",o))),t.$on("change",e[3]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),s=!0},p(e,[n]){const s=2&n?re(r,[oe(e[1])]):{};!i&&1&n&&(i=!0,s.value=e[0],Y((()=>i=!1))),t.$set(s)},i(e){s||(ie(t.$$.fragment,e),s=!0)},o(e){se(t.$$.fragment,e),s=!1},d(e){he(t,e)}}}function of(e,t,i){const s=["value"];let r=g(t,s),{value:o}=t;return e.$$set=e=>{t=n(n({},t),f(e)),i(1,r=g(t,s)),"value"in e&&i(0,o=e.value)},[o,r,function(e){o=e,i(0,o)},function(t){z.call(this,e,t)}]}class af extends ue{constructor(e){super(),pe(this,e,of,rf,a,{value:0})}}const lf=sn("ctn"),cf=sn("input"),hf=sn("btn");class pf{constructor(e,t){this.element=e.createElement("div"),this.container=e.createElement("div"),this.container.classList.add(lf()),t.viewProps.bindClassModifiers(this.container),this.input=e.createElement("input"),this.input.classList.add(cf()),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.filetypes?t.filetypes.join(","):"*"),this.input.style.height=`calc(20px * ${t.lineCount})`,this.fileIcon=e.createElement("div"),this.fileIcon.classList.add(lf("icon")),this.text=e.createElement("span"),this.text.classList.add(lf("text")),this.warning=e.createElement("span"),this.warning.classList.add(lf("warning")),this.warning.innerHTML=t.invalidFiletypeMessage,this.warning.style.display="none",this.deleteButton=e.createElement("button"),this.deleteButton.classList.add(hf("b")),this.deleteButton.innerHTML="Delete",this.deleteButton.style.display="none",this.container.appendChild(this.input),this.container.appendChild(this.fileIcon),this.element.appendChild(this.container),this.element.appendChild(this.warning),this.element.appendChild(this.deleteButton)}changeDraggingState(e){var t,n;e?null===(t=this.container)||void 0===t||t.classList.add(lf("input_area_dragging")):null===(n=this.container)||void 0===n||n.classList.remove(lf("input_area_dragging"))}}class uf{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new pf(e,{viewProps:this.viewProps,value:t.value,invalidFiletypeMessage:t.invalidFiletypeMessage,lineCount:t.lineCount,filetypes:t.filetypes}),this.config=t,this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.onDeleteClick=this.onDeleteClick.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.view.deleteButton.addEventListener("click",this.onDeleteClick),this.value.emitter.on("change",(()=>this.handleValueChange())),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.element.removeEventListener("drop",this.onDrop),this.view.element.removeEventListener("dragover",this.onDragOver),this.view.element.removeEventListener("dragleave",this.onDragLeave),this.view.deleteButton.removeEventListener("click",this.onDeleteClick)}))}onFile(e){const t=this.view.input;if(t.files&&t.files.length>0){const e=t.files[0];this.isFileValid(e)?this.value.setRawValue(e):this.showWarning()}}showWarning(){this.view.warning.style.display="block",setTimeout((()=>{this.view.warning.style.display="none"}),5e3)}isFileValid(e){var t;const n=this.config.filetypes,i="."+(null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase());return!(n&&n.length>0&&!n.includes(i)&&i)}onDeleteClick(){this.value.rawValue&&(this.value.setRawValue(null),this.view.input.value="",this.view.warning.style.display="none")}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}onDrop(e){if(e instanceof DragEvent&&(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files)){const t=e.dataTransfer.files;if(1==t.length){const e=t.item(0);e&&(this.isFileValid(e)?this.value.setRawValue(e):this.showWarning())}}this.view.changeDraggingState(!1)}handleValueChange(){const e=this.value.rawValue,t=this.view.container,n=this.view.text,i=this.view.fileIcon,s=this.view.deleteButton;e?(n.textContent=e.name,t.appendChild(n),t.contains(i)&&t.removeChild(i),this.view.warning.style.display="none",s.style.display="block",t.style.border="unset"):(n.textContent="",t.appendChild(i),t.removeChild(n),this.view.warning.style.display="none",s.style.display="none",t.style.border="1px dashed #717070")}}function df(e){const t=new Image;return t.crossOrigin="anonymous",t.src=e,t}Cn({id:"file-input",type:"input",accept(e,t){if("string"!=typeof e)return null;const n=zt(t,(e=>({view:e.required.constant("file-input"),invalidFiletypeMessage:e.optional.string,lineCount:e.optional.number,filetypes:e.optional.array(e.required.string)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>e instanceof File?e:null,constraint:e=>new si([]),writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new uf(e.document,{value:e.value,viewProps:e.viewProps,invalidFiletypeMessage:null!==(t=e.params.invalidFiletypeMessage)&&void 0!==t?t:"Unaccepted file type.",lineCount:null!==(n=e.params.lineCount)&&void 0!==n?n:3,filetypes:e.params.filetypes})}});const mf=sn("img");class vf{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(mf()),t.viewProps.bindClassModifiers(this.element),this.input=e.createElement("input"),this.input.classList.add(mf("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.extensions.join(",")),this.image_=e.createElement("img"),this.image_.id="tpimg_"+Math.random().toString(36).slice(2),this.image_.classList.add(mf("image")),this.image_.classList.add(mf(`image_${t.imageFit}`)),this.image_.crossOrigin="anonymous",this.image_.onclick=e=>t.clickCallback?t.clickCallback(e,this.input):this.input.click(),this.element.classList.add(mf("area_root")),this.element.appendChild(this.image_),this.element.appendChild(this.input)}changeImage(e){this.image_.src=e}changeDraggingState(e){const t=this.element;e?null==t||t.classList.add(mf("area_dragging")):null==t||t.classList.remove(mf("area_dragging"))}}let ff=null;class gf{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new vf(e,{viewProps:this.viewProps,extensions:t.extensions,imageFit:t.imageFit,clickCallback:t.clickCallback}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragstart",this.onDragStart),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose((()=>{this.view.input.removeEventListener("change",this.onFile),this.view.element.removeEventListener("drop",this.onDrop),this.view.element.removeEventListener("dragstart",this.onDragStart),this.view.element.removeEventListener("dragover",this.onDragOver),this.view.element.removeEventListener("dragleave",this.onDragLeave)})),this.value.emitter.on("change",(()=>this.handleValueChange())),this.handleValueChange()}onFile(e){const t=(null==e?void 0:e.target).files;if(!t||!t.length)return;const n=t[0];this.setValue(n)}onDrop(e){e.preventDefault();try{const{dataTransfer:t}=e,n=null==t?void 0:t.files[0];if(n)this.setValue(n);else{const e=null==t?void 0:t.getData("img-id");if(e){const t=document.getElementById(e);this.setValue(t)}else{const e=null==t?void 0:t.getData("url");if(!e)throw new Error("No url");this.setValue(e)}}}catch(e){console.error("Could not parse the dropped image",e)}finally{this.view.changeDraggingState(!1)}}onDragStart(e){var t,n;null===(t=e.dataTransfer)||void 0===t||t.setData("img-id",this.view.image_.id),null===(n=e.dataTransfer)||void 0===n||n.setDragImage(this.view.image_,0,0)}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(e){e instanceof HTMLImageElement?this.updateImage(e.src):"string"!=typeof e&&e?this.setValue(e):("placeholder"!==e&&e||(e=this.handlePlaceholderImage().src),this.updateImage(e))}updateImage(e){this.view.changeImage(e)}setValue(e){if(e instanceof HTMLImageElement)this.value.setRawValue(e);else if(e instanceof File){const t=URL.createObjectURL(e)+"#"+e.name;e.src=t;const n=df(t);this.value.setRawValue(n||e)}else e?this.value.setRawValue(df(e)):this.value.setRawValue(this.handlePlaceholderImage())}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return ff||(ff=function(){const e=new Blob(['\n\t<svg width="320" height="50" xmlns="http://www.w3.org/2000/svg">\n  <style>\n    text {\n      font-family: "Menlo", monospace;\n      font-size: 12px;\n\t\t\tfill: gray;\n    }\n  </style>\n  <text x="50%" y="55%" text-anchor="middle">\n    No Image\n  </text>\n</svg>'],{type:"image/svg+xml"}),t=new Image;return t.src=URL.createObjectURL(e),t}()),ff}}const bf=[".jpg",".png",".gif"];function wf(e){let t,i,s,r;const o=[{options:e[2]},e[3]];function a(t){e[12](t)}function l(t){e[13](t)}let c={};for(let e=0;e<o.length;e+=1)c=n(c,o[e]);return void 0!==e[0]&&(c.value=e[0]),void 0!==e[1]&&(c.ref=e[1]),t=new sf({props:c}),I.push((()=>ae(t,"value",a))),I.push((()=>ae(t,"ref",l))),t.$on("change",e[14]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),r=!0},p(e,[n]){const r=12&n?re(o,[4&n&&{options:e[2]},8&n&&oe(e[3])]):{};!i&&1&n&&(i=!0,r.value=e[0],Y((()=>i=!1))),!s&&2&n&&(s=!0,r.ref=e[1],Y((()=>s=!1))),t.$set(r)},i(e){r||(ie(t.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),r=!1},d(e){he(t,e)}}}function _f(e,t,i){const s=["value","options","min","max","step","pointerScale","keyScale","format","ref"];let r,o=g(t,s),{value:a}=t,{options:l}=t,{min:c}=t,{max:h}=t,{step:p}=t,{pointerScale:u}=t,{keyScale:d}=t,{format:m}=t,{ref:v}=t,b=m;return e.$$set=e=>{t=n(n({},t),f(e)),i(3,o=g(t,s)),"value"in e&&i(0,a=e.value),"options"in e&&i(4,l=e.options),"min"in e&&i(5,c=e.min),"max"in e&&i(6,h=e.max),"step"in e&&i(7,p=e.step),"pointerScale"in e&&i(8,u=e.pointerScale),"keyScale"in e&&i(9,d=e.keyScale),"format"in e&&i(10,m=e.format),"ref"in e&&i(1,v=e.ref)},e.$$.update=()=>{3072&e.$$.dirty&&b!==m&&i(11,b=m),3056&e.$$.dirty&&i(2,r={min:c,max:h,format:b,keyScale:d,pointerScale:u,step:p,...l})},[a,v,r,o,l,c,h,p,u,d,m,b,function(e){a=e,i(0,a)},function(e){v=e,i(1,v)},function(t){z.call(this,e,t)}]}Cn({id:"input-image",type:"input",accept(e,t){if(!(e instanceof HTMLImageElement||"string"==typeof e))return null;const n=zt(t,(e=>({view:e.required.constant("input-image"),acceptUrl:e.optional.boolean,clickCallback:e.optional.function,imageFit:e.optional.custom((e=>"contain"===e||"cover"===e?e:void 0)),extensions:e.optional.array(e.required.string)})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>void 0!==e.src?""===e.src?"placeholder":e.src:e,writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new gf(e.document,{value:e.value,imageFit:null!==(t=e.params.imageFit)&&void 0!==t?t:"cover",clickCallback:e.params.clickCallback,viewProps:e.viewProps,extensions:null!==(n=e.params.extensions)&&void 0!==n?n:bf})}});class yf extends ue{constructor(e){super(),pe(this,e,_f,wf,a,{value:0,options:4,min:5,max:6,step:7,pointerScale:8,keyScale:9,format:10,ref:1})}}function xf(e){let t,i,s,r,o;const a=[{options:e[1]},e[2]];function l(t){e[7](t)}let c={};for(let e=0;e<a.length;e+=1)c=n(c,a[e]);void 0!==e[0]&&(c.ref=e[0]),t=new Bd({props:c}),I.push((()=>ae(t,"ref",l)));let h=!1;return{c(){le(t.$$.fragment),s=P(),r=E()},m(e,n){ce(t,e,n),_(e,s,n),_(e,r,n),o=!0},p(e,[n]){const s=6&n?re(a,[2&n&&{options:e[1]},4&n&&oe(e[2])]):{};!i&&1&n&&(i=!0,s.ref=e[0],Y((()=>i=!1))),t.$set(s)},i(e){o||(ie(t.$$.fragment,e),ie(h),o=!0)},o(e){se(t.$$.fragment,e),se(h),o=!1},d(e){e&&(y(s),y(r)),he(t,e)}}}function Cf(e){return t=e,Array.isArray(t)&&t.every((e=>"object"==typeof e&&null!==e&&"text"in e&&"value"in e))||function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}(e)?e:e.map((e=>({value:e,text:"object"==typeof e?JSON.stringify(e):String(e)})));var t}function Pf(e,t,i){const s=["value","options","label"];let r=g(t,s),{value:o}=t,{options:a}=t,{label:l}=t;const c=N();let h,p;function u(){if(void 0===o){const e=Cf(a);return Array.isArray(e)?(i(4,o=e[0].value),o):(i(4,o=e[Object.keys(e)[0]]),o)}return o}return e.$$set=e=>{i(3,t=n(n({},t),f(e))),i(2,r=g(t,s)),"value"in e&&i(4,o=e.value),"options"in e&&i(5,a=e.options),"label"in e&&i(6,l=e.label)},e.$$.update=()=>{96&e.$$.dirty&&i(1,p={value:u(),label:l,options:Cf(a),view:"list"}),1&e.$$.dirty&&h&&h.on("change",(e=>{Rv(e.value,o)||(i(4,o=e.value),c("change",{value:dv(o),origin:"internal"}))})),17&e.$$.dirty&&h&&(Rv(h.value,o)||(i(0,h.value=o,h),c("change",{value:dv(o),origin:"external"})))},t=f(t),[h,p,r,t,o,a,l,function(e){h=e,i(0,h)}]}class Ef extends ue{constructor(e){super(),pe(this,e,Pf,xf,a,{value:4,options:5,label:6})}}const $f=sn("ckr");class kf{constructor(e,t){this.tickElems_=[],this.labelElems_=[],this.boundsWidth_=-1,this.onShowsTooltipChange_=this.onShowsTooltipChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.formatters_=t.formatters,this.unit_=t.unit,this.element=e.createElement("div"),this.element.classList.add($f(),$f(void 0,`m${t.seriesId}`)),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.showsTooltip.emitter.on("change",this.onShowsTooltipChange_);const n=e.createElement("div");n.classList.add($f("w")),this.element.appendChild(n),this.offsetElem_=e.createElement("div"),this.offsetElem_.classList.add($f("o")),n.appendChild(this.offsetElem_),this.svgElem_=e.createElementNS(Ut,"svg"),this.svgElem_.classList.add($f("g")),this.offsetElem_.appendChild(this.svgElem_),this.tooltipElem_=e.createElement("div"),this.tooltipElem_.classList.add(sn("tt")(),$f("tt")),this.element.appendChild(this.tooltipElem_),this.waitToBeAdded_()}waitToBeAdded_(){const e=new IntersectionObserver((t=>{t.forEach((t=>{t.target===this.element&&0!==t.intersectionRatio&&(this.update(),e.disconnect())}))}),{root:null});e.observe(this.element)}rebuildScaleIfNeeded_(e){if(this.boundsWidth_===e)return;this.boundsWidth_=e,this.tickElems_.forEach((e=>{Zt(e)})),this.tickElems_=[],this.labelElems_.forEach((e=>{Zt(e)})),this.labelElems_=[];const t=this.element.ownerDocument,n=this.unit_.ticks,i=this.unit_.pixels,s=(2*(Math.ceil(e/2/i)+1)+1)*n,r=i/n;for(let e=0;e<s;e++){const i=e*r;if(e%n===0){const e=t.createElementNS(Ut,"line");e.classList.add($f("mjt")),e.setAttributeNS(null,"x1",String(i)),e.setAttributeNS(null,"y1","0"),e.setAttributeNS(null,"x2",String(i)),e.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(e),this.tickElems_.push(e);const n=t.createElement("div");n.classList.add($f("l")),n.style.left=`${i}px`,this.offsetElem_.appendChild(n),this.labelElems_.push(n)}else{const e=t.createElementNS(Ut,"line");e.classList.add($f("mnt")),e.setAttributeNS(null,"x1",String(i)),e.setAttributeNS(null,"y1","0"),e.setAttributeNS(null,"x2",String(i)),e.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(e),this.tickElems_.push(e)}}}updateScale_(e){const t=this.unit_.value,n=this.unit_.pixels,i=this.value_.rawValue,s=Math.ceil(e/2/n)+1,r=i-i%t-t*s,o=s=>1-Math.pow(wt(Math.abs(i-s)/(e/2*(t/n)),0,1),10);this.labelElems_.forEach(((e,n)=>{const i=r+n*t;e.textContent=this.formatters_.ring(i),e.style.opacity=String(o(i))}));const a=this.unit_.ticks;this.tickElems_.forEach(((e,n)=>{const i=r+n/a*t;e.style.opacity=String(o(i))}))}update(){const e=this.element.getBoundingClientRect().width,t=this.unit_.value,n=this.unit_.pixels,i=this.value_.rawValue,s=e/2-n/t*(i%t+t*(Math.ceil(e/2/n)+1));this.offsetElem_.style.transform=`translateX(${s}px)`,this.tooltipElem_.textContent=this.formatters_.text(i),this.rebuildScaleIfNeeded_(e),this.updateScale_(e)}onValueChange_(){this.update()}onShowsTooltipChange_(e){e.rawValue?this.element.classList.add($f(void 0,"tt")):this.element.classList.remove($f(void 0,"tt"))}}class Vf{constructor(e,t){this.ox_=0,this.ov_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.tooltipEnabled_=t.tooltipEnabled,this.unit_=t.unit,this.showsTooltip_=He(!1),this.view=new kf(e,{formatters:t.formatters,seriesId:t.seriesId,showsTooltip:this.showsTooltip_,unit:t.unit,value:this.value,viewProps:this.viewProps});const n=new Si(this.view.element);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}onPointerDown_(e){const t=e.data;t.point&&(this.ox_=t.point.x,this.ov_=this.value.rawValue,this.tooltipEnabled_&&(this.showsTooltip_.rawValue=!0))}onPointerMove_(e){const t=e.data;if(!t.point)return;const n=t.point.x-this.ox_,i=this.unit_.pixels,s=this.unit_.value;this.value.setRawValue(this.ov_-n/i*s,{forceEmit:!1,last:!1})}onPointerUp_(){this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0}),this.showsTooltip_.rawValue=!1}}const Lf=sn("ckrtxt");class Mf{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Lf());const n=e.createElement("div");n.classList.add(Lf("r")),n.appendChild(t.ringView.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(Lf("t")),i.appendChild(t.textView.element),this.element.appendChild(i)}}class Sf{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.rc_=new Vf(e,{formatters:{ring:t.ringFormatter,text:t.textProps.get("formatter")},seriesId:t.seriesId,tooltipEnabled:!1,unit:t.ringUnit,value:this.value,viewProps:this.viewProps}),this.tc_=new ji(e,{parser:t.parser,props:t.textProps,value:this.value,viewProps:this.viewProps}),this.view=new Mf(e,{ringView:this.rc_.view,textView:this.tc_.view})}}function Af(e){const t=[],n=Et(e);n&&t.push(n);const i=Pt(e);return i&&t.push(i),new si(t)}function Df(e){return 0===e||1===e||2===e?e:void 0}function jf(e){return void 0!==e?String(e):"0"}Cn({id:"input-ring",type:"input",accept(e,t){if("number"!=typeof e)return null;const n=zt(t,(e=>Object.assign(Object.assign({},kt(e)),{series:e.optional.custom(Df),unit:e.optional.object({pixels:e.required.number,ticks:e.required.number,value:e.required.number}),view:e.required.constant("cameraring"),wide:e.optional.boolean})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>vt,constraint:e=>Af(e.params),writer:e=>Yi},controller(e){var t,n,i;const s=null!==(t=e.params.unit)&&void 0!==t?t:{ticks:5,pixels:40,value:10},r=function(e){const t=ft(bt(e.value));return e=>{const n=t(e),i=n.substr(0,1);return n+("-"===i||"+"===i?" ":"")}}(s),o=$t(e.params,e.initialValue);if(e.params.wide)return new Vf(e.document,{formatters:{ring:r,text:o.formatter},seriesId:null!==(n=jf(e.params.series))&&void 0!==n?n:"0",tooltipEnabled:!0,unit:s,value:e.value,viewProps:e.viewProps});const a=Ge.fromObject(o);return new Sf(e.document,{parser:mt,ringFormatter:r,ringUnit:s,seriesId:null!==(i=jf(e.params.series))&&void 0!==i?i:"0",textProps:a,value:e.value,viewProps:e.viewProps})}}),Cn({id:"input-wheel",type:"input",accept(e,t){if("number"!=typeof e)return null;const n=zt(t,(e=>Object.assign(Object.assign({},kt(e)),{amount:e.optional.number,view:e.required.constant("camerawheel"),wide:e.optional.boolean})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>vt,constraint:e=>Af(e.params),writer:e=>Yi},controller(e){var t,n;const i=ft(0),s=$t(e.params,e.initialValue);return e.params.wide?new Vf(e.document,{formatters:{ring:i,text:s.formatter},seriesId:"w",tooltipEnabled:!0,unit:{ticks:10,pixels:40,value:40*(null!==(t=e.params.amount)&&void 0!==t?t:s.pointerScale)},value:e.value,viewProps:e.viewProps}):new Sf(e.document,{parser:mt,ringFormatter:i,ringUnit:{ticks:10,pixels:40,value:40*(null!==(n=e.params.amount)&&void 0!==n?n:s.pointerScale)},seriesId:"w",textProps:Ge.fromObject(s),value:e.value,viewProps:e.viewProps})}});class Tf{multiply(e){return this.format(this.quat.multiply(e.quat))}premultiply(e){return this.format(e.multiply(this))}slerp(e,t){return this.format(this.quat.slerp(e.quat,t))}}function Nf(e,t,n){return Math.min(Math.max(e,t),n)}function Bf(e,t){return e-function(e,t){return Math.floor(e/t)*t}(e,t)}function Of(e){return Bf(e+Math.PI,2*Math.PI)-Math.PI}class zf extends Tf{static fromQuaternion(e,t,n){const i=e.toMat3(),[s,r,o,a]="XYZ"===t?[0,1,2,1]:"XZY"===t?[0,2,1,-1]:"YXZ"===t?[1,0,2,-1]:"YZX"===t?[1,2,0,1]:"ZXY"===t?[2,0,1,1]:[2,1,0,-1],l=[0,0,0],c=i[o+3*s];return l[r]=-a*Math.asin(Nf(c,-1,1)),Math.abs(c)<.999999?(l[s]=a*Math.atan2(i[o+3*r],i[4*o]),l[o]=a*Math.atan2(i[r+3*s],i[4*s])):l[s]=a*Math.atan2(-i[r+3*o],i[4*r]),Math.abs(l[s])+Math.abs(l[o])>Math.PI&&(l[s]=Of(l[s]+Math.PI),l[r]=Of(Math.PI-l[r]),l[o]=Of(l[o]+Math.PI)),new zf(...l,t).reunit(n)}constructor(e,t,n,i,s){super(),this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0,this.order=null!=i?i:"XYZ",this.unit=null!=s?s:"rad"}get quat(){return Ff.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(e,t){return this.reorder(e).reunit(t)}format(e){return e instanceof zf?e.reorder(this.order):e.toEuler(this.order,this.unit)}reorder(e){return e===this.order?this:this.quat.toEuler(e,this.unit)}reunit(e){const t={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit]*{deg:180/Math.PI,rad:1,turn:.5/Math.PI}[e];return new zf(t*this.x,t*this.y,t*this.z,this.order,e)}}class Ff extends Tf{static fromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return new Ff(e.x*i,e.y*i,e.z*i,Math.cos(n))}static fromEuler(e){const t=e.reunit("rad"),[n,i,s,r]="XYZ"===t.order?[0,1,2,1]:"XZY"===t.order?[0,2,1,-1]:"YXZ"===t.order?[1,0,2,-1]:"YZX"===t.order?[1,2,0,1]:"ZXY"===t.order?[2,0,1,1]:[2,1,0,-1],o=t.getComponents(),a=.5*o[n],l=.5*r*o[i],c=.5*o[s],h=Math.cos(a),p=Math.cos(l),u=Math.cos(c),d=Math.sin(a),m=Math.sin(l),v=Math.sin(c),f=[0,0,0,u*p*h+v*m*d];return f[n]=u*p*d-v*m*h,f[i]=r*(u*m*h+v*p*d),f[s]=v*p*h-u*m*d,new Ff(...f)}static lookRotation(e,t){const{normal:n,tangent:i,binormal:s}=e.orthoNormalize(t),r=s.x,o=i.x,a=n.x,l=s.y,c=i.y,h=n.y,p=s.z,u=i.z,d=n.z,m=r+c+d;if(m>0){const e=.5/Math.sqrt(m+1);return new Ff((u-h)*e,(a-p)*e,(l-o)*e,.25/e)}if(r>c&&r>d){const e=2*Math.sqrt(1+r-c-d);return new Ff(.25*e,(o+l)/e,(a+p)/e,(u-h)/e)}if(c>d){const e=2*Math.sqrt(1+c-r-d);return new Ff((o+l)/e,.25*e,(h+u)/e,(a-p)/e)}{const e=2*Math.sqrt(1+d-r-c);return new Ff((a+p)/e,(h+u)/e,.25*e,(l-o)/e)}}constructor(e,t,n,i){super(),this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0,this.w=null!=i?i:1}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(e,t){return zf.fromQuaternion(this,e,t)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return 0===e?new Ff:new Ff(this.x/e,this.y/e,this.z/e,this.w/e)}get negated(){return new Ff(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(e){const t=e.quat;return new Ff(this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w,this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z)}format(e){return e.quat}slerp(e,t){let n=e.quat;if(0===t)return this;if(1===t)return n;const i=this.ban360s;n=n.ban360s;let s=i.w*n.w+i.x*n.x+i.y*n.y+i.z*n.z;if(s<0&&(n=n.negated,s=-s),s>=1)return i;const r=1-s*s;if(r<=Number.EPSILON){const e=1-t;return new Ff(e*i.x+t*n.x,e*i.y+t*n.y,e*i.z+t*n.z,e*i.w+t*n.w).normalized}const o=Math.sqrt(r),a=Math.atan2(o,s),l=Math.sin((1-t)*a)/o,c=Math.sin(t*a)/o;return new Ff(i.x*l+n.x*c,i.y*l+n.y*c,i.z*l+n.z*c,i.w*l+n.w*c)}toMat3(){const{x:e,y:t,z:n,w:i}=this;return[1-2*t*t-2*n*n,2*e*t+2*n*i,2*e*n-2*t*i,2*e*t-2*n*i,1-2*e*e-2*n*n,2*t*n+2*e*i,2*e*n+2*t*i,2*t*n-2*e*i,1-2*e*e-2*t*t]}}class If{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(e){const t=.5*(this.viewport[0]+this.viewport[2]),n=.5*(this.viewport[1]+this.viewport[3]),i=this.viewport[2]-this.viewport[0],s=this.viewport[3]-this.viewport[1],r=1/Math.tan(this.fov*Math.PI/360),o=-(e.z+this.offset[2]);return[t+(e.x+this.offset[0])/o*r*i*.5/this.aspect,n-(e.y+this.offset[1])/o*r*s*.5]}}class Rf{constructor(e,t,n){this.element=e.createElementNS(Ut,"path"),this.vertices=t,this.projector=n}setRotation(e){let t="";return this.vertices.forEach(((n,i)=>{const s=n.applyQuaternion(e),[r,o]=this.projector.project(s);t+=`${0===i?"M":"L"}${r} ${o}`})),this.element.setAttributeNS(null,"d",t),this}}class qf{constructor(e,t,n){this.x=null!=e?e:0,this.y=null!=t?t:0,this.z=null!=n?n:0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return 0===e?new qf:new qf(this.x/e,this.y/e,this.z/e)}get negated(){return new qf(-this.x,-this.y,-this.z)}add(e){return new qf(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return new qf(this.x-e.x,this.y-e.y,this.z-e.z)}scale(e){return new qf(this.x*e,this.y*e,this.z*e)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){return new qf(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}orthoNormalize(e){const t=this.normalized;e=e.normalized;let n=t.dot(e);1===n&&(e=Math.abs(t.y)>Math.abs(t.z)?new qf(0,0,1):new qf(0,1,0),n=t.dot(e));const i=(e=e.sub(t.scale(n)).normalized).cross(t);return{normal:t,tangent:e,binormal:i}}applyQuaternion(e){const t=e.w*this.x+e.y*this.z-e.z*this.y,n=e.w*this.y+e.z*this.x-e.x*this.z,i=e.w*this.z+e.x*this.y-e.y*this.x,s=-e.x*this.x-e.y*this.y-e.z*this.z;return new qf(t*e.w+s*-e.x+n*-e.z-i*-e.y,n*e.w+s*-e.y+i*-e.x-t*-e.z,i*e.w+s*-e.z+t*-e.y-n*-e.x)}}function Uf(e,t){const n=t.z>0?new Ff(0,0,0,1):new Ff(0,0,1,0);return Math.abs(e.z)>.9999?n:Ff.lookRotation(e,t)}function Kf(e,t,n,i,s,r=1){const o=[];for(let a=0;a<n;a++){const l=e+t*a/(n-1),c=new qf;c[i]=r*Math.cos(l),c[s]=r*Math.sin(l),o.push(c)}return o}const Hf=sn("rotationgizmo"),Gf=new qf(0,0,0),Yf=new qf(1,0,0),Xf=new qf(0,1,0),Wf=new qf(0,0,1),Zf=new qf(0,0,-1),Qf=new qf(.7,0,0),Jf=new qf(0,.7,0),eg=new qf(0,0,.7),tg=new qf(-.7,0,0),ng=new qf(0,-.7,0),ig=new qf(0,0,-.7),sg=new Ff(0,0,0,1);function rg(e,t,n){const i=e.createElementNS(Ut,"g"),s=e.createElementNS(Ut,"circle");s.classList.add(Hf(t)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),i.appendChild(s);const r=e.createElementNS(Ut,"text");return r.classList.add(Hf("labeltext")),r.setAttributeNS(null,"y","4"),r.setAttributeNS(null,"text-anchor","middle"),r.setAttributeNS(null,"font-size","10"),r.textContent=n,i.appendChild(r),i}class og{get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Hf()),"popup"===t.pickerLayout&&this.element.classList.add(Hf(void 0,"p"));const n=e.createElement("div");n.classList.add(Hf("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=e.createElementNS(Ut,"svg");i.classList.add(Hf("g")),this.padElement.appendChild(i),this.svgElem_=i,this.projector_=new If,this.projector_.viewport=[0,0,136,136];const s=Kf(0,Math.PI,33,"x","y"),r=Kf(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new Rf(e,s,this.projector_),this.xArcB_.element.classList.add(Hf("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new Rf(e,s,this.projector_),this.yArcB_.element.classList.add(Hf("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new Rf(e,s,this.projector_),this.zArcB_.element.classList.add(Hf("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new Rf(e,s,this.projector_),this.xArcBC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new Rf(e,s,this.projector_),this.yArcBC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new Rf(e,s,this.projector_),this.zArcBC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const o=e.createElementNS(Ut,"g");i.classList.add(Hf("axes")),this.svgElem_.appendChild(o),this.axesElem_=o,this.xAxis_=new Rf(e,[Gf,Qf],this.projector_),this.xAxis_.element.classList.add(Hf("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new Rf(e,[Gf,Jf],this.projector_),this.yAxis_.element.classList.add(Hf("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new Rf(e,[Gf,eg],this.projector_),this.zAxis_.element.classList.add(Hf("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new Rf(e,[Gf,tg],this.projector_),this.xnAxis_.element.classList.add(Hf("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new Rf(e,[Gf,ng],this.projector_),this.ynAxis_.element.classList.add(Hf("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new Rf(e,[Gf,ig],this.projector_),this.znAxis_.element.classList.add(Hf("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new Rf(e,s,this.projector_),this.xArcF_.element.classList.add(Hf("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new Rf(e,s,this.projector_),this.yArcF_.element.classList.add(Hf("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new Rf(e,s,this.projector_),this.zArcF_.element.classList.add(Hf("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new Rf(e,s,this.projector_),this.xArcFC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new Rf(e,s,this.projector_),this.yArcFC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new Rf(e,s,this.projector_),this.zArcFC_.element.classList.add(Hf("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new Rf(e,r,this.projector_),this.rArc_.element.classList.add(Hf("arcr")),this.rArc_.setRotation(sg),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new Rf(e,r,this.projector_),this.rArcC_.element.classList.add(Hf("arcc")),this.rArcC_.setRotation(sg),this.svgElem_.appendChild(this.rArcC_.element);const a=e.createElementNS(Ut,"g");i.classList.add(Hf("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=rg(e,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=rg(e,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=rg(e,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=rg(e,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=rg(e,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=rg(e,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const l=()=>{this.xArcB_.element.classList.add(Hf("arcx_hover")),this.xArcF_.element.classList.add(Hf("arcx_hover"))},c=()=>{this.xArcB_.element.classList.remove(Hf("arcx_hover")),this.xArcF_.element.classList.remove(Hf("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",l),this.xArcBC_.element.addEventListener("mouseleave",c),this.xArcFC_.element.addEventListener("mouseenter",l),this.xArcFC_.element.addEventListener("mouseleave",c);const h=()=>{this.yArcB_.element.classList.add(Hf("arcy_hover")),this.yArcF_.element.classList.add(Hf("arcy_hover"))},p=()=>{this.yArcB_.element.classList.remove(Hf("arcy_hover")),this.yArcF_.element.classList.remove(Hf("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",h),this.yArcBC_.element.addEventListener("mouseleave",p),this.yArcFC_.element.addEventListener("mouseenter",h),this.yArcFC_.element.addEventListener("mouseleave",p);const u=()=>{this.zArcB_.element.classList.add(Hf("arcz_hover")),this.zArcF_.element.classList.add(Hf("arcz_hover"))},d=()=>{this.zArcB_.element.classList.remove(Hf("arcz_hover")),this.zArcF_.element.classList.remove(Hf("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",u),this.zArcBC_.element.addEventListener("mouseleave",d),this.zArcFC_.element.addEventListener("mouseenter",u),this.zArcFC_.element.addEventListener("mouseleave",d);this.rArcC_.element.addEventListener("mouseenter",(()=>{this.rArc_.element.classList.add(Hf("arcr_hover"))})),this.rArcC_.element.addEventListener("mouseleave",(()=>{this.rArc_.element.classList.remove(Hf("arcr_hover"))})),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,t.mode.emitter.on("change",this.onModeChange_),this.mode_=t.mode,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const e=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(e),this.yAxis_.setRotation(e),this.zAxis_.setRotation(e),this.xnAxis_.setRotation(e),this.ynAxis_.setRotation(e),this.znAxis_.setRotation(e);const t=Yf.applyQuaternion(e),n=Xf.applyQuaternion(e),i=Wf.applyQuaternion(e),s=t.negated,r=n.negated,o=i.negated;[{el:this.xAxis_.element,v:t},{el:this.yAxis_.element,v:n},{el:this.zAxis_.element,v:i},{el:this.xnAxis_.element,v:s},{el:this.ynAxis_.element,v:r},{el:this.znAxis_.element,v:o}].map((({el:e,v:t})=>(this.axesElem_.removeChild(e),{el:e,v:t}))).sort(((e,t)=>e.v.z-t.v.z)).forEach((({el:e})=>{this.axesElem_.appendChild(e)})),this.xArcB_.setRotation(Uf(t,Zf)),this.yArcB_.setRotation(Uf(n,Zf)),this.zArcB_.setRotation(Uf(i,Zf)),this.xArcBC_.setRotation(Uf(t,Zf)),this.yArcBC_.setRotation(Uf(n,Zf)),this.zArcBC_.setRotation(Uf(i,Zf)),this.xArcF_.setRotation(Uf(t,Wf)),this.yArcF_.setRotation(Uf(n,Wf)),this.zArcF_.setRotation(Uf(i,Wf)),this.xArcFC_.setRotation(Uf(t,Wf)),this.yArcFC_.setRotation(Uf(n,Wf)),this.zArcFC_.setRotation(Uf(i,Wf)),[{el:this.xLabel,v:Qf},{el:this.yLabel,v:Jf},{el:this.zLabel,v:eg},{el:this.xnLabel,v:tg},{el:this.ynLabel,v:ng},{el:this.znLabel,v:ig}].forEach((({el:t,v:n})=>{const[i,s]=this.projector_.project(n.applyQuaternion(e));t.setAttributeNS(null,"transform",`translate( ${i}, ${s} )`)})),[{el:this.xLabel,v:t},{el:this.yLabel,v:n},{el:this.zLabel,v:i},{el:this.xnLabel,v:s},{el:this.ynLabel,v:r},{el:this.znLabel,v:o}].map((({el:e,v:t})=>(this.labelsElem_.removeChild(e),{el:e,v:t}))).sort(((e,t)=>e.v.z-t.v.z)).forEach((({el:e})=>{this.labelsElem_.appendChild(e)}))}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const e=this.mode_.rawValue,t="angle-x"===e?"add":"remove",n="angle-y"===e?"add":"remove",i="angle-z"===e?"add":"remove",s="angle-r"===e?"add":"remove";this.xArcB_.element.classList[t](Hf("arcx_active")),this.yArcB_.element.classList[n](Hf("arcy_active")),this.zArcB_.element.classList[i](Hf("arcz_active")),this.xArcF_.element.classList[t](Hf("arcx_active")),this.yArcF_.element.classList[n](Hf("arcy_active")),this.zArcF_.element.classList[i](Hf("arcz_active")),this.rArc_.element.classList[s](Hf("arcr_active"))}}function ag(e){return Nf(e,0,1)}const lg=1/Math.sqrt(2),cg=new qf(1,0,0),hg=new qf(0,1,0),pg=new qf(0,0,1),ug=new Ff(0,0,0,1),dg=new Ff(lg,0,0,lg),mg=new Ff(0,-lg,0,lg),vg=new Ff(-lg,0,0,lg),fg=new Ff(0,lg,0,lg),gg=new Ff(0,1,0,0);class bg{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.mode_=He("free"),this.view=new og(e,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:t.pickerLayout}),this.ptHandler_=new Si(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const n=new Si(this.view.xArcBElement);n.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),n.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const i=new Si(this.view.xArcFElement);i.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-x"))),i.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const s=new Si(this.view.yArcBElement);s.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),s.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const r=new Si(this.view.yArcFElement);r.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-y"))),r.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const o=new Si(this.view.zArcBElement);o.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),o.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const a=new Si(this.view.zArcFElement);a.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-z"))),a.emitter.on("up",(()=>this.changeModeIfNotAuto_("free")));const l=new Si(this.view.rArcElement);l.emitter.on("down",(()=>this.changeModeIfNotAuto_("angle-r"))),l.emitter.on("up",(()=>this.changeModeIfNotAuto_("free"))),[{el:this.view.xLabel,q:mg},{el:this.view.yLabel,q:dg},{el:this.view.zLabel,q:ug},{el:this.view.xnLabel,q:fg},{el:this.view.ynLabel,q:vg},{el:this.view.znLabel,q:gg}].forEach((({el:e,q:t})=>{new Si(e).emitter.on("down",(()=>this.autoRotate_(t)))})),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(e){if(!e.point)return;const t=this.mode_.rawValue,n=e.point.x,i=e.point.y;if("auto"===t);else if("free"===t){if(null!=this.px_&&null!=this.py_){const e=n-this.px_,t=i-this.py_,s=Math.sqrt(e*e+t*t);if(0===s)return;const r=new qf(t/s,e/s,0),o=Ff.fromAxisAngle(r,s/68);this.value.rawValue=this.value.rawValue.premultiply(o)}this.px_=n,this.py_=i}else if("angle-r"===t){const t=e.bounds.width/2,s=e.bounds.height/2,r=Math.atan2(i-s,n-t);if(null==this.angleState_){const e=new qf(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:r,axis:e,reverseAngle:!0}}else{const{initialRotation:e,initialAngle:t,axis:n}=this.angleState_,i=-Of(r-t),s=Ff.fromAxisAngle(n,i);this.value.rawValue=e.premultiply(s)}}else{const s=e.bounds.width/2,r=e.bounds.height/2,o=Math.atan2(i-r,n-s);if(null==this.angleState_){const e="angle-x"===t?cg:"angle-y"===t?hg:pg,n=e.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:o,axis:e,reverseAngle:n}}else{const{initialRotation:e,initialAngle:t,axis:n,reverseAngle:i}=this.angleState_;let s=Of(o-t);s=i?-s:s;const r=Ff.fromAxisAngle(n,s);this.value.rawValue=e.multiply(r)}}}onPointerDown_(e){this.handlePointerEvent_(e.data)}onPointerMove_(e){this.handlePointerEvent_(e.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(e){Li(e.key)&&e.preventDefault();const t=$i(1,Vi(e)),n=$i(1,ki(e));if(0!==t||0!==n){const e=new qf(-n,t,0),i=Ff.fromAxisAngle(e,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(i)}}changeModeIfNotAuto_(e){"auto"!==this.mode_.rawValue&&(this.mode_.rawValue=e)}autoRotate_(e){this.mode_.rawValue="auto";const t=this.value.rawValue,n=Date.now(),i=()=>{const s=Date.now(),r=function(e){if(e<=0)return 0;if(e>=1)return 1;const t=1-e;return ag(1-t*(t*(t*(t*(t*(t*(-6*t+7)))))))}(ag((s-n-(o=0))/(300-o)));var o;this.value.rawValue=t.slerp(e,r),1!==r?requestAnimationFrame(i):this.mode_.rawValue="free"};requestAnimationFrame(i)}}const wg=sn("rotationswatch"),_g=new qf(1,0,0),yg=new qf(0,1,0),xg=new qf(0,0,1),Cg=new Ff(0,0,0,1);class Pg{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(wg()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(wg("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=e.createElementNS(Ut,"svg");i.classList.add(wg("g")),n.appendChild(i),this.svgElem_=i,this.projector_=new If,this.projector_.viewport=[0,0,20,20];const s=Kf(0,Math.PI,33,"x","y"),r=Kf(0,2*Math.PI,65,"x","y");this.rArc_=new Rf(e,r,this.projector_),this.rArc_.element.classList.add(wg("arcr")),i.appendChild(this.rArc_.element),this.rArc_.setRotation(Cg),this.xArc_=new Rf(e,s,this.projector_),this.xArc_.element.classList.add(wg("arc")),i.appendChild(this.xArc_.element),this.yArc_=new Rf(e,s,this.projector_),this.yArc_.element.classList.add(wg("arc")),i.appendChild(this.yArc_.element),this.zArc_=new Rf(e,s,this.projector_),this.zArc_.element.classList.add(wg("arc")),i.appendChild(this.zArc_.element),this.update_()}update_(){const e=this.value.rawValue.quat.normalized,t=_g.applyQuaternion(e),n=yg.applyQuaternion(e),i=xg.applyQuaternion(e);this.xArc_.setRotation(Uf(t,xg)),this.yArc_.setRotation(Uf(n,xg)),this.zArc_.setRotation(Uf(i,xg))}onValueChange_(){this.update_()}}class Eg{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Pg(e,{value:this.value,viewProps:this.viewProps})}}const $g=sn("rotation");class kg{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add($g()),t.foldable.bindExpandedClass(this.element,$g(void 0,"expanded")),tn(t.foldable,"completed",fn(this.element,$g(void 0,"cpl"))),"quaternion"===t.rotationMode&&this.element.classList.add($g("quat"));const n=e.createElement("div");n.classList.add($g("h")),this.element.appendChild(n);const i=e.createElement("div");i.classList.add($g("s")),n.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add($g("t")),n.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add($g("g")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}class Vg{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Dn.create(t.expanded),this.swatchC_=new Eg(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Tr(e,{assembly:t.assembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new kg(e,{rotationMode:t.rotationMode,foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new vi(e,{viewProps:this.viewProps}):null;const i=new bg(e,{value:this.value,viewProps:this.viewProps,pickerLayout:t.pickerLayout});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.gizmoC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Ei({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e,backward:(e,t)=>t})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),Tn(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=Jt(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!Ht(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Lg(e,t){const n=Math.pow(.1,e);return{baseStep:n,constraint:t,textProps:Ge.fromObject({formatter:ft(e),keyScale:n,pointerScale:n})}}function Mg(e){if(!e)return;const t=[];return je(e.step)||t.push(new We(e.step)),je(e.max)&&je(e.min)||t.push(new Xe({max:e.max,min:e.min})),new si(t)}function Sg(e,t){return{toComponents:e=>e.getComponents(),fromComponents:n=>new zf(n[0],n[1],n[2],e,t)}}function Ag(e,t,n){return"number"==typeof(null==e?void 0:e.x)&&"number"==typeof(null==e?void 0:e.y)&&"number"==typeof(null==e?void 0:e.z)?new zf(e.x,e.y,e.z,t,n):new zf(0,0,0,t,n)}function Dg(e){switch(e){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return e;default:return}}function jg(e){switch(e){case"rad":case"deg":case"turn":return e;default:return}}Cn({id:"rotation",type:"input",accept(e,t){var n,i;const s=zt(t,(e=>({view:e.required.constant("rotation"),label:e.optional.string,picker:e.optional.custom(Gi),expanded:e.optional.boolean,rotationMode:e.required.constant("euler"),x:e.optional.custom(Ki),y:e.optional.custom(Ki),z:e.optional.custom(Ki),order:e.optional.custom(Dg),unit:e.optional.custom(jg)})));return s?{initialValue:Ag(e,null!==(n=s.order)&&void 0!==n?n:"XYZ",null!==(i=s.unit)&&void 0!==i?i:"rad"),params:s}:null},binding:{reader:({params:e})=>t=>{var n,i;return Ag(t,null!==(n=e.order)&&void 0!==n?n:"XYZ",null!==(i=e.unit)&&void 0!==i?i:"rad")},constraint({params:e}){var t,n;return new Ar({assembly:Sg(null!==(t=e.order)&&void 0!==t?t:"XYZ",null!==(n=e.unit)&&void 0!==n?n:"rad"),components:[Mg("x"in e?e.x:void 0),Mg("y"in e?e.y:void 0),Mg("z"in e?e.z:void 0)]})},writer:e=>(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}},controller({document:e,value:t,constraint:n,params:i,viewProps:s}){var r,o;if(!(n instanceof Ar))throw Fe.shouldNeverHappen();const a="expanded"in i?i.expanded:void 0,l="picker"in i?i.picker:void 0,c=null!==(r=i.unit)&&void 0!==r?r:"rad",h={rad:2,deg:0,turn:2}[c];return new Vg(e,{axes:[Lg(h,n.components[0]),Lg(h,n.components[1]),Lg(h,n.components[2])],assembly:Sg(null!==(o=i.order)&&void 0!==o?o:"XYZ",c),rotationMode:"euler",expanded:null!=a&&a,parser:mt,pickerLayout:null!=l?l:"popup",value:t,viewProps:s})}});const Tg={toComponents:e=>[e.x,e.y,e.z,e.w],fromComponents:e=>new Ff(e[0],e[1],e[2],e[3])};function Ng(e){return{baseStep:.01,constraint:e,textProps:Ge.fromObject({formatter:e=>Math.abs(e)<.995?e.toFixed(2).replace("0.","."):e.toFixed(1),keyScale:.01,pointerScale:.01})}}function Bg(e){return"number"==typeof(null==e?void 0:e.x)&&"number"==typeof(null==e?void 0:e.y)&&"number"==typeof(null==e?void 0:e.z)&&"number"==typeof(null==e?void 0:e.w)?new Ff(e.x,e.y,e.z,e.w):new Ff(0,0,0,1)}function Og(e){let t,i,s,r;const o=[e[2]];function a(t){e[4](t)}function l(t){e[5](t)}let c={};for(let e=0;e<o.length;e+=1)c=n(c,o[e]);return void 0!==e[0]&&(c.value=e[0]),void 0!==e[1]&&(c.ref=e[1]),t=new yf({props:c}),I.push((()=>ae(t,"value",a))),I.push((()=>ae(t,"ref",l))),t.$on("change",e[6]),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),r=!0},p(e,[n]){const r=4&n?re(o,[oe(e[2])]):{};!i&&1&n&&(i=!0,r.value=e[0],Y((()=>i=!1))),!s&&2&n&&(s=!0,r.ref=e[1],Y((()=>s=!1))),t.$set(r)},i(e){r||(ie(t.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),r=!1},d(e){he(t,e)}}}function zg(e,t,i){const s=["value","wide"];let r,o=g(t,s),{value:a}=t,{wide:l}=t;return e.$$set=e=>{t=n(n({},t),f(e)),i(2,o=g(t,s)),"value"in e&&i(0,a=e.value),"wide"in e&&i(3,l=e.wide)},e.$$.update=()=>{10&e.$$.dirty&&r&&void 0!==l&&function(e){const t=r?.element.querySelector("div.tp-sldtxtv_t");e?t?.style.setProperty("display","none"):t?.style.removeProperty("display")}(l)},[a,r,o,l,function(e){a=e,i(0,a)},function(e){r=e,i(1,r)},function(t){z.call(this,e,t)}]}Cn({id:"rotation",type:"input",accept(e,t){const n=zt(t,(e=>({view:e.required.constant("rotation"),label:e.optional.string,picker:e.optional.custom(Gi),expanded:e.optional.boolean,rotationMode:e.optional.constant("quaternion"),x:e.optional.custom(Ki),y:e.optional.custom(Ki),z:e.optional.custom(Ki),w:e.optional.custom(Ki)})));return n?{initialValue:Bg(e),params:n}:null},binding:{reader:e=>e=>Bg(e),constraint:({params:e})=>new Ar({assembly:Tg,components:[Mg("x"in e?e.x:void 0),Mg("y"in e?e.y:void 0),Mg("z"in e?e.z:void 0),Mg("w"in e?e.w:void 0)]}),writer:e=>(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}},controller({document:e,value:t,constraint:n,params:i,viewProps:s}){if(!(n instanceof Ar))throw Fe.shouldNeverHappen();const r="expanded"in i?i.expanded:void 0,o="picker"in i?i.picker:void 0;return new Vg(e,{axes:[Ng(n.components[0]),Ng(n.components[1]),Ng(n.components[2]),Ng(n.components[3])],assembly:Tg,rotationMode:"quaternion",expanded:null!=r&&r,parser:mt,pickerLayout:null!=o?o:"popup",value:t,viewProps:s})}});class Fg extends ue{constructor(e){super(),pe(this,e,zg,Og,a,{value:0,wide:3})}}class Ig{constructor(e,t){this.step=e,this.edge=t}constrain(e){var t,n;return null!==(n=null===(t=this.edge)||void 0===t?void 0:t.constrain(e))&&void 0!==n?n:e}}const Rg={fromComponents:e=>e[0],toComponents:e=>[e]},qg=sn("step");class Ug{constructor(e,t){this.buttonsView_=t.buttonsView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(qg());const n=e.createElement("div");n.classList.add(qg("s")),n.appendChild(this.buttonsView_.element),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(qg("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const Kg=sn("step");class Hg{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Kg()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.textContent="-",n.classList.add(Kg("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.btnMinus=n;const i=e.createElement("button");i.textContent="+",i.classList.add(Kg("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.btnPlus=i}}class Gg{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.step=t.constraint?t.constraint.step:1,this.view=new Hg(e,{value:this.value,viewProps:t.viewProps}),this.view.btnMinus.addEventListener("click",(()=>{var e;const t=null!==(e=this.value.rawValue)&&void 0!==e?e:0;this.value.setRawValue(t-this.step,{forceEmit:!0,last:!0})})),this.view.btnPlus.addEventListener("click",(()=>{var e;const t=null!==(e=this.value.rawValue)&&void 0!==e?e:0;this.value.setRawValue(t+this.step,{forceEmit:!0,last:!0})}))}}class Yg{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new Gg(e,t);const n={constraint:t.constraint.edge,textProps:t.textProps};this.tc_=new Tr(e,{assembly:Rg,axes:[n],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new Ug(e,{buttonsView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}Cn({id:"input-stepper",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=zt(t,(e=>Object.assign(Object.assign({},kt(e)),{view:e.required.constant("stepper")})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>"number"==typeof e?e:0,writer:e=>(e,t)=>{e.write(t)},constraint(e){const t=[],n=Et(e.params);n&&t.push(n);const i=Pt(e.params);return i&&t.push(i),new Ig(e.params.step?e.params.step:1,new si(t))}},controller(e){const t=e.value,n=e.constraint;if(!(n instanceof Ig))throw Fe.shouldNeverHappen();const i=Ge.fromObject($t(e.params,t.rawValue));return new Yg(e.document,{constraint:n,parser:mt,textProps:i,value:t,viewProps:e.viewProps})}});const Xg=sn("txtr");class Wg{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Xg()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.rows=t.rows,n.cols=22,n.placeholder=t.placeholder,n.classList.add(Xg("i")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class Zg{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.rows=t.rows,this.placeholder=t.placeholder,this.view=new Wg(e,{value:this.value,viewProps:this.viewProps,rows:this.rows,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value;this.value.rawValue=t,this.view.refresh()}}function Qg(e){let t,n;return t=new yd({props:{theme:e[4],userCreatedPane:!1,$$slots:{default:[tb]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n&&(i.theme=e[4]),16399&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Jg(e){let t,n,i,s;const r=[ib,nb],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function eb(e){let t;const n=e[11].default,i=p(n,e,e[14],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||16384&s)&&m(i,n,e,e[14],t?d(n,e[14],s,null):v(e[14]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function tb(e){let t,n,i;function s(t){e[13](t)}let r={disabled:e[2],title:e[1],userExpandable:e[3],$$slots:{default:[eb]},$$scope:{ctx:e}};return void 0!==e[0]&&(r.expanded=e[0]),t=new ab({props:r}),I.push((()=>ae(t,"expanded",s))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),i=!0},p(e,i){const s={};4&i&&(s.disabled=e[2]),2&i&&(s.title=e[1]),8&i&&(s.userExpandable=e[3]),16384&i&&(s.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,s.expanded=e[0],Y((()=>n=!1))),t.$set(s)},i(e){i||(ie(t.$$.fragment,e),i=!0)},o(e){se(t.$$.fragment,e),i=!1},d(e){he(t,e)}}}function nb(e){let t,n,i,s;t=new Vo({props:{keysAdd:["containerUnitSize"],theme:e[4]}});let r=e[0]&&sb(e);return{c(){le(t.$$.fragment),n=P(),r&&r.c(),i=E()},m(e,o){ce(t,e,o),_(e,n,o),r&&r.m(e,o),_(e,i,o),s=!0},p(e,n){const s={};16&n&&(s.theme=e[4]),t.$set(s),e[0]?r?(r.p(e,n),1&n&&ie(r,1)):(r=sb(e),r.c(),ie(r,1),r.m(i.parentNode,i)):r&&(te(),se(r,1,1,(()=>{r=null})),ne())},i(e){s||(ie(t.$$.fragment,e),ie(r),s=!0)},o(e){se(t.$$.fragment,e),se(r),s=!1},d(e){e&&(y(n),y(i)),he(t,e),r&&r.d(e)}}}function ib(e){let t,n;const i=e[11].default,s=p(i,e,e[14],null);return{c(){t=x("div"),s&&s.c(),k(t,"display","none")},m(i,r){_(i,t,r),s&&s.m(t,null),e[12](t),n=!0},p(e,t){s&&s.p&&(!n||16384&t)&&m(s,i,e,e[14],n?d(i,e[14],t,null):v(e[14]),null)},i(e){n||(ie(s,e),n=!0)},o(e){se(s,e),n=!1},d(n){n&&y(t),s&&s.d(n),e[12](null)}}}function sb(e){let t,n,i;t=new Vo({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding"],theme:e[4]}});const s=e[11].default,r=p(s,e,e[14],null);return{c(){le(t.$$.fragment),n=P(),r&&r.c()},m(e,s){ce(t,e,s),_(e,n,s),r&&r.m(e,s),i=!0},p(e,n){const o={};16&n&&(o.theme=e[4]),t.$set(o),r&&r.p&&(!i||16384&n)&&m(r,s,e,e[14],i?d(s,e[14],n,null):v(e[14]),null)},i(e){i||(ie(t.$$.fragment,e),ie(r,e),i=!0)},o(e){se(t.$$.fragment,e),se(r,e),i=!1},d(e){e&&y(n),he(t,e),r&&r.d(e)}}}function rb(e){let t,n,i,s;const r=[Jg,Qg],o=[];return t=function(e){return e[6]?0:1}(e),n=o[t]=r[t](e),{c(){n.c(),i=E()},m(e,n){o[t].m(e,n),_(e,i,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[t].d(e)}}}function ob(e,t,n){let i,s,{$$slots:r={},$$scope:o}=t,{title:a="Folder"}=t,{disabled:l=!1}=t,{expanded:c=!0}=t,{userExpandable:p=!0}=t,{theme:u}=t;const d=O("parentStore");h(e,d,(e=>n(10,i=e)));const m=me();h(e,m,(e=>n(15,s=e)));const v=O("userCreatedPane");let f,g,w;return B("parentStore",m),j((()=>{n(8,g=f?So(f):0)})),T((()=>{s?.dispose()})),e.$$set=e=>{"title"in e&&n(1,a=e.title),"disabled"in e&&n(2,l=e.disabled),"expanded"in e&&n(0,c=e.expanded),"userExpandable"in e&&n(3,p=e.userExpandable),"theme"in e&&n(4,u=e.theme),"$$scope"in e&&n(14,o=e.$$scope)},e.$$.update=()=>{514&e.$$.dirty&&w&&n(9,w.title=a,w),516&e.$$.dirty&&w&&n(9,w.disabled=l,w),513&e.$$.dirty&&w&&void 0!==c&&n(9,w.expanded=c,w),1792&e.$$.dirty&&i&&!w&&void 0!==g&&(b(m,s=i.addFolder({disabled:l,expanded:c,index:g,title:a}),s),s.on("fold",(()=>{n(0,c=s.expanded)})),n(9,w=s)),520&e.$$.dirty&&w&&jo(p,w.element,"tp-fldv_b","tp-fldv_m"),1040&e.$$.dirty&&u&&i&&(v||!Lo(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Folder> components for a theme prop.)")},[c,a,l,p,u,f,d,m,g,w,i,r,function(e){I[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},function(e){c=e,n(0,c)},o]}Cn({id:"input-template",type:"input",accept(e,t){if("string"!=typeof e)return null;const n=zt(t,(e=>({view:e.required.constant("textarea"),rows:e.optional.number,placeholder:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{reader:e=>e=>"string"==typeof e?e:"",writer:e=>(e,t)=>{e.write(t)}},controller(e){var t,n;return new Zg(e.document,{value:e.value,rows:null!==(t=e.params.rows)&&void 0!==t?t:3,placeholder:null!==(n=e.params.placeholder)&&void 0!==n?n:"Enter text here",viewProps:e.viewProps})}});class ab extends ue{constructor(e){super(),pe(this,e,ob,rb,a,{title:1,disabled:2,expanded:0,userExpandable:3,theme:4})}}var lb={local:{},session:{}};function cb(e,t,n){var i,s,r,o,a,l,c,h;(null==n?void 0:n.onError)&&console.warn("onError has been deprecated. Please use onWriteError instead");const p=null!=(i=null==n?void 0:n.serializer)?i:JSON,u=null!=(s=null==n?void 0:n.storage)?s:"local",d=null==(r=null==n?void 0:n.syncTabs)||r,m=null!=(a=null!=(o=null==n?void 0:n.onWriteError)?o:null==n?void 0:n.onError)?a:t=>console.error(`Error when writing value from persisted store "${e}" to ${u}`,t),v=null!=(l=null==n?void 0:n.onParseError)?l:(t,n)=>console.error(`Error when parsing ${t?'"'+t+'"':"value"} from persisted store "${e}"`,n),f=null!=(c=null==n?void 0:n.beforeRead)?c:e=>e,g=null!=(h=null==n?void 0:n.beforeWrite)?h:e=>e,b="undefined"!=typeof window&&"undefined"!=typeof document,w=b?"local"===u?localStorage:sessionStorage:null;function _(e,t){const n=g(t);try{null==w||w.setItem(e,p.stringify(n))}catch(e){m(e)}}if(!lb[u][e]){const n=me(function(){const n=null==w?void 0:w.getItem(e);if(null==n)return t;const i=function(e){try{return p.parse(e)}catch(t){v(e,t)}}(n);return null==i?t:f(i)}(),(t=>{if(b&&"local"==u&&d){const n=n=>{if(n.key===e&&n.newValue){let e;try{e=p.parse(n.newValue)}catch(e){return void v(n.newValue,e)}const i=f(e);t(i)}};return window.addEventListener("storage",n),()=>window.removeEventListener("storage",n)}})),{subscribe:i,set:s}=n;lb[u][e]={set(t){s(t),_(e,t)},update:t=>n.update((n=>{const i=t(n);return _(e,i),i})),reset(){this.set(t)},subscribe:i}}return lb[u][e]}const{window:hb}=w;function pb(e){let t;const n=e[25].default,i=p(n,e,e[32],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||2&s[1])&&m(i,n,e,e[32],t?d(n,e[32],s,null):v(e[32]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function ub(e){let t,i,s,o,a,l,c,h,p=`${e[2]}px`,u=`${e[3]}px`,d=`${e[4]}px`;const m=[{scale:e[8]},{title:e[7]},Ao(e[16],"position")];function v(t){e[26](t)}function f(t){e[27](t)}let g={$$slots:{default:[pb]},$$scope:{ctx:e}};for(let e=0;e<m.length;e+=1)g=n(g,m[e]);return void 0!==e[1]&&(g.expanded=e[1]),void 0!==e[0]&&(g.tpPane=e[0]),i=new gd({props:g}),I.push((()=>ae(i,"expanded",v))),I.push((()=>ae(i,"tpPane",f))),{c(){var n,s,r;t=x("div"),le(i.$$.fragment),n=t,s="class",null==(r="draggable-container svelte-ex9mcb")?n.removeAttribute(s):n.getAttribute(s)!==r&&n.setAttribute(s,r),G((()=>e[28].call(t))),S(t,"not-collapsable",!e[6]),S(t,"not-resizable",!e[5]),k(t,"left",p),k(t,"padding",e[9]),k(t,"top",u),k(t,"width",d),k(t,"z-index",e[14])},m(n,s){_(n,t,s),ce(i,t,null),a=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=x("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const i=M();let s;return i?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=$(window,"message",(e=>{e.source===n.contentWindow&&t()}))):(n.src="about:blank",n.onload=()=>{s=$(n.contentWindow,"resize",t),t()}),function(e,t){e.appendChild(t)}(e,n),()=>{(i||s&&n.contentWindow)&&s(),y(n)}}(t,e[28].bind(t)),e[29](t),l=!0,c||(h=[$(hb,"resize",e[15]),$(t,"focus",e[30],!0),$(t,"pointerdown",e[31],!0)],c=!0)},p(e,n){const r=65920&n[0]?re(m,[256&n[0]&&{scale:e[8]},128&n[0]&&{title:e[7]},65536&n[0]&&oe(Ao(e[16],"position"))]):{};2&n[1]&&(r.$$scope={dirty:n,ctx:e}),!s&&2&n[0]&&(s=!0,r.expanded=e[1],Y((()=>s=!1))),!o&&1&n[0]&&(o=!0,r.tpPane=e[0],Y((()=>o=!1))),i.$set(r),(!l||64&n[0])&&S(t,"not-collapsable",!e[6]),(!l||32&n[0])&&S(t,"not-resizable",!e[5]),4&n[0]&&p!==(p=`${e[2]}px`)&&k(t,"left",p),512&n[0]&&k(t,"padding",e[9]),8&n[0]&&u!==(u=`${e[3]}px`)&&k(t,"top",u),16&n[0]&&d!==(d=`${e[4]}px`)&&k(t,"width",d),16384&n[0]&&k(t,"z-index",e[14])},i(e){l||(ie(i.$$.fragment,e),l=!0)},o(e){se(i.$$.fragment,e),l=!1},d(n){n&&y(t),he(i),a(),e[29](null),c=!1,r(h)}}}const db="svelte-tweakpane-ui-draggable-position-",mb="1",vb=[];let fb=1e3;function gb(e,i,s){let r;const o=["storePositionLocally","localStoreId","tpPane","expanded","collapseChildrenToFit","x","y","width","resizable","userExpandable","minWidth","maxWidth","title","scale","padding"];let a,c=g(i,o),h=t,p=()=>(h(),h=l(d,(e=>s(41,a=e))),d);e.$$.on_destroy.push((()=>h()));let u,d,{$$slots:m={},$$scope:v}=i,{storePositionLocally:b=!0}=i,{localStoreId:w=mb}=i,{tpPane:_}=i;b&&p(d=cb(`${db}${w}`,{x:0,y:0,expanded:!0,width:350}));let y,x,C,P,E,$,k,V,{expanded:L=a?.expanded??!0}=i,{collapseChildrenToFit:M=!1}=i,{x:S=a?.x??0}=i,{y:A=a?.y??0}=i,{width:D=a?.width??256}=i,{resizable:N=!0}=i,{userExpandable:B=!0}=i,{minWidth:O=200}=i,{maxWidth:z=600}=i,{title:F="Tweakpane"}=i,{scale:R=1}=i,{padding:q="0"}=i,U=fb;function K(){if(void 0!==S&&void 0!==A&&void 0!==D){const e=k,t=V;s(23,k=document.documentElement.clientWidth),s(24,V=document.documentElement.clientHeight);const n=k-e,i=V-t,r=(S+D/2)/k,o=(A+E/2)/V;!Number.isNaN(n)&&r>=.5&&s(2,S+=n),!Number.isNaN(i)&&o>=.5&&s(3,A+=i)}}const H=e=>{e.stopPropagation()};let G=0,Y=0,X=0,W=0;const Z=e=>{e.stopPropagation(),e.target&&void 0!==D&&e.target===C&&s(4,D=D<r?r:O)},Q=e=>{void 0!==S&&void 0!==A&&0===e.button&&e.target instanceof HTMLElement&&(W=0,u=e,ie(),se(),e.target===x&&(x.style.cursor="grabbing"),s(11,y.style.transition="width 0s ease",y),e.target.setPointerCapture(e.pointerId),G=D??0,Y=S-e.pageX,X=A-e.pageY)},J=e=>{e.target instanceof HTMLElement&&void 0!==D&&void 0!==O&&void 0!==S&&void 0!==A&&(e.target===x?(W+=Math.hypot(e.movementX,e.movementY),s(2,S=e.pageX+Y),s(3,A=e.pageY+X)):e.target===C&&s(4,D=Mo(e.pageX+Y+G-S,O,r)))},ee=()=>{if(u?.target instanceof HTMLElement){const{target:e}=u,t=e.getBoundingClientRect(),n=new PointerEvent("pointercancel",{bubbles:!0,clientX:t.left+t.width/2,clientY:t.top+t.height/2,composed:!0,pointerId:u.pointerId,pointerType:u.pointerType});e.dispatchEvent(n)}},te=e=>{e.stopImmediatePropagation(),e.target instanceof HTMLElement&&(e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId),e.target===x&&x.style.removeProperty("cursor"),y.style.removeProperty("transition"),"pointerup"===e.type&&e.target===x&&W<3&&B&&_&&s(0,_.expanded=!_.expanded,_),u=void 0,re(),ne())},ne=()=>{x.addEventListener("pointerdown",Q),C?.addEventListener("pointerdown",Q)},ie=()=>{x.removeEventListener("pointerdown",Q),C?.removeEventListener("pointerdown",Q)},se=()=>{window.addEventListener("blur",ee),x.addEventListener("pointermove",J),x.addEventListener("pointerup",te),x.addEventListener("pointercancel",te),C?.addEventListener("pointermove",J),C?.addEventListener("pointerup",te),C?.addEventListener("pointercancel",te)},re=()=>{window.removeEventListener("blur",ee),x.removeEventListener("pointermove",J),x.removeEventListener("pointerup",te),x.removeEventListener("pointercancel",te),C?.removeEventListener("pointermove",J),C?.removeEventListener("pointerup",te),C?.removeEventListener("pointercancel",te)},oe=e=>{e.preventDefault()};function ae(e,t=Number.MAX_SAFE_INTEGER){if(t>0)for(const i of e)if("expanded"in i)i.expanded&&(t--,i.expanded=!1),"children"in i&&ae(i.children,t);else{const e=(n=i,n.controller?.valueController?.view?.swatchElement?.querySelector("button")??n.controller?.valueController?.view?.buttonElement);e&&To(i)&&(t--,e.click())}var n;
/*! Tweakpane 4.0.5 (c) 2016 cocopon, licensed under the MIT license. */}j((()=>{K(),_?y.append(_.element):console.warn("no tpPane in draggable"),y.addEventListener("touchmove",oe,{passive:!1});const e=y.querySelector(".tp-rotv_t");e&&(x=e,x.addEventListener("click",H),x.addEventListener("dblclick",Z),C=x.parentElement?.appendChild(document.createElement("div")),C&&(C.className="tp-custom-width-handle",C.textContent="↔",C.addEventListener("click",H),C.addEventListener("dblclick",Z)),ne())})),T((()=>{ie(),re(),x.removeEventListener("click",H),x.removeEventListener("dblclick",Z),C?.removeEventListener("click",H),C?.removeEventListener("dblclick",Z),y?.removeEventListener("touchmove",oe),void 0!==w&&vb.splice(vb.indexOf(w),1)}));return e.$$set=e=>{i=n(n({},i),f(e)),s(16,c=g(i,o)),"storePositionLocally"in e&&s(17,b=e.storePositionLocally),"localStoreId"in e&&s(18,w=e.localStoreId),"tpPane"in e&&s(0,_=e.tpPane),"expanded"in e&&s(1,L=e.expanded),"collapseChildrenToFit"in e&&s(19,M=e.collapseChildrenToFit),"x"in e&&s(2,S=e.x),"y"in e&&s(3,A=e.y),"width"in e&&s(4,D=e.width),"resizable"in e&&s(5,N=e.resizable),"userExpandable"in e&&s(6,B=e.userExpandable),"minWidth"in e&&s(20,O=e.minWidth),"maxWidth"in e&&s(21,z=e.maxWidth),"title"in e&&s(7,F=e.title),"scale"in e&&s(8,R=e.scale),"padding"in e&&s(9,q=e.padding),"$$scope"in e&&s(32,v=e.$$scope)},e.$$.update=()=>{var t;if(33&e.$$.dirty[0]&&_&&N&&(t=N,C&&(C.style.display=t?"block":"none")),6400&e.$$.dirty[0]&&y)if(void 0===R||1===R)s(22,E=P);else{const e=window.getComputedStyle(y),t=Number.parseFloat(e.paddingTop)+Number.parseFloat(e.paddingBottom);s(22,E=(P-t)*R+t)}33038365&e.$$.dirty[0]&&void 0!==E&&void 0!==k&&void 0!==V&&void 0!==S&&void 0!==A&&void 0!==D&&void 0!==O&&void 0!==z&&(M&&E>V&&_&&ae(_.children),s(2,S=Mo(S,0,Math.max(0,k-$))),s(3,A=Mo(A,0,Math.max(0,V-E))),k<$&&s(4,D=Math.max(O,Math.min(z,k)))),10485764&e.$$.dirty[0]&&(r=Math.min(z??600,k-(S??0))),393216&e.$$.dirty[0]&&b&&void 0!==w&&(vb.includes(w)&&console.warn('Multiple instances of <Pane> with `mode="draggable"` and `storePositionLocally=true` detected. You must explicitly set unique localStoreId property on each component to avoid collisions.'),vb.push(w)),393216&e.$$.dirty[0]&&!b&&w&&(vb.splice(vb.indexOf(w),1),localStorage.removeItem(`${db}${w}`)),262144&e.$$.dirty[0]&&w!==`${db}${w}`&&void 0!==w&&void 0!==d&&void 0!==L&&void 0!==D&&void 0!==S&&void 0!==A&&p(s(10,d=cb(`${db}${w}`,{x:S,y:A,expanded:L,width:D}))),394270&e.$$.dirty[0]&&b&&void 0!==w&&void 0!==S&&void 0!==A&&void 0!==D&&void 0!==L&&d?.set({x:S,y:A,expanded:L,width:D})},[_,L,S,A,D,N,B,F,R,q,d,y,P,$,U,K,c,b,w,M,O,z,E,k,V,m,function(e){L=e,s(1,L)},function(e){_=e,s(0,_)},function(){P=this.clientHeight,$=this.clientWidth,s(12,P),s(13,$)},function(e){I[e?"unshift":"push"]((()=>{y=e,s(11,y)}))},()=>{s(14,U=++fb)},()=>{s(14,U=++fb)},v]}class bb extends ue{constructor(e){super(),pe(this,e,gb,ub,a,{storePositionLocally:17,localStoreId:18,tpPane:0,expanded:1,collapseChildrenToFit:19,x:2,y:3,width:4,resizable:5,userExpandable:6,minWidth:20,maxWidth:21,title:7,scale:8,padding:9},null,[-1,-1])}}function wb(e){let t;const n=e[8].default,i=p(n,e,e[11],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||2048&s)&&m(i,n,e,e[11],t?d(n,e[11],s,null):v(e[11]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function _b(e){let t,i,s,r,o;const a=[{title:e[2]},Ao(e[3],"position")];function l(t){e[9](t)}function c(t){e[10](t)}let h={$$slots:{default:[wb]},$$scope:{ctx:e}};for(let e=0;e<a.length;e+=1)h=n(h,a[e]);return void 0!==e[1]&&(h.expanded=e[1]),void 0!==e[0]&&(h.tpPane=e[0]),i=new gd({props:h}),I.push((()=>ae(i,"expanded",l))),I.push((()=>ae(i,"tpPane",c))),{c(){t=x("div"),le(i.$$.fragment),k(t,"display","none")},m(e,n){_(e,t,n),ce(i,t,null),o=!0},p(e,[t]){const n=12&t?re(a,[4&t&&{title:e[2]},8&t&&oe(Ao(e[3],"position"))]):{};2048&t&&(n.$$scope={dirty:t,ctx:e}),!s&&2&t&&(s=!0,n.expanded=e[1],Y((()=>s=!1))),!r&&1&t&&(r=!0,n.tpPane=e[0],Y((()=>r=!1))),i.$set(n)},i(e){o||(ie(i.$$.fragment,e),o=!0)},o(e){se(i.$$.fragment,e),o=!1},d(e){e&&y(t),he(i)}}}function yb(e,t,i){const s=["expanded","x","y","width","title","tpPane"];let r,o=g(t,s),{$$slots:a={},$$scope:l}=t,{expanded:c}=t,{x:h}=t,{y:p}=t,{width:u}=t,{title:d="Tweakpane"}=t,{tpPane:m}=t;return e.$$set=e=>{t=n(n({},t),f(e)),i(3,o=g(t,s)),"expanded"in e&&i(1,c=e.expanded),"x"in e&&i(4,h=e.x),"y"in e&&i(5,p=e.y),"width"in e&&i(6,u=e.width),"title"in e&&i(2,d=e.title),"tpPane"in e&&i(0,m=e.tpPane),"$$scope"in e&&i(11,l=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&m?.element.parentElement&&i(7,r=m.element.parentElement),144&e.$$.dirty&&void 0!==r&&void 0!==h&&(r.style.setProperty("right","unset"),r.style.setProperty("left",`${h}px`)),160&e.$$.dirty&&void 0!==r&&void 0!==p&&r.style.setProperty("top",`${p}px`),192&e.$$.dirty&&void 0!==r&&void 0!==u&&r.style.setProperty("width",`${u}px`)},[m,c,d,o,h,p,u,r,a,function(e){c=e,i(1,c)},function(e){m=e,i(0,m)},l]}class xb extends ue{constructor(e){super(),pe(this,e,yb,_b,a,{expanded:1,x:4,y:5,width:6,title:2,tpPane:0})}}function Cb(e){let t,n,i,s;const r=[kb,$b],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function Pb(e){let t,i,s,r;const o=[{width:e[1]},Ao(e[6],"storePositionLocally")];function a(t){e[13](t)}function l(t){e[14](t)}let c={$$slots:{default:[Lb]},$$scope:{ctx:e}};for(let e=0;e<o.length;e+=1)c=n(c,o[e]);return void 0!==e[0]&&(c.expanded=e[0]),void 0!==e[2]&&(c.tpPane=e[2]),t=new yd({props:c}),I.push((()=>ae(t,"expanded",a))),I.push((()=>ae(t,"tpPane",l))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),r=!0},p(e,n){const r=66&n?re(o,[2&n&&{width:e[1]},64&n&&oe(Ao(e[6],"storePositionLocally"))]):{};524288&n&&(r.$$scope={dirty:n,ctx:e}),!i&&1&n&&(i=!0,r.expanded=e[0],Y((()=>i=!1))),!s&&4&n&&(s=!0,r.tpPane=e[2],Y((()=>s=!1))),t.$set(r)},i(e){r||(ie(t.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),r=!1},d(e){he(t,e)}}}function Eb(e){let t,n,i,s;const r=[Sb,Mb],o=[];return t=0,n=o[0]=r[0](e),{c(){n.c(),i=E()},m(e,t){o[0].m(e,t),_(e,i,t),s=!0},p(e,t){n.p(e,t)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),o[0].d(e)}}}function $b(e){let t,n;const i=e[7].default,s=p(i,e,e[19],null);return{c(){t=x("div"),s&&s.c(),k(t,"display","none")},m(e,i){_(e,t,i),s&&s.m(t,null),n=!0},p(e,t){s&&s.p&&(!n||524288&t)&&m(s,i,e,e[19],n?d(i,e[19],t,null):v(e[19]),null)},i(e){n||(ie(s,e),n=!0)},o(e){se(s,e),n=!1},d(e){e&&y(t),s&&s.d(e)}}}function kb(e){let t,i,s,r,o,a;const l=[{width:e[1]},e[6]];function c(t){e[15](t)}function h(t){e[16](t)}function p(t){e[17](t)}function u(t){e[18](t)}let d={$$slots:{default:[Vb]},$$scope:{ctx:e}};for(let e=0;e<l.length;e+=1)d=n(d,l[e]);return void 0!==e[0]&&(d.expanded=e[0]),void 0!==e[2]&&(d.tpPane=e[2]),void 0!==e[3]&&(d.x=e[3]),void 0!==e[4]&&(d.y=e[4]),t=new xb({props:d}),I.push((()=>ae(t,"expanded",c))),I.push((()=>ae(t,"tpPane",h))),I.push((()=>ae(t,"x",p))),I.push((()=>ae(t,"y",u))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),a=!0},p(e,n){const a=66&n?re(l,[2&n&&{width:e[1]},64&n&&oe(e[6])]):{};524288&n&&(a.$$scope={dirty:n,ctx:e}),!i&&1&n&&(i=!0,a.expanded=e[0],Y((()=>i=!1))),!s&&4&n&&(s=!0,a.tpPane=e[2],Y((()=>s=!1))),!r&&8&n&&(r=!0,a.x=e[3],Y((()=>r=!1))),!o&&16&n&&(o=!0,a.y=e[4],Y((()=>o=!1))),t.$set(a)},i(e){a||(ie(t.$$.fragment,e),a=!0)},o(e){se(t.$$.fragment,e),a=!1},d(e){he(t,e)}}}function Vb(e){let t;const n=e[7].default,i=p(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&m(i,n,e,e[19],t?d(n,e[19],s,null):v(e[19]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function Lb(e){let t;const n=e[7].default,i=p(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&m(i,n,e,e[19],t?d(n,e[19],s,null):v(e[19]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function Mb(e){let t,n;const i=e[7].default,s=p(i,e,e[19],null);return{c(){t=x("div"),s&&s.c(),k(t,"display","none")},m(e,i){_(e,t,i),s&&s.m(t,null),n=!0},p(e,t){s&&s.p&&(!n||524288&t)&&m(s,i,e,e[19],n?d(i,e[19],t,null):v(e[19]),null)},i(e){n||(ie(s,e),n=!0)},o(e){se(s,e),n=!1},d(e){e&&y(t),s&&s.d(e)}}}function Sb(e){let t,i,s,r,o,a,l;const c=[e[6]];function h(t){e[8](t)}function p(t){e[9](t)}function u(t){e[10](t)}function d(t){e[11](t)}function m(t){e[12](t)}let v={$$slots:{default:[Ab]},$$scope:{ctx:e}};for(let e=0;e<c.length;e+=1)v=n(v,c[e]);return void 0!==e[0]&&(v.expanded=e[0]),void 0!==e[2]&&(v.tpPane=e[2]),void 0!==e[1]&&(v.width=e[1]),void 0!==e[3]&&(v.x=e[3]),void 0!==e[4]&&(v.y=e[4]),t=new bb({props:v}),I.push((()=>ae(t,"expanded",h))),I.push((()=>ae(t,"tpPane",p))),I.push((()=>ae(t,"width",u))),I.push((()=>ae(t,"x",d))),I.push((()=>ae(t,"y",m))),{c(){le(t.$$.fragment)},m(e,n){ce(t,e,n),l=!0},p(e,n){const l=64&n?re(c,[oe(e[6])]):{};524288&n&&(l.$$scope={dirty:n,ctx:e}),!i&&1&n&&(i=!0,l.expanded=e[0],Y((()=>i=!1))),!s&&4&n&&(s=!0,l.tpPane=e[2],Y((()=>s=!1))),!r&&2&n&&(r=!0,l.width=e[1],Y((()=>r=!1))),!o&&8&n&&(o=!0,l.x=e[3],Y((()=>o=!1))),!a&&16&n&&(a=!0,l.y=e[4],Y((()=>a=!1))),t.$set(l)},i(e){l||(ie(t.$$.fragment,e),l=!0)},o(e){se(t.$$.fragment,e),l=!1},d(e){he(t,e)}}}function Ab(e){let t;const n=e[7].default,i=p(n,e,e[19],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,s){i&&i.p&&(!t||524288&s)&&m(i,n,e,e[19],t?d(n,e[19],s,null):v(e[19]),null)},i(e){t||(ie(i,e),t=!0)},o(e){se(i,e),t=!1},d(e){i&&i.d(e)}}}function Db(e){let t,n,i,s;const r=[Eb,Pb,Cb],o=[];function a(e,t){return void 0===e[5]||"draggable"===e[5]?0:"inline"===e[5]?1:"fixed"===e[5]?2:-1}return~(t=a(e))&&(n=o[t]=r[t](e)),{c(){n&&n.c(),i=E()},m(e,n){~t&&o[t].m(e,n),_(e,i,n),s=!0},p(e,[s]){let l=t;t=a(e),t===l?~t&&o[t].p(e,s):(n&&(te(),se(o[l],1,1,(()=>{o[l]=null})),ne()),~t?(n=o[t],n?n.p(e,s):(n=o[t]=r[t](e),n.c()),ie(n,1),n.m(i.parentNode,i)):n=null)},i(e){s||(ie(n),s=!0)},o(e){se(n),s=!1},d(e){e&&y(i),~t&&o[t].d(e)}}}function jb(e,t,i){const s=["expanded","position","width","tpPane","x","y"];let r=g(t,s),{$$slots:o={},$$scope:a}=t,{expanded:l}=t,{position:c}=t,{width:h}=t,{tpPane:p}=t,{x:u}=t,{y:d}=t;var m;return m=()=>{"inline"!==t.position&&"fixed"!==t.position||(i(3,u=t.x),i(4,d=t.y),i(1,h=t.width),i(0,l=t.expanded))},D().$$.before_update.push(m),e.$$set=e=>{i(20,t=n(n({},t),f(e))),i(6,r=g(t,s)),"expanded"in e&&i(0,l=e.expanded),"position"in e&&i(5,c=e.position),"width"in e&&i(1,h=e.width),"tpPane"in e&&i(2,p=e.tpPane),"x"in e&&i(3,u=e.x),"y"in e&&i(4,d=e.y),"$$scope"in e&&i(19,a=e.$$scope)},t=f(t),[l,h,p,u,d,c,r,o,function(e){l=e,i(0,l)},function(e){p=e,i(2,p)},function(e){h=e,i(1,h)},function(e){u=e,i(3,u)},function(e){d=e,i(4,d)},function(e){l=e,i(0,l)},function(e){p=e,i(2,p)},function(e){l=e,i(0,l)},function(e){p=e,i(2,p)},function(e){u=e,i(3,u)},function(e){d=e,i(4,d)},a]}class Tb extends ue{constructor(e){super(),pe(this,e,jb,Db,a,{expanded:0,position:5,width:1,tpPane:2,x:3,y:4})}}class Nb extends Lt{measureStart(e){this.controller.valueController.measureStart(e)}measureEnd(){return this.controller.valueController.measureEnd()}measure(e,t){this.controller.valueController.measure(e,t)}measureAsync(e,t){return this.controller.valueController.measureAsync(e,t)}get measureHandler(){return this.controller.valueController.measureHandler}set measureHandler(e){this.controller.valueController.measureHandler=e}}class Bb extends hn{constructor(e,t){const n=t.valueController,i=new an(e,{blade:t.blade,props:t.labelProps,valueController:n});super({blade:t.blade,view:i.view,viewProps:n.viewProps}),this.valueController=n,this.labelController=i}}class Ob{measureStart(){const e=performance.now();return()=>performance.now()-e}}function zb(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class Fb{constructor(){this.map=new Map,this.keySet=new Set}get(e){return this.map.get(e)}getOrCreate(e,t){this.keySet.has(e)||this.keySet.add(e);let n=this.map.get(e);return null==n&&(n=t(),this.map.set(e,n)),n}set(e,t){this.keySet.has(e)||this.keySet.add(e),this.map.set(e,t)}resetUsedSet(){this.keySet.clear()}vaporize(e){for(const[t,n]of this.map.entries())this.keySet.has(t)||(this.map.delete(t),null==e||e([t,n]))}}function Ib(e){let t=0;return e.forEach((e=>t+=e)),t}class Rb{constructor(e){this.__recalcForEach=0,this.__countUntilRecalc=0,this.__history=[],this.__index=0,this.__count=0,this.__cache=0,this.__length=e,this.__recalcForEach=e;for(let t=0;t<e;t++)this.__history[t]=0}get mean(){const e=Math.min(this.__count,this.__length);return 0===e?0:this.__cache/e}get recalcForEach(){return this.__recalcForEach}set recalcForEach(e){const t=e-this.__recalcForEach;this.__recalcForEach=e,this.__countUntilRecalc=Math.max(0,this.__countUntilRecalc+t)}reset(){this.__index=0,this.__count=0,this.__cache=0,this.__countUntilRecalc=0;for(let e=0;e<this.__length;e++)this.__history[e]=0}push(e){const t=this.__history[this.__index];this.__history[this.__index]=e,this.__count++,this.__index=(this.__index+1)%this.__length,0===this.__countUntilRecalc?this.recalc():(this.__countUntilRecalc--,this.__cache-=t,this.__cache+=e)}recalc(){this.__countUntilRecalc=this.__recalcForEach;const e=this.__history.slice(0,Math.min(this.__count,this.__length)).reduce(((e,t)=>e+t),0);this.__cache=e}}function qb(e,t){if("function"!=typeof t)return qb(e,(e=>e<t));const n=t;let i=0,s=e.length;for(;i<s;){const t=i+s>>1;n(e[t])?i=t+1:s=t}return i}class Ub{constructor(e){this.__history=[],this.__sorted=[],this.__index=0,this.__length=e}get median(){return this.percentile(50)}percentile(e){return 0===this.__history.length?0:this.__sorted[Math.round(.01*e*(this.__history.length-1))]}reset(){this.__index=0,this.__history=[],this.__sorted=[]}push(e){const t=this.__history[this.__index];if(this.__history[this.__index]=e,this.__index=(this.__index+1)%this.__length,this.__sorted.length===this.__length){const e=qb(this.__sorted,t);this.__sorted.splice(e,1)}const n=qb(this.__sorted,e);this.__sorted.splice(n,0,e)}}function Kb(e,t){let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}function Hb(e){return Math.min(Math.max(e,0),1)}function Gb(e){const t=[1,e=Hb(e),e*e,e*e*e],n=[t[2],t[3]].map((e=>e*t[2])),i=[Kb(t,[.13572138,4.6153926,-42.66032258,132.13108234])+Kb(n,[-152.94239396,59.28637943]),Kb(t,[.09140261,2.19418839,4.84296658,-14.18503333])+Kb(n,[4.27729857,2.82956604]),Kb(t,[.1066733,12.64194608,-60.58204836,110.36276771])+Kb(n,[-89.90310912,27.34824973])];return`rgb( ${i.map((e=>256*Hb(e))).join(", ")} )`}const Yb=sn("profiler");class Xb{constructor(e,t){this.targetDelta=t.targetDelta,this.deltaUnit=t.deltaUnit,this.fractionDigits=t.fractionDigits,this.calcMode=t.calcMode,this.element=e.createElement("div"),this.element.classList.add(Yb()),t.viewProps.bindClassModifiers(this.element),this.svgRootElement_=e.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgRootElement_.classList.add(Yb("root")),this.element.appendChild(this.svgRootElement_),this.entryContainerElement_=e.createElementNS("http://www.w3.org/2000/svg","g"),this.entryContainerElement_.classList.add(Yb("container")),this.entryContainerElement_.setAttribute("transform","translate( 1, 1 )"),this.svgRootElement_.appendChild(this.entryContainerElement_),this.tooltipElement_=e.createElement("div"),this.tooltipElement_.classList.add(Yb("tooltip")),this.tooltipElement_.style.display="none",this.element.appendChild(this.tooltipElement_),this.tooltipInsideElement_=e.createElement("div"),this.tooltipInsideElement_.classList.add(Yb("tooltipinside")),this.tooltipElement_.appendChild(this.tooltipInsideElement_),this.labelElement_=e.createElement("div"),this.labelElement_.classList.add(Yb("label")),this.labelElement_.textContent=this.deltaToDisplayDelta_(0),this.element.appendChild(this.labelElement_),this.entryElementCacheMap_=new Fb,this.hoveringEntry_=null}update(e){const t=this.entryToDelta_(e);this.labelElement_.textContent=this.deltaToDisplayDelta_(t),this.entryElementCacheMap_.resetUsedSet();const n=160/Math.max(this.targetDelta,t);let i=0;for(const t of e.children){this.addEntry_(t,"",this.entryContainerElement_,n).setAttribute("transform",`translate( ${i}, 0 )`),i+=this.entryToDelta_(t)*n}this.entryElementCacheMap_.vaporize((([e,t])=>{t.remove(),this.hoveringEntry_===e&&(this.hoveringEntry_=null)})),this.updateTooltip_()}updateTooltip_(){const e=this.hoveringEntry_;if(e){const t=this.entryElementCacheMap_.get(e),n=null==t?void 0:t.getAttribute("data-delta"),i=`${e}\n${this.deltaToDisplayDelta_(parseFloat(null!=n?n:"0.0"))}`;this.tooltipElement_.style.display="block",this.tooltipInsideElement_.textContent=i}else this.tooltipElement_.style.display="none"}addEntry_(e,t,n,i){const s=`${t}/${e.name}`,r=this.entryElementCacheMap_.getOrCreate(s,(()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.classList.add(Yb("entry")),n.appendChild(e),this.entryElementCacheMap_.set(s,e);const t=document.createElementNS("http://www.w3.org/2000/svg","rect");return t.classList.add(Yb("entryrect")),e.appendChild(t),t.addEventListener("mouseenter",(()=>{this.hoveringEntry_=s,this.updateTooltip_()})),t.addEventListener("mouseleave",(()=>{this.hoveringEntry_=null,this.updateTooltip_()})),e})),o=this.entryToDelta_(e);r.setAttribute("data-delta",`${o}`);const a=r.childNodes[0];a.setAttribute("width",`${Math.max(.01,o*i-1)}px`),a.setAttribute("height","9px");const l=.15+.7*Hb(o/this.targetDelta);if(a.setAttribute("fill",Gb(l)),e.children.length>0){let t=0;e.children.forEach((e=>{this.addEntry_(e,s,r,i).setAttribute("transform",`translate( ${t}, 10 )`),t+=this.entryToDelta_(e)*i}))}return r}entryToDelta_(e){if("frame"===this.calcMode)return e.delta;if("mean"===this.calcMode)return e.deltaMean;if("median"===this.calcMode)return e.deltaMedian;throw new Error('Unreachable! calcMode must be one of "frame", "mean", or "median"')}deltaToDisplayDelta_(e){return`${e.toFixed(this.fractionDigits)} ${this.deltaUnit}`}}class Wb{constructor(e,t){this.targetDelta=t.targetDelta,this.bufferSize=t.bufferSize,this.onTick_=this.onTick_.bind(this),this.ticker_=t.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.viewProps=t.viewProps,this.view=new Xb(e,{targetDelta:this.targetDelta,deltaUnit:t.deltaUnit,fractionDigits:t.fractionDigits,calcMode:t.calcMode,viewProps:this.viewProps}),this.viewProps.handleDispose((()=>{this.ticker_.dispose()})),this.measureHandler=t.measureHandler,this.rootCalcCacheStack_=[this.createNewEntryCalcCache_()]}measureStart(e){const t=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1].childrenCacheMap.getOrCreate(e,(()=>this.createNewEntryCalcCache_()));var n;t.childrenCacheMap.resetUsedSet(),(n=t.childrenPromiseDelta).splice(0,n.length),this.rootCalcCacheStack_.push(t),t.measureEnd=this.measureHandler.measureStart()}measureEnd(){return zb(this,void 0,void 0,(function*(){const e=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1],t=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-2],n=Promise.resolve(e.measureEnd());e.measureEnd=null,t.childrenPromiseDelta.push(n),this.rootCalcCacheStack_.pop(),e.childrenCacheMap.vaporize();const i=Ib(yield Promise.all(e.childrenPromiseDelta)),s=(yield n)-i;e.meanCalc.push(s),e.medianCalc.push(s),e.latest=s}))}measure(e,t){this.measureStart(e),t(),this.measureEnd()}measureAsync(e,t){return zb(this,void 0,void 0,(function*(){this.measureStart(e),yield t(),this.measureEnd()}))}renderEntry(){return this.renderEntryFromCalcCache_("",this.rootCalcCacheStack_[0])}renderEntryFromCalcCache_(e,t){const n=[];for(const e of t.childrenCacheMap.keySet){const i=t.childrenCacheMap.get(e);n.push(this.renderEntryFromCalcCache_(e,i))}const i=t.latest,s=t.meanCalc.mean,r=t.medianCalc.median;return{name:e,delta:i+Ib(n.map((e=>e.delta))),deltaMean:s+Ib(n.map((e=>e.deltaMean))),deltaMedian:r+Ib(n.map((e=>e.deltaMedian))),selfDelta:i,selfDeltaMean:s,selfDeltaMedian:r,children:n}}onTick_(){this.view.update(this.renderEntry())}createNewEntryCalcCache_(){return{meanCalc:new Rb(this.bufferSize),medianCalc:new Ub(this.bufferSize),latest:0,measureEnd:null,childrenCacheMap:new Fb,childrenPromiseDelta:[]}}}function Zb(e,t){return 0===t?new ni:new ii(e,null!=t?t:ro.defaultInterval)}function Qb(e){switch(e){case"frame":case"mean":case"median":return e;default:return}}function Jb(e){return"object"==typeof e&&null!=e&&"measureStart"in e?e:void("object"==typeof e&&null!=e&&"measure"in e&&console.warn("The API of `ProfilerBladeDefaultMeasureHandler` has been changed in v0.4.0! Please define `measureStart` instead of `measure`. Fallback to the default measure handler."))}Cn({id:"profiler",type:"blade",accept(e){const t=zt(e,(e=>({view:e.required.constant("profiler"),targetDelta:e.optional.number,bufferSize:e.optional.number,deltaUnit:e.optional.string,fractionDigits:e.optional.number,calcMode:e.optional.custom(Qb),label:e.optional.string,interval:e.optional.number,measureHandler:e.optional.custom(Jb)})));return t?{params:t}:null},controller(e){var t,n,i,s,r,o,a;const l=null!==(t=e.params.interval)&&void 0!==t?t:500,c=null!==(n=e.params.targetDelta)&&void 0!==n?n:16.67,h=null!==(i=e.params.bufferSize)&&void 0!==i?i:30,p=null!==(s=e.params.deltaUnit)&&void 0!==s?s:"ms",u=null!==(r=e.params.fractionDigits)&&void 0!==r?r:2,d=null!==(o=e.params.calcMode)&&void 0!==o?o:"mean",m=null!==(a=e.params.measureHandler)&&void 0!==a?a:new Ob;return new Bb(e.document,{blade:e.blade,labelProps:Ge.fromObject({label:e.params.label}),valueController:new Wb(e.document,{ticker:Zb(e.document,l),targetDelta:c,bufferSize:h,deltaUnit:p,fractionDigits:u,calcMode:d,viewProps:e.viewProps,measureHandler:m})})},api:e=>e.controller instanceof Bb?new Nb(e.controller):null});class ew{constructor(){this.drawer=e=>`L ${e[0]} ${e[1]}`}}class tw{constructor(){this.drawer=(e,t,n)=>{const[i,s]=this.controlPoint(n[t-1],n[t-2],e),[r,o]=this.controlPoint(e,n[t-1],n[t+1],!0);return`C ${i},${s} ${r},${o} ${e[0]},${e[1]}`}}controlPoint(e,t,n,i){const s=t||e,r=n||e,o=r[0]-s[0],a=r[1]-s[1],l=.2*Math.sqrt(Math.pow(o,2)+Math.pow(a,2)),c=Math.atan2(a,o)+(i?Math.PI:0);return[e[0]+Math.cos(c)*l,e[1]+Math.sin(c)*l]}}const nw=sn("wfm");class iw{constructor(e,t){switch(this.element=e.createElement("div"),this.element.classList.add(nw()),t.viewProps.bindClassModifiers(this.element),this.svgElem=e.createElementNS(Ut,"svg"),this.svgElem.classList.add(nw("g")),this.element.appendChild(this.svgElem),this.pathElem=e.createElementNS(Ut,"path"),this.svgElem.appendChild(this.pathElem),this.props=t.props,this.value=t.value,this.value.emitter.on("change",this.onValueChange_.bind(this)),this.props.get("lineStyle")){case"linear":default:this.lineDrawerProvider=new ew;break;case"bezier":this.lineDrawerProvider=new tw}this.refresh(),t.viewProps.handleDispose((()=>{this.value.emitter.off("change",this.onValueChange_)}))}svgPath(e,t){return e.reduce(((e,n,i,s)=>0===i?`M ${n[0]},${n[1]}`:`${e} ${t(n,i,s)}`),"")}refresh(){var e,t;const n=this.svgElem.getBoundingClientRect(),i=this.value.rawValue[0];if(i){const s=null!==(e=this.props.get("min"))&&void 0!==e?e:Math.min(...i)-1,r=null!==(t=this.props.get("max"))&&void 0!==t?t:Math.max(...i)+1,o=r-s,a=[],l=i.length-1,c=i.length>32?0:n.width/(i.length-1),h=o>50?0:n.height/o;this.element.style.backgroundSize=`${c}px ${h}px`,i.forEach(((e,t)=>{if(void 0===e)return;const i=gt(t,0,l,0,n.width),o=gt(e,s,r,n.height,0);a.push([Math.floor(i),Math.floor(o)])}));const p=this.svgPath(a,this.lineDrawerProvider.drawer);this.pathElem.setAttributeNS(null,"d",p)}}onValueChange_(){this.refresh()}}class sw{constructor(e,t){this.value=t.value,this.props=t.props,this.viewProps=t.viewProps,this.viewProps.handleDispose((()=>{})),this.view=new iw(e,{value:this.value,viewProps:this.viewProps,props:this.props})}}function rw(e){return"object"==typeof e&&"length"in e}function ow(e){let t,n;return t=new ab({props:{title:"PerlinNoise2DTime Params",$$slots:{default:[aw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};2&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function aw(e){let t,n;return t=new Fg({props:{label:"Seed",value:e[1].seed,min:0,max:4294967295,step:1}}),t.$on("change",e[11]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};2&n[0]&&(i.value=e[1].seed),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function lw(e){let t,n;return t=new ab({props:{title:"FlowNoise2DTime Params",$$slots:{default:[cw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};4&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function cw(e){let t,n,i,s,r,o;return t=new Fg({props:{label:"Seed",value:e[2].seed,min:0,max:4294967295,step:1}}),t.$on("change",e[12]),i=new Fg({props:{label:"Spin Variation",value:e[2].spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[13]),r=new Fg({props:{label:"N",value:e[2].N,min:1,max:512,step:1}}),r.$on("change",e[14]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};4&n[0]&&(s.value=e[2].seed),t.$set(s);const o={};4&n[0]&&(o.value=e[2].spinVariation),i.$set(o);const a={};4&n[0]&&(a.value=e[2].N),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function hw(e){let t,n;return t=new ab({props:{title:"FBMNoise2DTime Params",$$slots:{default:[fw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};28&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function pw(e){let t,n;return t=new ab({props:{title:"Flow Base Params",$$slots:{default:[dw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};12&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function uw(e){let t,n;return t=new ab({props:{title:"Perlin Base Params",$$slots:{default:[mw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};24&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function dw(e){let t,n,i,s,r,o;return t=new Fg({props:{label:"Flow Seed",value:e[3].flowBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[17]),i=new Fg({props:{label:"Spin Variation",value:e[3].flowBaseParams.spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[18]),r=new Fg({props:{label:"N",value:e[2].N,min:1,max:512,step:1}}),r.$on("change",e[19]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};8&n[0]&&(s.value=e[3].flowBaseParams.seed),t.$set(s);const o={};8&n[0]&&(o.value=e[3].flowBaseParams.spinVariation),i.$set(o);const a={};4&n[0]&&(a.value=e[2].N),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function mw(e){let t,n;return t=new Fg({props:{label:"Seed",value:e[3].perlinBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[16]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};8&n[0]&&(i.value=e[3].perlinBaseParams.seed),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function vw(e){let t,n,i,s,r,o;return t=new Fg({props:{label:"Octaves",value:e[3].octaves,min:1,max:8,step:1}}),t.$on("change",e[20]),i=new Fg({props:{label:"Persistence",value:e[3].persistence,min:0,max:1,step:.01}}),i.$on("change",e[21]),r=new Fg({props:{label:"Lacunarity",value:e[3].lacunarity,min:1,max:4,step:.01}}),r.$on("change",e[22]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};8&n[0]&&(s.value=e[3].octaves),t.$set(s);const o={};8&n[0]&&(o.value=e[3].persistence),i.$set(o);const a={};8&n[0]&&(a.value=e[3].lacunarity),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function fw(e){let t,n,i,s,r,o,a;t=new Ef({props:{label:"Base Type",value:e[3].baseType,options:[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"}]}}),t.$on("change",e[15]);const l=[uw,pw],c=[];function h(e,t){return"PerlinNoise2DTime"===e[3].baseType?0:"FlowNoise2DTime"===e[3].baseType?1:-1}return~(i=h(e))&&(s=c[i]=l[i](e)),o=new ab({props:{title:"Octave Params",$$slots:{default:[vw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=P(),s&&s.c(),r=P(),le(o.$$.fragment)},m(e,s){ce(t,e,s),_(e,n,s),~i&&c[i].m(e,s),_(e,r,s),ce(o,e,s),a=!0},p(e,n){const a={};8&n[0]&&(a.value=e[3].baseType),t.$set(a);let p=i;i=h(e),i===p?~i&&c[i].p(e,n):(s&&(te(),se(c[p],1,1,(()=>{c[p]=null})),ne()),~i?(s=c[i],s?s.p(e,n):(s=c[i]=l[i](e),s.c()),ie(s,1),s.m(r.parentNode,r)):s=null);const u={};8&n[0]|512&n[1]&&(u.$$scope={dirty:n,ctx:e}),o.$set(u)},i(e){a||(ie(t.$$.fragment,e),ie(s),ie(o.$$.fragment,e),a=!0)},o(e){se(t.$$.fragment,e),se(s),se(o.$$.fragment,e),a=!1},d(e){e&&(y(n),y(r)),he(t,e),~i&&c[i].d(e),he(o,e)}}}function gw(e){let t,n;return t=new ab({props:{title:"TurbulenceNoise2DTime Params",$$slots:{default:[Cw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};20&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function bw(e){let t,n;return t=new ab({props:{title:"Flow Base Params",$$slots:{default:[_w]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};20&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function ww(e){let t,n;return t=new ab({props:{title:"Perlin Base Params",$$slots:{default:[yw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function _w(e){let t,n,i,s,r,o;return t=new Fg({props:{label:"Flow Seed",value:e[4].flowBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[25]),i=new Fg({props:{label:"Spin Variation",value:e[4].flowBaseParams.spinVariation,min:0,max:1,step:.01}}),i.$on("change",e[26]),r=new Fg({props:{label:"N",value:e[2].N,min:1,max:512,step:1}}),r.$on("change",e[27]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};16&n[0]&&(s.value=e[4].flowBaseParams.seed),t.$set(s);const o={};16&n[0]&&(o.value=e[4].flowBaseParams.spinVariation),i.$set(o);const a={};4&n[0]&&(a.value=e[2].N),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function yw(e){let t,n;return t=new Fg({props:{label:"Seed",value:e[4].perlinBaseParams.seed,min:0,max:4294967295,step:1}}),t.$on("change",e[24]),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};16&n[0]&&(i.value=e[4].perlinBaseParams.seed),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function xw(e){let t,n,i,s,r,o;return t=new Fg({props:{label:"Octaves",value:e[4].octaves,min:1,max:8,step:1}}),t.$on("change",e[28]),i=new Fg({props:{label:"Persistence",value:e[4].persistence,min:0,max:1,step:.01}}),i.$on("change",e[29]),r=new Fg({props:{label:"Lacunarity",value:e[4].lacunarity,min:1,max:4,step:.01}}),r.$on("change",e[30]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};16&n[0]&&(s.value=e[4].octaves),t.$set(s);const o={};16&n[0]&&(o.value=e[4].persistence),i.$set(o);const a={};16&n[0]&&(a.value=e[4].lacunarity),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function Cw(e){let t,n,i,s,r,o,a;t=new Ef({props:{label:"Base Type",value:e[4].baseType,options:[{text:"PerlinNoise2DTime",value:"PerlinNoise2DTime"},{text:"FlowNoise2DTime",value:"FlowNoise2DTime"}]}}),t.$on("change",e[23]);const l=[ww,bw],c=[];function h(e,t){return"PerlinNoise2DTime"===e[4].baseType?0:"FlowNoise2DTime"===e[4].baseType?1:-1}return~(i=h(e))&&(s=c[i]=l[i](e)),o=new ab({props:{title:"Octave Params",$$slots:{default:[xw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=P(),s&&s.c(),r=P(),le(o.$$.fragment)},m(e,s){ce(t,e,s),_(e,n,s),~i&&c[i].m(e,s),_(e,r,s),ce(o,e,s),a=!0},p(e,n){const a={};16&n[0]&&(a.value=e[4].baseType),t.$set(a);let p=i;i=h(e),i===p?~i&&c[i].p(e,n):(s&&(te(),se(c[p],1,1,(()=>{c[p]=null})),ne()),~i?(s=c[i],s?s.p(e,n):(s=c[i]=l[i](e),s.c()),ie(s,1),s.m(r.parentNode,r)):s=null);const u={};16&n[0]|512&n[1]&&(u.$$scope={dirty:n,ctx:e}),o.$set(u)},i(e){a||(ie(t.$$.fragment,e),ie(s),ie(o.$$.fragment,e),a=!0)},o(e){se(t.$$.fragment,e),se(s),se(o.$$.fragment,e),a=!1},d(e){e&&(y(n),y(r)),he(t,e),~i&&c[i].d(e),he(o,e)}}}function Pw(e){let t,n,i,s,r,o,a,l,c,h,p;function u(t){e[10](t)}let d={label:"Noise Type",options:Ee};void 0!==e[0]&&(d.value=e[0]),t=new Ef({props:d}),I.push((()=>ae(t,"value",u)));let m="PerlinNoise2DTime"===e[0]&&ow(e),v="FlowNoise2DTime"===e[0]&&lw(e),f="FBMNoise2DTime"===e[0]&&hw(e),g="TurbulenceNoise2DTime"===e[0]&&gw(e);return l=new Fg({props:{label:"Frequency",min:.001,max:1,step:.001,value:e[5]}}),l.$on("change",e[31]),h=new Fg({props:{label:"Noise Speed",min:.1,max:1e3,step:.1,value:e[6]}}),h.$on("change",e[32]),{c(){le(t.$$.fragment),i=P(),m&&m.c(),s=P(),v&&v.c(),r=P(),f&&f.c(),o=P(),g&&g.c(),a=P(),le(l.$$.fragment),c=P(),le(h.$$.fragment)},m(e,n){ce(t,e,n),_(e,i,n),m&&m.m(e,n),_(e,s,n),v&&v.m(e,n),_(e,r,n),f&&f.m(e,n),_(e,o,n),g&&g.m(e,n),_(e,a,n),ce(l,e,n),_(e,c,n),ce(h,e,n),p=!0},p(e,i){const c={};!n&&1&i[0]&&(n=!0,c.value=e[0],Y((()=>n=!1))),t.$set(c),"PerlinNoise2DTime"===e[0]?m?(m.p(e,i),1&i[0]&&ie(m,1)):(m=ow(e),m.c(),ie(m,1),m.m(s.parentNode,s)):m&&(te(),se(m,1,1,(()=>{m=null})),ne()),"FlowNoise2DTime"===e[0]?v?(v.p(e,i),1&i[0]&&ie(v,1)):(v=lw(e),v.c(),ie(v,1),v.m(r.parentNode,r)):v&&(te(),se(v,1,1,(()=>{v=null})),ne()),"FBMNoise2DTime"===e[0]?f?(f.p(e,i),1&i[0]&&ie(f,1)):(f=hw(e),f.c(),ie(f,1),f.m(o.parentNode,o)):f&&(te(),se(f,1,1,(()=>{f=null})),ne()),"TurbulenceNoise2DTime"===e[0]?g?(g.p(e,i),1&i[0]&&ie(g,1)):(g=gw(e),g.c(),ie(g,1),g.m(a.parentNode,a)):g&&(te(),se(g,1,1,(()=>{g=null})),ne());const p={};32&i[0]&&(p.value=e[5]),l.$set(p);const u={};64&i[0]&&(u.value=e[6]),h.$set(u)},i(e){p||(ie(t.$$.fragment,e),ie(m),ie(v),ie(f),ie(g),ie(l.$$.fragment,e),ie(h.$$.fragment,e),p=!0)},o(e){se(t.$$.fragment,e),se(m),se(v),se(f),se(g),se(l.$$.fragment,e),se(h.$$.fragment,e),p=!1},d(e){e&&(y(i),y(s),y(r),y(o),y(a),y(c)),he(t,e),m&&m.d(e),v&&v.d(e),f&&f.d(e),g&&g.d(e),he(l,e),he(h,e)}}}function Ew(e){let t,n,i,s,r,o;return t=new af({props:{label:"Animating",value:e[7].animating}}),t.$on("change",e[33]),i=new Fg({props:{label:"Speed",min:.1,max:20,step:.1,value:e[7].speed}}),i.$on("change",e[34]),r=new af({props:{label:"Use advanceTime()",value:e[7].useAdvanceTime}}),r.$on("change",e[35]),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment)},m(e,a){ce(t,e,a),_(e,n,a),ce(i,e,a),_(e,s,a),ce(r,e,a),o=!0},p(e,n){const s={};128&n[0]&&(s.value=e[7].animating),t.$set(s);const o={};128&n[0]&&(o.value=e[7].speed),i.$set(o);const a={};128&n[0]&&(a.value=e[7].useAdvanceTime),r.$set(a)},i(e){o||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),o=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),o=!1},d(e){e&&(y(n),y(s)),he(t,e),he(i,e),he(r,e)}}}function $w(e){let t,n,i,s,r;function o(t){e[36](t)}let a={label:"Color Mode",options:Ae};return void 0!==e[8].colorMode&&(a.value=e[8].colorMode),t=new Ef({props:a}),I.push((()=>ae(t,"value",o))),s=new af({props:{label:"Show Scale Visualization",value:e[8].showScaleVisualization}}),s.$on("change",e[37]),{c(){le(t.$$.fragment),i=P(),le(s.$$.fragment)},m(e,n){ce(t,e,n),_(e,i,n),ce(s,e,n),r=!0},p(e,i){const r={};!n&&256&i[0]&&(n=!0,r.value=e[8].colorMode,Y((()=>n=!1))),t.$set(r);const o={};256&i[0]&&(o.value=e[8].showScaleVisualization),s.$set(o)},i(e){r||(ie(t.$$.fragment,e),ie(s.$$.fragment,e),r=!0)},o(e){se(t.$$.fragment,e),se(s.$$.fragment,e),r=!1},d(e){e&&y(i),he(t,e),he(s,e)}}}function kw(e){let n,i,s,r,o,a;return n=new Ld({props:{title:"Pause"}}),n.$on("click",e[38]),s=new Ld({props:{title:"Resume"}}),s.$on("click",e[39]),o=new Ld({props:{title:"Reset to Defaults"}}),o.$on("click",e[9]),{c(){le(n.$$.fragment),i=P(),le(s.$$.fragment),r=P(),le(o.$$.fragment)},m(e,t){ce(n,e,t),_(e,i,t),ce(s,e,t),_(e,r,t),ce(o,e,t),a=!0},p:t,i(e){a||(ie(n.$$.fragment,e),ie(s.$$.fragment,e),ie(o.$$.fragment,e),a=!0)},o(e){se(n.$$.fragment,e),se(s.$$.fragment,e),se(o.$$.fragment,e),a=!1},d(e){e&&(y(i),y(r)),he(n,e),he(s,e),he(o,e)}}}function Vw(e){let t,n,i,s,r,o,a,l;return t=new ab({props:{title:"Noise",$$slots:{default:[Pw]},$$scope:{ctx:e}}}),i=new ab({props:{title:"Simulation",$$slots:{default:[Ew]},$$scope:{ctx:e}}}),r=new ab({props:{title:"UI",$$slots:{default:[$w]},$$scope:{ctx:e}}}),a=new ab({props:{title:"Actions",expanded:!0,$$slots:{default:[kw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment),n=P(),le(i.$$.fragment),s=P(),le(r.$$.fragment),o=P(),le(a.$$.fragment)},m(e,c){ce(t,e,c),_(e,n,c),ce(i,e,c),_(e,s,c),ce(r,e,c),_(e,o,c),ce(a,e,c),l=!0},p(e,n){const s={};127&n[0]|512&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};128&n[0]|512&n[1]&&(o.$$scope={dirty:n,ctx:e}),i.$set(o);const l={};256&n[0]|512&n[1]&&(l.$$scope={dirty:n,ctx:e}),r.$set(l);const c={};512&n[1]&&(c.$$scope={dirty:n,ctx:e}),a.$set(c)},i(e){l||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),l=!0)},o(e){se(t.$$.fragment,e),se(i.$$.fragment,e),se(r.$$.fragment,e),se(a.$$.fragment,e),l=!1},d(e){e&&(y(n),y(s),y(o)),he(t,e),he(i,e),he(r,e),he(a,e)}}}function Lw(e){let t,n;return t=new Tb({props:{$$slots:{default:[Vw]},$$scope:{ctx:e}}}),{c(){le(t.$$.fragment)},m(e,i){ce(t,e,i),n=!0},p(e,n){const i={};511&n[0]|512&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Mw(e,t,n){let i,s,r,o,a,l,c,p,u;h(e,$e,(e=>n(0,i=e))),h(e,_e,(e=>n(1,s=e))),h(e,ye,(e=>n(2,r=e))),h(e,xe,(e=>n(3,o=e))),h(e,Ce,(e=>n(4,a=e))),h(e,ke,(e=>n(5,l=e))),h(e,Ve,(e=>n(6,c=e))),h(e,Me,(e=>n(7,p=e))),h(e,De,(e=>n(8,u=e)));return[i,s,r,o,a,l,c,p,u,function(){$e.reset(),_e.reset(),ye.reset(),xe.reset(),Ce.reset(),ke.reset(),Ve.reset(),Me.reset(),De.reset()},function(e){i=e,$e.set(i)},e=>_e.setSeed(e.detail.value),e=>ye.setSeed(e.detail.value),e=>ye.setSpinVariation(e.detail.value),e=>ye.setN(e.detail.value),e=>xe.setBaseType(e.detail.value),e=>xe.setPerlinBaseParams({...a.perlinBaseParams,seed:e.detail.value}),e=>xe.setFlowBaseParams({...o.flowBaseParams,seed:e.detail.value}),e=>xe.setFlowBaseParams({...o.flowBaseParams,spinVariation:e.detail.value}),e=>ye.setN(e.detail.value),e=>xe.setOctaves(e.detail.value),e=>xe.setPersistence(e.detail.value),e=>xe.setLacunarity(e.detail.value),e=>Ce.setBaseType(e.detail.value),e=>Ce.setPerlinBaseParams({...a.perlinBaseParams,seed:e.detail.value}),e=>Ce.setFlowBaseParams({...a.flowBaseParams,seed:e.detail.value}),e=>Ce.setFlowBaseParams({...a.flowBaseParams,spinVariation:e.detail.value}),e=>ye.setN(e.detail.value),e=>Ce.setOctaves(e.detail.value),e=>Ce.setPersistence(e.detail.value),e=>Ce.setLacunarity(e.detail.value),e=>ke.set(e.detail.value),e=>Ve.set(e.detail.value),e=>Me.setAnimating(e.detail.value),e=>Me.setSpeed(e.detail.value),e=>Me.setUseAdvanceTime(e.detail.value),function(t){e.$$.not_equal(u.colorMode,t)&&(u.colorMode=t,De.set(u))},e=>De.setShowScaleVisualization(e.detail.value),()=>Me.update((e=>({...e,animating:!1}))),()=>Me.update((e=>({...e,animating:!0})))]}Cn({id:"monitor-waveform",type:"monitor",accept:(e,t)=>{if(!rw(e))return null;const n=zt(t,(e=>({max:e.optional.number,min:e.optional.number,style:e.optional.custom((e=>"linear"===e||"bezier"===e?e:void 0)),view:e.optional.string})));return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>function(e){return"view"in e&&"waveform"===e.view}(e)?64:1,reader:e=>e=>rw(e)?e:[]},controller:e=>{var t,n,i;return new sw(e.document,{props:Ge.fromObject({max:null!==(t="max"in e.params?e.params.max:null)&&void 0!==t?t:null,min:null!==(n="min"in e.params?e.params.min:null)&&void 0!==n?n:null,lineStyle:null!==(i="style"in e.params?e.params.style:null)&&void 0!==i?i:"linear"}),value:e.value,viewProps:e.viewProps})}});new class extends ue{constructor(e){super(),pe(this,e,Mw,Lw,a,{},null,[-1,-1])}}({target:document.getElementById("ui")});const Sw=new class{constructor(e,{width:t=100,height:n=10,maxFps:i=60}={}){this.canvas=e,this.ctx=e.getContext("2d"),this.width=t,this.height=n,this.maxFps=i,this.history=new Array(t).fill(0),this.frameCount=0,this.lastFpsUpdate=performance.now(),this.currentFps=0}record(e=performance.now()){this.frameCount++;const t=e-this.lastFpsUpdate;t>=200&&(this.currentFps=this.frameCount/(t/1e3),this.frameCount=0,this.lastFpsUpdate=e,this.history.push(this.currentFps),this.history.length>this.width&&this.history.shift())}draw(){this.ctx.clearRect(0,0,this.width,this.height),this.ctx.fillStyle="#4af";for(let e=0;e<this.history.length;e++){const t=Math.round(this.history[e]/this.maxFps*this.height);this.ctx.fillRect(e,this.height-t,1,t)}this.ctx.fillStyle="#fff",this.ctx.font="8px monospace",this.ctx.fillText(Math.round(this.currentFps)+" fps",2,8)}}(document.getElementById("fps-canvas")),Aw=new class{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.bins=20,this.histogram=new Array(this.bins).fill(0)}update(e){this.histogram.fill(0);for(const t of e){const e=Math.floor((t+1)*(this.bins/2)),n=Math.max(0,Math.min(this.bins-1,e));this.histogram[n]++}}draw(){const e=this.ctx,t=this.canvas,n=Math.max(...this.histogram);e.clearRect(0,0,t.width,t.height);const i=t.width/this.bins;e.fillStyle="rgba(255, 255, 255, 0.5)";for(let s=0;s<this.bins;s++){const r=this.histogram[s]/n*t.height;e.fillRect(s*i,t.height-r,i-1,r)}}}(document.getElementById("histogram-canvas")),Dw=new class{constructor(e,{width:t=256,height:n=100}={}){this.canvas=e,this.ctx=e.getContext("2d"),this.width=t,this.height=n,this.history=new Array(t).fill({min:0,max:0})}record(e,t){this.history.push({min:e,max:t}),this.history.length>this.width&&this.history.shift()}draw(){const e=this.ctx;e.clearRect(0,0,this.width,this.height),e.strokeStyle="#4af",e.beginPath();for(let t=0;t<this.history.length;t++){const n=this.height-(this.history[t].max+1)*this.height/2;0===t?e.moveTo(t,n):e.lineTo(t,n)}e.stroke(),e.strokeStyle="#fa4",e.beginPath();for(let t=0;t<this.history.length;t++){const n=this.height-(this.history[t].min+1)*this.height/2;0===t?e.moveTo(t,n):e.lineTo(t,n)}e.stroke();const t=this.history[this.history.length-1];if(t){let n=1/0,i=-1/0;for(const e of this.history)e.min<n&&(n=e.min),e.max>i&&(i=e.max);e.font="12px monospace",e.fillStyle="#fff",e.textAlign="left",e.textBaseline="middle";const s=this.height/2;e.fillText(`min: ${t.min.toFixed(4)} (${n.toFixed(4)})`,4,s-8),e.fillText(`max: ${t.max.toFixed(4)} (${i.toFixed(4)})`,4,s+8)}}}(document.getElementById("minmax-canvas")),jw=document.getElementById("demo-canvas"),Tw=jw.getContext("2d"),Nw=jw.width,Bw=jw.height;Le.subscribe((e=>{}));let Ow=null;const zw={PerlinNoise2DTime:be,FlowNoise2DTime:we,FBMNoise2DTime:class{#f=0;constructor(e,{octaves:t=4,persistence:n=.5,lacunarity:i=2}={}){this.baseNoise=e,this.octaves=t,this.persistence=n,this.lacunarity=i}get time(){return this.#f}setTime(e){this.#f=e,this.baseNoise.setTime(e)}advanceTime(e){this.#f+=e,this.baseNoise.advanceTime(e)}getValue(e,t){let n=0,i=1,s=0,r=1;for(let o=0;o<this.octaves;o++)this.baseNoise.setTime(this.time*r),n+=this.baseNoise.getValue(e*r,t*r)*i,s+=i,i*=this.persistence,r*=this.lacunarity;return this.baseNoise.setTime(this.time),n/s}},TurbulenceNoise2DTime:class{#f=0;constructor(e,{octaves:t=4,persistence:n=.5,lacunarity:i=2}={}){this.baseNoise=e,this.octaves=t,this.persistence=n,this.lacunarity=i}get time(){return this.#f}setTime(e){this.#f=e,this.baseNoise.setTime(e)}advanceTime(e){this.#f+=e,this.baseNoise.advanceTime(e)}getValue(e,t){let n=0,i=1,s=0,r=1;for(let o=0;o<this.octaves;o++)this.baseNoise.setTime(this.time*r),n+=Math.abs(this.baseNoise.getValue(e*r,t*r))*i,s+=i,i*=this.persistence,r*=this.lacunarity;return this.baseNoise.setTime(this.time),n/s}}};const Fw={t:0,noiseValues:[]};function Iw(e,t){!function(){const e=c($e),t=Pe[e];if(!t)throw new Error("Unknown noise type: "+e);const n=c(t),i=c(Le);if(i[e]||i.noiseType){let t;if("FBMNoise2DTime"===e||"TurbulenceNoise2DTime"===e){const i=n.baseType,s="PerlinNoise2DTime"===i?n.perlinBaseParams:n.flowBaseParams,r=zw[i];if(!r)throw new Error("Unknown base noise type: "+i);const o=new r(s),a={octaves:n.octaves,persistence:n.persistence,lacunarity:n.lacunarity};t=new(0,zw[e])(o,a)}else t=new(0,zw[e])(n);t.setTime(Fw.t*c(Ve)*c(ke)),Ow=t,Le.clear(e),Le.clear("noiseType")}}();const{animating:n,speed:i,useAdvanceTime:s}=c(Me),r=c(ke),o=c(Ve);if(n){const e=Fw.t+t*i;Fw.t=e,s?Ow.advanceTime(t*i*o*r):Ow.setTime(e*o*r)}let a=[];for(let e=0;e<Bw;e++)for(let t=0;t<Nw;t++){const n=Ow.getValue(t*r,e*r);a.push(n)}Aw.update(a);const l=a.reduce(((e,t)=>Math.min(e,t)),1/0),h=a.reduce(((e,t)=>Math.max(e,t)),-1/0);Dw.record(l,h),Fw.noiseValues=a,Sw.record(e)}function Rw(){const e=Fw.noiseValues,t=c(ke),n=c(Ve),{colorMode:i,showScaleVisualization:s}=c(De),r=Tw.createImageData(Nw,Bw);let o=0;for(let t=0;t<Bw;t++)for(let n=0;n<Nw;n++){const s=e[t*Nw+n];let a,l,c;switch(i){case Se.HEIGHT_BANDS:{const e=12;a=l=c=Math.floor((s+1)/2*e)%2==0?0:255;break}case Se.GEOGRAPHICAL:s>=0?(a=0,l=Math.floor(127.5+127.5*s),c=0):(a=0,l=0,c=Math.floor(127.5-127.5*s));break;case Se.GRAYSCALE:default:a=l=c=Math.floor(127.5*(s+1));break}r.data[o++]=a,r.data[o++]=l,r.data[o++]=c,r.data[o++]=255}if(Tw.putImageData(r,0,0),s){!function(e,t,n,i,s="rgba(255, 255, 255, 0.2)"){const r=1/i;e.strokeStyle=s,e.lineWidth=1,e.beginPath();for(let i=0;i<t;i+=r)e.moveTo(i,0),e.lineTo(i,n);for(let i=0;i<n;i+=r)e.moveTo(0,i),e.lineTo(t,i);e.stroke()}(Tw,Nw,Bw,t);const e=1/(t*n),i=Fw.t%e/e;!function(e,t,n,i,s,r="rgba(255, 0, 0, 0.5)"){e.beginPath(),e.moveTo(t,n),e.arc(t,n,i,-Math.PI/2,-Math.PI/2+2*Math.PI*s),e.closePath(),e.fillStyle=r,e.fill()}(Tw,Nw-50,50,20,i)}Aw.draw(),Dw.draw(),Sw.draw()}let qw=performance.now();return function e(t=performance.now()){const n=(t-qw)/1e3;qw=t,Iw(t,n),Rw(),requestAnimationFrame(e)}(),e.noiseClasses=zw,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=bundle.js.map
